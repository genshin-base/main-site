{"version":3,"file":"main.ru.93ed53ca.js","mappings":"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","sources":["webpack://gi_builds/webpack/runtime/load script","webpack://gi_builds/./node_modules/preact/dist/preact.module.js","webpack://gi_builds/./node_modules/preact/hooks/dist/hooks.module.js","webpack://gi_builds/./node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js","webpack://gi_builds/./node_modules/preact/compat/src/portals.js","webpack://gi_builds/./www/src/utils/preact-compat.tsx","webpack://gi_builds/./node_modules/preact/compat/src/memo.js","webpack://gi_builds/./node_modules/preact/compat/src/util.js","webpack://gi_builds/./lib/utils/values.js","webpack://gi_builds/webpack/bootstrap","webpack://gi_builds/webpack/runtime/define property getters","webpack://gi_builds/webpack/runtime/ensure chunk","webpack://gi_builds/webpack/runtime/get javascript chunk filename","webpack://gi_builds/webpack/runtime/get mini-css chunk filename","webpack://gi_builds/webpack/runtime/hasOwnProperty shorthand","webpack://gi_builds/webpack/runtime/make namespace object","webpack://gi_builds/webpack/runtime/publicPath","webpack://gi_builds/webpack/runtime/jsonp chunk loading","webpack://gi_builds/./www/src/errors/rollbar.ts","webpack://gi_builds/./www/src/errors/index.ts","webpack://gi_builds/./www/src/errors/catch.ts","webpack://gi_builds/./lib/utils/collections.js","webpack://gi_builds/./www/src/utils/bootstrap.tsx","webpack://gi_builds/./www/src/utils/hooks.tsx","webpack://gi_builds/./www/src/utils/typography.tsx","webpack://gi_builds/./www/src/components/go-up-btn.tsx","webpack://gi_builds/./www/src/components/page-wrap.tsx","webpack://gi_builds/./www/src/utils/links.tsx","webpack://gi_builds/./www/src/i18n/i18n.tsx","webpack://gi_builds/./www/src/utils/dom.tsx","webpack://gi_builds/./www/src/modals/report-bug.tsx","webpack://gi_builds/./www/src/containers/footer.tsx","webpack://gi_builds/./www/src/api/generated.js","webpack://gi_builds/./www/src/routes/paths.js","webpack://gi_builds/./www/src/routes/router.tsx","webpack://gi_builds/./www/src/components/globe-icon.tsx","webpack://gi_builds/./www/src/components/nav.tsx","webpack://gi_builds/./lib/genshin.js","webpack://gi_builds/./lib/utils/date.js","webpack://gi_builds/./www/src/api/utils.ts","webpack://gi_builds/./www/src/api/endpoints.ts","webpack://gi_builds/./www/src/components/block-header.tsx","webpack://gi_builds/./www/src/components/placeholders.tsx","webpack://gi_builds/./www/src/modules/equipment/common.tsx","webpack://gi_builds/./www/src/media/circlet.png","webpack://gi_builds/./www/src/media/flower.png","webpack://gi_builds/./www/src/media/goblet.png","webpack://gi_builds/./www/src/media/plume.png","webpack://gi_builds/./www/src/media/sands.png","webpack://gi_builds/./www/src/utils/artifacts.tsx","webpack://gi_builds/./www/src/utils/calc-pos-for-dd.tsx","webpack://gi_builds/./www/src/utils/characters.tsx","webpack://gi_builds/./www/src/media/Icon_Bow.png","webpack://gi_builds/./www/src/media/Icon_Catalyst.png","webpack://gi_builds/./www/src/media/Icon_Claymore.png","webpack://gi_builds/./www/src/media/Icon_Polearm.png","webpack://gi_builds/./www/src/utils/weapons.tsx","webpack://gi_builds/./www/src/media/Icon_Sword.png","webpack://gi_builds/./www/src/components/tooltip.tsx","webpack://gi_builds/./www/src/components/mobile-desc-switch.tsx","webpack://gi_builds/./www/src/components/tabs.tsx","webpack://gi_builds/./www/src/containers/item-cards/item-detail-dd-portal.tsx","webpack://gi_builds/./www/src/utils/items.tsx","webpack://gi_builds/./www/src/containers/alchemy-calculator.tsx","webpack://gi_builds/./www/src/components/select.tsx","webpack://gi_builds/./www/src/containers/item-cards/card-map.tsx","webpack://gi_builds/./www/src/utils/domains.tsx","webpack://gi_builds/./www/src/utils/enemies.tsx","webpack://gi_builds/./www/src/utils/local-storage-keys.tsx","webpack://gi_builds/./www/src/containers/item-cards/common.tsx","webpack://gi_builds/./www/src/containers/item-cards/dd-cards.tsx","webpack://gi_builds/./www/src/modules/builds/common.tsx","webpack://gi_builds/./www/src/media/Element_Anemo.png","webpack://gi_builds/./www/src/media/Element_Cryo.png","webpack://gi_builds/./www/src/media/Element_Electro.png","webpack://gi_builds/./www/src/media/Element_Geo.png","webpack://gi_builds/./www/src/media/Element_Hydro.png","webpack://gi_builds/./www/src/utils/elements.tsx","webpack://gi_builds/./www/src/media/Element_Pyro.png","webpack://gi_builds/./www/src/containers/item-cards/item-avatars.tsx","webpack://gi_builds/./www/src/containers/mega-search.tsx","webpack://gi_builds/./www/src/containers/header.tsx","webpack://gi_builds/./www/src/i18n/about-site.tsx","webpack://gi_builds/./www/src/api/index.ts","webpack://gi_builds/./www/src/components/weapon-type-filter.tsx","webpack://gi_builds/./www/src/containers/character-picker/mobile-character-picker.tsx","webpack://gi_builds/./www/src/containers/character-picker/character-picker.tsx","webpack://gi_builds/./www/src/containers/character-picker/favorite-characters.tsx","webpack://gi_builds/./www/src/components/characters.tsx","webpack://gi_builds/./www/src/modules/builds/character-build-detailed.tsx","webpack://gi_builds/./www/src/components/accordion.tsx","webpack://gi_builds/./www/src/containers/item-cards/line-cards/artifact-card.tsx","webpack://gi_builds/./www/src/modules/equipment/artifacts-list.tsx","webpack://gi_builds/./www/src/containers/item-cards/line-cards/weapon-card.tsx","webpack://gi_builds/./www/src/modules/equipment/weapons-list.tsx","webpack://gi_builds/./www/src/modules/equipment/index.tsx","webpack://gi_builds/./www/src/containers/farm-today.tsx","webpack://gi_builds/./www/src/containers/region-switch.tsx","webpack://gi_builds/./www/src/containers/time-until-day-reset.tsx","webpack://gi_builds/./www/src/modules/builds/character-build-preview.tsx","webpack://gi_builds/./www/src/pages/front-page.tsx","webpack://gi_builds/./www/src/App.tsx","webpack://gi_builds/./www/src/pages/builds.tsx","webpack://gi_builds/./www/src/pages/equipment.tsx","webpack://gi_builds/./www/src/pages/about.tsx","webpack://gi_builds/./www/src/index.tsx"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"gi_builds:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\t\tscript.type = \"module\";\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\t;\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","var n,l,u,i,t,o,r,f,e={},c=[],s=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function a(n,l){for(var u in l)n[u]=l[u];return n}function h(n){var l=n.parentNode;l&&l.removeChild(n)}function v(l,u,i){var t,o,r,f={};for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),\"function\"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return y(l,f,t,o,null)}function y(n,i,t,o,r){var f={type:n,props:i,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++u:r};return null==r&&null!=l.vnode&&l.vnode(f),f}function p(){return{current:null}}function d(n){return n.children}function _(n,l){this.props=n,this.context=l}function k(n,l){if(null==l)return n.__?k(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?k(n):null}function b(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return b(n)}}function m(n){(!n.__d&&(n.__d=!0)&&t.push(n)&&!g.__r++||r!==l.debounceRendering)&&((r=l.debounceRendering)||o)(g)}function g(){for(var n;g.__r=t.length;)n=t.sort(function(n,l){return n.__v.__b-l.__v.__b}),t=[],n.some(function(n){var l,u,i,t,o,r;n.__d&&(o=(t=(l=n).__v).__e,(r=l.__P)&&(u=[],(i=a({},t)).__v=t.__v+1,j(r,t,i,l.__n,void 0!==r.ownerSVGElement,null!=t.__h?[o]:null,u,null==o?k(t):o,t.__h),z(u,t),t.__e!=o&&b(t)))})}function w(n,l,u,i,t,o,r,f,s,a){var h,v,p,_,b,m,g,w=i&&i.__k||c,A=w.length;for(u.__k=[],h=0;h<l.length;h++)if(null!=(_=u.__k[h]=null==(_=l[h])||\"boolean\"==typeof _?null:\"string\"==typeof _||\"number\"==typeof _||\"bigint\"==typeof _?y(null,_,null,null,_):Array.isArray(_)?y(d,{children:_},null,null,null):_.__b>0?y(_.type,_.props,_.key,null,_.__v):_)){if(_.__=u,_.__b=u.__b+1,null===(p=w[h])||p&&_.key==p.key&&_.type===p.type)w[h]=void 0;else for(v=0;v<A;v++){if((p=w[v])&&_.key==p.key&&_.type===p.type){w[v]=void 0;break}p=null}j(n,_,p=p||e,t,o,r,f,s,a),b=_.__e,(v=_.ref)&&p.ref!=v&&(g||(g=[]),p.ref&&g.push(p.ref,null,_),g.push(v,_.__c||b,_)),null!=b?(null==m&&(m=b),\"function\"==typeof _.type&&_.__k===p.__k?_.__d=s=x(_,s,n):s=P(n,_,p,w,b,s),\"function\"==typeof u.type&&(u.__d=s)):s&&p.__e==s&&s.parentNode!=n&&(s=k(p))}for(u.__e=m,h=A;h--;)null!=w[h]&&(\"function\"==typeof u.type&&null!=w[h].__e&&w[h].__e==u.__d&&(u.__d=k(i,h+1)),N(w[h],w[h]));if(g)for(h=0;h<g.length;h++)M(g[h],g[++h],g[++h])}function x(n,l,u){for(var i,t=n.__k,o=0;t&&o<t.length;o++)(i=t[o])&&(i.__=n,l=\"function\"==typeof i.type?x(i,l,u):P(u,i,i,t,i.__e,l));return l}function A(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(Array.isArray(n)?n.some(function(n){A(n,l)}):l.push(n)),l}function P(n,l,u,i,t,o){var r,f,e;if(void 0!==l.__d)r=l.__d,l.__d=void 0;else if(null==u||t!=o||null==t.parentNode)n:if(null==o||o.parentNode!==n)n.appendChild(t),r=null;else{for(f=o,e=0;(f=f.nextSibling)&&e<i.length;e+=2)if(f==t)break n;n.insertBefore(t,o),r=o}return void 0!==r?r:t.nextSibling}function C(n,l,u,i,t){var o;for(o in u)\"children\"===o||\"key\"===o||o in l||H(n,o,null,u[o],i);for(o in l)t&&\"function\"!=typeof l[o]||\"children\"===o||\"key\"===o||\"value\"===o||\"checked\"===o||u[o]===l[o]||H(n,o,l[o],u[o],i)}function $(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=null==u?\"\":\"number\"!=typeof u||s.test(l)?u:u+\"px\"}function H(n,l,u,i,t){var o;n:if(\"style\"===l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof i&&(n.style.cssText=i=\"\"),i)for(l in i)u&&l in u||$(n.style,l,\"\");if(u)for(l in u)i&&u[l]===i[l]||$(n.style,l,u[l])}else if(\"o\"===l[0]&&\"n\"===l[1])o=l!==(l=l.replace(/Capture$/,\"\")),l=l.toLowerCase()in n?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?i||n.addEventListener(l,o?T:I,o):n.removeEventListener(l,o?T:I,o);else if(\"dangerouslySetInnerHTML\"!==l){if(t)l=l.replace(/xlink[H:h]/,\"h\").replace(/sName$/,\"s\");else if(\"href\"!==l&&\"list\"!==l&&\"form\"!==l&&\"tabIndex\"!==l&&\"download\"!==l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null!=u&&(!1!==u||\"a\"===l[0]&&\"r\"===l[1])?n.setAttribute(l,u):n.removeAttribute(l))}}function I(n){this.l[n.type+!1](l.event?l.event(n):n)}function T(n){this.l[n.type+!0](l.event?l.event(n):n)}function j(n,u,i,t,o,r,f,e,c){var s,h,v,y,p,k,b,m,g,x,A,P=u.type;if(void 0!==u.constructor)return null;null!=i.__h&&(c=i.__h,e=u.__e=i.__e,u.__h=null,r=[e]),(s=l.__b)&&s(u);try{n:if(\"function\"==typeof P){if(m=u.props,g=(s=P.contextType)&&t[s.__c],x=s?g?g.props.value:s.__:t,i.__c?b=(h=u.__c=i.__c).__=h.__E:(\"prototype\"in P&&P.prototype.render?u.__c=h=new P(m,x):(u.__c=h=new _(m,x),h.constructor=P,h.render=O),g&&g.sub(h),h.props=m,h.state||(h.state={}),h.context=x,h.__n=t,v=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=P.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=a({},h.__s)),a(h.__s,P.getDerivedStateFromProps(m,h.__s))),y=h.props,p=h.state,v)null==P.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==P.getDerivedStateFromProps&&m!==y&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(m,x),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(m,h.__s,x)||u.__v===i.__v){h.props=m,h.state=h.__s,u.__v!==i.__v&&(h.__d=!1),h.__v=u,u.__e=i.__e,u.__k=i.__k,u.__k.forEach(function(n){n&&(n.__=u)}),h.__h.length&&f.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(m,h.__s,x),null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(y,p,k)})}h.context=x,h.props=m,h.state=h.__s,(s=l.__r)&&s(u),h.__d=!1,h.__v=u,h.__P=n,s=h.render(h.props,h.state,h.context),h.state=h.__s,null!=h.getChildContext&&(t=a(a({},t),h.getChildContext())),v||null==h.getSnapshotBeforeUpdate||(k=h.getSnapshotBeforeUpdate(y,p)),A=null!=s&&s.type===d&&null==s.key?s.props.children:s,w(n,Array.isArray(A)?A:[A],u,i,t,o,r,f,e,c),h.base=u.__e,u.__h=null,h.__h.length&&f.push(h),b&&(h.__E=h.__=null),h.__e=!1}else null==r&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=L(i.__e,u,i,t,o,r,f,c);(s=l.diffed)&&s(u)}catch(n){u.__v=null,(c||null!=r)&&(u.__e=e,u.__h=!!c,r[r.indexOf(e)]=null),l.__e(n,u,i)}}function z(n,u){l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function L(l,u,i,t,o,r,f,c){var s,a,v,y=i.props,p=u.props,d=u.type,_=0;if(\"svg\"===d&&(o=!0),null!=r)for(;_<r.length;_++)if((s=r[_])&&\"setAttribute\"in s==!!d&&(d?s.localName===d:3===s.nodeType)){l=s,r[_]=null;break}if(null==l){if(null===d)return document.createTextNode(p);l=o?document.createElementNS(\"http://www.w3.org/2000/svg\",d):document.createElement(d,p.is&&p),r=null,c=!1}if(null===d)y===p||c&&l.data===p||(l.data=p);else{if(r=r&&n.call(l.childNodes),a=(y=i.props||e).dangerouslySetInnerHTML,v=p.dangerouslySetInnerHTML,!c){if(null!=r)for(y={},_=0;_<l.attributes.length;_++)y[l.attributes[_].name]=l.attributes[_].value;(v||a)&&(v&&(a&&v.__html==a.__html||v.__html===l.innerHTML)||(l.innerHTML=v&&v.__html||\"\"))}if(C(l,p,y,o,c),v)u.__k=[];else if(_=u.props.children,w(l,Array.isArray(_)?_:[_],u,i,t,o&&\"foreignObject\"!==d,r,f,r?r[0]:i.__k&&k(i,0),c),null!=r)for(_=r.length;_--;)null!=r[_]&&h(r[_]);c||(\"value\"in p&&void 0!==(_=p.value)&&(_!==l.value||\"progress\"===d&&!_||\"option\"===d&&_!==y.value)&&H(l,\"value\",_,y.value,!1),\"checked\"in p&&void 0!==(_=p.checked)&&_!==l.checked&&H(l,\"checked\",_,y.checked,!1))}return l}function M(n,u,i){try{\"function\"==typeof n?n(u):n.current=u}catch(n){l.__e(n,i)}}function N(n,u,i){var t,o;if(l.unmount&&l.unmount(n),(t=n.ref)&&(t.current&&t.current!==n.__e||M(t,null,u)),null!=(t=n.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(n){l.__e(n,u)}t.base=t.__P=null}if(t=n.__k)for(o=0;o<t.length;o++)t[o]&&N(t[o],u,\"function\"!=typeof n.type);i||null==n.__e||h(n.__e),n.__e=n.__d=void 0}function O(n,l,u){return this.constructor(n,u)}function S(u,i,t){var o,r,f;l.__&&l.__(u,i),r=(o=\"function\"==typeof t)?null:t&&t.__k||i.__k,f=[],j(i,u=(!o&&t||i).__k=v(d,null,[u]),r||e,e,void 0!==i.ownerSVGElement,!o&&t?[t]:r?null:i.firstChild?n.call(i.childNodes):null,f,!o&&t?t:r?r.__e:i.firstChild,o),z(f,u)}function q(n,l){S(n,l,q)}function B(l,u,i){var t,o,r,f=a({},l.props);for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),y(l.type,f,t||l.key,o||l.ref,null)}function D(n,l){var u={__c:l=\"__cC\"+f++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var u,i;return this.getChildContext||(u=[],(i={})[l]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&u.some(m)},this.sub=function(n){u.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u.splice(u.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Provider.__=u.Consumer.contextType=u}n=c.slice,l={__e:function(n,l){for(var u,i,t;l=l.__;)if((u=l.__c)&&!u.__)try{if((i=u.constructor)&&null!=i.getDerivedStateFromError&&(u.setState(i.getDerivedStateFromError(n)),t=u.__d),null!=u.componentDidCatch&&(u.componentDidCatch(n),t=u.__d),t)return u.__E=u}catch(l){n=l}throw n}},u=0,i=function(n){return null!=n&&void 0===n.constructor},_.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=a({},this.state),\"function\"==typeof n&&(n=n(a({},u),this.props)),n&&a(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),m(this))},_.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),m(this))},_.prototype.render=d,t=[],o=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,g.__r=0,f=0;export{S as render,q as hydrate,v as createElement,v as h,d as Fragment,p as createRef,i as isValidElement,_ as Component,B as cloneElement,D as createContext,A as toChildArray,l as options};\n//# sourceMappingURL=preact.module.js.map\n","import{options as n}from\"preact\";var t,u,r,o=0,i=[],c=n.__b,f=n.__r,e=n.diffed,a=n.__c,v=n.unmount;function m(t,r){n.__h&&n.__h(u,t,o||r),o=0;var i=u.__H||(u.__H={__:[],__h:[]});return t>=i.__.length&&i.__.push({}),i.__[t]}function l(n){return o=1,p(w,n)}function p(n,r,o){var i=m(t++,2);return i.t=n,i.__c||(i.__=[o?o(r):w(void 0,r),function(n){var t=i.t(i.__[0],n);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}],i.__c=u),i.__}function y(r,o){var i=m(t++,3);!n.__s&&k(i.__H,o)&&(i.__=r,i.__H=o,u.__H.__h.push(i))}function h(r,o){var i=m(t++,4);!n.__s&&k(i.__H,o)&&(i.__=r,i.__H=o,u.__h.push(i))}function s(n){return o=5,d(function(){return{current:n}},[])}function _(n,t,u){o=6,h(function(){\"function\"==typeof n?n(t()):n&&(n.current=t())},null==u?u:u.concat(n))}function d(n,u){var r=m(t++,7);return k(r.__H,u)&&(r.__=n(),r.__H=u,r.__h=n),r.__}function A(n,t){return o=8,d(function(){return n},t)}function F(n){var r=u.context[n.__c],o=m(t++,9);return o.c=n,r?(null==o.__&&(o.__=!0,r.sub(u)),r.props.value):n.__}function T(t,u){n.useDebugValue&&n.useDebugValue(u?u(t):t)}function q(n){var r=m(t++,10),o=l();return r.__=n,u.componentDidCatch||(u.componentDidCatch=function(n){r.__&&r.__(n),o[1](n)}),[o[0],function(){o[1](void 0)}]}function x(){for(var t;t=i.shift();)if(t.__P)try{t.__H.__h.forEach(g),t.__H.__h.forEach(j),t.__H.__h=[]}catch(u){t.__H.__h=[],n.__e(u,t.__v)}}n.__b=function(n){u=null,c&&c(n)},n.__r=function(n){f&&f(n),t=0;var r=(u=n.__c).__H;r&&(r.__h.forEach(g),r.__h.forEach(j),r.__h=[])},n.diffed=function(t){e&&e(t);var o=t.__c;o&&o.__H&&o.__H.__h.length&&(1!==i.push(o)&&r===n.requestAnimationFrame||((r=n.requestAnimationFrame)||function(n){var t,u=function(){clearTimeout(r),b&&cancelAnimationFrame(t),setTimeout(n)},r=setTimeout(u,100);b&&(t=requestAnimationFrame(u))})(x)),u=null},n.__c=function(t,u){u.some(function(t){try{t.__h.forEach(g),t.__h=t.__h.filter(function(n){return!n.__||j(n)})}catch(r){u.some(function(n){n.__h&&(n.__h=[])}),u=[],n.__e(r,t.__v)}}),a&&a(t,u)},n.unmount=function(t){v&&v(t);var u,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{g(n)}catch(n){u=n}}),u&&n.__e(u,r.__v))};var b=\"function\"==typeof requestAnimationFrame;function g(n){var t=u,r=n.__c;\"function\"==typeof r&&(n.__c=void 0,r()),u=t}function j(n){var t=u;n.__c=n.__(),u=t}function k(n,t){return!n||n.length!==t.length||t.some(function(t,u){return t!==n[u]})}function w(n,t){return\"function\"==typeof t?t(n):t}export{l as useState,p as useReducer,y as useEffect,h as useLayoutEffect,s as useRef,_ as useImperativeHandle,d as useMemo,A as useCallback,F as useContext,T as useDebugValue,q as useErrorBoundary};\n//# sourceMappingURL=hooks.module.js.map\n","import{options as r,Fragment as _}from\"preact\";export{Fragment}from\"preact\";var o=0;function e(_,e,n,t,f){var l,s,u={};for(s in e)\"ref\"==s?l=e[s]:u[s]=e[s];var a={type:_,props:u,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--o,__source:t,__self:f};if(\"function\"==typeof _&&(l=_.defaultProps))for(s in l)void 0===u[s]&&(u[s]=l[s]);return r.vnode&&r.vnode(a),a}export{e as jsx,e as jsxs,e as jsxDEV};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","import { createElement, render } from 'preact';\n\n/**\n * @param {import('../../src/index').RenderableProps<{ context: any }>} props\n */\nfunction ContextProvider(props) {\n\tthis.getChildContext = () => props.context;\n\treturn props.children;\n}\n\n/**\n * Portal component\n * @this {import('./internal').Component}\n * @param {object | null | undefined} props\n *\n * TODO: use createRoot() instead of fake root\n */\nfunction Portal(props) {\n\tconst _this = this;\n\tlet container = props._container;\n\n\t_this.componentWillUnmount = function() {\n\t\trender(null, _this._temp);\n\t\t_this._temp = null;\n\t\t_this._container = null;\n\t};\n\n\t// When we change container we should clear our old container and\n\t// indicate a new mount.\n\tif (_this._container && _this._container !== container) {\n\t\t_this.componentWillUnmount();\n\t}\n\n\t// When props.vnode is undefined/false/null we are dealing with some kind of\n\t// conditional vnode. This should not trigger a render.\n\tif (props._vnode) {\n\t\tif (!_this._temp) {\n\t\t\t_this._container = container;\n\n\t\t\t// Create a fake DOM parent node that manages a subset of `container`'s children:\n\t\t\t_this._temp = {\n\t\t\t\tnodeType: 1,\n\t\t\t\tparentNode: container,\n\t\t\t\tchildNodes: [],\n\t\t\t\tappendChild(child) {\n\t\t\t\t\tthis.childNodes.push(child);\n\t\t\t\t\t_this._container.appendChild(child);\n\t\t\t\t},\n\t\t\t\tinsertBefore(child, before) {\n\t\t\t\t\tthis.childNodes.push(child);\n\t\t\t\t\t_this._container.appendChild(child);\n\t\t\t\t},\n\t\t\t\tremoveChild(child) {\n\t\t\t\t\tthis.childNodes.splice(this.childNodes.indexOf(child) >>> 1, 1);\n\t\t\t\t\t_this._container.removeChild(child);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// Render our wrapping element into temp.\n\t\trender(\n\t\t\tcreateElement(ContextProvider, { context: _this.context }, props._vnode),\n\t\t\t_this._temp\n\t\t);\n\t}\n\t// When we come from a conditional render, on a mounted\n\t// portal we should clear the DOM.\n\telse if (_this._temp) {\n\t\t_this.componentWillUnmount();\n\t}\n}\n\n/**\n * Create a `Portal` to continue rendering the vnode tree at a different DOM node\n * @param {import('./internal').VNode} vnode The vnode to render\n * @param {import('./internal').PreactElement} container The DOM node to continue rendering in to.\n */\nexport function createPortal(vnode, container) {\n\treturn createElement(Portal, { _vnode: vnode, _container: container });\n}\n","// direct imports to avoid kilobytes of side-effects from 'preact/compat'\n// normal imports (preact/compat/src/memo) do not work with webpack (it strictly follows 'exports' field in package.json)\nimport { memo as memo_ } from '#src/../../node_modules/preact/compat/src/memo'\nimport { createPortal as createPortal_ } from '#src/../../node_modules/preact/compat/src/portals'\n\nimport type { createPortal as createPortalOrig } from 'preact/compat'\nimport type { memo as memoOrig } from 'preact/compat'\n\nexport const createPortal = createPortal_ as typeof createPortalOrig\nexport const memo = memo_ as typeof memoOrig\n","import { createElement } from 'preact';\nimport { shallowDiffers } from './util';\n\n/**\n * Memoize a component, so that it only updates when the props actually have\n * changed. This was previously known as `React.pure`.\n * @param {import('./internal').FunctionComponent} c functional component\n * @param {(prev: object, next: object) => boolean} [comparer] Custom equality function\n * @returns {import('./internal').FunctionComponent}\n */\nexport function memo(c, comparer) {\n\tfunction shouldUpdate(nextProps) {\n\t\tlet ref = this.props.ref;\n\t\tlet updateRef = ref == nextProps.ref;\n\t\tif (!updateRef && ref) {\n\t\t\tref.call ? ref(null) : (ref.current = null);\n\t\t}\n\n\t\tif (!comparer) {\n\t\t\treturn shallowDiffers(this.props, nextProps);\n\t\t}\n\n\t\treturn !comparer(this.props, nextProps) || !updateRef;\n\t}\n\n\tfunction Memoed(props) {\n\t\tthis.shouldComponentUpdate = shouldUpdate;\n\t\treturn createElement(c, props);\n\t}\n\tMemoed.displayName = 'Memo(' + (c.displayName || c.name) + ')';\n\tMemoed.prototype.isReactComponent = true;\n\tMemoed._forwarded = true;\n\treturn Memoed;\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Check if two objects have a different shape\n * @param {object} a\n * @param {object} b\n * @returns {boolean}\n */\nexport function shallowDiffers(a, b) {\n\tfor (let i in a) if (i !== '__source' && !(i in b)) return true;\n\tfor (let i in b) if (i !== '__source' && a[i] !== b[i]) return true;\n\treturn false;\n}\n\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","/**\n * @template T\n * @param {T|null} val\n * @returns {T}\n */\nexport function mustBeNotNull(val) {\n\tif (val === null) throw new Error('value is null, this should not happen')\n\treturn val\n}\n\n/**\n * @template T\n * @param {T|undefined} val\n * @returns {T}\n */\nexport function mustBeDefined(val) {\n\tif (val === undefined) throw new Error('value is undefined, this should not happen')\n\treturn val\n}\n\n/**\n * @template T\n * @param {T|undefined} x\n * @returns {x is T}\n */\nexport function isDefined(x) {\n\treturn x !== undefined\n}\n\n/**\n * @param {never[]} values\n * @returns {never}\n */\nexport function mustBeNever(...values) {\n\tthrow new Error('must not be reachable')\n}\n\n/**\n * @param {never[]} values\n * @returns {void}\n */\nexport function staticNever(...values) {\n\t// пустая функция, для тайпчекера\n}\n\n/**\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport function simpleDeepEqual(a, b) {\n\tif (Array.isArray(a) && Array.isArray(b)) {\n\t\tif (a.length !== b.length) return false\n\t\tfor (let i = 0; i < a.length; i++) {\n\t\t\tif (!simpleDeepEqual(a[i], b[i])) return false\n\t\t}\n\t\treturn true\n\t}\n\tif (typeof a === 'object' && typeof b === 'object' && a !== null && b !== null) {\n\t\tif (Object.keys(a).length !== Object.keys(b).length) return false\n\t\tfor (const attr in a) {\n\t\t\tif (!simpleDeepEqual(a[attr], b[attr])) return false\n\t\t}\n\t\treturn true\n\t}\n\treturn a === b\n}\n\n/**\n * @template TVal\n * @template TKey\n * @param {Iterable<TVal>} items\n * @param {(item:TVal) => TKey} keyFunc\n * @returns {Map<TKey, TVal[]>}\n */\nexport function groupByToMap(items, keyFunc) {\n\tconst map = /**@type {Map<TKey, TVal[]>}*/ (new Map())\n\tfor (const item of items) {\n\t\tconst key = keyFunc(item)\n\t\tconst cur = map.get(key)\n\t\tif (cur) cur.push(item)\n\t\telse map.set(key, [item])\n\t}\n\treturn map\n}\n\n/**\n * @param {number} min\n * @param {number} val\n * @param {number} max\n * @returns {number}\n */\nexport function clamp(min, val, max) {\n\treturn val < min ? min : val > max ? max : val\n}\n\n/** @returns {Promise<never>} */\nexport function promiseNever() {\n\treturn new Promise(() => undefined)\n}\n\n/**\n * @class\n * @template T\n */\nexport function Deferred() {\n\t/** @type {Promise<T>} */\n\tthis.promise = new Promise((res, rej) => {\n\t\tthis.resolve = res\n\t\tthis.reject = rej\n\t})\n}\n\n/**\n * @template T\n * @param {T | Promise<T>} value\n * @returns {value is Promise<T>}\n */\nexport function isPromise(value) {\n\treturn typeof value === 'object' && value !== null && 'then' in value\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + \"async\" + \".ru.\" + \"8ded562f\" + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkgi_builds\"] = self[\"webpackChunkgi_builds\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","const ROLLBAR_TOKEN = 'f5661155727c4a9e9db4d770357a0bcf'\n\nexport function sendError(class_: string, message: string): Promise<void> {\n\treturn sendNewItem('error', undefined, {\n\t\ttrace: {\n\t\t\tframes: [],\n\t\t\texception: {\n\t\t\t\tclass: class_,\n\t\t\t\tmessage,\n\t\t\t\t// description: '',\n\t\t\t},\n\t\t},\n\t})\n}\n\nexport function sendMessage(msg: string): Promise<void> {\n\treturn sendNewItem('warning', 'msg:' + Date.now(), {\n\t\tmessage: {\n\t\t\tbody: msg,\n\t\t},\n\t})\n}\n\n/**\n * {@link https://explorer.docs.rollbar.com/#operation/create-item}\n */\nfunction sendNewItem(level, fingerprint, rollbarBody) {\n\tconst body = JSON.stringify({\n\t\tdata: {\n\t\t\tenvironment: process.env.NODE_ENV,\n\t\t\tbody: rollbarBody,\n\t\t\tlevel,\n\t\t\tcode_version: BUNDLE_ENV.COMMIT_HASH,\n\t\t\tplatform: 'browser',\n\t\t\tcontext: location.href,\n\t\t\tclient: {\n\t\t\t\tjavascript: {\n\t\t\t\t\tbrowser: navigator.userAgent,\n\t\t\t\t\t// code_version: ''\n\t\t\t\t\t// source_map_enabled: false,\n\t\t\t\t},\n\t\t\t},\n\t\t\tfingerprint,\n\t\t},\n\t})\n\tconst headers = {\n\t\t'X-Rollbar-Access-Token': ROLLBAR_TOKEN,\n\t\t'Content-Type': 'application/json',\n\t}\n\treturn fetch('https://api.rollbar.com/api/1/item/', { method: 'POST', body, headers })\n\t\t.then(r => r.json())\n\t\t.then(resp => {\n\t\t\tif (resp.err !== 0) throw new Error(`rollbar: ` + resp.message)\n\t\t})\n}\n","import { sendError } from './rollbar'\n\nexport function logErrorExt(message: string | null, anyError: unknown, silent: boolean): void {\n\tconst error = anyError ? (anyError instanceof Error ? anyError : new Error(anyError + '')) : null\n\n\tif (!silent) console.error(message, error)\n\n\tconst class_ = error ? error.constructor.name : 'Message'\n\tconst text = (message ? message + '\\n' : '') + (error ? error.stack : '')\n\tsendError(class_, text).catch(console.error)\n}\n\nexport function logError(error: unknown): void {\n\tlogErrorExt(null, error, false)\n}\n","import './rollbar'\n\nimport { logErrorExt } from './'\n\nif (!BUNDLE_ENV.IS_SSR) {\n\twindow.addEventListener('error', e => {\n\t\t// похоже на ошибку во внешнем плагине, игнорируем её\n\t\tif (e.message === 'Script error.' && e.filename === '') return\n\t\t// e.message обычно начинается с \"Uncaught Error:\", можно не добавлять свой префикс\n\t\tconst msg = `${e.message} in ${e.filename}:${e.lineno}:${e.colno}`\n\t\tlogErrorExt(msg, e.error, true)\n\t})\n\n\twindow.addEventListener('unhandledrejection', e => {\n\t\t// при Promise.reject(123) у ошибки не будет ни сообщения, ни стека; такой \"reason\" отправляем просто текстом\n\t\tconst msg = 'Unhandled Rejection: ' + (e.reason?.message ? e.reason.message : e.reason + '')\n\t\tlogErrorExt(msg, e.reason, true)\n\t})\n}\n","/**\n * @template T\n * @param {T[]} arr\n * @returns {T[]}\n */\nexport function arrSimpleUniq(arr) {\n\treturn arr.filter((value, index, self) => self.indexOf(value) === index)\n}\n\n/**\n * @template T\n * @param {T[]} arr\n * @param {T[]} items\n * @returns {number}\n */\nexport function arrPushIfNew(arr, ...items) {\n\tfor (let i = 0; i < items.length; i++)\n\t\tif (!arr.includes(items[i])) {\n\t\t\tarr.push(items[i])\n\t\t}\n\treturn arr.length\n}\n/**\n * @template T\n * @param {T[]} arr\n * @param {T} item\n * @returns {T[]}\n */\nexport function toggleInArr(arr, item) {\n\tif (arr.includes(item)) arr = arr.filter(i => i !== item)\n\telse arr.push(item)\n\treturn arr\n}\n\n/**\n * @template TKey\n * @template TVal\n * @param {Map<TKey, TVal[]>} map\n * @param {TKey} key\n * @param {TVal} val\n * @returns {TVal[]}\n */\nexport function mappedArrPush(map, key, val) {\n\tlet values = map.get(key)\n\tif (values) {\n\t\tvalues.push(val)\n\t} else {\n\t\tvalues = [val]\n\t\tmap.set(key, values)\n\t}\n\treturn values\n}\n\n/**\n * @template T\n * @param {T[]} arr\n * @param {(item:T) => boolean} func\n * @returns {T[][]}\n */\nexport function arrSplitFn(arr, func) {\n\tconst res = /**@type {T[][]}*/ ([[]])\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tconst item = arr[i]\n\t\tif (func(item)) res.push([])\n\t\telse res[res.length - 1].push(item)\n\t}\n\treturn res\n}\n\n/**\n * @param {unknown[]} a\n * @param {unknown[]} b\n */\nexport function arrShallowEqualAsSets(a, b) {\n\tif (a.length !== b.length) return false\n\tfor (let i = 0; i < a.length; i++) if (!b.includes(a[i])) return false\n\treturn true\n}\n\n/**\n * @param {unknown[]} a\n * @param {unknown[]} b\n */\nexport function arrShallowEqual(a, b) {\n\tif (a.length !== b.length) return false\n\tfor (let i = 0; i < a.length; i++) if (a[i] !== b[i]) return false\n\treturn true\n}\n\n/**\n * @template {string} TKey\n * @template TVal\n * @param {Record<TKey, TVal>} obj\n * @param {(a:[TKey,TVal], b:[TKey,TVal]) => number} sortFunc\n * @returns {Record<TKey, TVal>}\n */\nexport function sortObject(obj, sortFunc) {\n\tconst entries = /**@type {[TKey,TVal][]}*/ (Object.entries(obj)).sort(sortFunc)\n\tfor (const key in obj) delete obj[key]\n\tfor (const [key, val] of entries) obj[key] = val\n\treturn obj\n}\n/**\n * @template T\n * @param {T[]} arr\n * @param {T} item\n * @param {1|-1} [direction]\n * @returns {T}\n */\nexport function arrGetAfter(arr, item, direction = 1) {\n\tconst index = arr.indexOf(item)\n\treturn arr[(index + direction + arr.length) % arr.length]\n}\n\n/**\n * @template TKey\n * @template TVal\n * @param {Map<TKey, TVal>} map\n * @param {TKey} key\n * @param {() => TVal} defaultFunc\n * @returns {TVal}\n */\nexport function mapGetOrSet(map, key, defaultFunc) {\n\tlet value = map.get(key)\n\tif (value === undefined) {\n\t\tvalue = defaultFunc()\n\t\tmap.set(key, value)\n\t}\n\treturn value\n}\n\n/**\n * @template {string} TKey\n * @template TVal\n * @param {Partial<Record<TKey, TVal>>} obj\n * @param {TKey} key\n * @param {() => TVal} defaultFunc\n * @returns {TVal}\n */\nexport function objGetOrSet(obj, key, defaultFunc) {\n\tlet value = obj[key]\n\tif (value === undefined) {\n\t\tobj[key] = value = defaultFunc()\n\t}\n\treturn /**@type {TVal}*/ (value)\n}\n\n/**\n * @param {unknown} obj\n * @param {(item:unknown) => undefined|true|'skip-children'} func return true to abort iteration\n * @returns {boolean}\n */\nexport function objForEach(obj, func) {\n\tconst res = func(obj)\n\tif (res === 'skip-children') return false\n\tif (res) return true\n\n\tif (Array.isArray(obj)) {\n\t\tfor (const item of obj) if (objForEach(item, func)) return true\n\t} else if (typeof obj === 'object' && obj !== null) {\n\t\tfor (const attr in obj) if (objForEach(obj[attr], func)) return true\n\t}\n\treturn false\n}\n\n/**\n * @template T\n * @param {T | T[]} item\n * @returns {T[]}\n */\nexport function arrOrItemToArr(item) {\n\treturn Array.isArray(item) ? item : [item]\n}\n/**\n * @template T\n * @param {T[]} arr\n * @returns {T[] | T}\n */\nexport function arrItemIfSingle(arr) {\n\treturn arr.length === 1 ? arr[0] : arr\n}\n","export type BS_BreakpointCode = 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'xxl'\nexport const BS_BreakpointsCodes: BS_BreakpointCode[] = ['xs', 'sm', 'md', 'lg', 'xl', 'xxl']\n\nexport const BS_BreakpointsMap = { xs: 0, sm: 576, md: 768, lg: 992, xl: 1200, xxl: 1400 }\nexport function BS_getCurrBreakpoint(screenWidth: number): BS_BreakpointCode {\n\treturn (\n\t\t//todo правильные типы\n\t\t(Object.keys(BS_BreakpointsMap).find(k => screenWidth < BS_BreakpointsMap[k]) as BS_BreakpointCode) ||\n\t\t('xxl' as BS_BreakpointCode)\n\t)\n}\nexport function BS_isBreakpointLessThen(br: BS_BreakpointCode, targetBr: BS_BreakpointCode): boolean {\n\treturn BS_BreakpointsCodes.indexOf(br) <= BS_BreakpointsCodes.indexOf(targetBr)\n}\n","import { Ref, RefObject } from 'preact'\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'preact/hooks'\n\nimport { arrShallowEqual } from '#lib/utils/collections'\nimport { isPromise } from '#lib/utils/values'\nimport { logError } from '#src/errors'\nimport { BS_BreakpointCode, BS_getCurrBreakpoint } from '#src/utils/bootstrap'\n\ntype Pending = { _type: 'pending' }\n\nexport const PENDING: Pending = {} as never\n\nexport type LoadingState<T> = T | Error | Pending\n\nexport function isLoaded<T>(value: LoadingState<T>): value is T {\n\treturn value !== PENDING && !(value instanceof Error)\n}\n\nexport function useFetch<T>(\n\tloadFunc: (abortSignal: AbortSignal) => T,\n\targs: unknown[],\n): LoadingState<Awaited<T>> {\n\tconst controller = useRef<AbortController | null>(null)\n\tconst prevArgs = useRef<unknown[] | null>(null)\n\tconst data = useRef<LoadingState<Awaited<T>>>(PENDING)\n\tconst foceUpdate = useForceUpdate()\n\n\tif (prevArgs.current === null || !arrShallowEqual(prevArgs.current, args)) {\n\t\tif (controller.current !== null) controller.current.abort()\n\t\tconst ac: AbortController | null = new AbortController()\n\t\tcontroller.current = ac\n\n\t\tconst res = loadFunc(ac.signal)\n\t\tif (isPromise(res)) {\n\t\t\tres.then(res => (data.current = res as Awaited<T>))\n\t\t\t\t.catch(err => (data.current = err))\n\t\t\t\t.finally(foceUpdate)\n\t\t\tdata.current = PENDING\n\t\t} else {\n\t\t\tdata.current = res as Awaited<T>\n\t\t}\n\n\t\tprevArgs.current = args\n\t}\n\n\t// абортим при отмонтировании компонента\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (controller.current !== null) controller.current.abort()\n\t\t}\n\t}, [])\n\treturn data.current\n}\n\nexport function useFetchWithPrev<T>(\n\tloadFunc: (abortSignal: AbortSignal) => Promise<T> | T,\n\targs: unknown[],\n): [data: LoadingState<T>, isUpdating: boolean] {\n\tconst prevDataRef = useRef<LoadingState<T>>(PENDING)\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst data = useFetch(loadFunc, args)\n\tif (isLoaded(data)) prevDataRef.current = data\n\treturn [isLoaded(data) ? data : prevDataRef.current, data === PENDING]\n}\n\nexport const useToggle = (initial: boolean): [boolean, () => void] => {\n\tconst [flagState, setFlagState] = useState(initial)\n\treturn [flagState, useCallback(() => setFlagState(status => !status), [])]\n}\n\nexport const useClickAway = (\n\trefs: preact.RefObject<HTMLElement> | preact.RefObject<HTMLElement>[],\n\tcallback?: () => void,\n): void => {\n\tconst handleClick = (e: MouseEvent | TouchEvent) => {\n\t\tconst refsLocal = Array.isArray(refs) ? refs : [refs]\n\t\tconst isClickAwayEveryone = refsLocal.every(\n\t\t\tref => ref.current && e.target instanceof HTMLElement && !ref.current.contains(e.target),\n\t\t)\n\t\tif (isClickAwayEveryone) callback && callback()\n\t}\n\tuseEffect(() => {\n\t\tdocument.addEventListener('mousedown', handleClick)\n\t\tdocument.addEventListener('touchstart', handleClick)\n\t\t// document.addEventListener('click', handleClick)\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('mousedown', handleClick)\n\t\t\tdocument.removeEventListener('touchstart', handleClick)\n\t\t\t// document.removeEventListener('click', handleClick)\n\t\t}\n\t})\n}\n\ninterface WindowSize {\n\twidth: number | undefined\n\theight: number | undefined\n\tbreakpoint: BS_BreakpointCode\n}\nexport function useWindowSize(): WindowSize {\n\tconst [windowSize, setWindowSize] = useState<WindowSize>({\n\t\twidth: window.innerWidth,\n\t\theight: window.innerHeight,\n\t\tbreakpoint: BS_getCurrBreakpoint(window.innerWidth),\n\t})\n\tuseEffect(() => {\n\t\tfunction handleResize() {\n\t\t\tsetWindowSize({\n\t\t\t\twidth: window.innerWidth,\n\t\t\t\theight: window.innerHeight,\n\t\t\t\tbreakpoint: BS_getCurrBreakpoint(window.innerWidth),\n\t\t\t})\n\t\t}\n\t\twindow.addEventListener('resize', handleResize)\n\t\thandleResize()\n\t\treturn () => window.removeEventListener('resize', handleResize)\n\t}, [])\n\treturn windowSize\n}\n\ndeclare global {\n\tinterface WindowEventMap {\n\t\t'x-local-tab-storage': CustomEvent<{ key: string }>\n\t\t'x-local-hashchange': CustomEvent<null>\n\t}\n}\n\nexport function useLocalStorage<T>(key: string, initialValue: T): [T, (val: T) => unknown] {\n\tconst [value, setValueInner] = useState(() => {\n\t\ttry {\n\t\t\tconst curRecord = localStorage.getItem(key) //reading 'localStorage' from window may fail with SecurityError\n\t\t\treturn curRecord ? JSON.parse(curRecord) : initialValue //JSON parsing may fail\n\t\t} catch (ex) {\n\t\t\tlogError(ex)\n\t\t\treturn initialValue\n\t\t}\n\t})\n\n\tconst setValueAndSave = useCallback(\n\t\t(val: T) => {\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem(key, JSON.stringify(val)) //reading 'localStorage' from window may fail with SecurityError\n\t\t\t} catch (ex) {\n\t\t\t\t// ¯\\_(ツ)_/¯\n\t\t\t}\n\t\t\tsetValueInner(val)\n\t\t\tdispatchEvent(new CustomEvent('x-local-tab-storage', { detail: { key } }))\n\t\t},\n\t\t[key],\n\t)\n\n\tuseEffect(() => {\n\t\tfunction onStorage(e: StorageEvent | CustomEvent<{ key: string }>) {\n\t\t\tconst affectedKey = 'detail' in e ? e.detail.key : e.key\n\t\t\tif (affectedKey === key) {\n\t\t\t\ttry {\n\t\t\t\t\tconst curRecord = localStorage.getItem(key) //reading 'localStorage' from window may fail with SecurityError\n\t\t\t\t\tif (curRecord) setValueInner(JSON.parse(curRecord)) //JSON parsing may fail\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tconsole.log(ex)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\taddEventListener('storage', onStorage)\n\t\taddEventListener('x-local-tab-storage', onStorage)\n\t\treturn () => {\n\t\t\tremoveEventListener('storage', onStorage)\n\t\t\tremoveEventListener('x-local-tab-storage', onStorage)\n\t\t}\n\t}, [key])\n\n\treturn [value, setValueAndSave]\n}\n\nexport type Migration<TIn, TOut> = (val: TIn) => TOut\ntype MigrationResult<T> = T extends Migration<infer _A, infer B> ? B : never\ntype Last<T> = T extends readonly [...infer _I, infer L] ? L : never\ntype VersionedValue<T> = { version: number; value: T }\n\nexport function useVersionedStorage<T extends readonly Migration<unknown, unknown>[]>({\n\tkey,\n\tversions,\n}: {\n\tkey: string\n\tversions: T\n}): [MigrationResult<Last<T>>, (val: MigrationResult<Last<T>>) => unknown] {\n\tconst [val, setVal] = useLocalStorage<VersionedValue<unknown> | null>(key, null)\n\n\tlet version = -1\n\tlet value = null as unknown\n\tif (val && typeof val === 'object' && 'version' in val) {\n\t\t;({ version, value } = val)\n\t}\n\tfor (let i = version + 1; i < versions.length; i++) {\n\t\tvalue = versions[i](value)\n\t\tversion = i\n\t}\n\n\tconst setValInner = useCallback(\n\t\t(value: MigrationResult<Last<T>>) => {\n\t\t\tsetVal({ version, value })\n\t\t},\n\t\t[setVal, version],\n\t)\n\treturn [value as MigrationResult<Last<T>>, setValInner]\n}\n\nexport function useHover<T extends Element>(): [RefObject<T>, boolean] {\n\tconst [value, setValue] = useState<boolean>(false)\n\tconst ref = useRef<T | null>(null)\n\tuseEffect(\n\t\t() => {\n\t\t\tconst node = ref.current\n\t\t\tif (!node) return\n\n\t\t\tconst handleMouseOver = () => setValue(true)\n\t\t\tconst handleMouseOut = () => setValue(false)\n\t\t\tnode.addEventListener('mouseover', handleMouseOver)\n\t\t\tnode.addEventListener('mouseout', handleMouseOut)\n\t\t\treturn () => {\n\t\t\t\tsetValue(false)\n\t\t\t\tnode.removeEventListener('mouseover', handleMouseOver)\n\t\t\t\tnode.removeEventListener('mouseout', handleMouseOut)\n\t\t\t}\n\t\t},\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t[ref.current],\n\t)\n\treturn [ref, value]\n}\n\nexport const useWindowVisibility = () => {\n\tconst [isVisible, setIsVisible] = useState(\n\t\t// Focus for first render\n\t\tBUNDLE_ENV.IS_SSR ? true : document.visibilityState === 'visible',\n\t)\n\tuseEffect(() => {\n\t\tconst onVisibilityChange = () => setIsVisible(document.visibilityState === 'visible')\n\t\tconst onPageHide = () => setIsVisible(false)\n\t\tconst onPageShow = () => setIsVisible(true)\n\t\tdocument.addEventListener('visibilitychange', onVisibilityChange)\n\t\twindow.addEventListener('pagehide', onPageHide)\n\t\twindow.addEventListener('pageshow', onPageShow)\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('visibilitychange', onVisibilityChange)\n\t\t\twindow.removeEventListener('pagehide', onPageHide)\n\t\t\twindow.removeEventListener('pageshow', onPageShow)\n\t\t}\n\t}, [])\n\treturn isVisible\n}\n/*\n * not used\n *\nexport function useInterval(callback: () => void, delay: number | null) {\n\tconst savedCallback = useRef(callback)\n\t// Remember the latest callback if it changes.\n\tuseLayoutEffect(() => {\n\t\tsavedCallback.current = callback\n\t}, [callback])\n\n\t// Set up the interval.\n\tuseEffect(() => {\n\t\t// Don't schedule if no delay is specified.\n\t\t// Note: 0 is a valid value for delay.\n\t\tif (!delay && delay !== 0) {\n\t\t\treturn\n\t\t}\n\n\t\tconst id = setInterval(() => savedCallback.current(), delay)\n\t\treturn () => clearInterval(id)\n\t}, [delay])\n}\n*/\nexport function useForceUpdate(): () => void {\n\tconst setValue = useState(0)[1]\n\treturn useRef(() => setValue(v => ~v)).current\n}\n\nexport function useOnce(args: unknown[]): boolean {\n\tconst ref = useRef(true)\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tuseMemo(() => (ref.current = true), args)\n\tconst flag = ref.current\n\tref.current = false\n\treturn flag\n}\n\nexport function useUniqKey(): number {\n\tconst key = useMemo(() => {\n\t\treturn Math.random()\n\t}, [])\n\treturn key\n}\n\nexport function useVisibleTicker(callback: () => void, interval: number) {\n\tconst isVisible = useWindowVisibility()\n\n\tuseEffect(() => {\n\t\tif (!isVisible) return\n\t\tlet id\n\t\tfunction callbackInner() {\n\t\t\tcallback()\n\t\t\tid = setTimeout(callbackInner, interval - (Date.now() % interval) + 10)\n\t\t}\n\t\tcallbackInner()\n\t\treturn () => clearTimeout(id)\n\t\t// калбек не должен перезапускать таймер\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [interval, isVisible])\n}\n\nexport function useDocumentTitle(title: string, shouldRestoreOnUnmount = false) {\n\tconst defaultTitle = useRef(document.title).current\n\n\t// useEffect не подходит: он не сработает при серверном рендере\n\tuseMemo(() => {\n\t\tdocument.title = title\n\t}, [title])\n\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (shouldRestoreOnUnmount) {\n\t\t\t\tdocument.title = defaultTitle\n\t\t\t}\n\t\t}\n\t}, [shouldRestoreOnUnmount, defaultTitle])\n}\n\nexport function usePageDescription(func: () => string | null) {\n\tif (BUNDLE_ENV.IS_SSR) {\n\t\tSSR_ENV.outPageDescription = func()\n\t} else if (process.env.NODE_ENV === 'development') {\n\t\tconst description = func()\n\t\t// eslint-disable-next-line react-hooks/rules-of-hooks\n\t\tuseEffect(() => {\n\t\t\tfor (const meta of document.querySelectorAll('meta[name=\"description\"]')) {\n\t\t\t\tmeta.remove()\n\t\t\t}\n\t\t\tif (description !== null) {\n\t\t\t\tconst meta = document.createElement('meta')\n\t\t\t\tmeta.name = 'description'\n\t\t\t\tmeta.content = description\n\t\t\t\tdocument.head.appendChild(meta)\n\t\t\t}\n\t\t}, [description])\n\t}\n}\n\nexport function useHashValue<T extends string | null>(\n\tkey: string,\n\tdefaultValue: T,\n): [string | T, (key: T) => void] {\n\tconst [val, setVal] = useState(getHashValue(key) ?? defaultValue)\n\n\t// нужно один раз проставить зачание для ключа\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tuseMemo(() => setHashValue(key, val), [key])\n\n\t// нужно подчистить за собой значение\n\tuseEffect(() => {\n\t\treturn () => setHashValue(key, null)\n\t}, [key])\n\n\tuseEffect(() => {\n\t\tfunction onHashChange() {\n\t\t\tsetVal(getHashValue(key) ?? defaultValue)\n\t\t}\n\t\taddEventListener('hashchange', onHashChange)\n\t\taddEventListener('x-local-hashchange', onHashChange)\n\t\treturn () => {\n\t\t\tremoveEventListener('hashchange', onHashChange)\n\t\t\tremoveEventListener('x-local-hashchange', onHashChange)\n\t\t}\n\t}, [key, defaultValue])\n\n\tconst setValAndHash = useCallback(\n\t\t(val: T) => {\n\t\t\tsetVal(val)\n\t\t\tsetHashValue(key, val)\n\t\t\tdispatchEvent(new CustomEvent('x-local-hashchange'))\n\t\t},\n\t\t[key],\n\t)\n\treturn [val, setValAndHash]\n}\nfunction getHashValue(key: string) {\n\treturn new URLSearchParams(location.hash.slice(1)).get(key)\n}\nfunction setHashValue(key: string, val: string | null) {\n\tconst params = new URLSearchParams(location.hash.slice(1))\n\tif (params.get(key) !== val) {\n\t\tif (val === null) {\n\t\t\tparams.delete(key)\n\t\t} else {\n\t\t\tparams.set(key, val)\n\t\t}\n\t\tlet hash = params.toString()\n\t\tif (hash !== '') hash = '#' + hash\n\t\tconst { origin, pathname, search } = location\n\t\tconsole.log('history', hash, location.hash)\n\t\thistory.replaceState(history.state, '', origin + pathname + search + hash)\n\t}\n}\nexport function useScrollTo<T extends Element>(\n\tshouldScrollToArg: boolean,\n\tscrollParams?: ScrollIntoViewOptions,\n): [Ref<T>, (flag: boolean) => void] {\n\tconst ref = useRef<T>(null)\n\tconst [shouldScrollTo, setShouldScrollTo] = useState(false)\n\tuseEffect(() => {\n\t\tif (ref.current && (shouldScrollTo || shouldScrollToArg)) {\n\t\t\tlet params: ScrollIntoViewOptions = { behavior: 'smooth' }\n\t\t\tif (scrollParams) params = { ...params, ...scrollParams }\n\t\t\tref.current.scrollIntoView(params)\n\t\t\tsetShouldScrollTo(false)\n\t\t}\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [shouldScrollTo, shouldScrollToArg])\n\treturn [ref, setShouldScrollTo]\n}\nexport function useScrollPosition(): number {\n\tconst [scrollPosition, setScrollPosition] = useState<number>(0)\n\n\tuseEffect(() => {\n\t\tconst setScrollPositionLocal = () => {\n\t\t\tsetScrollPosition(window.pageYOffset)\n\t\t}\n\t\twindow.addEventListener('scroll', setScrollPositionLocal)\n\t\tsetScrollPositionLocal()\n\t\treturn () => window.removeEventListener('scroll', setScrollPositionLocal)\n\t}, [])\n\n\treturn scrollPosition\n}\n","export const BULLET = '•'\nexport const TIMES = '×'\nexport const LEFT_POINTING = '‹'\nexport const RIGHT_POINTING = '›'\nexport const TOP_POINTING = '︿'\nexport const ELLIPSIS = '…'\nexport const STAR = '★'\nexport const HEART = '♥'\nexport const HEART_EMPTY = '♡'\nexport const VARIATION_SELECTOR = '\\uFE0E'\nexport const NBSP = ' '\nexport const DASH = '—'\n","import { useCallback } from 'preact/hooks'\n\nimport { useScrollPosition } from '#src/utils/hooks'\nimport { TOP_POINTING } from '#src/utils/typography'\n\nexport function GoUpBtn({ classes = '' }: { classes?: string }): JSX.Element | null {\n\tconst onClick = useCallback(() => {\n\t\twindow.scrollTo(0, 0)\n\t}, [])\n\tconst scrollPos = useScrollPosition()\n\tif (scrollPos < 10) return null\n\treturn (\n\t\t<button\n\t\t\tclassName={`btn rounded-circle lh-1 navbar-darker-bg bottom-0 left-0 p-1 text-center m-1 ${classes} d-none d-md-block`}\n\t\t\tstyle={{ position: 'fixed' }}\n\t\t\tonClick={onClick}\n\t\t>\n\t\t\t<span>{TOP_POINTING}</span>\n\t\t</button>\n\t)\n}\n","export function PageWrap({ children }): JSX.Element {\n\treturn <div className=\"page py-4\">{children}</div>\n}\n","export const LINK_DISCORD_INVITE = 'https://discord.gg/YapnrQ63bD'\r\nexport const LINK_KO_FI = 'https://ko-fi.com/genshinbase'\r\nexport const LINK_DONATION_ALERTS = 'https://www.donationalerts.com/r/genshinbase'\r\nexport const LINK_GOOGLE_FORM_ORDER_SITE = 'https://forms.gle/WtWCxStRy5kqDwFY8'\r\nexport const LINK_HELPER_TEAM_TABLE =\r\n\t'https://docs.google.com/spreadsheets/d/1gNxZ2xab1J6o1TuNVWMeLOZ7TPOqrsf3SshP5DLvKzI/pubhtml#'\r\nexport const LINK_HONEY_IMPACT = 'https://genshin.honeyhunterworld.com/'\r\nexport const LINK_GI_MAP = 'https://webstatic-sea.hoyolab.com/ys/app/interactive-map/index.html'\r\nexport const LINK_GI_WIKI = 'https://genshin-impact.fandom.com/wiki/Genshin_Impact_Wiki'\r\n","import {\n\tGI_ArtifactGroupCode,\n\tGI_ArtifactTypeCode,\n\tGI_KnownStatBonusCode,\n\tGI_WeaponObtainSource,\n\tGI_WeaponTypeCode,\n\tMapCode,\n} from '#lib/genshin'\nimport { GI_TalentCode } from '#lib/parsing/helperteam/types'\nimport { LINK_DISCORD_INVITE } from '#src/utils/links'\nimport { BULLET, DASH, ELLIPSIS, NBSP } from '#src/utils/typography'\n\ntype Lang = 'en' | 'ru'\nexport const LANG = BUNDLE_ENV.LANG as Lang\nexport const I18N_LANG_NAMES: Record<Lang, string> = {\n\ten: 'English',\n\tru: 'Русский',\n}\nexport const I18N_LANG_NAME = I18N_LANG_NAMES[LANG]\nexport const I18N_PAGE_TITLE_POSTFIX = { en: ` ${BULLET} Genshin Base`, ru: ` ${BULLET} Геншин База` }[LANG]\nexport const I18N_LOADING = { en: 'Loading', ru: 'Загрузка' }[LANG]\nexport const I18N_COLLAPSE = { en: 'Collapse', ru: 'Свернуть' }[LANG]\nexport const I18N_DASHBOARD = { en: 'Dashboard', ru: 'Самое важное' }[LANG]\nexport const I18N_REGION = { en: 'Region', ru: 'Регион' }[LANG]\nexport const I18N_UNTIL_DAY_RESET = { en: 'Until Day Reset', ru: 'До нового дня' }[LANG]\nexport const I18N_ALCHEMY_CALC = { en: 'Alchemy Calculator', ru: 'Калькулятор алхимии' }[LANG]\nexport const I18N_WHAT_TO_FARM = { en: 'What to Farm', ru: 'Что фармить' }[LANG]\nexport const I18N_BUILDS = { en: 'Builds', ru: 'Сборки персонажей' }[LANG]\nexport const I18N_ASIA = { en: 'Asia', ru: 'Азия' }[LANG]\nexport const I18N_NORH_AMERICA = { en: 'North America', ru: 'Северная Америка' }[LANG]\nexport const I18N_EUROPE = { en: 'Europe', ru: 'Европа' }[LANG]\nexport const I18N_MINUTE = { en: 'minute', ru: 'минута' }[LANG]\nexport const I18N_MINUTES = { en: 'minutes', ru: 'минуты' }[LANG]\nexport const I18N_MINUTES_3 = { en: 'minutes', ru: 'минут' }[LANG]\nexport const I18N_TODAY = { en: 'today', ru: 'сегодня' }[LANG]\nexport const I18N_WEEKDAYS = {\n\ten: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'],\n\tru: ['Понедельник', 'Вторник', 'Среда', 'Четверг', 'Пятница', 'Суббота', 'Воскресенье'],\n}[LANG]\nexport const I18N_TOMORROW = { en: 'tomorrow', ru: 'завтра' }[LANG]\nexport const I18N_DUNGEONS = { en: 'Dungeons', ru: 'Подземелья' }[LANG]\nexport const I18N_TALENTS = { en: 'Talents', ru: 'Таланты' }[LANG]\nexport const I18N_WEAPONS = { en: 'Weapons', ru: 'Оружие' }[LANG]\nexport const I18N_MAIN_INFO = { en: 'main info', ru: 'основная информация' }[LANG]\nexport const I18N_WEAPON_STACKS_COUNT = {\n\ten: (stacks: number) => stacks + ' ' + pluralizeEN(stacks, 'stack', 'stacks'),\n\tru: (stacks: number) => stacks + ' ' + pluralizeRU(stacks, 'стак', 'стака', 'стаков'),\n}[LANG]\nexport const I18N_WEAPON_REFINE = {\n\ten: (refine: string) => 'R' + refine,\n\tru: (refine: string) => 'Р' + refine,\n}[LANG]\nexport const I18N_WHY_ADD_TO_FAVS_TIP = {\n\ten: 'Add characters or items to your favorites to see them marked here.',\n\tru: 'Добавьте персонажей и предметы в избранные, чтобы выделить их здесь',\n}[LANG]\nexport const I18N_FAV_CHARACTERS = { en: 'Favorite characters', ru: 'Избранные персонажи' }[LANG]\n\nexport const I18N_FAV_TIPS = {\n\ten: (() => {\n\t\tconst add = (s: string) => `Add ${s} to favourites`\n\t\tconst remove = (s: string) => `Remove ${s} from favourites`\n\t\treturn {\n\t\t\tadd: { weapon: add('weapon'), character: add('character'), material: add('material') },\n\t\t\tremove: {\n\t\t\t\tweapon: remove('weapon'),\n\t\t\t\tcharacter: remove('character'),\n\t\t\t\tmaterial: remove('material'),\n\t\t\t},\n\t\t}\n\t})(),\n\tru: (() => {\n\t\tconst add = (s: string) => `Добавить ${s} в избранное`\n\t\tconst remove = (s: string) => `Убрать ${s} из избранного`\n\t\treturn {\n\t\t\tadd: { weapon: add('оружие'), character: add('персонажа'), material: add('материал') },\n\t\t\tremove: {\n\t\t\t\tweapon: remove('оружие'),\n\t\t\t\tcharacter: remove('персонажа'),\n\t\t\t\tmaterial: remove('материал'),\n\t\t\t},\n\t\t}\n\t})(),\n}[LANG]\nexport const I18N_CHOOSE_FROM_FAV = {\n\ten: 'Choose from favorite',\n\tru: 'Выберите из избранных',\n}[LANG]\nexport const I18N_ARTIFACTS = { en: 'Artifacts', ru: 'Артефакты' }[LANG]\nexport const I18N_CHARACTERS = { en: 'Characters', ru: 'Персонажи' }[LANG]\nexport const I18N_ART_STATS_PRIORITY = { en: 'Artifact stats priority', ru: 'Приоритетные главстаты' }[LANG]\nexport const I18N_SUBSTATS_PRIORITY = { en: 'Substats priority', ru: 'Приоритетные допстаты' }[LANG]\nexport const I18N_TALENTS_PRIORITY = { en: 'Talents Priority', ru: 'Приоритетные таланты' }[LANG]\nexport const I18N_ASC_MATERIALS = { en: 'Ascension materials', ru: 'Материалы возвышения' }[LANG]\nexport const I18N_FULL_BUILD_INFO = { en: 'Full build info', ru: 'Полная информация о билде' }[LANG]\nexport const I18N_CHAR_LORE = { en: 'Character lore', ru: 'Лор персонажа' }[LANG]\nexport const I18N_MORE_ON_BUILDS_PAGE = {\n\ten: 'more on build page',\n\tru: 'продолжение на странице билда',\n}[LANG]\nexport const I18N_BACK = { en: 'Back', ru: 'Назад' }[LANG]\nexport const I18N_NOTES = { en: 'Notes', ru: 'Примечания' }[LANG]\n\nconst artTypeNamesRU: Record<GI_ArtifactTypeCode, string> = {\n\tflower: 'цветок',\n\tplume: 'перо',\n\tsands: 'часы',\n\tgoblet: 'кубок',\n\tcirclet: 'корона',\n}\nexport const I18N_ART_TYPE = {\n\ten: (code: GI_ArtifactTypeCode) => code as string,\n\tru: (code: GI_ArtifactTypeCode) => artTypeNamesRU[code],\n}[LANG]\n\nconst statNamesRu: Record<GI_KnownStatBonusCode, string> = {\n\tdef: 'защита',\n\t'def%': '% защиты',\n\tdmg: 'урон',\n\t'dmg%': '% урона',\n\tatk: 'сила атаки',\n\t'atk%': '% атаки',\n\thp: 'ХП',\n\t'hp%': '% ХП',\n\tem: 'мастерство стихий',\n\ter: 'восстановление энергии',\n\t'er%': '% восстановления энергии',\n\thealing: 'лечение',\n\t'healing%': '% лечения',\n\t'crit-rate': 'шанс крит. попадания',\n\t'crit-rate%': '%шанса крит. попадания',\n\t'crit-dmg': 'крит. урон',\n\t'crit-dmg%': '% крит. урона',\n\t'phys-dmg': 'физ. урон',\n\t'cryo-dmg': 'Крио урон',\n\t'geo-dmg': 'Гео урон',\n\t'anemo-dmg': 'Анемо урон',\n\t'hydro-dmg': 'Гидро урон',\n\t'electro-dmg': 'Электро урон',\n\t'pyro-dmg': 'Пиро урон',\n\t'phys-dmg%': '% физ. урона',\n\t'cryo-dmg%': '% Крио урона',\n\t'geo-dmg%': '% Гео урона',\n\t'anemo-dmg%': '% Анемо урона',\n\t'hydro-dmg%': '% Гидро урона',\n\t'electro-dmg%': '% Электро урона',\n\t'pyro-dmg%': '% Пиро урона',\n}\nexport const I18N_STAT_NAME = {\n\ten: (code: string) => code.replace(/-/g, ' '),\n\tru: (code: string) => statNamesRu[code] ?? code,\n}[LANG]\n\ntype TalentTypeNames = Record<GI_TalentCode, string>\nconst talentTypesNamesRU: TalentTypeNames = {\n\tattack: 'обычная атака',\n\tskill: 'элементальный навык',\n\tburst: 'взрыв стихии',\n}\nexport const I18N_TALENT_NAME = {\n\ten: (code: GI_TalentCode) => code,\n\tru: (code: GI_TalentCode) => talentTypesNamesRU[code],\n}[LANG]\n\ntype ConjuctionType = 'or' | 'and'\nexport const I18N_CONJUCTIONS: Record<ConjuctionType, string> = {\n\ten: { or: 'or', and: 'and' },\n\tru: { or: 'или', and: 'и' },\n}[LANG]\n\nexport const I18N_RECOMMENDED_FOR = { en: 'Recommended for', ru: 'Рекомендуется для' }[LANG]\nexport const I18N_FOR_NOBODY = { en: 'Nobody', ru: 'Никого' }[LANG]\nexport const I18N_SOURCE = { en: 'Source', ru: 'Источник' }[LANG]\nexport const I18N_SCROLL_TO_ZOOM = { en: 'Scroll to zoom', ru: 'Зум колёсиком' }[LANG]\nexport const I18N_PINCH_TO_ZOOM = { en: 'Pinch to zoom', ru: 'Зум щипком' }[LANG]\nexport const I18N_CANCEL = { en: 'cancel', ru: 'отмена' }[LANG]\nexport const I18N_SUBMIT = { en: 'submit', ru: 'отправить' }[LANG]\nexport const I18N_SUBMIT_BUG_SUCCESS = { en: 'Message sent. Thank you', ru: 'Сообщение отправлено. Спасибо' }[\n\tLANG\n]\nexport const I18N_SUBMIT_BUG_ERROR = {\n\ten: 'Error happened while sending message. Please disable adblock or try again later, or contact us on Discord',\n\tru: 'Не удалось отправить сообщение. Выключите блокировщик рекламы или попробуйте позже, а лучше напишите нам в Дискорде',\n}[LANG]\nexport const I18N_YOUR_MESSAGE_HERE = { en: 'Your message here', ru: 'Текст сообщения' }[LANG]\nexport const I18N_REPORT_BUG_GUIDE = {\n\ten: () => (\n\t\t<>\n\t\t\t<p>\n\t\t\t\tPlease describe your problem here. You can upload images on{' '}\n\t\t\t\t<a href=\"https://imgur.com/upload\" target=\"_blank\">\n\t\t\t\t\timgur.com\n\t\t\t\t</a>{' '}\n\t\t\t\tand use generated links to them in your message.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tOr message us on{' '}\n\t\t\t\t<a href={LINK_DISCORD_INVITE} target=\"_blank\">\n\t\t\t\t\tour Discord server\n\t\t\t\t</a>\n\t\t\t\t!\n\t\t\t</p>\n\t\t</>\n\t),\n\tru: () => (\n\t\t<>\n\t\t\t<p>\n\t\t\t\tПожалуйста, опишите проблему в поле ниже. Если требуется, вы можете загрузить скриншоты на\n\t\t\t\tсайт{' '}\n\t\t\t\t<a href=\"https://imgur.com/upload\" target=\"_blank\">\n\t\t\t\t\timgur.com\n\t\t\t\t</a>{' '}\n\t\t\t\tи вставить ссылки на скриншоты в своё сообщение.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tИли напишите нам на{' '}\n\t\t\t\t<a href={LINK_DISCORD_INVITE} target=\"_blank\">\n\t\t\t\t\tнaшем сервере в Дискорде\n\t\t\t\t</a>\n\t\t\t\t!\n\t\t\t</p>\n\t\t</>\n\t),\n}[LANG]()\nexport const I18N_ERROR = { en: 'Error, reload page', ru: 'Ошибка, перезагрузите страницу' }[LANG]\nexport const I18N_PIECE_BONUS = {\n\ten: (n: number) => `${n} piece bonus`,\n\tru: (n: number) => `Бонус ${n} части`,\n}[LANG]\nexport const I18N_PIECES_BONUS = {\n\ten: (n: number) => `${n} pieces bonus`,\n\tru: (n: number) => `Бонус ${n} частей`,\n}[LANG]\nexport const I18N_BASE_ATTACK = { en: 'Base attack', ru: 'Базовая атака' }[LANG]\nexport const I18N_ITEM_STORY = { en: 'Item Story', ru: 'История предмета' }[LANG]\nexport const I18N_SECONDARY_STAT = { en: 'Secondary Stat', ru: 'Пассивная способность' }[LANG]\ntype MapCodeName = Record<MapCode, string>\nexport const I18N_MAP_CODES_NAME: MapCodeName = {\n\ten: { teyvat: 'Teyvat', enkanomiya: 'Enkanomiya', chasm: 'The Chasm' },\n\tru: { teyvat: 'Тейват', enkanomiya: 'Энканомия', chasm: 'Разлом' },\n}[LANG]\nexport const I18N_CHAR_BUILD_RECS = {\n\ten: 'Character builds recommendations',\n\tru: 'Рекомендуемые сборки персонажей',\n}[LANG]\nexport const I18N_SELECT_CHAR_BELOW = { en: 'Select character below', ru: 'Выберите персонажа' }[LANG]\nexport const I18N_BUILD_RECS_FOR = { en: 'build recommendations', ru: 'билд' }[LANG]\nexport const I18N_RECOMMENDED_RU_ONLY = { en: '', ru: 'Рекомендуемый' }[LANG]\nexport const I18N_ABOUT_SITE = { en: 'Site History', ru: 'История сайта' }[LANG]\nexport const I18N_EQUIPMENT = { en: 'Equipment', ru: 'Снаряжение' }[LANG]\nexport const I18N_CHAR_EQUIPMENT = { en: 'Character Equipment', ru: 'Снаряжение персонажа' }[LANG]\nexport const I18N_OUR_DISCORD = { en: 'Our Discord', ru: 'Наш Дискорд' }[LANG]\nexport const I18N_CREATED_BY_US = {\n\ten: `Designed and coded by${NBSP}Absolute${NBSP}Evil${NBSP}Studio`,\n\tru: `Задизайнено и запрограммировано в${NBSP}Абсолют${NBSP}Ивел${NBSP}студии`,\n}[LANG]\nexport const I18N_REPORT_BUG = {\n\ten: 'Report a bug',\n\tru: 'Сообщить об ошибке',\n}[LANG]\nexport const I18N_SUPPORT_US = {\n\ten: 'Support Us',\n\tru: 'Поддержать нас',\n}[LANG]\nexport const I18N_SUPPORT_VIA_KO_FI = {\n\ten: 'Ko-fi, if you have PayPal',\n\tru: 'Ко-фи, если у вас есть Пейпал',\n}[LANG]\nexport const I18N_SUPPORT_VIA_DON_ALERTS = {\n\ten: 'DonationAlerts',\n\tru: 'Донейшн Алертс',\n}[LANG]\nexport const I18N_ORDER_SITE_FROM_US = {\n\ten: 'Request a site from us',\n\tru: 'Закажите у нас сайт',\n}[LANG]\nexport const I18N_NOT_AFFILIATED_WITH_MIHOYO = {\n\ten: 'We are not affiliated with HoYoverse',\n\tru: 'Мы не связаны с Хоёверс',\n}[LANG]\nexport const I18N_C_MIHOYO = {\n\ten: 'Genshin Impact, items and characters illustrations are trademarks and copyrights of HoYoverse.',\n\tru: 'Геншин Импакт, иллюстрации персонажей и предметов принадлежат Хоёверсу',\n}[LANG]\nexport const I18N_HELPER_TEAM_TABLE = {\n\ten: 'Helper Team',\n\tru: 'Хелпер Тим',\n}[LANG]\nexport const I18N_HONEY_IMPACT = {\n\ten: 'Honey Impact',\n\tru: 'Хани Импакт',\n}[LANG]\nexport const I18N_GI_MAP = {\n\ten: 'Genshin Map',\n\tru: 'Карта Геншина',\n}[LANG]\nexport const I18N_GI_WIKI = {\n\ten: 'Genshin Wiki',\n\tru: 'Вики Геншина',\n}[LANG]\nexport const I18N_WE_USE_DATA_FROM = {\n\ten: 'We use data from',\n\tru: 'Использованные источники',\n}[LANG]\nexport const I18N_COPYRIGHTS = {\n\ten: 'Copyrights',\n\tru: 'Авторские права',\n}[LANG]\nexport const I18N_SEE_NOTES = {\n\ten: 'see notes',\n\tru: 'см. заметки',\n}[LANG]\nexport const I18N_UNSUPPORTED_LOCATION_WARNING = {\n\ten: \"Looks like you've opened a cached/saved page. It won't work correctly that way :(\",\n\tru: 'Похоже, вы открыли сохранённую страницу. В таком виде она нормально работать не будет :(',\n}[LANG]\nexport const I18N_NOTHING_TO_SHOW = {\n\ten: 'nothing to show',\n\tru: 'нет результатов',\n}[LANG]\nexport const I18N_MEGA_SEARCH_PLACEHOLDER = {\n\ten: 'Search for characters, weapons, artifacts',\n\tru: 'Искать персонажей, артефакты, оружие',\n}[LANG]\n\nexport const I18N_FRONT_PAGE_DESCRIPTION = {\n\ten: 'Up-to-date character builds recommendations, list of all weapons and artifacts in the game, dungeons schedule and other useful information about Genshin Impact',\n\tru: 'Актуальные билды персонажей, список всего оружия и артефактов, что есть в игре, расписание подземелий и другая полезная информация о Геншин Импакте',\n}[LANG]\nexport const I18N_BUILDS_PAGE_DESCRIPTION = {\n\ten: 'Genshin Impact builds recommendations for every character',\n\tru: 'Рекомендуемые билды для персонажей Геншин Импакта',\n}[LANG]\nexport const I18N_EQUIPMENT_PAGE_DESCRIPTION = {\n\ten: (code: 'weapons' | 'artifacts') => {\n\t\treturn `List of Genshin Impact ${code} with full information and recommended characters`\n\t},\n\tru: (code: 'weapons' | 'artifacts') => {\n\t\tconst name = { artifacts: 'артефактов', weapons: 'оружия' }[code] ?? code\n\t\treturn `Список ${name} Геншин Импакта с полной информацией и рекомендуемыми персонажами`\n\t},\n}[LANG]\nexport function I18N_CHARACTER_PAGE_DESCRIPTION(\n\tcharacterName: string,\n\troleName: string,\n\tweaponR5Name: string | null | undefined,\n\tweaponR4Name: string | null | undefined,\n\tartifactName: string | null | undefined,\n\ttipsText: string,\n\tnotesText: string,\n) {\n\tconst weaponLabel = { en: 'Recommended weapon', ru: 'Рекомендуемое оружие' }[LANG]\n\tconst artifactLabel = { en: 'Recommended artifact', ru: 'Рекомендуемые артефакты' }[LANG]\n\n\t// заметки не всегда заканчиваются точкой\n\tif (tipsText && !tipsText.trim().endsWith('.')) tipsText += '.'\n\tlet extraText = tipsText + ' ' + notesText\n\t// ограничиваем длину по очередному пробелу\n\tif (extraText.length > 250) {\n\t\tconst cutIndex = Math.min(...[' ', '.'].map(x => extraText.lastIndexOf(x, 230)))\n\t\textraText = extraText.slice(0, cutIndex) + ELLIPSIS\n\t}\n\n\treturn (\n\t\t`${characterName} ${DASH} ${roleName}.` +\n\t\t` ${weaponLabel}: ${[weaponR5Name, weaponR4Name].filter(x => x).join(', ')}.` +\n\t\t` ${artifactLabel}: ${artifactName ?? ''}.` +\n\t\t' ' +\n\t\textraText\n\t)\n}\n\ntype WeaponTypeNames = Record<GI_WeaponTypeCode, string>\nconst weaponTypeNamesRU: WeaponTypeNames = {\n\tclaymore: 'Двуручный меч',\n\tsword: 'Меч',\n\tcatalyst: 'Катализатор',\n\tpolearm: 'Копье',\n\tbow: 'Лук',\n}\nexport const I18N_WEAPON_TYPE_NAME = {\n\ten: (code: GI_WeaponTypeCode) => code,\n\tru: (code: GI_WeaponTypeCode) => weaponTypeNamesRU[code],\n}[LANG]\n\ntype WeaponObtainSourceNames = Record<GI_WeaponObtainSource | 'other', string>\nconst weaponObtainSourceNamesRU: WeaponObtainSourceNames = {\n\twishes: 'молитвы',\n\t'event-wishes': 'молитвы события',\n\tevents: 'события',\n\t'battle-pass': 'боевой пропуск',\n\t'in-game-shop': 'внутриигровой магазин',\n\tforging: 'ковка',\n\tfishing: 'рыболовля',\n\t'npc-shop': 'магазин НПС',\n\tchests: 'сундуки',\n\tquests: 'квесты',\n\tpuzzles: 'паззл',\n\tinvestigation: 'исследование мира',\n\t'adventure-rank-10': '10 ранг приключений',\n\tplaystation: 'плейстейшн',\n\tother: 'другое',\n}\nexport const I18N_WEAPON_OBTAIN_SOURCE_NAME = {\n\ten: (code: GI_WeaponObtainSource | 'other') => code.replace(/-/g, ' ').replace(/\\bnpc\\b/, 'NPC'),\n\tru: (code: GI_WeaponObtainSource | 'other') => weaponObtainSourceNamesRU[code],\n}[LANG]\nexport const I18N_OBTAINED_DURING_STORYLINE = {\n\ten: 'Obtained during storyline quests',\n\tru: 'Выдаётся во время прохождения сюжетных заданий',\n}[LANG]\nexport const I18N_ART_GROUP_NAME: Record<GI_ArtifactGroupCode, string> = {\n\t'18%-atk': { en: 'ATK +18%', ru: 'Сила атаки +18%' }[LANG],\n\t'20%-er': { en: 'Energy Recharge +20%', ru: 'Восстановление энергии +20%' }[LANG],\n\t'25%-ph-atk': { en: 'Physical DMG +25%', ru: 'Физ. урон +25%' }[LANG],\n}\nexport const I18N_ITEM_DETAIL = {\n\ten: 'item detail',\n\tru: 'страница предмета',\n}[LANG]\nexport const I18N_ARROWS_TO_SELECT = {\n\ten: 'you can use Arrow keys and Enter to select option',\n\tru: 'нужный результат можно быстро выбрать кнопками-стрелочками и Интером',\n}[LANG]\nexport const I18N_RECOMMENDED_BUILDS = {\n\ten: 'recomended builds',\n\tru: 'билды персонажа',\n}[LANG]\nexport const I18N_OBTAIN_SOURCES = {\n\ten: 'Obtain sources',\n\tru: 'Способы получения',\n}[LANG]\nexport const I18N_SORT_BY = {\n\ten: 'Sort by',\n\tru: 'Сортировать по',\n}[LANG]\nexport const I18N_WEAPON_TYPE = {\n\ten: 'Weapon type',\n\tru: 'Тип оружия',\n}[LANG]\nexport const I18N_NAME = {\n\ten: 'Name',\n\tru: 'Название',\n}[LANG]\nexport const I18N_SUBSTAT = {\n\ten: 'Substat',\n\tru: 'Допстат',\n}[LANG]\nexport const I18N_RARITY = {\n\ten: 'Rarity',\n\tru: 'Редкость',\n}[LANG]\nexport const I18N_WEAPON_TYPE_FILTER_TIP: Record<GI_WeaponTypeCode | 'everything', string> = {\n\ten: {\n\t\teverything: 'every type of weapon selected',\n\t\tsword: 'showing only swords',\n\t\tcatalyst: 'showing only catalists',\n\t\tclaymore: 'showing only claymores',\n\t\tpolearm: 'showing only polearms',\n\t\tbow: 'showing only bows',\n\t},\n\tru: {\n\t\teverything: 'выбраны все виды оружия',\n\t\tsword: 'выбраны только мечи',\n\t\tcatalyst: 'выбраны только катализаторы',\n\t\tclaymore: 'выбраны только двуручные мечи',\n\t\tpolearm: 'выбраны только копья',\n\t\tbow: 'выбраны только луки',\n\t},\n}[LANG]\n\nconst pluralizeHours = {\n\ten: (hours: number) => pluralizeEN(hours, 'hour', 'hours'),\n\tru: (hours: number) => pluralizeRU(hours, 'час', 'часа', 'часов'),\n}[LANG]\nconst pluralizeMinutes = {\n\ten: (minutes: number) => pluralizeEN(minutes, 'minute', 'minutes'),\n\tru: (minutes: number) => pluralizeRU(minutes, 'минута', 'минуты', 'минут'),\n}[LANG]\nexport function I18N_MS_TO_HM_WORDS(duration: number): string {\n\tconst minutes = Math.floor((duration / (1000 * 60)) % 60)\n\tconst hours = Math.floor((duration / (1000 * 60 * 60)) % 24)\n\treturn `${hours} ${pluralizeHours(hours)} ${minutes} ${pluralizeMinutes(minutes)}`\n}\n\nfunction pluralizeEN(n: number, w0: string, w1: string): string {\n\tif (n < 0) n = -n\n\tconst d0 = n % 10\n\tconst d10 = n % 100\n\n\tif (d10 === 11 || d10 === 12 || d0 === 0 || (d0 >= 2 && d0 <= 9)) return w1\n\treturn w0\n}\nfunction pluralizeRU(n: number, w0: string, w1: string, w3: string): string {\n\tif (n < 0) n = -n\n\tif (n % 10 === 1 && n % 100 !== 11) {\n\t\treturn w0\n\t} else if (n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20)) {\n\t\treturn w1\n\t} else {\n\t\treturn w3\n\t}\n}\n","let modalsEl: Element | undefined\nexport function GET_MODALS_EL(): Element {\n\treturn (modalsEl ??= document.querySelector('.modals') as Element)\n}\n\nexport const stopPropagation = e => e.stopPropagation()\n","import { useCallback, useRef, useState } from 'preact/hooks'\r\n\r\nimport { sendMessage } from '#src/errors/rollbar'\r\nimport {\r\n\tI18N_CANCEL,\r\n\tI18N_REPORT_BUG,\r\n\tI18N_REPORT_BUG_GUIDE,\r\n\tI18N_SUBMIT,\r\n\tI18N_SUBMIT_BUG_ERROR,\r\n\tI18N_SUBMIT_BUG_SUCCESS,\r\n\tI18N_YOUR_MESSAGE_HERE,\r\n} from '#src/i18n/i18n'\r\nimport { GET_MODALS_EL } from '#src/utils/dom'\r\nimport { useClickAway } from '#src/utils/hooks'\r\nimport { createPortal } from '#src/utils/preact-compat'\r\n\r\nexport const ReportBugModal = ({ onClickAway }: { onClickAway(): void }): JSX.Element => {\r\n\tconst [message, setMessage] = useState<string>('')\r\n\tconst [isInvalid, setIsInvalid] = useState<boolean>(false)\r\n\tconst onMessageChange = useCallback(\r\n\t\te => {\r\n\t\t\tsetMessage(e.target.value)\r\n\t\t\tisInvalid && setIsInvalid(false)\r\n\t\t},\r\n\t\t[setMessage, isInvalid, setIsInvalid],\r\n\t)\r\n\tconst modalRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\r\n\tuseClickAway(modalRef, onClickAway)\r\n\tconst tryToSendMessage = useCallback(() => {\r\n\t\tif (!message.length) return setIsInvalid(true)\r\n\t\tsendMessage('message from bug report modal: ' + message)\r\n\t\t\t.then(() => alert(I18N_SUBMIT_BUG_SUCCESS))\r\n\t\t\t.catch(() => alert(I18N_SUBMIT_BUG_ERROR))\r\n\t\t\t.finally(() => {\r\n\t\t\t\tonClickAway()\r\n\t\t\t})\r\n\t}, [message, onClickAway, setIsInvalid])\r\n\treturn createPortal(\r\n\t\t<>\r\n\t\t\t<div className=\"modal-backdrop show d-block\"></div>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"modal d-block\"\r\n\t\t\t\tid=\"exampleModal\"\r\n\t\t\t\ttab-index=\"-1\"\r\n\t\t\t\taria-labelledby=\"exampleModalLabel\"\r\n\t\t\t\taria-hidden=\"true\"\r\n\t\t\t>\r\n\t\t\t\t<div className=\"modal-dialog modal-dialog-scrollable\" ref={modalRef}>\r\n\t\t\t\t\t<div className=\"modal-content\">\r\n\t\t\t\t\t\t<div className=\"modal-header\">\r\n\t\t\t\t\t\t\t<h5 className=\"modal-title\" id=\"exampleModalLabel\">\r\n\t\t\t\t\t\t\t\t{I18N_REPORT_BUG}\r\n\t\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tclassName=\"btn-close btn-sm\"\r\n\t\t\t\t\t\t\t\taria-label=\"Close\"\r\n\t\t\t\t\t\t\t\tonClick={onClickAway}\r\n\t\t\t\t\t\t\t></button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"modal-body\">\r\n\t\t\t\t\t\t\t<div className=\"text-muted\">{I18N_REPORT_BUG_GUIDE}</div>\r\n\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\tvalue={message}\r\n\t\t\t\t\t\t\t\tplaceholder={I18N_YOUR_MESSAGE_HERE}\r\n\t\t\t\t\t\t\t\trows={5}\r\n\t\t\t\t\t\t\t\tclassName={`w-100 bg-light border ${\r\n\t\t\t\t\t\t\t\t\tisInvalid ? 'border-2 border-danger' : 'border-light'\r\n\t\t\t\t\t\t\t\t} rounded`}\r\n\t\t\t\t\t\t\t\tonInput={onMessageChange}\r\n\t\t\t\t\t\t\t></textarea>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"modal-footer\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tclassName=\"btn btn-link text-decoration-none text-capitalize\"\r\n\t\t\t\t\t\t\t\tonClick={onClickAway}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{I18N_CANCEL}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tclassName=\"btn btn-primary text-capitalize\"\r\n\t\t\t\t\t\t\t\tonClick={tryToSendMessage}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{I18N_SUBMIT}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</>,\r\n\t\tGET_MODALS_EL(),\r\n\t)\r\n}\r\n","import {\n\tI18N_COPYRIGHTS,\n\tI18N_CREATED_BY_US,\n\tI18N_C_MIHOYO,\n\tI18N_GI_MAP,\n\tI18N_GI_WIKI,\n\tI18N_HELPER_TEAM_TABLE,\n\tI18N_HONEY_IMPACT,\n\tI18N_NOT_AFFILIATED_WITH_MIHOYO,\n\tI18N_ORDER_SITE_FROM_US,\n\tI18N_REPORT_BUG,\n\tI18N_WE_USE_DATA_FROM,\n} from '#src/i18n/i18n'\nimport { ReportBugModal } from '#src/modals/report-bug'\nimport {\n\tLINK_GI_MAP,\n\tLINK_GI_WIKI,\n\tLINK_GOOGLE_FORM_ORDER_SITE,\n\tLINK_HELPER_TEAM_TABLE,\n\tLINK_HONEY_IMPACT,\n} from '#src/utils/links'\nimport { useCallback, useState } from 'preact/hooks'\n\nexport function Footer() {\n\tconst [isReportBugModalVisible, setIsReportBugModalVisible] = useState<boolean>(false)\n\tconst onRepBugBtnClick = useCallback(() => {\n\t\tsetIsReportBugModalVisible(true)\n\t}, [setIsReportBugModalVisible])\n\tconst closeRepBugModal = useCallback(() => {\n\t\tsetIsReportBugModalVisible(false)\n\t}, [setIsReportBugModalVisible])\n\treturn (\n\t\t<footer className=\"mt-auto bg-dark\">\n\t\t\t<div className=\"container my-3 opacity-75\">\n\t\t\t\t<div className=\"row pt-3 gy-3\">\n\t\t\t\t\t<div className=\"col-12 col-md-3\">\n\t\t\t\t\t\t<h5>Genshin Base</h5>\n\t\t\t\t\t\t<p className=\"small\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"link text-decoration-underline-dotted\"\n\t\t\t\t\t\t\t\tonClick={onRepBugBtnClick}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{I18N_REPORT_BUG}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t{isReportBugModalVisible && <ReportBugModal onClickAway={closeRepBugModal} />}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"small\">{I18N_CREATED_BY_US}</p>\n\t\t\t\t\t\t<p className=\"small\">\n\t\t\t\t\t\t\t<a href={LINK_GOOGLE_FORM_ORDER_SITE} target=\"_blank\">\n\t\t\t\t\t\t\t\t{I18N_ORDER_SITE_FROM_US}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-12 col-md-4\">\n\t\t\t\t\t\t<div className=\"ps-md-3\">\n\t\t\t\t\t\t\t<h5>{I18N_WE_USE_DATA_FROM}</h5>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_HELPER_TEAM_TABLE} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_HELPER_TEAM_TABLE}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_HONEY_IMPACT} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_HONEY_IMPACT}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_GI_MAP} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_GI_MAP}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_GI_WIKI} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_GI_WIKI}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-12 col-md-4\">\n\t\t\t\t\t\t<div className=\"ps-md-3\">\n\t\t\t\t\t\t\t<h5>{I18N_COPYRIGHTS}</h5>\n\t\t\t\t\t\t\t<p className=\"small\">{I18N_C_MIHOYO}</p>\n\t\t\t\t\t\t\t<p className=\"small\">{I18N_NOT_AFFILIATED_WITH_MIHOYO}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</footer>\n\t)\n}\n","\nexport const GENERATED_DATA_HASH = \"0f96ac8f\"\n\n/** @type {import('#lib/parsing/combine').CharacterShortInfo[]} */\nexport const charactersShortList = [\n\t{\n\t\t\"code\": \"amber\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"barbara\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"beidou\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"bennett\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"chongyun\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"diluc\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"fischl\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"jean\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kaeya\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"keqing\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"klee\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"lisa\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"mona\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ningguang\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"noelle\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"qiqi\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"razor\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"sucrose\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"traveler-anemo\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"traveler-electro\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"traveler-geo\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"venti\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xiangling\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"xingqiu\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"diona\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"tartaglia\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xinyan\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"zhongli\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"albedo\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ganyu\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"hu-tao\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xiao\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"rosaria\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"eula\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"yanfei\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"kazuha\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ayaka\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"sayu\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"yoimiya\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"aloy\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kokomi\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kujou-sara\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"raiden-shogun\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"thoma\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"gorou\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"itto\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"shenhe\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"yun-jin\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"yae-miko\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ayato\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t}\n]\n\n/** @type {import('#lib/parsing').ArtifcatSetGroupsCodes} */\nexport const ART_GROUP_CODES = {\n\t\"18%-atk\": [\n\t\t\"echoes-of-an-offering\",\n\t\t\"gladiators-finale\",\n\t\t\"shimenawas-reminiscence\",\n\t\t\"vermillion-hereafter\",\n\t\t\"brave-heart\",\n\t\t\"resolution-of-sojourner\"\n\t],\n\t\"20%-er\": [\n\t\t\"emblem-of-severed-fate\",\n\t\t\"scholar\",\n\t\t\"the-exile\"\n\t],\n\t\"25%-ph-atk\": [\n\t\t\"bloodstained-chivalry\",\n\t\t\"pale-flame\"\n\t]\n}\n","import { charactersShortList } from '../api/generated.js'\n\nexport const paths = /** @type {const} */ ({\n\tfront: [''],\n\tbuilds: ['/builds'],\n\tbuildCharacters: ['/builds/', ['code', charactersShortList.map(x => x.code)]],\n\tweapons: ['/weapons'],\n\tartifacts: ['/artifacts'],\n\tabout: ['/about'],\n})\n\n/**\n * @param {import('./router').RoutePath} path\n * @param {string} url\n * @returns {Record<string, string> | null}\n */\nexport function matchPath(path, url) {\n\tif (path.length === 0) return null\n\tlet rem = url\n\tconst props = /**@type {Record<string, string>}*/ ({})\n\tfor (const part of path) {\n\t\tlet matched = true //true на случай пустых variants\n\t\tif (typeof part === 'string') {\n\t\t\t;[rem, matched] = withoutPrefix(rem, part)\n\t\t} else {\n\t\t\tconst [name, variants] = part\n\t\t\tfor (const variant of variants) {\n\t\t\t\t;[rem, matched] = withoutPrefix(rem, variant)\n\t\t\t\tif (matched) {\n\t\t\t\t\tprops[name] = variant\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!matched) return null\n\t}\n\treturn !rem || rem === '/' ? props : null\n}\n\n/**\n * @param {string} prefix\n * @param {import('./router').RoutePath} path\n * @param {number} [fromIndex]\n * @returns {string[]}\n */\nexport function pathToStrings(prefix, path, fromIndex = 0) {\n\tif (path.length === 0) return []\n\tif (fromIndex >= path.length) return [prefix]\n\n\tconst part = path[fromIndex]\n\tif (typeof part === 'string') {\n\t\treturn pathToStrings(prefix + part, path, fromIndex + 1)\n\t} else {\n\t\tconst [, variants] = part\n\t\treturn variants.flatMap(x => pathToStrings(prefix + x, path, fromIndex + 1))\n\t}\n}\n\n/**\n * @param {string} url\n * @param {string} prefix\n * @returns {[string, boolean]}\n */\nfunction withoutPrefix(url, prefix) {\n\treturn url.startsWith(prefix) ? [url.slice(prefix.length), true] : [url, false]\n}\n","import { ComponentType, h, Ref } from 'preact'\nimport { useEffect, useState } from 'preact/hooks'\n\nimport { matchPath } from './paths'\n\nexport type RoutePath = readonly (string | readonly [name: string, variants: readonly string[]])[]\n\ntype Routes = [RoutePath, ComponentType][]\n\ntype SubRoute<T> = readonly [string, readonly T[]]\ntype EmptySubRoute = readonly [string, readonly []]\ntype PathProps<T extends RoutePath> = {\n\t[K in keyof T as T[K] extends EmptySubRoute\n\t\t? never\n\t\t: T[K] extends SubRoute<unknown>\n\t\t? T[K][0]\n\t\t: never]: T[K] extends SubRoute<infer A> ? A : never\n} & {\n\t[K in keyof T as T[K] extends EmptySubRoute ? T[K][0] : never]?: undefined\n}\n\ndeclare global {\n\tinterface WindowEventMap {\n\t\t'x-route-to': CustomEvent<{ path: string }>\n\t}\n}\n\nconst URL_LANG_PREFIX = makeUrlLangPrefix(BUNDLE_ENV.LANG)\n\nfunction findRoutedComponent(routes: Routes, url: string): [ComponentType, Record<string, string>] | null {\n\tfor (const [route, comp] of routes) {\n\t\tconst props = matchPath(route, url)\n\t\tif (props) return [comp, props]\n\t}\n\treturn null\n}\n\nfunction pathSearchHash(url: { pathname: string; search: string; hash: string }) {\n\treturn url.pathname + url.search + url.hash\n}\n\nfunction tryRouteToPage(routes: Routes, url: URL) {\n\tif (url.origin === location.origin) {\n\t\tif (findRoutedComponent(routes, url.pathname)) {\n\t\t\tif (pathSearchHash(location) !== pathSearchHash(url)) {\n\t\t\t\tconst hashChanged = url.hash !== location.hash\n\t\t\t\thistory.pushState(null, '', pathSearchHash(url))\n\t\t\t\tif (hashChanged) dispatchEvent(new CustomEvent('x-local-hashchange'))\n\t\t\t}\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nfunction handleAnchorClick(e: MouseEvent, routes: Routes) {\n\tif (e.ctrlKey || e.altKey || e.shiftKey || e.metaKey || e.button !== 0) return\n\n\tconst a = e.target instanceof Element && e.target.closest('a')\n\tif (a && a.href && (!a.target || a.target === '_self')) {\n\t\tif (tryRouteToPage(routes, new URL(a.href))) {\n\t\t\te.preventDefault()\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nexport function useRouter(routes: Routes) {\n\tconst [, forceUpdate] = useState(0)\n\n\tuseEffect(() => {\n\t\tfunction onClick(e: MouseEvent) {\n\t\t\tconst handled = handleAnchorClick(e, routes)\n\t\t\tif (handled) forceUpdate(x => x + 1)\n\t\t}\n\t\tfunction onRouteTo(e: WindowEventMap['x-route-to']) {\n\t\t\tconst url = new URL(e.detail.path, location.href)\n\t\t\tif (tryRouteToPage(routes, url)) {\n\t\t\t\tforceUpdate(x => x + 1)\n\t\t\t} else {\n\t\t\t\tlocation.href = url.toString()\n\t\t\t}\n\t\t}\n\t\tfunction onPopState(e: PopStateEvent) {\n\t\t\tforceUpdate(x => x + 1)\n\t\t}\n\t\t// Тут обязательно слушать клик на боди, т.к. на window висит кривая гуглометрика,\n\t\t// которая при виде клика по <a> делает `location.href = a.href`, чем ломает\n\t\t// все роутерные переходы-без-перезагрузки.\n\t\t// Использовать onCapture тоже нельзя: в этом случае onlick какого-нибудь элмента\n\t\t// сработает после пеерключения страницы (т.е. когда элмента на странице уже нет),\n\t\t// это неторт (и предупреждение от preact/debug'а).\n\t\t// Сейчас же слушатель с боди срабатывает до метрики, проставляет `defaultPrevented`,\n\t\t// метрика о чём-то догадывается и не трогает location.\n\t\tdocument.body.addEventListener('click', onClick)\n\t\taddEventListener('x-route-to', onRouteTo)\n\t\taddEventListener('popstate', onPopState)\n\t\treturn () => {\n\t\t\tdocument.body.removeEventListener('click', onClick)\n\t\t\tremoveEventListener('x-route-to', onRouteTo)\n\t\t\tremoveEventListener('popstate', onPopState)\n\t\t}\n\t}, [routes])\n\n\tconst res = findRoutedComponent(routes, location.pathname)\n\tif (!res) return '404'\n\tconst [Comp, props] = res\n\treturn <Comp {...props} />\n}\n\n/**\n * Создаёт евент, который можно кинуть роутеру, чтоб тот перешёл на другую страницу.\n * Например:\n *   dispatchRouteTo('/path/to/page')\n * Тут бы логичнее выглядел какой-нибудь\n *   const goToPage = useRouterGoTo()\n *   goToPage('/path/to/page')\n * Но для этого всё внутри <App> надо оборачивать в провайдер, делать хуки с консьюмерами...\n * А тут кинул евент - и всё.\n */\nexport function dispatchRouteTo(path: string) {\n\tdispatchEvent(new CustomEvent('x-route-to', { detail: { path: URL_LANG_PREFIX + path } }))\n}\n\nexport const route = <TPath extends RoutePath>(\n\tpath: TPath,\n\tcomp: ComponentType<PathProps<TPath>>,\n): [RoutePath, ComponentType] => [[URL_LANG_PREFIX, ...path], comp as ComponentType]\n\nfunction makeUrlLangPrefix(lang: string): string {\n\treturn lang === 'en' ? '' : '/ru'\n}\n\nexport function isOnRoute(path: RoutePath): boolean {\n\treturn matchPath([URL_LANG_PREFIX, ...path], location.pathname) !== null\n}\n\nexport function makeLocationHrefForLang(lang: string): string {\n\tconst url = location.pathname + location.search + location.hash\n\tconst curPrefix = URL_LANG_PREFIX\n\tconst newPrefix = makeUrlLangPrefix(lang)\n\tlet newUrl = newPrefix + (url.startsWith(curPrefix) ? url.slice(curPrefix.length) : url)\n\tif (newUrl === '') newUrl = '/'\n\treturn newUrl\n}\n\nexport function A(\n\tprops: JSX.HTMLAttributes<HTMLAnchorElement> & {\n\t\tref?: Ref<typeof A>\n\t\tinnerRef?: Ref<HTMLAnchorElement>\n\t\tisExternal?: boolean\n\t},\n): JSX.Element {\n\tprops = Object.assign({}, props)\n\t// @ts-ignore\n\tprops.ref = props.innerRef\n\tdelete props.innerRef\n\tif (props.href && !props.isExternal) props.href = URL_LANG_PREFIX + props.href\n\tif (props.isExternal) props.target = '_blank'\n\t// тайпскриптовый JSX-трансформер какой-то туповатый:\n\t// он для <a {...props}/> генерит лишний Object.assign({}, props)\n\treturn h('a', props as Parameters<typeof h>[1])\n}\n","export function GlobeIcon({ classes = '' }) {\n\treturn (\n\t\t<svg\n\t\t\tclass={classes}\n\t\t\twidth=\"24\"\n\t\t\theight=\"24\"\n\t\t\tviewBox=\"0 0 24 24\"\n\t\t\tfill=\"none\"\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t>\n\t\t\t<path\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Zm2.8-2.6a7 7 0 0 0 4.2-5.9c-.8.5-1.9.8-3 1.1-.2 1.9-.6 3.5-1.2 4.8ZM9.2 5.6a7 7 0 0 0-4 4.6l1.2.8 1.6.5c0-2.3.5-4.4 1.2-6Zm.9 8.3c.2 1.5.5 2.7.9 3.7l.8 1.2.2.2.2-.2.8-1.2c.4-1 .7-2.2.9-3.7a20 20 0 0 1-3.8 0Zm-2-.3c.1 1.9.5 3.5 1 4.8a7 7 0 0 1-4-5.9c.7.5 1.8.8 3 1.1Zm5.9-1.7a17.8 17.8 0 0 1-4 0c0-2.2.4-4.2 1-5.5l.8-1.2.2-.2.2.2.8 1.2c.6 1.3 1 3.3 1 5.5Zm2-.4c0-2.3-.5-4.4-1.2-6a7 7 0 0 1 4 4.7l-1.2.8-1.6.5Z\"\n\t\t\t\tfill=\"currentColor\"\n\t\t\t/>\n\t\t</svg>\n\t)\n}\n","import { useCallback, useRef, useState } from 'preact/hooks'\n\nimport {\n\tI18N_ABOUT_SITE,\n\tI18N_ARTIFACTS,\n\tI18N_BUILDS,\n\tI18N_EQUIPMENT,\n\tI18N_LANG_NAME,\n\tI18N_LANG_NAMES,\n\tI18N_OUR_DISCORD,\n\tI18N_SUPPORT_US,\n\tI18N_SUPPORT_VIA_DON_ALERTS,\n\tI18N_SUPPORT_VIA_KO_FI,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { paths } from '#src/routes/paths'\nimport { A, isOnRoute, makeLocationHrefForLang } from '#src/routes/router'\nimport { useClickAway } from '#src/utils/hooks'\nimport { VARIATION_SELECTOR } from '#src/utils/typography'\nimport { GlobeIcon } from './globe-icon'\nimport { LINK_DISCORD_INVITE, LINK_DONATION_ALERTS, LINK_KO_FI } from '#src/utils/links'\n\ntype Props = { isNavExpanded: boolean }\nconst isPageActive = routs => routs.some(r => isOnRoute(r))\nexport function Nav({ isNavExpanded }: Props): JSX.Element {\n\treturn (\n\t\t<div className={`collapse navbar-collapse ${isNavExpanded ? 'show' : ''}`}>\n\t\t\t<ul className=\"navbar-nav me-auto mb-2 mb-md-0\">\n\t\t\t\t<li className=\"nav-item\">\n\t\t\t\t\t<A\n\t\t\t\t\t\tclassName={`nav-link ${\n\t\t\t\t\t\t\tisPageActive([paths.builds, paths.buildCharacters]) ? ' active' : ''\n\t\t\t\t\t\t}`}\n\t\t\t\t\t\thref={paths.builds[0]}\n\t\t\t\t\t>\n\t\t\t\t\t\t{I18N_BUILDS}\n\t\t\t\t\t</A>\n\t\t\t\t</li>\n\t\t\t\t<EquipmentDd />\n\t\t\t</ul>\n\t\t\t<ul className=\"navbar-nav mb-2 mb-md-0 float-md-end\">\n\t\t\t\t<li className=\"nav-item\">\n\t\t\t\t\t<a className=\"nav-link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\n\t\t\t\t\t\t{I18N_OUR_DISCORD}\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t\t<li className=\"nav-item\">\n\t\t\t\t\t<A\n\t\t\t\t\t\tclassName={`nav-link ${isPageActive([paths.about]) ? ' active' : ''}`}\n\t\t\t\t\t\thref={paths.about[0]}\n\t\t\t\t\t>\n\t\t\t\t\t\t{I18N_ABOUT_SITE}\n\t\t\t\t\t</A>\n\t\t\t\t</li>\n\t\t\t\t<DonationDd />\n\t\t\t\t<LangSelect />\n\t\t\t</ul>\n\t\t</div>\n\t)\n}\ntype DdLink = {\n\ttitle: string | JSX.Element\n\thref: string\n\tisExternal?: boolean\n\tisActive?: boolean\n\tcode?: string\n}\n\nconst SUPPORT_DD_LINKS: DdLink[] = [\n\t{\n\t\ttitle: I18N_SUPPORT_VIA_KO_FI,\n\t\thref: LINK_KO_FI,\n\t\tisExternal: true,\n\t},\n\t{\n\t\ttitle: I18N_SUPPORT_VIA_DON_ALERTS,\n\t\thref: LINK_DONATION_ALERTS,\n\t\tisExternal: true,\n\t},\n]\nfunction DonationDd(): JSX.Element {\n\treturn <HeadDd title={I18N_SUPPORT_US} ddLinks={SUPPORT_DD_LINKS} />\n}\nconst EQUIPMENT_DD_LINKS: DdLink[] = [\n\t{\n\t\ttitle: I18N_WEAPONS,\n\t\thref: '/weapons',\n\t\tcode: 'weapons',\n\t},\n\t{\n\t\ttitle: I18N_ARTIFACTS,\n\t\thref: '/artifacts',\n\t\tcode: 'artifacts',\n\t},\n]\nfunction EquipmentDd(): JSX.Element {\n\tconst ddLinksLocal = EQUIPMENT_DD_LINKS.map(l => {\n\t\treturn {\n\t\t\t...l,\n\t\t\tisActive: isPageActive([paths[l.code]]),\n\t\t}\n\t})\n\treturn <HeadDd title={I18N_EQUIPMENT} ddLinks={ddLinksLocal} />\n}\n\nfunction HeadDd({ title, ddLinks }: { title: string | JSX.Element; ddLinks: DdLink[] }): JSX.Element {\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst ddRef = useRef(null)\n\tconst closeDd = useCallback(() => isExpanded && setIsExpanded(false), [setIsExpanded, isExpanded])\n\tconst openDd = useCallback(() => !isExpanded && setIsExpanded(true), [setIsExpanded, isExpanded])\n\n\t// TODO клик мимо компонента\n\tuseClickAway(ddRef, closeDd)\n\tconst isActive = ddLinks.some(l => l.isActive)\n\treturn (\n\t\t<li className=\"nav-item dropdown\">\n\t\t\t<a\n\t\t\t\tclassName={`nav-link dropdown-toggle ${isActive ? 'active' : ''} ${isExpanded ? 'show' : ''}`}\n\t\t\t\tid=\"navbarDropdown\"\n\t\t\t\trole=\"button\"\n\t\t\t\tonClick={openDd}\n\t\t\t>\n\t\t\t\t{title}\n\t\t\t</a>\n\t\t\t<ul className={`dropdown-menu ${isExpanded ? 'show' : ''}`} style={'right: 0'} ref={ddRef}>\n\t\t\t\t{isExpanded\n\t\t\t\t\t? ddLinks.map(l => (\n\t\t\t\t\t\t\t<li key={l.href}>\n\t\t\t\t\t\t\t\t<A\n\t\t\t\t\t\t\t\t\tclassName={`dropdown-item ${l.isActive ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\thref={l.href}\n\t\t\t\t\t\t\t\t\tisExternal={l.isExternal}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{l.title}\n\t\t\t\t\t\t\t\t</A>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t  ))\n\t\t\t\t\t: null}\n\t\t\t</ul>\n\t\t</li>\n\t)\n}\n// const LANG_DD_LINKS: DdLink[] = BUNDLE_ENV.LANGS.map(lang => {\n// \treturn {\n// \t\ttitle: I18N_LANG_NAMES[lang],\n// \t\thref: makeLocationHrefForLang(lang),\n// \t\tisActive: I18N_LANG_NAMES[lang] === I18N_LANG_NAME,\n// \t}\n// })\nfunction LangSelect(): JSX.Element {\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst ddRef = useRef(null)\n\tconst closeDd = useCallback(() => isExpanded && setIsExpanded(false), [setIsExpanded, isExpanded])\n\tconst openDd = useCallback(() => !isExpanded && setIsExpanded(true), [setIsExpanded, isExpanded])\n\n\t// TODO клик мимо компонента\n\tuseClickAway(ddRef, closeDd)\n\n\treturn (\n\t\t<li className=\"nav-item dropdown\">\n\t\t\t<a\n\t\t\t\tclassName={`nav-link dropdown-toggle ${isExpanded ? 'show' : ''}`}\n\t\t\t\tid=\"navbarDropdown\"\n\t\t\t\trole=\"button\"\n\t\t\t\tonClick={openDd}\n\t\t\t>\n\t\t\t\t<GlobeIcon />\n\t\t\t\t{VARIATION_SELECTOR} {I18N_LANG_NAME}\n\t\t\t</a>\n\t\t\t{/* todo почему-то не добавляется класс dropdown-menu-end */}\n\t\t\t<ul className={`dropdown-menu ${isExpanded ? 'show' : ''}`} style={'right: 0'} ref={ddRef}>\n\t\t\t\t{/* В переключатеях будут неправильные ссылки, если сменится страница,\n\t\t\t\t\t\tа список языков не будет перерендерен (если тут таки появится useMemo).\n\t\t\t\t\t\tТак что явно генерим сожержимое списка после разворачивания дропдауна. */}\n\t\t\t\t{isExpanded &&\n\t\t\t\t\tBUNDLE_ENV.LANGS.map(lang => {\n\t\t\t\t\t\tconst langName = I18N_LANG_NAMES[lang]\n\t\t\t\t\t\tconst isActiveLang = langName === I18N_LANG_NAME\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li key={lang}>\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tclassName={`dropdown-item ${isActiveLang ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\thref={makeLocationHrefForLang(lang)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{I18N_LANG_NAMES[lang]}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t</ul>\n\t\t</li>\n\t)\n}\n","import { setDayStartUTC, weekdayAsMonSun } from './utils/date.js'\n\n/** @typedef {'pyro' | 'electro' | 'hydro' | 'dendro' | 'cryo' | 'anemo' | 'geo'} GI_ElementCode */\n/** @typedef {'claymore' | 'sword' | 'catalyst' | 'polearm' | 'bow'} GI_WeaponTypeCode */\n/** @typedef {'flower' | 'plume' | 'sands' | 'goblet' | 'circlet'} GI_ArtifactTypeCode */\n/** @typedef {1 | 2 | 3 | 4 | 5} GI_RarityCode */\n/**\n * @typedef {'wishes'|'event-wishes'|'events'|'battle-pass'|'in-game-shop'|\n *   'forging'|'fishing'|'npc-shop'|'chests'|'quests'|'puzzles'|'investigation'|\n *   'adventure-rank-10'|'playstation'} GI_WeaponObtainSource\n */\n/** @typedef {'limited'|'unlimited'} GI_DomainTypeCode */\n\n/** @typedef {{mapCode:MapCode, x:number, y:number}} MapLocation */\n\n/** @typedef {'teyvat'|'enkanomiya'|'chasm'} MapCode */\n/** @type {MapCode[]} */\nexport const GI_MAP_CODES = ['teyvat', 'enkanomiya', 'chasm']\n\n/** @typedef {'mondstadt'|'liyue'|'inazuma'} GI_RegionCode */\n/** @type {GI_RegionCode[]} */\nexport const GI_REGION_CODES = ['mondstadt', 'liyue', 'inazuma']\n\n/** @typedef {'europe'|'asia'|'north-america'} GI_ServerRegionCode */\n/** @type {GI_ServerRegionCode[]} */\nexport const GI_SERVER_REGIONS = ['europe', 'asia', 'north-america']\n\n/** @typedef {'mon'|'tue'|'wed'|'thu'|'fri'|'sat'|'sun'} WeekdayCode */\n/** @type {WeekdayCode[]} */\nexport const GI_ROTATION_WEEKDAY_CODES = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun']\n\n/** @type {GI_ElementCode[]} */\nexport const GI_ELEMENT_CODES = ['pyro', 'electro', 'hydro', 'dendro', 'cryo', 'anemo', 'geo']\n\n/** @type {GI_WeaponTypeCode[]} */\nexport const GI_WEAPON_TYPE_CODES = ['claymore', 'sword', 'catalyst', 'polearm', 'bow']\n\n/** @type {GI_ArtifactTypeCode[]} */\nexport const GI_ARTIFACT_TYPE_CODES = ['flower', 'plume', 'sands', 'goblet', 'circlet']\n\nexport const ART_GROUP_18_ATK_CODE = '18%-atk'\nexport const ART_GROUP_20_ER_CODE = '20%-er'\nexport const ART_GROUP_25_PH_ATK_CODE = '25%-ph-atk'\n/** @typedef {'18%-atk'|'20%-er'|'25%-ph-atk'} GI_ArtifactGroupCode */\n/** @type {GI_ArtifactGroupCode[]} */\nexport const GI_ARTIFACT_GROUP_CODES = [ART_GROUP_18_ATK_CODE, ART_GROUP_20_ER_CODE, ART_GROUP_25_PH_ATK_CODE]\n\n/** @type {GI_RarityCode[]} */\nexport const GI_RARITY_CODES = [1, 2, 3, 4, 5]\n\n/** Обычные коды, используются как есть */\nconst _GI_STAT_REGULAR = /**@type {const}*/ (['em'])\n/** Используется как в обычном виде, так и с процентами: <stat> и <stat>% */\nconst _GI_STAT_PERCENT = /**@type {const}*/ (['def', 'dmg', 'atk', 'hp', 'er', 'healing'])\n/** Используются с префиксом 'crit-' */\nconst _GI_STAT_CRIT_SUFFIXES = /**@type {const}*/ (['rate', 'dmg', 'rate%', 'dmg%'])\n/** Используются с суффиксами '-dmg' и '-dmg%' */\nconst _GI_STAT_DMG_PEFIXES = /**@type {const}*/ (['phys', 'cryo', 'geo', 'anemo', 'hydro', 'electro', 'pyro'])\n\n/**\n * @typedef {typeof _GI_STAT_REGULAR[number]\n *   | typeof _GI_STAT_PERCENT[number]\n *   | `${typeof _GI_STAT_PERCENT[number]}%`\n *   | `crit-${typeof _GI_STAT_CRIT_SUFFIXES[number]}`\n *   | `${typeof _GI_STAT_DMG_PEFIXES[number]}-dmg`\n *   | `${typeof _GI_STAT_DMG_PEFIXES[number]}-dmg%`} GI_KnownStatBonusCode\n */\n\nexport const GI_KNOWN_STAT_BONUS_CODES = /**@type {GI_KnownStatBonusCode[]}*/ (\n\t/**@type {readonly string[]}*/ (_GI_STAT_REGULAR)\n\t\t.concat(_GI_STAT_PERCENT)\n\t\t.concat(_GI_STAT_PERCENT.map(x => x + '%'))\n\t\t.concat(_GI_STAT_CRIT_SUFFIXES.map(x => 'crit-' + x))\n\t\t.concat(_GI_STAT_DMG_PEFIXES.map(x => x + '-dmg'))\n\t\t.concat(_GI_STAT_DMG_PEFIXES.map(x => x + '-dmg%'))\n)\n\n/**\n * Сдвиг таймзоны региона относительно UTC (в часах)\n * @type {Record<GI_ServerRegionCode, number>}\n */\nexport const GI_REGION_TIMEZONE_OFFSET = {\n\teurope: 1,\n\tasia: 8,\n\t'north-america': -5,\n}\n/** Время перезапуска сервера (в часах) относительно полуночи по локальному времени региона */\nexport const GI_SERVER_RESET_TIME = 4\n/**\n * @param {GI_ServerRegionCode} regionCode\n * @returns {{weekdayCode:WeekdayCode, weekdayMonSun:number, resetIn:number, resetAt:Date}}\n */\nexport function getRegionTime(regionCode) {\n\tconst now = new Date()\n\t// время до перезапуска сервера относительно конца дня по UTC\n\tconst offsetHours = GI_SERVER_RESET_TIME - GI_REGION_TIMEZONE_OFFSET[regionCode]\n\n\tconst lastResetDate = new Date(now)\n\tlastResetDate.setHours(lastResetDate.getHours() - offsetHours)\n\tconst weekdayMonSun = weekdayAsMonSun(lastResetDate.getUTCDay())\n\tsetDayStartUTC(lastResetDate)\n\tlastResetDate.setUTCHours(offsetHours)\n\n\tconst nextResetDate = new Date(lastResetDate)\n\tnextResetDate.setDate(nextResetDate.getDate() + 1)\n\n\treturn {\n\t\tweekdayMonSun: weekdayMonSun,\n\t\tweekdayCode: GI_ROTATION_WEEKDAY_CODES[weekdayMonSun],\n\t\tresetIn: +nextResetDate - +now,\n\t\tresetAt: nextResetDate,\n\t}\n}\n/**\n * {@link https://www.timeanddate.com/time/map/}\n * @returns {GI_ServerRegionCode}\n */\nexport function guessCurrentRegion() {\n\tif (navigator.language.startsWith('ru')) return 'europe'\n\tconst curOffset = -new Date().getTimezoneOffset() / 60\n\tif (curOffset <= -2) return 'north-america'\n\tif (curOffset >= 5) return 'asia'\n\treturn 'europe'\n}\n\n/** @param {string} name */\nexport function getCharacterCodeFromName(name) {\n\tconst code = name.trim().toLocaleLowerCase().replace(/\\s/g, '-')\n\tif (code === 'childe') return 'tartaglia'\n\tif (code === 'kamisato-ayaka') return 'ayaka'\n\tif (code === 'kamisato-ayato') return 'ayato'\n\tif (code === 'sangonomiya-kokomi') return 'kokomi'\n\tif (code === 'kaedehara-kazuha') return 'kazuha'\n\tif (code === 'arataki-itto') return 'itto'\n\treturn code\n}\n\n/** @param {string} name */\nexport function getArtifactCodeFromName(name) {\n\treturn name.trim().toLocaleLowerCase().replace(/\\s/g, '-').replace(/'/g, '')\n}\n\n/** @param {string} name */\nexport function getWeaponCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/\\s+/g, '-')\n\t\t.replace(/['\"«»]/g, '')\n}\n\n/** @param {string} name */\nexport function getDomainCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/[\\s:]+/g, '-')\n\t\t.replace(/'/g, '')\n}\n\n/** @param {string} name */\nexport function getItemCodeFromName(name) {\n\treturn name.trim().toLocaleLowerCase().replace(/\\s+/g, '-').replace(/'/g, '')\n}\n\n/** @param {string} name */\nexport function getEnemyCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/[\\s:\\-,]+/g, '-')\n\t\t.replace(/'/g, '')\n}\n\n/**\n * @template {{rarity:GI_RarityCode}} T\n * @param {T[]} items\n * @returns {T}\n */\nexport function getWithMaxRarity(items) {\n\tlet maxItem = items[0]\n\tfor (let i = 0; i < items.length; i++) if (maxItem.rarity < items[i].rarity) maxItem = items[i]\n\treturn maxItem\n}\n\n/** @type {Record<MapCode, string>} */\nconst locEnc_map2code = {\n\tteyvat: 'T',\n\tenkanomiya: 'E',\n\tchasm: 'C',\n}\n/** @type {Record<string, MapCode>} */\nconst locEnc_code2map = {\n\tT: 'teyvat',\n\tE: 'enkanomiya',\n\tC: 'chasm',\n}\n/**\n * @param {MapLocation[]} locations\n * @param {number} [downsample]\n * @returns {string}\n */\nexport function encodeLocations(locations, downsample = 1) {\n\tif (downsample < 1 || downsample > 35 || downsample % 1 !== 0)\n\t\tthrow new Error(`wrong downsample: ${downsample}`)\n\n\tconst sortedLocs = locations.slice().sort((a, b) => a.x - b.x || a.y - b.y)\n\n\tlet res = downsample.toString(36)\n\tfor (const [groupMapCode, groupLetter] of Object.entries(locEnc_map2code)) {\n\t\tlet xx = ''\n\t\tlet yy = ''\n\t\tfor (const { mapCode, x, y } of sortedLocs) {\n\t\t\tif (mapCode === groupMapCode) {\n\t\t\t\txx += encodeLocNum(x, downsample)\n\t\t\t\tyy += encodeLocNum(y, downsample)\n\t\t\t}\n\t\t}\n\t\tif (xx || yy) res += xx + yy + groupLetter\n\t}\n\treturn res\n}\n/**\n * @param {MapLocation[]} locations\n * @param {number} [downsample]\n * @returns {string}\n */\nexport function encodeLocationsChecked(locations, downsample = 1) {\n\tconst res = encodeLocations(locations, downsample)\n\n\tconst codes = Object.keys(locEnc_map2code)\n\tconst sortedLocs = locations\n\t\t.slice()\n\t\t.sort((a, b) => codes.indexOf(a.mapCode) - codes.indexOf(b.mapCode) || a.x - b.x || a.y - b.y)\n\t\t.map(l => ({\n\t\t\t...l,\n\t\t\tx: Math.round(l.x / downsample) * downsample,\n\t\t\ty: Math.round(l.y / downsample) * downsample,\n\t\t}))\n\tconst decodedLocs = decodeLocations(res)\n\tconst inJson = JSON.stringify(sortedLocs)\n\tconst outJson = JSON.stringify(decodedLocs)\n\tif (inJson !== outJson)\n\t\tthrow new Error('wrong decoded locations:\\n> ' + inJson + '\\n> ' + outJson + '\\n> ' + res)\n\n\treturn res\n}\n/**\n * @param {string} encodedLocations\n * @returns {MapLocation[]}\n */\nexport function decodeLocations(encodedLocations) {\n\tconst downsample = parseInt(encodedLocations[0], 36)\n\tencodedLocations = encodedLocations.slice(1)\n\n\tconst locs = /**@type {MapLocation[]}*/ ([])\n\twhile (encodedLocations) {\n\t\tlet i = 0\n\t\tfor (; i < encodedLocations.length; i++) {\n\t\t\tconst mapCode = locEnc_code2map[encodedLocations[i]]\n\t\t\tif (mapCode) {\n\t\t\t\tconst len3 = (i / 2) | 0\n\t\t\t\tfor (let j = 0; j < len3; j += 3) {\n\t\t\t\t\tconst x = decodeLocNum(encodedLocations, j, downsample)\n\t\t\t\t\tconst y = decodeLocNum(encodedLocations, j + len3, downsample)\n\t\t\t\t\tlocs.push({ mapCode, x, y })\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\tencodedLocations = encodedLocations.slice(i + 1)\n\t}\n\treturn locs\n}\nconst LOC_NUM_ENC_OFFSET = 18 * 36 * 36\n/**\n * @param {number} num\n * @param {number} downsample\n */\nfunction encodeLocNum(num, downsample) {\n\tconst numD = Math.round(num / downsample)\n\tif (numD < -LOC_NUM_ENC_OFFSET || numD >= LOC_NUM_ENC_OFFSET)\n\t\tthrow new Error(`location value out of range: ${num} (${numD})`)\n\tconst str = (LOC_NUM_ENC_OFFSET + numD).toString(36)\n\treturn '0'.repeat(3 - str.length) + str\n}\n/**\n * @param {string} str\n * @param {number} i\n * @param {number} downsample\n */\nfunction decodeLocNum(str, i, downsample) {\n\treturn (parseInt(str.slice(i, i + 3), 36) - LOC_NUM_ENC_OFFSET) * downsample\n}\n\n/**\n * @template {{locations: 'external' | MapLocation[], _locsEnc?: string|null}} T\n * @param {T} obj\n * @param {number} [downsample]\n * @returns {void}\n */\nexport function encodeObjLocations(obj, downsample = 1) {\n\tif (obj.locations !== 'external') {\n\t\tobj._locsEnc = encodeLocationsChecked(obj.locations, downsample)\n\t\tobj.locations = []\n\t}\n}\n/**\n * @template {{locations: 'external' | MapLocation[], _locsEnc?: string|null}} T\n * @param {T} obj\n * @returns {void}\n */\nexport function decodeObjLocations(obj) {\n\tif (obj._locsEnc) {\n\t\tobj.locations = decodeLocations(obj._locsEnc)\n\t\tobj._locsEnc = null\n\t}\n}\n","/**\n * Конвертирует номер дня недели из вс-пн…-сб в пн-вт…-вс\n * @param {number} weekday\n * @returns {number}\n */\nexport function weekdayAsMonSun(weekday) {\n\treturn weekday === 0 ? 6 : weekday - 1\n}\n\n/**\n * @param {Date} date\n * @returns {number}\n */\nexport function setDayStartUTC(date) {\n\treturn date.setUTCHours(0, 0, 0, 0)\n}\n","import { decodeObjLocations } from '#lib/genshin'\nimport { DomainShortInfo, EnemyShortInfo, ItemShortInfo } from '#lib/parsing/combine'\n\nexport function apiGetJSONFile<T>(path: string, signal?: AbortSignal | null): Promise<T> | T {\n\tif (BUNDLE_ENV.IS_SSR) {\n\t\treturn JSON.parse(SSR_ENV.readPublic(path))\n\t} else {\n\t\treturn fetch(BUNDLE_ENV.ASSET_PATH + path, { method: 'GET', signal }).then(x => x.json())\n\t}\n}\n\ntype MapByCodeInner<T> = T extends (infer A)[] ? (A extends { code: string } ? Map<string, A> : never) : never\n\nexport type MapAllByCode<T> = T & {\n\tmaps: {\n\t\t[K in keyof T as T[K] extends (infer A)[]\n\t\t\t? A extends { code: string }\n\t\t\t\t? K\n\t\t\t\t: never\n\t\t\t: never]: MapByCodeInner<T[K]>\n\t}\n}\n\nexport function mapAllByCode<T>(obj: T): MapAllByCode<T> {\n\t// @ts-ignore\n\tconst maps: MapAllByCode<T>['maps'] = {}\n\tfor (const attr in obj) {\n\t\tconst val = obj[attr]\n\t\tif (Array.isArray(val) && (val.length === 0 || 'code' in val[0])) {\n\t\t\t// @ts-ignore\n\t\t\tmaps[attr] = new Map(val.map(x => [x.code, x]))\n\t\t}\n\t}\n\treturn Object.assign({}, obj, { maps })\n}\n\nexport function decodeRelatedLocations<T extends { items?: ItemShortInfo[]; enemies?: EnemyShortInfo[] }>(\n\trel: T,\n): T {\n\tif (rel.items) for (const item of rel.items) decodeObjLocations(item)\n\tif (rel.enemies) for (const enemy of rel.enemies) decodeObjLocations(enemy)\n\treturn rel\n}\n\nexport type RelItemsShort = { items: Map<string, ItemShortInfo> }\nexport type RelDomainsShort = { domains: Map<string, DomainShortInfo> }\nexport type RelEnemiesShort = { enemies: Map<string, EnemyShortInfo> }\n\nexport function getAllRelated<T>(map: Map<string, T>, codes: string[]): T[] {\n\tconst res: T[] = []\n\tfor (const code of codes) {\n\t\tconst item = map.get(code)\n\t\tif (item !== undefined) res.push(item)\n\t}\n\treturn res\n}\n\n/*\ntype MergeNestedInner<TBase, T> = T & {\n\t[K in keyof T as K extends 'materialCodes'\n\t\t? 'materials'\n\t\t: K extends 'domainCodes'\n\t\t? 'domains'\n\t\t: K extends 'enemyCodes'\n\t\t? 'enemies'\n\t\t: K]: K extends 'materialCodes'\n\t\t? TBase extends { items: (infer TItem)[] }\n\t\t\t? TItem[]\n\t\t\t: never\n\t\t: K extends 'domainCodes'\n\t\t? TBase extends { domains: (infer TDomain)[] }\n\t\t\t? TDomain[]\n\t\t\t: never\n\t\t: K extends 'enemyCodes'\n\t\t? TBase extends { enemies: (infer TEnemy)[] }\n\t\t\t? TEnemy[]\n\t\t\t: never\n\t\t: MergeNestedInner<TBase, T[K]>\n}\n\ntype WithNested_<T, TArt, TItem, TDomain, TEnemy> = T & {\n\t[K in keyof T as K extends 'materialCodes'\n\t\t? 'materials'\n\t\t: K extends 'domainCodes'\n\t\t? 'domains'\n\t\t: K extends 'enemyCodes'\n\t\t? 'enemies'\n\t\t: K]: K extends 'materialCodes'\n\t\t? TItem\n\t\t: K extends 'domainCodes'\n\t\t? TDomain\n\t\t: K extends 'enemyCodes'\n\t\t? TEnemy\n\t\t: WithNested_<T[K], TItem, TDomain, TEnemy>\n}\n\ntype WithNestedAuto<T> = WithNested_<\n\tT,\n\tT extends { items: (infer TItem)[] } ? TItem[] : never,\n\tT extends { artifacts: (infer TArt)[] } ? TArt[] : never,\n\tT extends { domains: (infer TDomain)[] } ? TDomain[] : never,\n\tT extends { enemies: (infer TEnemy)[] } ? TEnemy[] : never\n>\n\nexport type WithNested<T> = MergeNestedInner<T, T>\n\nexport function addNested<T>(obj: T): WithNested<T> {\n\tconst mapsCache = {}\n\tfunction getAllByCode(codes, attr) {\n\t\tif (!(attr in obj)) throw new Error(`no attr '${attr}' in obj`)\n\t\tconst map = (mapsCache[attr] = mapsCache[attr] ?? new Map(obj[attr].map(x => [x.code, x])))\n\t\tconst res: unknown[] = []\n\t\tfor (const code of codes) {\n\t\t\tconst item = map.get(code)\n\t\t\tif (item) res.push(item)\n\t\t}\n\t\treturn res\n\t}\n\n\tconst relatedAttrMap = {\n\t\tmaterialCodes: ['materials', 'items'],\n\t\tdomainCodes: ['domains', 'domains'],\n\t\tenemyCodes: ['enemies', 'enemies'],\n\t}\n\tfunction mergeInner(cur) {\n\t\tif (cur === null || typeof cur !== 'object') return cur\n\n\t\tfor (const attr in cur) {\n\t\t\tmergeInner(cur[attr])\n\t\t\tconst rel = relatedAttrMap[attr]\n\t\t\tif (rel) cur[rel[0]] = getAllByCode(cur[attr], rel[1])\n\t\t}\n\t}\n\n\tmergeInner(obj)\n\treturn obj as WithNested<T>\n}\n*/\n\n/*\ntype ItemsWithCodeAttrs<T> = {\n\t[K in keyof T]: T[K] extends (infer A)[] ? (A extends { code: string } ? K : never) : never\n}[keyof T]\n\nexport function mapByCode<T, K extends ItemsWithCodeAttrs<T>>(obj: T, attrs: K[]): MapByCode<T, K> {\n\t// @ts-ignore\n\tconst maps: MapByCode<T, K>['maps'] = {}\n\tfor (const attr of attrs) {\n\t\t// @ts-ignore\n\t\tmaps[attr] = new Map(obj[attr].map(x => [x.code, x]))\n\t}\n\treturn Object.assign({}, obj, { maps })\n}\n*/\n","import { isPromise } from '#lib/utils/values'\nimport { GENERATED_DATA_HASH } from './generated'\nimport { apiGetJSONFile, decodeRelatedLocations, mapAllByCode, MapAllByCode } from './utils'\n\nimport type {\n\tArtifactFullInfoWithRelated,\n\tArtifactRegularInfo,\n\tCharacterFullInfoWithRelated,\n\tExtractedLocationsInfo,\n\tMaterialsTimetableWithRelated,\n\tSearchItem,\n\tWeaponFullInfoWithRelated,\n\tWeaponRegularInfo,\n} from '#lib/parsing/combine'\n\nconst get = <T>(prefix: string, signal: AbortSignal) =>\n\tapiGetJSONFile<T>(`generated/${prefix}.json?v=${GENERATED_DATA_HASH}`, signal)\n\nconst getLang = <T>(prefix: string, signal: AbortSignal) => get<T>(prefix + '-' + BUNDLE_ENV.LANG, signal)\n\ntype PromiseOrSync<T> = Promise<T> | T\n\nconst _map = <T, R>(val: PromiseOrSync<T>, func: (v: T) => R): PromiseOrSync<R> =>\n\tisPromise(val) ? val.then(func) : func(val)\n\nexport function apiGetCharacter(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<CharacterFullInfoWithRelated>> {\n\treturn _map(getLang<CharacterFullInfoWithRelated>(`characters/${code}`, signal), mapAllByCode)\n}\n\nexport function apiGetCharacterRelatedLocs(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<ExtractedLocationsInfo> {\n\treturn getLang(`characters/${code}-locs`, signal)\n}\n\nexport function apiGetArtifacts(signal: AbortSignal): PromiseOrSync<ArtifactRegularInfo[]> {\n\treturn getLang<ArtifactRegularInfo[]>(`artifacts`, signal)\n}\n\nexport function apiGetArtifact(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<ArtifactFullInfoWithRelated>> {\n\treturn _map(getLang<ArtifactFullInfoWithRelated>(`artifacts/${code}`, signal), arts =>\n\t\tmapAllByCode(decodeRelatedLocations(arts)),\n\t)\n}\n\nexport function apiGetWeapons(signal: AbortSignal): PromiseOrSync<WeaponRegularInfo[]> {\n\treturn getLang<WeaponRegularInfo[]>(`weapons`, signal)\n}\nexport function apiGetWeapon(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<WeaponFullInfoWithRelated>> {\n\treturn _map(getLang<WeaponFullInfoWithRelated>(`weapons/${code}`, signal), arts =>\n\t\tmapAllByCode(decodeRelatedLocations(arts)),\n\t)\n}\n\nexport function apiMaterialsTimetable(\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<MaterialsTimetableWithRelated>> {\n\treturn _map(getLang<MaterialsTimetableWithRelated>(`timetables/materials`, signal), mapAllByCode)\n}\n\nexport function apiGetSearchData(signal: AbortSignal) {\n\treturn getLang<SearchItem[]>(`search`, signal)\n}\n","export function BlockHeader({ children, classes = '' }) {\n\treturn <h6 className={`text-uppercase opacity-75 letter-spacing-1 ${classes}`}>{children}</h6>\n}\n","export function Spinner(): JSX.Element {\n\treturn (\n\t\t<div class=\"d-flex justify-content-center\">\n\t\t\t<div class=\"spinner-border\" role=\"status\">\n\t\t\t\t<span class=\"visually-hidden\">Loading...</span>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\nexport function CentredSpinner(): JSX.Element {\n\treturn (\n\t\t<div className=\"position-absolute top-0 bottom-0 start-0 end-0 d-flex justify-content-center align-items-center\">\n\t\t\t<Spinner />\n\t\t</div>\n\t)\n}\nexport function CentredLabel({ label }: { label: string }): JSX.Element {\n\treturn (\n\t\t<div className=\"position-absolute top-0 bottom-0 start-0 end-0 d-flex justify-content-center align-items-center placeholder-backdrop\">\n\t\t\t<div class=\"d-flex justify-content-center\">\n\t\t\t\t<div>{label}</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","export const WEAPON_ROW_CARD_HASH_KEY = 'w'\nexport const ARTIFACT_ROW_CARD_HASH_KEY = 'a'\nconst keyMap = {\n\tweapon: WEAPON_ROW_CARD_HASH_KEY,\n\tartifact: ARTIFACT_ROW_CARD_HASH_KEY,\n}\nexport const genEquipmentHash = (type: 'weapon' | 'artifact', code: string): string => {\n\treturn `#${keyMap[type]}=${code}`\n}\n","export default __webpack_public_path__ + \"circlet.a7d84b1e.png\";","export default __webpack_public_path__ + \"flower.695510cb.png\";","export default __webpack_public_path__ + \"goblet.06e92e38.png\";","export default __webpack_public_path__ + \"plume.6851630b.png\";","export default __webpack_public_path__ + \"sands.e69477c6.png\";","import { GI_ARTIFACT_GROUP_CODES, GI_ArtifactTypeCode } from '#lib/genshin'\nimport { ART_GROUP_CODES } from '#src/api/generated'\nimport icon_circlet from '#src/media/circlet.png'\nimport icon_flower from '#src/media/flower.png'\nimport icon_goblet from '#src/media/goblet.png'\nimport icon_plume from '#src/media/plume.png'\nimport icon_sands from '#src/media/sands.png'\n\nexport type GI_ArtifactType = { readonly code: GI_ArtifactTypeCode; imgSrc: string }\nexport const artifactTypes: GI_ArtifactType[] = [\n\t{ code: 'flower' as const, imgSrc: icon_flower },\n\t{ code: 'plume' as const, imgSrc: icon_plume },\n\t{ code: 'sands' as const, imgSrc: icon_sands },\n\t{ code: 'goblet' as const, imgSrc: icon_goblet },\n\t{ code: 'circlet' as const, imgSrc: icon_circlet },\n]\n\nexport function getArtifactTypeIconSrc(artifactTypeCode: string): string {\n\treturn (artifactTypes.find(at => at.code === artifactTypeCode) || artifactTypes[0]).imgSrc\n}\n\nfunction isGroup(code: string) {\n\treturn (GI_ARTIFACT_GROUP_CODES as string[]).includes(code)\n}\n\nexport function getArtifactIconSrc(artifactCode: string): string {\n\treturn isGroup(artifactCode) ? icon_flower : BUNDLE_ENV.ASSET_PATH + `media/artifacts/${artifactCode}.png`\n}\n\nexport function getArtifactIconLargeSrc(artifactCode: string): string {\n\treturn isGroup(artifactCode)\n\t\t? icon_flower\n\t\t: BUNDLE_ENV.ASSET_PATH + `media/artifacts/${artifactCode}.large.png`\n}\n\nfunction getAllOrNone<T>(codes: string[], map: Map<string, T>) {\n\tconst res: T[] = []\n\tfor (const code of codes) {\n\t\tconst item = map.get(code)\n\t\tif (!item) return []\n\t\tres.push(item)\n\t}\n\treturn res\n}\nexport function getAllArtifacts<T>(code: string, artsMap: Map<string, T>): T[] {\n\tif (code in ART_GROUP_CODES) return getAllOrNone(ART_GROUP_CODES[code], artsMap)\n\treturn getAllOrNone([code], artsMap)\n}\n","// bootstrap edition\nexport function calcPosForDd(\n\tparentRect: DOMRect,\n\tddRect: DOMRect,\n\t{ isAbsolute = false, isCentered = false, shouldFitInScreen = false } = {},\n): { top: number; left: number; layoutPosition: { x: 'end' | 'start'; y: 'top' | 'bottom' } } {\n\tconst tWidth = window.innerWidth\n\tconst tHeight = window.innerHeight\n\tconst scrollTopFix = isAbsolute ? window.scrollY : 0\n\tconst centredFix = isCentered ? (parentRect.width - ddRect.width) / 2 : 0\n\tlet top = 0\n\tlet left = 0\n\tlet layoutPositionX: 'end' | 'start' = 'end'\n\tlet layoutPositionY: 'top' | 'bottom' = 'bottom'\n\tif (parentRect.top + parentRect.height + ddRect.height < tHeight) {\n\t\t// to bottom\n\t\ttop = parentRect.top + parentRect.height + scrollTopFix\n\t\tlayoutPositionY = 'bottom'\n\t} else {\n\t\t// to top\n\t\ttop = parentRect.top - ddRect.height + scrollTopFix\n\t\tlayoutPositionY = 'top'\n\t}\n\tif (parentRect.left + ddRect.width + centredFix < tWidth) {\n\t\t// to right\n\t\tleft = parentRect.left + centredFix\n\t\tlayoutPositionX = 'end'\n\t} else {\n\t\t// to left\n\t\tleft = parentRect.left + parentRect.width - ddRect.width - centredFix\n\t\tlayoutPositionX = 'start'\n\t}\n\tif (shouldFitInScreen) {\n\t\tleft = Math.min(Math.max(0, left), tWidth - ddRect.width)\n\t\ttop = Math.max(top, 0)\n\t}\n\treturn { top, left, layoutPosition: { y: layoutPositionY, x: layoutPositionX } }\n}\n","// export type Character = {\n// \tcode: string,\n// \telement:\n// }\n\n// export function getCharactersWithElement = (characters, elementCode) = {\n// \treturn characters.filter(c=> c.element = elementCode)\n// }\n\nfunction unprefixTraveler(code: string) {\n\treturn code.startsWith('traveler-') ? 'traveler' : code\n}\n\nexport function getCharacterAvatarSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/avatars/${unprefixTraveler(code)}.png`\n}\n\nexport function getCharacterAvatarLargeSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/avatars/${unprefixTraveler(code)}.large.png`\n}\n\nexport function getCharacterPortraitSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/portraits/${unprefixTraveler(code)}.png`\n}\n\nexport function getCharacterSilhouetteSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/silhouettes/${unprefixTraveler(code)}.svg`\n}\n","export default __webpack_public_path__ + \"Icon_Bow.e7c82786.png\";","export default __webpack_public_path__ + \"Icon_Catalyst.871a7999.png\";","export default __webpack_public_path__ + \"Icon_Claymore.46946e88.png\";","export default __webpack_public_path__ + \"Icon_Polearm.73080ee4.png\";","import icon_Bow from '#src/media/Icon_Bow.png'\nimport icon_Catalyst from '#src/media/Icon_Catalyst.png'\nimport icon_Claymore from '#src/media/Icon_Claymore.png'\nimport icon_Polearm from '#src/media/Icon_Polearm.png'\nimport icon_Sword from '#src/media/Icon_Sword.png'\n\nimport type { GI_WeaponTypeCode } from '#lib/genshin'\n\nexport type GI_WeaponType = { readonly code: GI_WeaponTypeCode; imgSrc: string }\nexport const weaponTypes: GI_WeaponType[] = [\n\t{ code: 'sword' as const, imgSrc: icon_Sword },\n\t{ code: 'bow' as const, imgSrc: icon_Bow },\n\t{ code: 'catalyst' as const, imgSrc: icon_Catalyst },\n\t{ code: 'claymore' as const, imgSrc: icon_Claymore },\n\t{ code: 'polearm' as const, imgSrc: icon_Polearm },\n]\n\nexport function getWeaponIconSrc(weaponCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/weapons/${weaponCode}.png`\n}\n\nexport function getWeaponIconLageSrc(weaponCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/weapons/${weaponCode}.large.png`\n}\n","export default __webpack_public_path__ + \"Icon_Sword.a2824108.png\";","import { useCallback, useLayoutEffect, useRef, useState } from 'preact/hooks'\n\nimport { calcPosForDd } from '#src/utils/calc-pos-for-dd'\nimport { GET_MODALS_EL } from '#src/utils/dom'\nimport { useWindowSize } from '#src/utils/hooks'\nimport { createPortal } from '#src/utils/preact-compat'\n\nexport function Tooltip({\n\tchildren,\n\tclasses = '',\n\ttargetEl,\n}: {\n\tchildren: JSX.Node\n\tclasses?: string\n\ttargetEl: HTMLElement | null | undefined\n}): JSX.Element {\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `tooltip fade show ${classes}`\n\tconst [arrowStyle, setArrowStyle] = useState<string>('')\n\tconst onResize = useCallback(() => {\n\t\tif (!wrapRef.current) return\n\t\tif (!targetEl) return\n\t\tconst wrapEl = wrapRef.current\n\t\tconst pos = calcPosForDd(targetEl.getBoundingClientRect(), wrapEl.getBoundingClientRect(), {\n\t\t\tisAbsolute: true,\n\t\t\tisCentered: true,\n\t\t})\n\t\t;('bs-tooltip-top bs-tooltip-bottom')\n\t\twrapEl.className = `${defClassName} bs-tooltip-${pos.layoutPosition.y}`\n\t\twrapEl.style.left = `${Math.max(0, pos.left)}px`\n\t\twrapEl.style.top = `${Math.max(0, pos.top)}px`\n\t\tsetArrowStyle(\n\t\t\t`position: absolute; transform: translate3d(${wrapEl.offsetWidth / 2 - 8}px, 0, 0); left: 0`,\n\t\t)\n\t}, [wrapRef, targetEl, defClassName, setArrowStyle])\n\tuseLayoutEffect(onResize)\n\tuseWindowSize()\n\t//todo обновлять позицию, когда загрузилась картинка\n\treturn createPortal(\n\t\t<div className={defClassName} ref={wrapRef}>\n\t\t\t<div className=\"tooltip-arrow\" style={arrowStyle}></div>\n\t\t\t<div className=\"tooltip-inner\">{children}</div>\n\t\t</div>,\n\t\tGET_MODALS_EL(),\n\t)\n}\n","import { BS_isBreakpointLessThen } from '#src/utils/bootstrap'\nimport { useWindowSize } from '#src/utils/hooks'\n\n//переключалка для мобильного и десктопного вида\nexport function MobileDesktopSwitch({\n\tchildrenDesktop,\n\tchildrenMobile,\n}: {\n\tchildrenDesktop: JSX.Element | null\n\tchildrenMobile: JSX.Element | null\n}): JSX.Element | null {\n\tconst windowSize = useWindowSize()\n\treturn BS_isBreakpointLessThen(windowSize.breakpoint, 'xl') ? childrenMobile : childrenDesktop\n}\n","import { useCallback, useMemo, useState } from 'preact/hooks'\n\nimport { arrShallowEqual } from '#lib/utils/collections'\nimport { A } from '#src/routes/router'\n\nexport type Tab = { code: string; title?: string | JSX.Element; href?: string }\n\nexport function tabTitleFromName(obj: { name: string }): string {\n\treturn obj.name\n}\n\nexport function Tabs<T extends Tab>({\n\ttabs,\n\ttitleFunc,\n\tselectedTab,\n\tonTabSelect,\n\tclasses = '',\n}: {\n\ttabs: T[]\n\ttitleFunc?: (tab: T) => string | JSX.Element\n\tselectedTab: T\n\tonTabSelect?: (tab: T) => unknown\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ul className={`nav nav-tabs ${classes}`}>\n\t\t\t{tabs.map(t => (\n\t\t\t\t<li className=\"nav-item\" key={t.code}>\n\t\t\t\t\t<A\n\t\t\t\t\t\tclassName={`nav-link c-pointer ${t.code === selectedTab.code ? 'active' : ''}`}\n\t\t\t\t\t\thref={t.href}\n\t\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\t\tif (t.href) return\n\t\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\t\tonTabSelect && onTabSelect(t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t\t</A>\n\t\t\t\t</li>\n\t\t\t))}\n\t\t</ul>\n\t)\n}\n\nexport function BtnTabGroup<T extends Tab>({\n\ttabs,\n\ttitleFunc,\n\tselectedTab,\n\tonTabSelect,\n\tclasses = '',\n\tvisibleTabsLength,\n}: {\n\ttabs: T[]\n\ttitleFunc?: (tab: T) => string | JSX.Element\n\tselectedTab: T\n\tonTabSelect: (tab: T) => void\n\tclasses?: string\n\tvisibleTabsLength?: number\n}): JSX.Element {\n\tconst tabsGrouped: T[][] = []\n\tif (visibleTabsLength) {\n\t\ttabsGrouped[0] = tabs.slice(0, visibleTabsLength)\n\t\ttabsGrouped[1] = tabs.slice(visibleTabsLength, tabs.length - 1)\n\t} else {\n\t\ttabsGrouped[0] = tabs\n\t}\n\t// todo бордеррадиусы или другой дизайн\n\treturn (\n\t\t<div>\n\t\t\t<div class={`btn-group ${classes}`}>\n\t\t\t\t{tabsGrouped[0].map(t => (\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tdisabled={tabs.length === 1}\n\t\t\t\t\t\tclassName={`btn lh-sm ${\n\t\t\t\t\t\t\tt.code === selectedTab.code ? 'btn-primary' : 'btn-outline-primary'\n\t\t\t\t\t\t} `}\n\t\t\t\t\t\tkey={t.code}\n\t\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\t\tonTabSelect(t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t\t</button>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t\t{visibleTabsLength && tabsGrouped[1].length ? (\n\t\t\t\t<div class={`btn-group ${classes}`}>\n\t\t\t\t\t{tabsGrouped[1].map(t => (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tdisabled={tabs.length === 1}\n\t\t\t\t\t\t\tclassName={`btn lh-sm ${\n\t\t\t\t\t\t\t\tt.code === selectedTab.code ? 'btn-primary' : 'btn-outline-primary'\n\t\t\t\t\t\t\t} `}\n\t\t\t\t\t\t\tkey={t.code}\n\t\t\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\t\t\tonTabSelect(t)\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t) : null}\n\t\t</div>\n\t)\n}\nexport function LightBtnTabGroup<T extends Tab>({\n\ttabs,\n\ttitleFunc,\n\tselectedTab,\n\tonTabSelect,\n\tclasses = '',\n}: {\n\ttabs: T[]\n\ttitleFunc?: (tab: T) => string | JSX.Element\n\tselectedTab: T\n\tonTabSelect?: (tab: T) => void\n\tclasses?: string\n}): JSX.Element {\n\tconst btnClass = 'flex-sm-fill small lh-sm text-sm-center nav-link c-pointer'\n\tconst btnClassActive = btnClass + ' active'\n\tconst btnClassDisabled = btnClass + ' disabled'\n\treturn (\n\t\t<nav className={`nav nav-pills flex-column flex-sm-row ${classes}`}>\n\t\t\t{tabs.map(t => (\n\t\t\t\t<A\n\t\t\t\t\tclassName={\n\t\t\t\t\t\ttabs.length === 1\n\t\t\t\t\t\t\t? btnClassDisabled\n\t\t\t\t\t\t\t: t.code === selectedTab.code\n\t\t\t\t\t\t\t? btnClassActive\n\t\t\t\t\t\t\t: btnClass\n\t\t\t\t\t}\n\t\t\t\t\tkey={t.code}\n\t\t\t\t\thref={t.href}\n\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\tif (t.href) return\n\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\tonTabSelect && onTabSelect(t)\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t</A>\n\t\t\t))}\n\t\t</nav>\n\t)\n}\n\n/**\n * а) сохраняет выделенную вкладку по коду (после смены вкладок, если выбранного ранее кода\n *    среди новых вкладок нет, возвращает первую вкладку).\n * б) если передан массив args, сохраняет выбранную вкладку для каждого уникального набора args\n *    (полезно, если эти вкладки находятся врутри другого переключателя,\n *    например вкладки ролей, а над ними - переключатель персонажей).\n */\nexport function useSelectable<T extends Tab>(tabs: T[], args?: unknown[]): [T, (tab: T) => unknown] {\n\tconst [tabCodes, setTabCodes] = useState<{ code: string; args: unknown[] }[]>([])\n\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst argsInner = useMemo(() => args ?? [], args)\n\n\tconst item = useMemo(() => tabCodes.find(x => arrShallowEqual(argsInner, x.args)), [argsInner, tabCodes])\n\n\tconst tab = useMemo(() => (item && tabs.find(x => x.code === item.code)) ?? tabs[0], [tabs, item])\n\n\tconst setTab = useCallback(\n\t\t(tab: T) => {\n\t\t\tif (item) {\n\t\t\t\tif (item.code !== tab.code) {\n\t\t\t\t\tsetTabCodes(tabCodes.filter(x => x !== item).concat({ ...item, code: tab.code }))\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetTabCodes(tabCodes.concat({ code: tab.code, args: argsInner }))\n\t\t\t}\n\t\t},\n\t\t[argsInner, item, tabCodes],\n\t)\n\treturn [tab, setTab]\n}\n","import { useCallback, useEffect, useLayoutEffect, useRef, useState } from 'preact/hooks'\n\nimport { calcPosForDd } from '#src/utils/calc-pos-for-dd'\nimport { GET_MODALS_EL } from '#src/utils/dom'\nimport { useClickAway, useWindowSize } from '#src/utils/hooks'\nimport { createPortal } from '#src/utils/preact-compat'\n\nexport const ItemDetailDdPortal = ({\n\tonClickAway,\n\tchildren,\n\tclasses = '',\n\ttargetEl,\n\tcontentKey = null,\n\tshouldScrollToTop,\n}: {\n\tonClickAway?(): void\n\tchildren: JSX.Nodes\n\tclasses?: string\n\ttargetEl: HTMLElement | null | undefined\n\tcontentKey?: string | null | undefined\n\tshouldScrollToTop?: boolean\n}): JSX.Element => {\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `popover item-detail-popover ${classes}`\n\tconst [arrowStyle, setArrowStyle] = useState('')\n\tconst onResize = useCallback(() => {\n\t\tif (!wrapRef.current) return\n\t\tif (!targetEl) return\n\t\tconst wrapEl = wrapRef.current\n\t\tconst pos = calcPosForDd(targetEl.getBoundingClientRect(), wrapEl.getBoundingClientRect(), {\n\t\t\tisAbsolute: true,\n\t\t\tisCentered: true,\n\t\t\tshouldFitInScreen: true,\n\t\t})\n\t\t;('bs-popover-top bs-popover-bottom')\n\t\twrapEl.className = `${defClassName} bs-popover-${pos.layoutPosition.y}`\n\t\twrapEl.style.left = `${pos.left}px`\n\t\twrapEl.style.top = `${pos.top}px`\n\t\tsetArrowStyle(\n\t\t\t`position: absolute; transform: translate3d(${wrapEl.offsetWidth / 2 - 8}px, 0, 0); left: 0`,\n\t\t)\n\t}, [wrapRef, targetEl, defClassName, setArrowStyle])\n\tuseLayoutEffect(onResize)\n\tuseEffect(() => {\n\t\tif (!shouldScrollToTop) return\n\t\tconst wrapEl = wrapRef.current\n\t\tif (!wrapEl) return\n\t\tconst elTop = wrapEl.getBoundingClientRect().top\n\t\tif (elTop < 0) scrollTo(0, scrollY + elTop)\n\t})\n\tuseWindowSize()\n\tuseClickAway(wrapRef, onClickAway)\n\t//todo обновлять позицию, когда загрузилась картинка\n\treturn createPortal(\n\t\t<div class={defClassName} ref={wrapRef}>\n\t\t\t{children}\n\t\t\t<div class=\"popover-arrow\" style={arrowStyle}></div>\n\t\t</div>,\n\t\tGET_MODALS_EL(),\n\t)\n}\nexport const ItemDetailDdMobilePortal = ({\n\tonClickAway,\n\tchildren,\n\tclasses = '',\n\tcontentKey = null,\n}: {\n\tonClickAway?(): void\n\tchildren: JSX.Nodes\n\tclasses?: string\n\tcontentKey?: string | null | undefined\n}): JSX.Element => {\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `fixed-bottom ${classes}`\n\n\tuseClickAway(wrapRef, onClickAway)\n\n\treturn createPortal(\n\t\t<div class={defClassName} ref={wrapRef}>\n\t\t\t{children}\n\t\t</div>,\n\t\tGET_MODALS_EL(),\n\t)\n}\n","export function getItemIconSrc(itemCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/items/${itemCode}.png`\n}\n\nexport function getItemIconLargeSrc(itemCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/items/${itemCode}.large.png`\n}\n","import { useCallback, useEffect, useState } from 'preact/hooks'\nimport { ItemAvatar } from './item-cards/item-avatars'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { GI_RarityCode } from '#src/../../lib/genshin'\n\nconst DEF_ANCESTRY_CODES = [\n\t'agnidus-agate-sliver',\n\t'agnidus-agate-fragment',\n\t'agnidus-agate-chunk',\n\t'agnidus-agate-gemstone',\n]\nexport function AlchemyCalculator({\n\tclasses = '',\n\tancestryCodes = DEF_ANCESTRY_CODES,\n}: {\n\tclasses?: string\n\tancestryCodes?: string[]\n}): JSX.Element {\n\tconst [values, setValues] = useState<number[]>([])\n\tconst onValueChange = useCallback(\n\t\te => {\n\t\t\tconst value = +e.target.value\n\t\t\tconst index = +e.target.dataset.index\n\t\t\tsetValues(values.map((v, i) => (v = Math.floor(3 ** (index - i) * value))))\n\t\t},\n\t\t[setValues, values],\n\t)\n\tuseEffect(() => {\n\t\tsetValues(ancestryCodes.map((c, i) => 3 ** (ancestryCodes.length - 1 - i)))\n\t}, [ancestryCodes])\n\tconst startNotRoundClass = 'not-rounded-start'\n\tconst endNotRoundClass = 'not-rounded-end'\n\tconst endRoundClass = 'rounded-end'\n\treturn (\n\t\t<div className={`alchemy-calculator overflow-hidden ${classes}`}>\n\t\t\t<div className=\"input-group\">\n\t\t\t\t{ancestryCodes.map((c, i) => {\n\t\t\t\t\tconst isFirst = i === 0\n\t\t\t\t\tconst isLast = i === ancestryCodes.length - 1\n\t\t\t\t\tconst rarity = 5 - (ancestryCodes.length - 1 - i)\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{i !== 0 ? (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={`input-group-text text-dark border-light border-top border-bottom bg-${\n\t\t\t\t\t\t\t\t\t\trarity - 1\n\t\t\t\t\t\t\t\t\t} ps-1`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{'='}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t\tclassName={`form-control bg-dark text-light text-end border-secondary pe-1 ${\n\t\t\t\t\t\t\t\t\t!isFirst ? startNotRoundClass : ''\n\t\t\t\t\t\t\t\t} ${endNotRoundClass}`}\n\t\t\t\t\t\t\t\tonInput={onValueChange}\n\t\t\t\t\t\t\t\tvalue={values[i]}\n\t\t\t\t\t\t\t\tdata-index={i}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tsrc={getItemIconSrc(c)}\n\t\t\t\t\t\t\t\trarity={rarity as GI_RarityCode}\n\t\t\t\t\t\t\t\tclasses={`small-avatar with-padding input-group-avatar ${startNotRoundClass} ${\n\t\t\t\t\t\t\t\t\t!isLast ? endNotRoundClass : endRoundClass + ' border-end'\n\t\t\t\t\t\t\t\t} border-top border-bottom border-light`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { useCallback } from 'preact/hooks'\n\nexport type Option = { title: string | JSX.Element; code: string }\n\nexport function SimpleSelect({\n\toptions,\n\tselectedOption,\n\tonOptionSelect,\n\tclasses = '',\n\tsize = 1,\n}: {\n\toptions: Option[]\n\tselectedOption: Option | null\n\tonOptionSelect(Option): unknown\n\tclasses?: string\n\tsize?: number\n}): JSX.Element {\n\tconst handleChange = useCallback(\n\t\te => {\n\t\t\tonOptionSelect(options.find(o => o.code === e.target.value))\n\t\t},\n\t\t[options, onOptionSelect],\n\t)\n\treturn (\n\t\t<select\n\t\t\tclassName={`form-select border-secondary bg-dark text-light c-pointer ${classes}`}\n\t\t\tonChange={handleChange}\n\t\t\tsize={size}\n\t\t>\n\t\t\t<option value=\"\" disabled selected hidden>\n\t\t\t\tSelect…\n\t\t\t</option>\n\t\t\t{options.map(o => (\n\t\t\t\t<option\n\t\t\t\t\tclassName=\"c-pointer\"\n\t\t\t\t\tkey={o.code}\n\t\t\t\t\tvalue={o.code}\n\t\t\t\t\tselected={!!(selectedOption && o.code === selectedOption.code)}\n\t\t\t\t>\n\t\t\t\t\t{o.title}\n\t\t\t\t</option>\n\t\t\t))}\n\t\t</select>\n\t)\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { GI_DomainTypeCode, MapCode, MapLocation } from '#lib/genshin'\nimport { ArtifactRegularInfo, ItemShortInfo, WeaponRegularInfo } from '#lib/parsing/combine'\nimport { arrGetAfter } from '#lib/utils/collections'\nimport { SimpleSelect } from '#src/components/select'\nimport { CentredLabel, Spinner } from '#src/components/placeholders'\nimport { BtnTabGroup, useSelectable } from '#src/components/tabs'\nimport { MapMarkerRaw } from '#src/components/teyvat-map'\nimport {\n\tI18N_ERROR,\n\tI18N_MAP_CODES_NAME,\n\tI18N_NOTHING_TO_SHOW,\n\tI18N_PINCH_TO_ZOOM,\n\tI18N_SCROLL_TO_ZOOM,\n\tI18N_SOURCE,\n} from '#src/i18n/i18n'\nimport { ToggleWeaponPrimaryMaterialFav } from '#src/modules/builds/common'\nimport { getDomainIconSrc } from '#src/utils/domains'\nimport { getEnemyIconSrc } from '#src/utils/enemies'\nimport { isLoaded, useFetch } from '#src/utils/hooks'\nimport { ELLIPSIS, LEFT_POINTING, RIGHT_POINTING } from '#src/utils/typography'\nimport { LabeledItemAvatar } from './item-avatars'\n\nconst LazyTeyvatMap = import('#src/components/teyvat-map')\n\nexport type CardMapMarkerGroup = {\n\tcode: string\n\ttitle: string\n\tmarkers: 'external' | MapMarkerRaw[]\n}\n\nconst dummyMarkerGroups: CardMapMarkerGroup[] = [\n\t{\n\t\tcode: '',\n\t\ttitle: ELLIPSIS,\n\t\tmarkers: [{ mapCode: 'teyvat', x: 0, y: 0, icon: '' }],\n\t},\n]\nexport function addMarkerGroupsByDomains(\n\tmarkerGroups: CardMapMarkerGroup[],\n\tdomains: { code: string; name: string; type: GI_DomainTypeCode; location: MapLocation }[],\n) {\n\tfor (const domain of domains) {\n\t\tconst loc = domain.location\n\t\tconst icon = getDomainIconSrc(domain.type)\n\t\tmarkerGroups.push({ code: domain.code, title: domain.name, markers: [{ ...loc, icon }] })\n\t}\n}\nexport function addMarkerGroupsByEnemies(\n\tmarkerGroups: CardMapMarkerGroup[],\n\tenemies: { code: string; name: string; locations: 'external' | MapLocation[] }[],\n) {\n\tfor (const enemy of enemies) {\n\t\tconst markers =\n\t\t\tenemy.locations === 'external'\n\t\t\t\t? 'external'\n\t\t\t\t: enemy.locations.map((loc): MapMarkerRaw => {\n\t\t\t\t\t\tconst icon = getEnemyIconSrc(enemy.code)\n\t\t\t\t\t\treturn { ...loc, icon, style: 'circle' }\n\t\t\t\t  })\n\t\tmarkerGroups.push({ code: enemy.code, title: enemy.name, markers })\n\t}\n}\nexport function CardMap({\n\titemData,\n\tmarkerGroups,\n\tisItemFavable,\n\tisFatHead,\n\tclasses = '',\n}: {\n\titemData?: {\n\t\timgSrc: string\n\t\titem: ItemShortInfo | ArtifactRegularInfo | WeaponRegularInfo\n\t}\n\tmarkerGroups: CardMapMarkerGroup[]\n\tisItemFavable?: boolean\n\tisFatHead?: boolean\n\tclasses?: string\n}): JSX.Element {\n\tconst TeyvatMap = useFetch(() => LazyTeyvatMap.then(x => x.TeyvatMap), [])\n\tconst markerGroupsLocal = useMemo(\n\t\t() => (markerGroups.length ? markerGroups : dummyMarkerGroups),\n\t\t[markerGroups],\n\t)\n\tconst isMapEmpty: boolean = useMemo(() => markerGroupsLocal === dummyMarkerGroups, [markerGroupsLocal])\n\tconst [selectedSource, setSelectedSource] = useSelectable(markerGroupsLocal)\n\n\tconst visibleMapCodeTabs = useMemo(() => {\n\t\tif (selectedSource.markers === 'external') return []\n\t\tconst mapCodes = new Set<MapCode>()\n\t\tfor (const marker of selectedSource.markers) mapCodes.add(marker.mapCode)\n\t\treturn Array.from(mapCodes, code => ({ code }))\n\t}, [selectedSource])\n\n\tconst [selectedMapCodeTab, setMapCodeTab] = useSelectable(visibleMapCodeTabs)\n\tconst selectedMapCode = selectedMapCodeTab.code\n\n\tconst setSourceAndFixMapCode = (selectedSource: CardMapMarkerGroup) => {\n\t\tif (\n\t\t\tselectedSource.markers !== 'external' &&\n\t\t\t!selectedSource.markers.find(m => m.mapCode === selectedMapCode)\n\t\t)\n\t\t\tsetMapCodeTab({ code: selectedSource.markers[0].mapCode })\n\t\tsetSelectedSource(selectedSource)\n\t}\n\tconst goToPrevGroup = () => {\n\t\tsetSourceAndFixMapCode(arrGetAfter(markerGroupsLocal, selectedSource, -1))\n\t}\n\tconst goToNextGroup = () => {\n\t\tsetSourceAndFixMapCode(arrGetAfter(markerGroupsLocal, selectedSource))\n\t}\n\n\tlet sourceSelectEl\n\tif (!markerGroupsLocal.length) {\n\t\tsourceSelectEl = null\n\t} else if (markerGroupsLocal.length === 1) {\n\t\tsourceSelectEl = <span className=\"align-self-center lh-1 small\">{markerGroupsLocal[0].title}</span>\n\t} else if (markerGroupsLocal.length < 3) {\n\t\tsourceSelectEl = (\n\t\t\t<BtnTabGroup\n\t\t\t\ttabs={markerGroupsLocal}\n\t\t\t\tselectedTab={selectedSource}\n\t\t\t\tonTabSelect={setSourceAndFixMapCode}\n\t\t\t\tclasses=\"w-100 btn-group-sm\"\n\t\t\t/>\n\t\t)\n\t} else {\n\t\tsourceSelectEl = (\n\t\t\t<div className=\"btn-group w-100\">\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"btn btn-secondary border-dark border-end-0 text-muted fs-4 lh-1\"\n\t\t\t\t\tonClick={goToPrevGroup}\n\t\t\t\t>\n\t\t\t\t\t{LEFT_POINTING}\n\t\t\t\t</button>\n\t\t\t\t<SimpleSelect\n\t\t\t\t\toptions={markerGroupsLocal}\n\t\t\t\t\tselectedOption={selectedSource}\n\t\t\t\t\tonOptionSelect={setSourceAndFixMapCode}\n\t\t\t\t\tclasses=\"w-100 rounded-0\"\n\t\t\t\t/>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"btn btn-secondary border-dark border-start-0 text-muted fs-4 lh-1\"\n\t\t\t\t\tonClick={goToNextGroup}\n\t\t\t\t>\n\t\t\t\t\t{RIGHT_POINTING}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t)\n\t}\n\n\tconst isItemWeaponPrimaryMaterial = useMemo(\n\t\t() =>\n\t\t\titemData?.item &&\n\t\t\t'types' in itemData.item &&\n\t\t\t~itemData?.item.types?.indexOf('weapon-material-primary'),\n\t\t[itemData?.item],\n\t)\n\n\treturn (\n\t\t<div className={`map-wrap position-relative mb-3 ${classes}`}>\n\t\t\t{selectedSource.markers !== 'external' && isLoaded(TeyvatMap) ? (\n\t\t\t\t<TeyvatMap\n\t\t\t\t\tclasses=\"h-inherit\"\n\t\t\t\t\tpos=\"auto\"\n\t\t\t\t\tmapCode={selectedMapCode}\n\t\t\t\t\tmarkers={selectedSource.markers}\n\t\t\t\t/>\n\t\t\t) : TeyvatMap instanceof Error ? (\n\t\t\t\t<div className=\"text-muted position-absolute top-0 bottom-0 start-0 end-0 d-flex justify-content-center align-items-center\">\n\t\t\t\t\t{I18N_ERROR}\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t\t<div className=\"map-header position-absolute top-0 px-3 py-1 w-100\">\n\t\t\t\t<div className=\"map-header-bg position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-75\"></div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={`d-flex ${isFatHead ? 'flex-column' : 'flex-row'} justify-content-between`}\n\t\t\t\t\tstyle={{ opacity: '0.9999' }}\n\t\t\t\t>\n\t\t\t\t\t{itemData && (\n\t\t\t\t\t\t<div className={`me-2 flex-shrink-1 d-flex ${isFatHead ? '' : 'align-self-center'}`}>\n\t\t\t\t\t\t\t{isItemWeaponPrimaryMaterial && isItemFavable ? (\n\t\t\t\t\t\t\t\t<ToggleWeaponPrimaryMaterialFav\n\t\t\t\t\t\t\t\t\titemCode={itemData.item.code}\n\t\t\t\t\t\t\t\t\tclasses=\"align-self-center p-1 flex-fill fs-5\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t<LabeledItemAvatar\n\t\t\t\t\t\t\t\tisNoBg={true}\n\t\t\t\t\t\t\t\tclasses=\"small-avatar small\"\n\t\t\t\t\t\t\t\tavatarClasses=\"with-padding \"\n\t\t\t\t\t\t\t\timgSrc={itemData.imgSrc}\n\t\t\t\t\t\t\t\ttitle={itemData.item.name}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t{!isMapEmpty ? (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={`d-flex flex-fill ${\n\t\t\t\t\t\t\t\tisFatHead ? 'mt-1' : 'justify-content-end align-self-center'\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<label className=\"me-1 text-muted align-self-center small\">{I18N_SOURCE}:</label>\n\t\t\t\t\t\t\t{sourceSelectEl}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : null}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"map-tip position-absolute px-3 pt-1 lh-1 top-100 start-0 small text-muted opacity-75 user-select-none\">\n\t\t\t\t{!isMapEmpty &&\n\t\t\t\t\tvisibleMapCodeTabs.map(({ code }) => (\n\t\t\t\t\t\t<div className=\"d-inline me-2\" key={code} onClick={() => setMapCodeTab({ code })}>\n\t\t\t\t\t\t\t{visibleMapCodeTabs.length > 1 ? (\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclassName=\"lh-1 align-middle c-pointer me-1\"\n\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\tid={code}\n\t\t\t\t\t\t\t\t\tchecked={code === selectedMapCode}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\tclassName={`lh-1 align-middle text-capitalize ${\n\t\t\t\t\t\t\t\t\tvisibleMapCodeTabs.length > 1 ? 'c-pointer' : ''\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\tfor={code}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{I18N_MAP_CODES_NAME[code]}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclassName={`map-tip position-absolute \\\n\t\t\t\t px-3 pt-1 lh-1 \\\n\t\t\t\t bottom-0 end-0 small text-muted \\\n\t\t\t\t opacity-75 pe-none bg-dark opacity-75 \\\n\t\t\t\t rounded-start not-rounded-bottom \\\n\t\t\t\t ${isMapEmpty ? 'd-none' : ''}`}\n\t\t\t>\n\t\t\t\t<div class=\"d-none d-xl-block\">{I18N_SCROLL_TO_ZOOM}</div>\n\t\t\t\t<div class=\"d-xl-none\">{I18N_PINCH_TO_ZOOM}</div>\n\t\t\t</div>\n\t\t\t{isMapEmpty ? <CentredLabel label={I18N_NOTHING_TO_SHOW} /> : null}\n\t\t</div>\n\t)\n}\n","import { GI_DomainTypeCode } from '#lib/genshin'\n\nexport function getDomainIconSrc(domainType: GI_DomainTypeCode): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/domains/${domainType}.png`\n}\n","export function getEnemyIconSrc(enemyCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/enemies/${enemyCode}.png`\n}\n","import { guessCurrentRegion } from '#lib/genshin'\n\n//sv - storage versioned\nexport const SV_SELECTED_REGION_CODE = {\n\tkey: 'selected-region-code',\n\tversions: [() => guessCurrentRegion()] as const,\n}\n\nexport type SV_FavCodes = string[]\nconst favCodes = (key: string) => ({\n\tkey,\n\tversions: [() => [] as SV_FavCodes] as const,\n})\nexport const SV_FAV_CHAR_CODES = favCodes('favoriteCharacterCodes')\nexport const SV_FAV_TALENT_MATERIAL_CODES = favCodes('favoriteTalentMaterialCodes')\nexport const SV_FAV_WEAPON_PRIMARY_MATERIAL_CODES = favCodes('favoriteWeaponPrimaryMaterialCodes')\n\nexport type STORAGE_WEAPON_DATA = [weaponCode: string, weaponMaterialCode: string]\nexport const SV_FAV_WEAPON_DATAS = {\n\tkey: 'favoriteWeaponDatas',\n\tversions: [() => [] as STORAGE_WEAPON_DATA[]] as const,\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { ItemShortInfo } from '#lib/parsing/combine'\nimport { mappedArrPush } from '#lib/utils/collections'\nimport { I18N_ASC_MATERIALS, I18N_FOR_NOBODY, I18N_RECOMMENDED_FOR } from '#src/i18n/i18n'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { CharacterAvatar, ItemAvatar } from './item-avatars'\nimport { HEART } from '#src/utils/typography'\nimport { useVersionedStorage } from '#src/utils/hooks'\nimport { SV_FAV_CHAR_CODES } from '#src/utils/local-storage-keys'\n\nexport function RecommendedTo({\n\tcharCodes,\n\tisInline = false,\n\tisAvatarWithBorder = false,\n\tnavigateToCharacter = false,\n}: {\n\tcharCodes: (string | { count: number; code: string })[]\n\tisInline?: boolean\n\tnavigateToCharacter?: boolean\n\tisAvatarWithBorder?: boolean\n}): JSX.Element {\n\tconst [favCharCodes] = useVersionedStorage(SV_FAV_CHAR_CODES)\n\n\tconst charLists = useMemo(() => {\n\t\tconst groupsMap = new Map<number, string[]>()\n\t\tfor (const item of charCodes) {\n\t\t\tif (typeof item === 'string') {\n\t\t\t\tmappedArrPush(groupsMap, 0, item)\n\t\t\t} else {\n\t\t\t\tmappedArrPush(groupsMap, item.count, item.code)\n\t\t\t}\n\t\t}\n\t\tconst groups = Array.from(groupsMap.entries())\n\t\tgroups.sort(([countA], [countB]) => countB - countA)\n\t\tgroups.forEach(([, codes]) => codes.reverse()) //сначала новые персонажи (по умолчанию они в конце)\n\n\t\tif (groups.every(([, codes]) => codes.length === 0))\n\t\t\treturn <span class={`align-middle ${isInline ? 'py-1' : ''}`}>{I18N_FOR_NOBODY}</span>\n\n\t\treturn groups.map(([count, codes]) => (\n\t\t\t<div>\n\t\t\t\t{count !== 0 && 'x' + count + ': '}\n\t\t\t\t{codes.map(c => (\n\t\t\t\t\t<CharacterAvatar\n\t\t\t\t\t\tkey={c}\n\t\t\t\t\t\tcode={c}\n\t\t\t\t\t\trarity={isAvatarWithBorder ? 4 : undefined}\n\t\t\t\t\t\tisNoBg={!navigateToCharacter}\n\t\t\t\t\t\tclasses={`small-avatar mb-2 me-2`}\n\t\t\t\t\t\thref={navigateToCharacter ? '/builds/' + c : undefined}\n\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t~favCharCodes.indexOf(c) ? <span className=\"text-danger\">{HEART}</span> : null\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t))\n\t}, [charCodes, isInline, navigateToCharacter, isAvatarWithBorder, favCharCodes])\n\treturn (\n\t\t<div class={`d-flex ${isInline ? 'flex-row' : 'flex-column'}`}>\n\t\t\t<label class=\"opacity-75 pe-2 align-middle py-1\">\n\t\t\t\t{I18N_RECOMMENDED_FOR}\n\t\t\t\t{isInline ? ':' : ''}\n\t\t\t</label>\n\t\t\t{charLists}\n\t\t</div>\n\t)\n}\n\nexport function AscMaterials({\n\tmaterials,\n\tselectedMat,\n\tonMatSelect,\n}: {\n\tmaterials: ItemShortInfo[]\n\tselectedMat?: ItemShortInfo\n\tonMatSelect: (ItemShortInfo) => unknown\n}): JSX.Element {\n\tconst matList = useMemo(\n\t\t() =>\n\t\t\tmaterials.length\n\t\t\t\t? materials.map(m => (\n\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\tkey={m.code}\n\t\t\t\t\t\t\trarity={2}\n\t\t\t\t\t\t\tclasses={`mb-2 mx-1 small-avatar with-padding ${\n\t\t\t\t\t\t\t\tselectedMat?.code !== m.code && 'opacity-50'\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\t\tonClick={() => onMatSelect(m)}\n\t\t\t\t\t\t/>\n\t\t\t\t  ))\n\t\t\t\t: null,\n\t\t[materials, selectedMat, onMatSelect],\n\t)\n\treturn (\n\t\t<>\n\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_ASC_MATERIALS}:</label>\n\t\t\t{matList}\n\t\t</>\n\t)\n}\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { ArtifactRegularInfo, ItemShortInfo, WeaponRegularInfo } from '#lib/parsing/combine'\nimport { getAllRelated, RelDomainsShort, RelEnemiesShort, RelItemsShort } from '#src/api/utils'\nimport { BlockHeader } from '#src/components/block-header'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { BtnTabGroup, tabTitleFromName, useSelectable } from '#src/components/tabs'\nimport {\n\tItemDetailDdMobilePortal,\n\tItemDetailDdPortal,\n} from '#src/containers/item-cards/item-detail-dd-portal'\nimport {\n\tI18N_ALCHEMY_CALC,\n\tI18N_BASE_ATTACK,\n\tI18N_OBTAINED_DURING_STORYLINE,\n\tI18N_PIECE_BONUS,\n\tI18N_PIECES_BONUS,\n\tI18N_SECONDARY_STAT,\n\tI18N_STAT_NAME,\n\tI18N_WEAPON_OBTAIN_SOURCE_NAME,\n\tI18N_WEAPON_TYPE_NAME,\n} from '#src/i18n/i18n'\nimport {\n\tnotesToJSX,\n\tToggleTalentMaterialFav,\n\tToggleWeaponPrimaryMaterialFav,\n} from '#src/modules/builds/common'\nimport { getArtifactIconLargeSrc, getArtifactIconSrc } from '#src/utils/artifacts'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { BULLET } from '#src/utils/typography'\nimport { getWeaponIconLageSrc } from '#src/utils/weapons'\nimport { AlchemyCalculator } from '../alchemy-calculator'\nimport { addMarkerGroupsByDomains, addMarkerGroupsByEnemies, CardMap, CardMapMarkerGroup } from './card-map'\nimport { RecommendedTo } from './common'\nimport { DdContext, ItemAvatar } from './item-avatars'\n\nimport type { MapMarkerRaw } from '#src/components/teyvat-map'\n//переключалка для мобильного и десктопного вида\nexport function CardDescMobileWrap({\n\tchildren,\n\ttargetEl,\n\tonClickAway,\n}: {\n\tonClickAway: () => void\n\ttargetEl: HTMLElement | null | undefined\n\tchildren: JSX.Element\n}): JSX.Element {\n\treturn (\n\t\t<MobileDesktopSwitch\n\t\t\tchildrenDesktop={\n\t\t\t\t<ItemDetailDdPortal onClickAway={onClickAway} targetEl={targetEl} shouldScrollToTop={true}>\n\t\t\t\t\t{children}\n\t\t\t\t</ItemDetailDdPortal>\n\t\t\t}\n\t\t\tchildrenMobile={\n\t\t\t\t<ItemDetailDdMobilePortal onClickAway={onClickAway}>{children}</ItemDetailDdMobilePortal>\n\t\t\t}\n\t\t/>\n\t)\n}\n// основной макет карточек\nfunction Card({\n\tclasses = '',\n\ttitleEl,\n\tselectorEl,\n\tbodyEl,\n\tmapEl,\n}: {\n\tclasses?: string\n\ttitleEl: JSX.Nodes | string\n\tselectorEl?: JSX.Nodes\n\tbodyEl?: JSX.Nodes\n\tmapEl?: JSX.Nodes\n}): JSX.Element {\n\treturn (\n\t\t<div className={`item-detail-popover-card card ${classes}`}>\n\t\t\t<h3 className=\"card-header fs-4 d-flex position-relative\">\n\t\t\t\t<span className=\"flex-fill\">{titleEl}</span>{' '}\n\t\t\t\t<DdContext.Consumer>\n\t\t\t\t\t{ddContext =>\n\t\t\t\t\t\tddContext.onClickAway && (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"btn-close btn-sm position-absolute end-0 top-50 translate-middle\"\n\t\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\t\tonClick={ddContext.onClickAway}\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t</DdContext.Consumer>\n\t\t\t</h3>\n\t\t\t{selectorEl && <div class=\"p-3\">{selectorEl}</div>}\n\t\t\t<div\n\t\t\t\tclassName={`card-body overflow-auto flex-shrink-1 hide-if-empty mb-3 pb-0 ${\n\t\t\t\t\tselectorEl ? 'pt-0' : ''\n\t\t\t\t}`}\n\t\t\t>\n\t\t\t\t{bodyEl}\n\t\t\t</div>\n\t\t\t{mapEl}\n\t\t</div>\n\t)\n}\n\nexport function ArtifactCard({\n\tclasses,\n\tartifacts,\n\trelated,\n\ttitle,\n}: {\n\tclasses?: string\n\tartifacts: ArtifactRegularInfo[]\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n\ttitle: string\n}): JSX.Element {\n\tconst [selectedArt, setSelectedArt] = useSelectable(artifacts)\n\n\tconst dataForMap = useMemo(() => {\n\t\tconst srcs = selectedArt.obtainSources\n\t\tconst markerGroups = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: selectedArt,\n\t\t\t\timgSrc: getArtifactIconSrc(selectedArt.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [selectedArt, related])\n\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={title}\n\t\t\tclasses={classes}\n\t\t\tselectorEl={\n\t\t\t\tartifacts.length > 1 ? (\n\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\ttabs={artifacts}\n\t\t\t\t\t\ttitleFunc={tabTitleFromName}\n\t\t\t\t\t\tselectedTab={selectedArt}\n\t\t\t\t\t\tonTabSelect={setSelectedArt}\n\t\t\t\t\t\tclasses=\"w-100 btn-group-sm\"\n\t\t\t\t\t\tvisibleTabsLength={3}\n\t\t\t\t\t/>\n\t\t\t\t) : null\n\t\t\t}\n\t\t\tbodyEl={\n\t\t\t\t<div className=\"\">\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\trarity={selectedArt.rarity}\n\t\t\t\t\t\tclasses=\"float-end me-2 large-avatar\"\n\t\t\t\t\t\tsrc={getArtifactIconLargeSrc(selectedArt.code)}\n\t\t\t\t\t/>\n\t\t\t\t\t{selectedArt.sets[1] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECE_BONUS(1)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[1])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{selectedArt.sets[2] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(2)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[2])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{selectedArt.sets[4] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(4)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[4])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{<RecommendedTo charCodes={selectedArt.recommendedTo} />}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <CardMap {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n\nexport function WeaponCard({\n\tclasses,\n\tweapon,\n\trelated,\n}: {\n\tonCloseClick?: () => void\n\tclasses?: string\n\tweapon: WeaponRegularInfo\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n}): JSX.Element {\n\tconst materials = getAllRelated(related.items, weapon.materialCodes)\n\tconst [materialOnMap, setMaterialOnMap] = useState(materials[0])\n\tconst dataForMap = useMemo(() => {\n\t\tconst srcs = materialOnMap.obtainSources\n\t\tconst markerGroups = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: materialOnMap,\n\t\t\t\timgSrc: getItemIconSrc(materialOnMap.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [materialOnMap, related])\n\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={\n\t\t\t\tweapon.name\n\t\t\t\t// <>\n\t\t\t\t// \t{weapon.name}{' '}\n\t\t\t\t// \t{ascMaterial && (\n\t\t\t\t// \t\t<ToggleWeaponFav\n\t\t\t\t// \t\t\tweaponCode={weapon.code}\n\t\t\t\t// \t\t\tweapMatCode={ascMaterial.code}\n\t\t\t\t// \t\t\tclasses=\"d-inline align-middle p-1\"\n\t\t\t\t// \t\t/>\n\t\t\t\t// \t)}\n\t\t\t\t// </>\n\t\t\t}\n\t\t\tclasses={classes}\n\t\t\tbodyEl={\n\t\t\t\t<div className=\"\">\n\t\t\t\t\t<div className=\"float-end\">\n\t\t\t\t\t\t<div className=\"d-flex w-100 justify-content-around\">\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\t\tclasses=\"mb-2 large-avatar\"\n\t\t\t\t\t\t\t\tsrc={getWeaponIconLageSrc(weapon.code)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"d-flex justify-content-between w-100\">\n\t\t\t\t\t\t\t{materials.map(m => (\n\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\tkey={m.code}\n\t\t\t\t\t\t\t\t\trarity={2}\n\t\t\t\t\t\t\t\t\tclasses={`mb-2 mx-1 small-avatar with-padding ${\n\t\t\t\t\t\t\t\t\t\tmaterialOnMap.code !== m.code && 'opacity-50'\n\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\t\t\t\tonClick={() => setMaterialOnMap(m)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden\">\n\t\t\t\t\t\t<BlockHeader classes=\"d-inline-block me-1\">\n\t\t\t\t\t\t\t{I18N_WEAPON_TYPE_NAME(weapon.typeCode)}\n\t\t\t\t\t\t</BlockHeader>\n\t\t\t\t\t\t<span className=\"mb-2 text-muted\">\n\t\t\t\t\t\t\t{BULLET} {weapon.obtainSources.map(I18N_WEAPON_OBTAIN_SOURCE_NAME).join(', ')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t\t<div className=\"me-2\">\n\t\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_BASE_ATTACK}</div>\n\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t{weapon.atk.base} / {weapon.atk.max}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{weapon.subStat && (\n\t\t\t\t\t\t\t<div className=\"ms-1\">\n\t\t\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_STAT_NAME(weapon.subStat.code)}</div>\n\t\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t\t{weapon.subStat.base} / {weapon.subStat.max}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t<span className=\"opacity-75\">{I18N_SECONDARY_STAT}</span>\n\t\t\t\t\t\t<div className=\"\">{notesToJSX(weapon.passiveStat)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<RecommendedTo charCodes={weapon.recommendedTo} />\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <CardMap isItemFavable={true} {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n\nexport function OtherItemCard({\n\tclasses,\n\titem,\n\trelated,\n}: {\n\tonCloseClick?: () => void\n\tclasses?: string\n\titem: ItemShortInfo\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n}): JSX.Element {\n\tconst materials = getAllRelated(related.items, [item.code])\n\tconst materialOnMap = materials[0]\n\tconst dataForMap = useMemo(() => {\n\t\tconst markerGroups: CardMapMarkerGroup[] = []\n\t\tconst srcs = materialOnMap.obtainSources\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\t\tif (materialOnMap.locations.length > 0) {\n\t\t\tconst icon = getItemIconSrc(materialOnMap.code)\n\t\t\tconst markers =\n\t\t\t\tmaterialOnMap.locations === 'external'\n\t\t\t\t\t? 'external'\n\t\t\t\t\t: materialOnMap.locations.map((loc): MapMarkerRaw => ({ ...loc, icon, style: 'outline' }))\n\t\t\tmarkerGroups.push({ code: materialOnMap.code, title: materialOnMap.name, markers })\n\t\t}\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: materialOnMap,\n\t\t\t\timgSrc: getItemIconSrc(materialOnMap.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [materialOnMap, related])\n\n\tconst isItemCharTalentMaterial = useMemo(() => ~item.types.indexOf('character-material-talent'), [item])\n\tconst isItemWeaponPrimaryMaterial = useMemo(() => ~item.types.indexOf('weapon-material-primary'), [item])\n\tconst codesForCalc = useMemo(() => {\n\t\treturn [...item.ancestryCodes.reverse(), item.code]\n\t}, [item])\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={\n\t\t\t\t<>\n\t\t\t\t\t{item.name}{' '}\n\t\t\t\t\t{isItemCharTalentMaterial ? (\n\t\t\t\t\t\t<ToggleTalentMaterialFav itemCode={item.code} classes=\"d-inline align-middle p-1\" />\n\t\t\t\t\t) : null}\n\t\t\t\t\t{isItemWeaponPrimaryMaterial ? (\n\t\t\t\t\t\t<ToggleWeaponPrimaryMaterialFav\n\t\t\t\t\t\t\titemCode={item.code}\n\t\t\t\t\t\t\tclasses=\"d-inline align-middle p-1\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : null}\n\t\t\t\t</>\n\t\t\t}\n\t\t\tclasses={classes}\n\t\t\tbodyEl={\n\t\t\t\titem.code === 'brilliant-diamond-gemstone' ? (\n\t\t\t\t\tI18N_OBTAINED_DURING_STORYLINE\n\t\t\t\t) : item.ancestryCodes.length > 0 ? (\n\t\t\t\t\t<div className=\"\">\n\t\t\t\t\t\t{/* <ItemAvatar rarity={3} classes=\"large-avatar float-end\" src={getItemIconSrc(item.code)} /> */}\n\t\t\t\t\t\t{/* <BlockHeader>Описание</BlockHeader>\n\t\t\t\t<div className=\"mb-3\">{notesToJSX()}</div> */}\n\t\t\t\t\t\t<BlockHeader>{I18N_ALCHEMY_CALC}</BlockHeader>\n\t\t\t\t\t\t<AlchemyCalculator ancestryCodes={codesForCalc} />\n\t\t\t\t\t</div>\n\t\t\t\t) : null\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <CardMap {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n","import { useCallback, useMemo } from 'preact/hooks'\n\nimport { CharacterFullInfoWithRelated } from '#lib/parsing/combine'\nimport { CompactTextParagraphs, TextNode } from '#lib/parsing/helperteam/text'\nimport { ArtifactRef, ArtifactRefNode, CharacterBuildInfoRole } from '#lib/parsing/helperteam/types'\nimport { mustBeDefined, staticNever } from '#lib/utils/values'\nimport { ART_GROUP_CODES } from '#src/api/generated'\nimport { MapAllByCode } from '#src/api/utils'\nimport { Tooltip } from '#src/components/tooltip'\nimport { ArtifactCard } from '#src/containers/item-cards/dd-cards'\nimport { ItemLabelWithDd, LabeledItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { logError } from '#src/errors'\nimport { I18N_ART_GROUP_NAME, I18N_CONJUCTIONS, I18N_FAV_TIPS, I18N_STAT_NAME } from '#src/i18n/i18n'\nimport { getAllArtifacts, getArtifactIconSrc } from '#src/utils/artifacts'\nimport { Migration, useHover, useVersionedStorage } from '#src/utils/hooks'\nimport {\n\tSV_FAV_CHAR_CODES,\n\tSV_FAV_TALENT_MATERIAL_CODES,\n\tSV_FAV_WEAPON_DATAS,\n\tSV_FAV_WEAPON_PRIMARY_MATERIAL_CODES,\n\tSV_FavCodes,\n} from '#src/utils/local-storage-keys'\nimport { HEART, HEART_EMPTY, STAR } from '#src/utils/typography'\n\nexport const DUMMY_ROLE: { code: string; name: string } & Partial<CharacterBuildInfoRole<'monolang'>> = {\n\tname: '…',\n\tcode: '',\n}\nexport const DUMMY_ROLES = [DUMMY_ROLE]\n\nexport type BuildRoleOrDummy = CharacterBuildInfoRole<'monolang'> | typeof DUMMY_ROLE\n\nexport function makeRoleTitle(r: BuildRoleOrDummy) {\n\treturn (\n\t\t<span key={r.code}>\n\t\t\t{r.isRecommended && (\n\t\t\t\t<span className=\"fs-4 lh-1 opacity-75 text-warning align-bottom\">{STAR}</span>\n\t\t\t)}\n\t\t\t{r.name}\n\t\t</span>\n\t)\n}\nexport const CIRCLET_GOBLET_SANDS = ['sands', 'goblet', 'circlet'] as const\nexport function getRoleData(build: CharacterFullInfoWithRelated, selectedCode: string) {\n\treturn mustBeDefined(build.character.roles.find(x => x.code === selectedCode))\n}\nexport function genArtMainStatDetail(\n\trole: CharacterBuildInfoRole<'monolang'>,\n\titemCode: 'circlet' | 'goblet' | 'sands',\n\tisShort?: boolean,\n) {\n\treturn (\n\t\t<span className=\"\">\n\t\t\t{genSimpleList(role.mainStats[itemCode].codes.map(I18N_STAT_NAME))}{' '}\n\t\t\t{!isShort && genNotes(role.mainStats[itemCode])}\n\t\t\t{!isShort && genSeeCharNotes(role.mainStats[itemCode])}\n\t\t</span>\n\t)\n}\nexport function genSimpleList(arr: string[]) {\n\treturn arr.join(', ')\n}\nexport function notesWrap(str) {\n\treturn <span className=\"text-muted small\">{str}</span>\n}\nexport function genNotes(item: { notes: CompactTextParagraphs | null }) {\n\treturn item.notes === null ? '' : notesWrap(notesToJSX(item.notes))\n}\nexport function genSeeCharNotes(item: { seeCharNotes: boolean }) {\n\treturn '' //TODO\n\treturn item.seeCharNotes ? notesWrap(' (see notes)') : ''\n}\nexport function notesToJSX(tips: CompactTextParagraphs | null): JSX.Nodes {\n\tfunction processString(str: string) {\n\t\treturn str\n\t\t\t.split('\\n')\n\t\t\t.map((sub, i, arr) => [sub, i < arr.length - 1 ? <br /> : ''])\n\t\t\t.flat()\n\t\t\t.filter(a => a)\n\t}\n\tfunction processObj(tip: TextNode) {\n\t\tif (typeof tip === 'string') return processString(tip)\n\t\tif ('p' in tip) return <p>{notesToJSX(tip.p)}</p>\n\t\tif ('b' in tip) return <b class=\"opacity-75 text-normal\">{notesToJSX(tip.b)}</b>\n\t\tif ('i' in tip) return <i>{notesToJSX(tip.i)}</i>\n\t\tif ('s' in tip) return <s>{notesToJSX(tip.s)}</s>\n\t\tif ('a' in tip)\n\t\t\treturn (\n\t\t\t\t<a href={tip.href} target=\"_blank\">\n\t\t\t\t\t{notesToJSX(tip.a)}\n\t\t\t\t</a>\n\t\t\t)\n\t\tif ('weapon' in tip)\n\t\t\treturn (\n\t\t\t\t<ItemLabelWithDd type=\"weapon\" code={tip.code}>\n\t\t\t\t\t{notesToJSX(tip.weapon)}\n\t\t\t\t</ItemLabelWithDd>\n\t\t\t)\n\t\tif ('artifact' in tip)\n\t\t\treturn (\n\t\t\t\t<ItemLabelWithDd type=\"artifact\" code={tip.code}>\n\t\t\t\t\t{notesToJSX(tip.artifact)}\n\t\t\t\t</ItemLabelWithDd>\n\t\t\t)\n\t\tif ('item' in tip) return <>{notesToJSX(tip.item)}</>\n\t\tstaticNever(tip)\n\t\tlogError('unknown text node: ' + JSON.stringify(tip))\n\t\treturn <span>{JSON.stringify(tip)}</span>\n\t}\n\tif (!tips) return null\n\tif (Array.isArray(tips)) return tips.map(processObj).flat()\n\treturn processObj(tips)\n}\n\nexport function getCoverArtifactForSet(code, artsForDd) {\n\tlet coverArt\n\tif (code in ART_GROUP_CODES) {\n\t\tcoverArt = {\n\t\t\tname: I18N_ART_GROUP_NAME[code],\n\t\t\tcode: code,\n\t\t\trarity: 5,\n\t\t}\n\t} else {\n\t\tcoverArt = artsForDd[0]\n\t}\n\treturn coverArt\n}\nexport function genArtifactAdvice(\n\tset: ArtifactRef | ArtifactRefNode,\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>,\n\tisLast = true,\n) {\n\t// todo notes\n\tif ('code' in set) {\n\t\t//ArtifactRef\n\t\tconst artifactsForDd = getAllArtifacts(set.code, build.maps.artifacts)\n\t\tif (!artifactsForDd.length) return null\n\t\tconst coverArt = getCoverArtifactForSet(set.code, artifactsForDd)\n\t\treturn (\n\t\t\t<LabeledItemAvatar\n\t\t\t\timgSrc={getArtifactIconSrc(set.code)}\n\t\t\t\trarity={coverArt.rarity}\n\t\t\t\ttitle={coverArt.name}\n\t\t\t\tkey={set.code}\n\t\t\t\tavatarTopEndBadge={'x' + set.count}\n\t\t\t\tavatarClasses=\"with-padding\"\n\t\t\t\tclasses={`small ${isLast ? 'mb-1' : ''}`}\n\t\t\t\tddComponent={\n\t\t\t\t\t<ArtifactCard artifacts={artifactsForDd} related={build.maps} title={coverArt.name} />\n\t\t\t\t}\n\t\t\t/>\n\t\t)\n\t} else {\n\t\t//ArtifactRefNode\n\t\treturn (\n\t\t\t<ItemsListGroupWrap>\n\t\t\t\t{set.arts.map((art, i) => {\n\t\t\t\t\tconst isLastInList = i >= set.arts.length - 1\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{genArtifactAdvice(art, build, isLastInList)}\n\t\t\t\t\t\t\t{!isLastInList && <ItemsJoinerWrap>{I18N_CONJUCTIONS[set.op]}</ItemsJoinerWrap>}\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</ItemsListGroupWrap>\n\t\t)\n\t}\n}\nexport function ItemsJoinerWrap({ children }): JSX.Element {\n\treturn <div className=\"text-start text-muted small px-5 my-n1\">{children}</div>\n}\nexport function ItemsListGroupWrap({\n\tchildren,\n}: {\n\tchildren: JSX.Node | (JSX.Element | null)[]\n}): JSX.Element {\n\treturn <div className=\"border-2 rounded border-secondary border-start ps-2\">{children}</div>\n}\nexport const MAX_SMTHS_TO_STORE = 5\nexport function removeOldSmthsFromList<T>(codes: T[]): T[] {\n\treturn codes.slice(0, MAX_SMTHS_TO_STORE)\n}\n\nfunction ToggleSmthFav<\n\tTStorageKey extends {\n\t\tkey: string\n\t\tversions: readonly [...Migration<unknown, unknown>[], Migration<unknown, SV_FavCodes>]\n\t},\n>({\n\tsmthCode,\n\tclasses,\n\tstorageKey,\n\ttipFav,\n\ttipNotFav,\n}: {\n\tsmthCode: string\n\tclasses?: string\n\tstorageKey: TStorageKey\n\ttipFav: string\n\ttipNotFav: string\n}): JSX.Element {\n\tconst [favSmthCodes, setFavSmthCodes] = useVersionedStorage(storageKey)\n\tconst [elRef, isHovered] = useHover<HTMLDivElement>()\n\tconst isFav = ~favSmthCodes.indexOf(smthCode)\n\tconst toggleFav = useCallback(() => {\n\t\tsetFavSmthCodes(\n\t\t\tremoveOldSmthsFromList(\n\t\t\t\tisFav ? favSmthCodes.filter(c => c !== smthCode) : [smthCode, ...favSmthCodes],\n\t\t\t),\n\t\t)\n\t}, [smthCode, setFavSmthCodes, favSmthCodes, isFav])\n\treturn (\n\t\t<div\n\t\t\trole=\"button\"\n\t\t\tclassName={`user-select-none lh-1 ${isFav ? 'text-danger' : 'text-danger opacity-50'} ${classes}`}\n\t\t\tonClick={toggleFav}\n\t\t\tref={elRef}\n\t\t>\n\t\t\t{isFav ? HEART : HEART_EMPTY}\n\t\t\t{elRef.current && isHovered ? (\n\t\t\t\t<Tooltip targetEl={elRef.current}>{isFav ? tipFav : tipNotFav}</Tooltip>\n\t\t\t) : null}\n\t\t</div>\n\t)\n}\n\nexport function ToggleCharFav({\n\tcharacterCode,\n\tclasses,\n}: {\n\tcharacterCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={characterCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SV_FAV_CHAR_CODES}\n\t\t\ttipFav={I18N_FAV_TIPS.remove.character}\n\t\t\ttipNotFav={I18N_FAV_TIPS.add.character}\n\t\t/>\n\t)\n}\nexport function ToggleWeaponPrimaryMaterialFav({\n\titemCode,\n\tclasses,\n}: {\n\titemCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={itemCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SV_FAV_WEAPON_PRIMARY_MATERIAL_CODES}\n\t\t\ttipFav={I18N_FAV_TIPS.remove.material}\n\t\t\ttipNotFav={I18N_FAV_TIPS.add.material}\n\t\t/>\n\t)\n}\nexport function ToggleTalentMaterialFav({\n\titemCode,\n\tclasses,\n}: {\n\titemCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={itemCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SV_FAV_TALENT_MATERIAL_CODES}\n\t\t\ttipFav={I18N_FAV_TIPS.remove.material}\n\t\t\ttipNotFav={I18N_FAV_TIPS.add.material}\n\t\t/>\n\t)\n}\n\n//not used\nexport function ToggleWeaponFav({\n\tweaponCode,\n\tweapMatCode,\n\tclasses,\n}: {\n\tweaponCode: string\n\tweapMatCode: string\n\tclasses?: string\n}): JSX.Element {\n\tconst [favWeaponDatas, setWeaponDatas] = useVersionedStorage(SV_FAV_WEAPON_DATAS)\n\tconst favWeaponCodes = useMemo(() => favWeaponDatas.map(wd => wd[0]), [favWeaponDatas])\n\tconst [elRef, isHovered] = useHover<HTMLDivElement>()\n\tconst isFav = ~favWeaponCodes.indexOf(weaponCode)\n\tconst toggleFav = useCallback(() => {\n\t\tsetWeaponDatas(\n\t\t\tremoveOldSmthsFromList(\n\t\t\t\tisFav\n\t\t\t\t\t? favWeaponDatas.filter(d => d[0] !== weaponCode)\n\t\t\t\t\t: [[weaponCode, weapMatCode], ...favWeaponDatas],\n\t\t\t),\n\t\t)\n\t}, [weaponCode, weapMatCode, setWeaponDatas, favWeaponDatas, isFav])\n\treturn (\n\t\t<div\n\t\t\trole=\"button\"\n\t\t\tclassName={`user-select-none lh-1 ${isFav ? 'text-danger' : 'text-danger opacity-50'} ${classes}`}\n\t\t\tonClick={toggleFav}\n\t\t\tref={elRef}\n\t\t>\n\t\t\t{isFav ? HEART : HEART_EMPTY}\n\t\t\t{elRef.current && isHovered ? (\n\t\t\t\t<Tooltip targetEl={elRef.current}>\n\t\t\t\t\t{isFav ? I18N_FAV_TIPS.remove.weapon : I18N_FAV_TIPS.add.weapon}\n\t\t\t\t</Tooltip>\n\t\t\t) : null}\n\t\t</div>\n\t)\n}\n","export default __webpack_public_path__ + \"Element_Anemo.f809fde3.png\";","export default __webpack_public_path__ + \"Element_Cryo.019d72f9.png\";","export default __webpack_public_path__ + \"Element_Electro.342332ac.png\";","export default __webpack_public_path__ + \"Element_Geo.94f4e68a.png\";","export default __webpack_public_path__ + \"Element_Hydro.f2f8bd8a.png\";","import element_Anemo from '#src/media/Element_Anemo.png'\n// import element_Dendro from '#src/media/Element_Dendro.png'\nimport element_Cryo from '#src/media/Element_Cryo.png'\nimport element_Electro from '#src/media/Element_Electro.png'\nimport element_Geo from '#src/media/Element_Geo.png'\nimport element_Hydro from '#src/media/Element_Hydro.png'\nimport element_Pyro from '#src/media/Element_Pyro.png'\n\nimport type { GI_ElementCode } from '#lib/genshin'\n\nexport type GI_Element = { readonly code: GI_ElementCode; imgSrc: string }\nexport const elements: GI_Element[] = [\n\t{ code: 'pyro' as const, imgSrc: element_Pyro },\n\t{ code: 'hydro' as const, imgSrc: element_Hydro },\n\t{ code: 'anemo' as const, imgSrc: element_Anemo },\n\t{ code: 'electro' as const, imgSrc: element_Electro },\n\t// { code: 'dendro' as const , imgSrc: element_Dendro },\n\t{ code: 'cryo' as const, imgSrc: element_Cryo },\n\t{ code: 'geo' as const, imgSrc: element_Geo },\n]\n","export default __webpack_public_path__ + \"Element_Pyro.f65c2e38.png\";","import { createContext } from 'preact'\nimport { useCallback, useContext, useRef, useState } from 'preact/hooks'\n\nimport { GI_RarityCode } from '#lib/genshin'\nimport {\n\tArtifactRegularInfo,\n\tDomainShortInfo,\n\tEnemyShortInfo,\n\tItemShortInfo,\n\tWeaponRegularInfo,\n} from '#lib/parsing/combine'\nimport { mustBeNever } from '#src/../../lib/utils/values'\nimport { getCoverArtifactForSet } from '#src/modules/builds/common'\nimport { A } from '#src/routes/router'\nimport { getAllArtifacts } from '#src/utils/artifacts'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { elements } from '#src/utils/elements'\nimport { ArtifactCard, CardDescMobileWrap, WeaponCard } from './dd-cards'\n\nimport './item-cards.scss'\n\nexport function getRarityBorder(r: GI_RarityCode): string {\n\treturn r === 5 ? 'border-warning' : 'border-light'\n}\n\ninterface ItemAvatarCommonProps {\n\trarity?: GI_RarityCode\n\tisNoBg?: boolean\n\tclasses?: string\n\thref?: string\n\tonClick?(): unknown\n\tbadgeTopStart?: string | null | JSX.Node\n\tbadgeTopEnd?: string | null | JSX.Node\n\tddComponent?: JSX.Element\n}\ninterface ItemAvatarProps extends ItemAvatarCommonProps {\n\tsrc: string\n}\ninterface CharacterAvatarProps extends ItemAvatarCommonProps {\n\tcode: string //todo charcode\n}\nexport function ItemAvatar({\n\tsrc,\n\trarity,\n\tclasses = '',\n\thref,\n\tisNoBg,\n\tonClick,\n\tbadgeTopStart,\n\tbadgeTopEnd,\n\tddComponent,\n}: ItemAvatarProps): JSX.Element {\n\t;['bg-2', 'bg-3', 'bg-4', 'bg-5']\n\tconst rarityClass = isNoBg ? '' : rarity ? 'bg-' + rarity : 'bg-dark'\n\n\tconst elRef = useRef<HTMLAnchorElement>(null)\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst closeDd = useCallback(() => isExpanded && setIsExpanded(false), [setIsExpanded, isExpanded])\n\tconst openDd = useCallback(() => !isExpanded && setIsExpanded(true), [setIsExpanded, isExpanded])\n\tconst pointerClass = ddComponent || onClick ? 'c-pointer' : ''\n\tconst onClickLocal = useCallback(() => {\n\t\topenDd && openDd()\n\t\tonClick && onClick()\n\t}, [openDd, onClick])\n\treturn (\n\t\t<DdContext.Provider value={{ onClickAway: closeDd }}>\n\t\t\t<A\n\t\t\t\thref={href}\n\t\t\t\tclassName={`item-avatar position-relative rounded-circle d-inline-block ${pointerClass} ${rarityClass} ${classes}`}\n\t\t\t\tinnerRef={elRef}\n\t\t\t\tonClick={onClickLocal}\n\t\t\t>\n\t\t\t\t<img className=\"image\" src={src} />\n\t\t\t\t{badgeTopStart && (\n\t\t\t\t\t<span className=\"position-absolute top-0 start-0 translate-middle badge rounded-pill opacity-75 small\">\n\t\t\t\t\t\t{badgeTopStart}\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\t\t\t\t{badgeTopEnd && (\n\t\t\t\t\t<span className=\"position-absolute top-0 start-100 translate-middle badge rounded-pill opacity-75 small\">\n\t\t\t\t\t\t{badgeTopEnd}\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\t\t\t\t{/* <span className=\"position-absolute top-0 start-0 translate-middle badge rounded-pill bg-primary border border-light\">\n\t\t\t\t4\n\t\t\t</span> */}\n\t\t\t\t{isExpanded && elRef.current && ddComponent && (\n\t\t\t\t\t<CardDescMobileWrap onClickAway={closeDd} targetEl={elRef.current}>\n\t\t\t\t\t\t{ddComponent}\n\t\t\t\t\t</CardDescMobileWrap>\n\t\t\t\t)}\n\t\t\t</A>\n\t\t</DdContext.Provider>\n\t)\n}\nconst codeToBadge = (code: string) => {\n\tconst e = elements.find(e => code === `traveler-${e.code}`)\n\treturn e ? <img className=\"badge-element-icon d-block ms-n1 mb-n1\" src={e.imgSrc} /> : null\n}\nexport function CharacterAvatar(props: CharacterAvatarProps) {\n\tconst classesLocal = props.rarity\n\t\t? `${props.classes} border ${getRarityBorder(props.rarity)}`\n\t\t: props.classes\n\treturn (\n\t\t<ItemAvatar\n\t\t\t{...props}\n\t\t\trarity={undefined} //обработкой рарности персонажа занимается этот компонент, а не итемаватар\n\t\t\tclasses={classesLocal}\n\t\t\tsrc={getCharacterAvatarSrc(props.code)}\n\t\t\tbadgeTopEnd={codeToBadge(props.code)}\n\t\t/>\n\t)\n}\nfunction ItemLabel({\n\trarity,\n\tclasses = '',\n\tchildren,\n}: {\n\trarity?: GI_RarityCode | null\n\tclasses?: string\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst rarityClass =\n\t\trarity === 5 //\n\t\t\t? 'text-warning'\n\t\t\t: rarity === 4\n\t\t\t? 'text-primary'\n\t\t\t: ''\n\t//todo c-pointer text-decoration-underline-dotted для интерактивных\n\treturn <label class={`${classes} ${rarityClass}`}>{children}</label>\n}\n\nfunction ItemDd({\n\tclasses = '',\n\tchildren,\n\tddComponent,\n}: {\n\tclasses?: string\n\tddComponent?: JSX.Element | null\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst elRef = useRef<HTMLButtonElement>(null)\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\n\tconst closeDd = useCallback(() => setIsExpanded(false), [])\n\tconst openDd = useCallback(() => setIsExpanded(true), [])\n\n\tconst pointerClass = ddComponent ? 'c-pointer' : ''\n\treturn (\n\t\t<DdContext.Provider value={{ onClickAway: closeDd }}>\n\t\t\t<button\n\t\t\t\tclassName={`btn-reset ${pointerClass} ${classes}`}\n\t\t\t\tref={elRef}\n\t\t\t\tonClick={openDd}\n\t\t\t\tdisabled={!ddComponent}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t\t{isExpanded && elRef.current && ddComponent && (\n\t\t\t\t\t<CardDescMobileWrap onClickAway={closeDd} targetEl={elRef.current}>\n\t\t\t\t\t\t{ddComponent}\n\t\t\t\t\t</CardDescMobileWrap>\n\t\t\t\t)}\n\t\t\t</button>\n\t\t</DdContext.Provider>\n\t)\n}\n\nexport const ItemsDataContext = createContext({\n\tweapons: new Map<string, WeaponRegularInfo>(),\n\tartifacts: new Map<string, ArtifactRegularInfo>(),\n\tdomains: new Map<string, DomainShortInfo>(),\n\tenemies: new Map<string, EnemyShortInfo>(),\n\titems: new Map<string, ItemShortInfo>(),\n})\n\nexport function ItemLabelWithDd({\n\tclasses = '',\n\ttype,\n\tcode,\n\tchildren,\n}: {\n\tclasses?: string\n\ttype: 'weapon' | 'artifact'\n\tcode: string\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst maps = useContext(ItemsDataContext)\n\n\tlet ddComp: JSX.Element | undefined = undefined\n\tlet rarity: GI_RarityCode | undefined = undefined\n\tif (type === 'weapon') {\n\t\tconst weapon = maps.weapons.get(code)\n\t\tif (weapon) {\n\t\t\tddComp = <WeaponCard weapon={weapon} related={maps} />\n\t\t\trarity = weapon.rarity\n\t\t}\n\t} else if (type === 'artifact') {\n\t\tconst artifacts = getAllArtifacts(code, maps.artifacts)\n\t\tif (artifacts.length > 0) {\n\t\t\tconst coverArtifact = getCoverArtifactForSet(code, artifacts)\n\t\t\tddComp = <ArtifactCard title={coverArtifact.name} artifacts={artifacts} related={maps} />\n\t\t\trarity = artifacts[0].rarity\n\t\t}\n\t} else mustBeNever(type)\n\n\tconst interactiveLabelClass = ddComp ? 'text-decoration-underline-dotted' : ''\n\treturn (\n\t\t<ItemDd ddComponent={ddComp} classes={`d-inline ${classes}`}>\n\t\t\t<ItemLabel classes={`${interactiveLabelClass} c-inherit`} rarity={rarity}>\n\t\t\t\t{children}\n\t\t\t</ItemLabel>\n\t\t</ItemDd>\n\t)\n}\n\nexport const DdContext = createContext({\n\tonClickAway: () => {\n\t\treturn\n\t},\n})\n\nexport function LabeledItemAvatar({\n\timgSrc,\n\trarity,\n\tclasses = '',\n\tavatarClasses = '',\n\ttitle,\n\tavatarTopStartBadge,\n\tavatarTopEndBadge,\n\tddComponent,\n\tisNoBg = false,\n}: {\n\tisNoBg?: boolean\n\timgSrc: string\n\trarity?: GI_RarityCode\n\ttitle: string\n\tclasses?: string\n\tavatarClasses?: string\n\tavatarTopStartBadge?: string\n\tavatarTopEndBadge?: string\n\tddComponent?: JSX.Element\n}): JSX.Element {\n\tconst interactiveLabelClass = ddComponent ? 'text-decoration-underline-dotted' : ''\n\treturn (\n\t\t<ItemDd ddComponent={ddComponent} classes={`w-100 text-nowrap ${classes}`}>\n\t\t\t<ItemAvatar\n\t\t\t\tclasses={`small-avatar align-middle ${avatarClasses}`}\n\t\t\t\tsrc={imgSrc}\n\t\t\t\tbadgeTopStart={avatarTopStartBadge}\n\t\t\t\tbadgeTopEnd={avatarTopEndBadge}\n\t\t\t\tisNoBg={isNoBg}\n\t\t\t/>\n\t\t\t<ItemLabel\n\t\t\t\tclasses={'text-wrap align-middle lh-1 ps-1 mw-75 c-inherit ' + interactiveLabelClass}\n\t\t\t\trarity={rarity}\n\t\t\t>\n\t\t\t\t{title}\n\t\t\t</ItemLabel>\n\t\t</ItemDd>\n\t)\n}\n","import { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'preact/hooks'\n\nimport { SearchItem, SearchItemType } from '#lib/parsing/combine'\nimport { apiGetSearchData } from '#src/api/endpoints'\nimport { BlockHeader } from '#src/components/block-header'\nimport { CentredLabel, CentredSpinner } from '#src/components/placeholders'\nimport {\n\tI18N_ARROWS_TO_SELECT,\n\tI18N_ARTIFACTS,\n\tI18N_CHARACTERS,\n\tI18N_ITEM_DETAIL,\n\tI18N_MEGA_SEARCH_PLACEHOLDER,\n\tI18N_NOTHING_TO_SHOW,\n\tI18N_RECOMMENDED_BUILDS,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { genEquipmentHash } from '#src/modules/equipment/common'\nimport { A, dispatchRouteTo } from '#src/routes/router'\nimport { getArtifactIconSrc } from '#src/utils/artifacts'\nimport { calcPosForDd } from '#src/utils/calc-pos-for-dd'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { GET_MODALS_EL } from '#src/utils/dom'\nimport {\n\tisLoaded,\n\tuseClickAway,\n\tuseFetch,\n\tuseForceUpdate,\n\tuseScrollTo,\n\tuseWindowSize,\n} from '#src/utils/hooks'\nimport { createPortal } from '#src/utils/preact-compat'\nimport { getWeaponIconSrc } from '#src/utils/weapons'\nimport { ItemAvatar } from './item-cards/item-avatars'\n\nimport './mega-search.scss'\n\ntype MegaSearch_SearchItem = SearchItem & {\n\tnameLC: string\n\tnameEnLC?: string\n}\ntype SearchResults = Record<SearchItemType, MegaSearch_SearchItem[]>\n\nfunction getIconForItem({ code, type }: { code: string; type: SearchItemType }): string {\n\treturn {\n\t\tcharacter: getCharacterAvatarSrc,\n\t\tweapon: getWeaponIconSrc,\n\t\tartifact: getArtifactIconSrc,\n\t}[type](code)\n}\nfunction searchInItem(item: MegaSearch_SearchItem, searchStr: string): boolean {\n\treturn item.nameLC.includes(searchStr) || (item.nameEnLC ? item.nameEnLC.includes(searchStr) : false)\n}\nfunction strIndexOrInf(str: string | undefined, searchStr: string) {\n\tif (!str) return Infinity\n\tconst index = str.indexOf(searchStr)\n\treturn index === -1 ? Infinity : index\n}\nfunction sortInItem(item: MegaSearch_SearchItem, searchStr: string): number {\n\treturn Math.min(strIndexOrInf(item.nameLC, searchStr), strIndexOrInf(item.nameEnLC, searchStr))\n}\nconst itemTypes: SearchItemType[] = ['character', 'weapon', 'artifact']\n\nexport function MegaSearch({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [searchStr, setSearchStr] = useState<string>('')\n\tconst searchData = useFetch(apiGetSearchData, [])\n\n\tconst searchDataGrouped = useMemo(() => {\n\t\tconst searchDataLocal: SearchResults = { weapon: [], character: [], artifact: [] }\n\t\tif (isLoaded(searchData)) {\n\t\t\tsearchData.forEach(si => {\n\t\t\t\tsearchDataLocal[si.type].push({\n\t\t\t\t\t...si,\n\t\t\t\t\tnameLC: si.name.toLocaleLowerCase(),\n\t\t\t\t\tnameEnLC: si.nameEn?.toLocaleLowerCase(),\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\t\treturn searchDataLocal\n\t}, [searchData])\n\n\tconst ddRef = useRef<HTMLDivElement>(null)\n\tconst targetRef = useRef<HTMLInputElement>(null)\n\n\tconst clearSearch = useCallback(\n\t\t(shouldBlur?: boolean) => {\n\t\t\tif (shouldBlur && targetRef.current) targetRef.current.blur()\n\t\t\tsetSearchStr('')\n\t\t},\n\t\t[targetRef],\n\t)\n\n\tuseClickAway([targetRef, ddRef], clearSearch)\n\n\tconst onResize = useCallback(() => {\n\t\tif (!ddRef.current) return\n\t\tif (!targetRef.current) return\n\t\tconst ddEl = ddRef.current\n\t\tconst targetEl = targetRef.current\n\t\tconst pos = calcPosForDd(targetEl.getBoundingClientRect(), ddEl.getBoundingClientRect(), {\n\t\t\tisAbsolute: true,\n\t\t\tisCentered: true,\n\t\t})\n\t\tddEl.style.left = `${Math.max(0, pos.left)}px`\n\t\tddEl.style.top = `${Math.max(0, pos.top)}px`\n\t}, [ddRef, targetRef])\n\n\tconst searchResults = useMemo<SearchResults | null>(() => {\n\t\tif (!isLoaded(searchData) || !searchStr) return null\n\t\tconst searchResultsLocal: SearchResults = { character: [], weapon: [], artifact: [] }\n\t\titemTypes.forEach(t => {\n\t\t\tsearchResultsLocal[t] = searchDataGrouped[t]\n\t\t\t\t.filter(it => searchInItem(it, searchStr))\n\t\t\t\t.sort((a, b) => sortInItem(a, searchStr) - sortInItem(b, searchStr))\n\t\t})\n\t\treturn searchResultsLocal\n\t}, [searchStr, searchDataGrouped, searchData])\n\n\tuseEffect(() => {\n\t\tconst clearSearchAndBlurLocal = () => clearSearch(true)\n\n\t\tfunction onKeyPress(e: KeyboardEvent) {\n\t\t\tif (e.key === 'Escape') clearSearch(true)\n\t\t}\n\t\taddEventListener('popstate', clearSearchAndBlurLocal)\n\t\taddEventListener('keydown', onKeyPress)\n\t\treturn () => {\n\t\t\tremoveEventListener('popstate', clearSearchAndBlurLocal)\n\t\t\tremoveEventListener('keydown', onKeyPress)\n\t\t}\n\t}, [clearSearch])\n\n\tuseEffect(() => onResize(), [searchResults, onResize])\n\tconst onSearchValueChange = useCallback((e: JSX.TargetedEvent<HTMLInputElement, Event>) => {\n\t\tsetSearchStr(e.currentTarget.value.toLocaleLowerCase())\n\t}, [])\n\tuseLayoutEffect(onResize)\n\tuseWindowSize()\n\n\treturn (\n\t\t<div className={`mega-search position-relative d-inline-block w-100 ${classes}`}>\n\t\t\t<input\n\t\t\t\tclassName=\"rounded border bg-dark text-light border-secondary w-100 text-center\"\n\t\t\t\ttype=\"search\"\n\t\t\t\tvalue={searchStr}\n\t\t\t\tonInput={onSearchValueChange}\n\t\t\t\tdisabled={!isLoaded(searchData)}\n\t\t\t\tref={targetRef}\n\t\t\t\tplaceholder={I18N_MEGA_SEARCH_PLACEHOLDER}\n\t\t\t/>\n\t\t\t{!isLoaded(searchData) ? <CentredSpinner /> : null}\n\t\t\t{searchStr &&\n\t\t\t\tsearchResults &&\n\t\t\t\tcreatePortal(\n\t\t\t\t\t<div className=\"card search-results-dd position-absolute mx-2 my-1\" ref={ddRef}>\n\t\t\t\t\t\t<div className=\"card-body p-2 pb-4 position-relative\">\n\t\t\t\t\t\t\t{searchResults && (\n\t\t\t\t\t\t\t\t<SearchResultsWrap\n\t\t\t\t\t\t\t\t\tsearchResults={searchResults}\n\t\t\t\t\t\t\t\t\tsearchStr={searchStr}\n\t\t\t\t\t\t\t\t\tclearSearch={clearSearch}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={`position-absolute w-100\\\n\t\t\t\t \t\t\t\t\t\t\t\t\t\tpx-2 py-2 lh-1 text-center\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbottom-0 start-0 small text-muted \\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\topacity-75 pe-none`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"d-none d-md-block\">{I18N_ARROWS_TO_SELECT}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>,\n\t\t\t\t\tGET_MODALS_EL(),\n\t\t\t\t)}\n\t\t</div>\n\t)\n}\n\nconst searckTypeTitleMap: Record<SearchItemType, string> = {\n\tcharacter: I18N_CHARACTERS,\n\tartifact: I18N_ARTIFACTS,\n\tweapon: I18N_WEAPONS,\n}\n/**\n * Ищет следующую непустую группу в заданном направлении и с заданным отступом\n */\nfunction switchSearchType(\n\tsearchResults: SearchResults,\n\tselected: { type: SearchItemType; index: number },\n\toffset: -1 | 0 | 1,\n\tdirection: -1 | 1,\n) {\n\tconst fromIndex = itemTypes.indexOf(selected.type)\n\tconst itemsLen = itemTypes.length\n\tfor (let i = 0; i < itemsLen; i++) {\n\t\tconst index = (i * direction + fromIndex + offset + itemsLen * 2) % itemsLen\n\t\tconst type = itemTypes[index]\n\t\tif (searchResults[type].length > 0) {\n\t\t\tselected.type = type\n\t\t\tselected.index = Math.min(searchResults[type].length - 1, selected.index)\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nfunction SearchResultsWrap({\n\tsearchResults,\n\tsearchStr,\n\tclearSearch,\n}: {\n\tsearchResults: SearchResults\n\tsearchStr: string\n\tclearSearch: (shouldBlur?: boolean) => unknown\n}): JSX.Element {\n\tconst forceUpdate = useForceUpdate()\n\tconst selected = useRef({ type: 'character' as SearchItemType, index: -1 }).current\n\n\tuseMemo(() => {\n\t\t// после изменения поисковой строки снимаем выделение с элементов\n\t\t// и по возможности сохраняем текущую группу\n\t\tselected.index = -1\n\t\tswitchSearchType(searchResults, selected, 0, 1)\n\t}, [searchResults, selected])\n\n\tuseEffect(() => {\n\t\tfunction onKeyPress(e: KeyboardEvent) {\n\t\t\tif (e.ctrlKey || e.altKey || e.shiftKey || e.metaKey) return\n\t\t\tconst results = searchResults[selected.type]\n\n\t\t\tif (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {\n\t\t\t\tconst len = results.length\n\t\t\t\tif (len > 0) {\n\t\t\t\t\tif (e.key === 'ArrowDown') selected.index = (selected.index + 1) % len\n\t\t\t\t\tif (e.key === 'ArrowUp') selected.index = (selected.index - 1 + len) % len\n\t\t\t\t}\n\t\t\t\tif (e.key === 'ArrowLeft') switchSearchType(searchResults, selected, -1, -1)\n\t\t\t\tif (e.key === 'ArrowRight') switchSearchType(searchResults, selected, 1, 1)\n\t\t\t\tforceUpdate()\n\t\t\t\te.preventDefault()\n\t\t\t}\n\n\t\t\tif (['Enter', ' '].includes(e.key)) {\n\t\t\t\tconst gotSingleResult = itemTypes.every(\n\t\t\t\t\tx => searchResults[x].length === (x === selected.type ? 1 : 0),\n\t\t\t\t)\n\t\t\t\t// если нашлась только одна непустая группа, и в ней только один результат,\n\t\t\t\t// сразу переходим на его, даже если он явно не выбран (не в selected)\n\t\t\t\tconst item = results[gotSingleResult ? 0 : selected.index]\n\t\t\t\tif (item) {\n\t\t\t\t\tconst path = mainItemHrefMap[item.type](item.code)\n\t\t\t\t\tclearSearch(true)\n\t\t\t\t\tdispatchRouteTo(path)\n\t\t\t\t\te.preventDefault()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\taddEventListener('keydown', onKeyPress)\n\t\treturn () => removeEventListener('keydown', onKeyPress)\n\t}, [forceUpdate, clearSearch, searchResults, selected])\n\n\treturn (\n\t\t<div className=\"search-results-wrap d-flex align-items-stretch\">\n\t\t\t{itemTypes.map(type => (\n\t\t\t\t<div className=\"w-33 h-100 px-1 d-flex flex-column\" key={type}>\n\t\t\t\t\t<BlockHeader>{searckTypeTitleMap[type]}</BlockHeader>\n\t\t\t\t\t<div className=\"overflow-auto flex-fill position-relative pe-1\">\n\t\t\t\t\t\t{searchResults[type].length ? (\n\t\t\t\t\t\t\tsearchResults[type].map((item, i) => (\n\t\t\t\t\t\t\t\t<SearchItemCard\n\t\t\t\t\t\t\t\t\tkey={item.code}\n\t\t\t\t\t\t\t\t\titem={item}\n\t\t\t\t\t\t\t\t\tsearchStr={searchStr}\n\t\t\t\t\t\t\t\t\tisSelected={type === selected.type && i === selected.index}\n\t\t\t\t\t\t\t\t\tclearSearch={clearSearch}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<CentredLabel label={I18N_NOTHING_TO_SHOW} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\nfunction highlightPartOfText(regexp: RegExp, text: string | undefined) {\n\tif (!text) return undefined\n\tconst parts = text.split(regexp)\n\treturn parts.filter(String).map((part, i) => {\n\t\treturn regexp.test(part) ? (\n\t\t\t<mark className=\"p-0\" key={i}>\n\t\t\t\t{part}\n\t\t\t</mark>\n\t\t) : (\n\t\t\t<span key={i}>{part}</span>\n\t\t)\n\t})\n}\nconst mainItemHrefMap: Record<SearchItemType, (code: string) => string> = {\n\tweapon: c => `/weapons${genEquipmentHash('weapon', c)}`,\n\tartifact: c => `/artifacts${genEquipmentHash('artifact', c)}`,\n\tcharacter: c => `/builds/${c}`,\n}\nconst SearchItemCard = ({\n\titem,\n\tsearchStr,\n\tisSelected,\n\tclearSearch,\n}: {\n\titem: SearchItem\n\tsearchStr: string\n\tisSelected: boolean\n\tclearSearch: (shouldBlur?: boolean) => unknown\n}): JSX.Element => {\n\tconst [wrapRef] = useScrollTo<HTMLDivElement>(isSelected, { block: 'nearest' })\n\tconst clearSearchAndBlurLocal = useCallback(() => clearSearch(true), [clearSearch])\n\tconst regexp = new RegExp(`(${searchStr})`, 'gi')\n\tconst nameWithHighlight = searchStr ? highlightPartOfText(regexp, item.name) : item.name\n\tconst nameEnWithHighlight = searchStr ? highlightPartOfText(regexp, item.nameEn) : item.nameEn\n\tconst mainItemHref = mainItemHrefMap[item.type](item.code)\n\treturn (\n\t\t<div\n\t\t\tclassName={`lh-sm d-flex mt-1 mb-2 py-1 search-item-card rounded ${\n\t\t\t\tisSelected ? 'ps-1 highlighted bg-secondary' : ''\n\t\t\t}`}\n\t\t\tref={wrapRef}\n\t\t>\n\t\t\t<div className=\"me-1 d-none d-md-block \">\n\t\t\t\t<ItemAvatar\n\t\t\t\t\tsrc={getIconForItem(item)}\n\t\t\t\t\thref={mainItemHref}\n\t\t\t\t\tclasses=\"bg-dark-on-dark\"\n\t\t\t\t\tonClick={clearSearchAndBlurLocal}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<h6 className=\"mb-0 text-break\">\n\t\t\t\t\t<ItemAvatar src={getIconForItem(item)} classes=\"emoji-avatar me-1 d-md-none\" />\n\t\t\t\t\t<span className=\"align-middle\">{nameWithHighlight}</span>\n\t\t\t\t</h6>\n\t\t\t\t<div className=\"text-muted small text-break\">{nameEnWithHighlight}</div>\n\t\t\t\t<div className=\"small\">\n\t\t\t\t\t{item.type === 'weapon' && (\n\t\t\t\t\t\t<A href={mainItemHref} onClick={clearSearchAndBlurLocal}>\n\t\t\t\t\t\t\t{I18N_ITEM_DETAIL}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t)}\n\t\t\t\t\t{item.type === 'artifact' && (\n\t\t\t\t\t\t<A href={mainItemHref} onClick={clearSearchAndBlurLocal}>\n\t\t\t\t\t\t\t{I18N_ITEM_DETAIL}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t)}\n\t\t\t\t\t{item.type === 'character' && (\n\t\t\t\t\t\t<A href={mainItemHref} onClick={clearSearchAndBlurLocal}>\n\t\t\t\t\t\t\t{I18N_RECOMMENDED_BUILDS}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { A } from '#src/routes/router'\nimport { useState } from 'preact/hooks'\n\nimport { Nav } from '../components/nav'\nimport { MegaSearch } from './mega-search'\n\nexport function Header() {\n\tconst [isNavExpanded, setIsNavExpanded] = useState(false)\n\t// TODO клик мимо компонента\n\treturn (\n\t\t<header>\n\t\t\t<div className=\"navbar navbar-expand-lg navbar-dark bg-primary\">\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<A className=\"navbar-brand\" href=\"/\">\n\t\t\t\t\t\tGenshin Base\n\t\t\t\t\t</A>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"navbar-toggler\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tonClick={() => setIsNavExpanded(!isNavExpanded)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"navbar-toggler-icon\"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<Nav isNavExpanded={isNavExpanded} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"navbar py-2 navbar-darker-bg\">\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<MegaSearch />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</header>\n\t)\n}\n","import { LINK_DISCORD_INVITE } from '#src/utils/links'\r\nimport { LANG } from './i18n'\r\n\r\nexport const I18N_ABOUT_SITE_EPIGRAPH = {\r\n\ten: { quote: 'A site to be hold!', footer: 'The head shrine maiden in charge of', cite: 'Grand Shrine' },\r\n\tru: { quote: 'Сайт, достойный созерцания!', footer: 'Верховная жрица', cite: 'Великого храма' },\r\n}[LANG]\r\nexport const I18N_ABOUT_SITE_CONTENT = {\r\n\ten: () => (\r\n\t\t<>\r\n\t\t\t<p>\r\n\t\t\t\tThe Genshin Base is a site that contains only the necessary information about Genshin Impact.\r\n\t\t\t\tThe site is equally convenient to use both from a computer and from a phone.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tWe welcome any support. If you want to become a part of our team, arrange a collaboration or\r\n\t\t\t\tjust chat, we are waiting for you in our{' '}\r\n\t\t\t\t<a className=\"link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\r\n\t\t\t\t\tDiscord\r\n\t\t\t\t</a>\r\n\t\t\t\t.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tSurfing once again on the Internet in search of actual information about character builds, I\r\n\t\t\t\tfelt indignant. I spent a lot of time collecting information bit by bit from different places.\r\n\t\t\t\tBadly designed pictures with recommendations for leveling characters, the date of which was\r\n\t\t\t\talmost equal to the release date of the game, or complicated Google tables, funny articles\r\n\t\t\t\ttranslated by an electronic translator from copywriters for two pennies who have never seen\r\n\t\t\t\tthe game. Unable to endure it any longer, I called my few comrades together and announced: we\r\n\t\t\t\tare making a site on Genshin. We start today.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tA week passed and we started. First of all, we decided to make a page with builds. Based on\r\n\t\t\t\tone of the few usable tables, I came up with a universal character page design. It turned out\r\n\t\t\t\tthat for such a design, information from the table alone was not enough — we had to take\r\n\t\t\t\tinformation from four more sites.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tThe result is a section that contains the detailed information needed to level up and unlock\r\n\t\t\t\tthe potential of a character. For each character defined the team roles. For each role there\r\n\t\t\t\tare lists of recommended artifacts, weapons, talents, as well as tips for playing this role.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tFor each artifact, weapon, or material needed to upgrade a character or weapon, there are\r\n\t\t\t\tcards with a detailed description and information about where this item is obtained. Also, for\r\n\t\t\t\tartifacts and weapons there are always character recommendations.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tBut this seemed to us not enough. The site, consisting of a single section, looks somehow dry.\r\n\t\t\t\tWe started thinking about what else to add. After analyzing our needs as players, we came to\r\n\t\t\t\tthe conclusion that it would be good to show on the main page information for game planning.\r\n\t\t\t\tFirstly, we add a block with information about what is farmed today and tomorrow in dungeons,\r\n\t\t\t\tso users can plan where to spend the resin, and the time until the end of the day on different\r\n\t\t\t\tservers. Secondly, we designed a block with a summary of the character build. At the same\r\n\t\t\t\ttime, a system of favorites appeared: now any character and any material can be added to\r\n\t\t\t\tfavorites. Selected materials are highlighted on the main page. Information about selected\r\n\t\t\t\tcharacters is also displayed there.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tThe last thing I added was the Alchemy Calculator. A third of our team of three people laugh\r\n\t\t\t\tat him, but I find it extremely useful. It is designed to simplify the calculation of the\r\n\t\t\t\tnecessary resources for leveling up talent books, as well as materials for characters and\r\n\t\t\t\tweapons.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tWe have many plans for the future. Our goal is to make the most complete and useful site about\r\n\t\t\t\tGenshin. And we need your help. Message to us on{' '}\r\n\t\t\t\t<a className=\"link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\r\n\t\t\t\t\tDiscord\r\n\t\t\t\t</a>{' '}\r\n\t\t\t\tif you want to participate in the development.\r\n\t\t\t</p>\r\n\t\t</>\r\n\t),\r\n\tru: () => (\r\n\t\t<>\r\n\t\t\t<p>\r\n\t\t\t\tБаза Геншина — сайт, на котором собрана только нужная информация по Геншин Импакту. Сайтом\r\n\t\t\t\tодинаково удобно пользоваться как с компьютера, так и с телефона.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tМы будем рады любой поддержке. Если вы хотите стать частью нашей команды, устроить\r\n\t\t\t\tколлаборацию или просто пообщаться — ждем вас у нас в{' '}\r\n\t\t\t\t<a className=\"link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\r\n\t\t\t\t\tДискорде\r\n\t\t\t\t</a>\r\n\t\t\t\t.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tЛазая в очередной раз по интернетам в поисках актуальных билдов персонажей, я испытал\r\n\t\t\t\tнегодование. Кучу времени приходится тратить на то, чтобы собрать информацию по крупицам из\r\n\t\t\t\tразных мест. Эти плохо свёрстанные картинки с рекомендациями по прокачке персонажей, дата\r\n\t\t\t\tсоставления которых чуть ли не равна дате релиза игры, сложно составленные таблички в Гугле,\r\n\t\t\t\tсмешные статьи, переведенные электронным переводчиком от копирайтеров за две копейки, которые\r\n\t\t\t\tникогда не видели игру. Не в силах больше это терпеть, я созвал своих немногочисленных\r\n\t\t\t\tтоварищей и объявил: мы делаем сайт по Геншину. Начинаем сегодня.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tНе прошло и недели, как мы начали. В первую очередь было решено сделать страницу с билдами.\r\n\t\t\t\tВзяв за основу одну из немногих адекватных таблиц, я придумал универсальный дизайн страницы\r\n\t\t\t\tперсонажа. Правда, оказалось, что для такого дизайна информации с одной только таблички\r\n\t\t\t\tнедостаточно — пришлось брать информацию ещё с четырех сайтов.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tРезультатом стал раздел, который содержит детальную информацию, необходимую для развития и\r\n\t\t\t\tраскрытия потенциала персонажа. Для каждого персонажа определены роли, которые он может\r\n\t\t\t\tвыполнять в отряде. Для каждой роли, в свою очередь, составлены списки рекомендованных\r\n\t\t\t\tартефактов, оружия, талантов, а так же написаны заметки об особенностях игры на данной роли.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tДля каждого артефакта, оружия или материала, необходимого для улучшения персонажа или оружия,\r\n\t\t\t\tсоставлены карточки с подробным описанием характеристик и информацией о том, где данный\r\n\t\t\t\tпредмет добывается. Также для артефактов и оружия всегда видны рекомендованные персонажи.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tНо этого нам показалось мало. Как-то сухо выглядит сайт, состоящий из одного-единственного\r\n\t\t\t\tраздела. Мы начали думать, что еще можно добавить. Проанализировав наши потребности как\r\n\t\t\t\tигроков, мы пришли к выводу, что хорошо было бы вывести на главной информацию для планирования\r\n\t\t\t\tигры. Первым стал блок о том, что добывается сегодня и завтра в данжах, чтобы было удобно\r\n\t\t\t\tпланировать, куда тратить смолу, и время до окончания дня на разных серверах. Вторым — блок с\r\n\t\t\t\tкратким содержание билда персонажей. Одновременно с этим появилось система избранных: теперь\r\n\t\t\t\tлюбого персонажа и любой материал для улучшения можно добавить в избранное. Избранные\r\n\t\t\t\tматериалы выделяются на главной. Там же выводится и информация об избранных персонажах —\r\n\t\t\t\tнапример, какие артефакты рекомендуется носить и какие таланты улучшать.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tПоследним я добавил Алхимический калькулятор. Треть нашей команды из трех человек над ним\r\n\t\t\t\tсмеётся, но я считаю его крайне полезным. Он призван упростить расчёт необходимых ресурсов для\r\n\t\t\t\tулучшения книжек талантов, а также материалов для улучшения персонажей и оружия.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tУ нас много планов на будущее. Наша цель — сделать самый полный и полезный сайт по Геншину. И\r\n\t\t\t\tнам нужна ваша помощь. Пишите нам в{' '}\r\n\t\t\t\t<a className=\"link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\r\n\t\t\t\t\tДискорд\r\n\t\t\t\t</a>\r\n\t\t\t\t, если хотите поучаствовать в разработке.\r\n\t\t\t</p>\r\n\t\t</>\r\n\t),\r\n}[LANG]()\r\n","import { useMemo } from 'preact/hooks'\n\nimport { decodeLocations } from '#lib/genshin'\nimport {\n\tCharacterFullInfoWithRelated,\n\tEnemyShortInfo,\n\tExtractedLocationsInfo,\n\tItemShortInfo,\n} from '#lib/parsing/combine'\nimport { promiseNever } from '#lib/utils/values'\nimport { isLoaded, LoadingState, useFetch, useFetchWithPrev } from '#src/utils/hooks'\nimport { apiGetCharacter, apiGetCharacterRelatedLocs } from './endpoints'\nimport { MapAllByCode, mapAllByCode } from './utils'\n\nexport function useBuildWithDelayedLocs(\n\tcharacterCode: string,\n): [build: LoadingState<MapAllByCode<CharacterFullInfoWithRelated>>, isUpdating: boolean] {\n\tconst [build, isUpdating] = useFetchWithPrev(sig => apiGetCharacter(characterCode, sig), [characterCode])\n\tconst buildIsLoaded = isLoaded(build)\n\n\tconst locs = useFetch(\n\t\tsig =>\n\t\t\tbuildIsLoaded\n\t\t\t\t? apiGetCharacterRelatedLocs(characterCode, sig) //\n\t\t\t\t: promiseNever(), //не загружаем локации, пока не загрузится до конца билд\n\t\t[characterCode, buildIsLoaded],\n\t)\n\n\tconst buildWithLocs = useMemo(\n\t\t() => (buildIsLoaded && isLoaded(locs) ? applyFullInfoLocationsImmut(build, locs) : build),\n\t\t[build, buildIsLoaded, locs],\n\t)\n\treturn [buildWithLocs, isUpdating]\n}\n\nfunction applyFullInfoLocationsImmut(\n\tfullInfo: MapAllByCode<CharacterFullInfoWithRelated>,\n\tlocsInfo: ExtractedLocationsInfo,\n): MapAllByCode<CharacterFullInfoWithRelated> {\n\tconst items = applyItemsLocationsImmut(fullInfo.items, locsInfo.items)\n\tconst enemies = applyItemsLocationsImmut(fullInfo.enemies, locsInfo.enemies)\n\treturn mapAllByCode({ ...fullInfo, items, enemies })\n}\n\nfunction applyItemsLocationsImmut<T extends ItemShortInfo | EnemyShortInfo>(\n\titems: T[],\n\tlocItems: Record<string, string>,\n): T[] {\n\tlet resItems = items\n\tfor (let i = 0; i < items.length; i++) {\n\t\tconst locs = locItems[items[i].code]\n\t\tif (locs) {\n\t\t\tif (resItems === items) resItems = items.slice()\n\t\t\tresItems[i] = { ...items[i], locations: decodeLocations(locs) }\n\t\t}\n\t}\n\treturn resItems\n}\n","import { GI_WeaponTypeCode } from '#src/../../lib/genshin'\r\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\r\nimport { weaponTypes } from '#src/utils/weapons'\r\n\r\nexport function WeaponTypeFilter({\r\n\tselectedWeaponTypeCode,\r\n\tonTypeCodeSelect,\r\n\tclasses = '',\r\n}: {\r\n\tselectedWeaponTypeCode: GI_WeaponTypeCode | null\r\n\tonTypeCodeSelect: (typeCode: GI_WeaponTypeCode) => unknown\r\n\tclasses?: string\r\n}): JSX.Element {\r\n\treturn (\r\n\t\t<div className={classes}>\r\n\t\t\t{weaponTypes.map(wt => (\r\n\t\t\t\t<ItemAvatar\r\n\t\t\t\t\tclasses={`small-avatar bg-secondary p-1 m-1 ${\r\n\t\t\t\t\t\tselectedWeaponTypeCode && selectedWeaponTypeCode !== wt.code ? 'opacity-25' : ''\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\tkey={wt.code}\r\n\t\t\t\t\tsrc={wt.imgSrc}\r\n\t\t\t\t\tonClick={() => onTypeCodeSelect(wt.code)}\r\n\t\t\t\t/>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { GI_ElementCode, GI_WeaponTypeCode } from '#lib/genshin'\nimport { charactersShortList } from '#src/api/generated'\nimport { CharacterAvatar, ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { elements } from '#src/utils/elements'\nimport { WeaponTypeFilter } from '#src/components/weapon-type-filter'\n\nexport function CharacterPickerMobile() {\n\tconst [selectedElementCode, setSelectedElementCode] = useState<null | GI_ElementCode>(null)\n\tconst selectElement = el => setSelectedElementCode(selectedElementCode === el.code ? null : el.code)\n\tconst [selectedWeaponTypeCode, setSelectedWeaponTypeCode] = useState<null | GI_WeaponTypeCode>(null)\n\n\tconst selectWeaponTypeCode = code =>\n\t\tsetSelectedWeaponTypeCode(selectedWeaponTypeCode === code ? null : code)\n\n\tconst elementGroups = useMemo(() => {\n\t\tconst filteredElements = selectedElementCode\n\t\t\t? elements.filter(x => x.code === selectedElementCode)\n\t\t\t: elements\n\t\treturn filteredElements\n\t\t\t.map(element => ({\n\t\t\t\telement,\n\t\t\t\tcharacters: charactersShortList.filter(\n\t\t\t\t\tx =>\n\t\t\t\t\t\tx.elementCode === element.code &&\n\t\t\t\t\t\t(selectedWeaponTypeCode === null || x.weaponTypeCode === selectedWeaponTypeCode),\n\t\t\t\t),\n\t\t\t}))\n\t\t\t.filter(x => x.characters.length > 0)\n\t}, [selectedElementCode, selectedWeaponTypeCode])\n\n\tconst rows = elementGroups.map(({ element, characters }) => (\n\t\t<div className=\"row py-2\" key={element.code}>\n\t\t\t<div className=\"col-2 py-1\">\n\t\t\t\t<ItemAvatar isNoBg={true} classes=\"d-block mx-auto muted-icon\" src={element.imgSrc} />\n\t\t\t</div>\n\t\t\t<div className=\"col py-31\">\n\t\t\t\t{characters.map(x => (\n\t\t\t\t\t<CharacterAvatar\n\t\t\t\t\t\tcode={x.code}\n\t\t\t\t\t\trarity={x.rarity}\n\t\t\t\t\t\thref={'/builds/' + x.code}\n\t\t\t\t\t\tclasses={`m-1`}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t))\n\n\treturn (\n\t\t<div className=\"character-picker-mobile\">\n\t\t\t<div className=\"m-auto text-center my-3\">\n\t\t\t\t<div className=\"m-auto\">Filter </div>\n\t\t\t\t<div className=\"d-inline\">\n\t\t\t\t\t<div className=\"d-inline\">\n\t\t\t\t\t\t{elements.map(el => (\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tclasses={`small-avatar bg-secondary p-1 m-1 ${\n\t\t\t\t\t\t\t\t\tselectedElementCode && selectedElementCode !== el.code ? 'opacity-25' : ''\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\tkey={el.code}\n\t\t\t\t\t\t\t\tsrc={el.imgSrc}\n\t\t\t\t\t\t\t\tonClick={() => selectElement(el)} //todo почему без стрелки тайпскрипт не пускает?\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<br />\n\t\t\t\t\t<WeaponTypeFilter\n\t\t\t\t\t\tselectedWeaponTypeCode={selectedWeaponTypeCode}\n\t\t\t\t\t\tonTypeCodeSelect={selectWeaponTypeCode}\n\t\t\t\t\t\tclasses={'d-inline'}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{rows.length === 0 ? 'not yet' : rows}\n\t\t</div>\n\t)\n}\n","import { charactersShortList } from '#src/api/generated'\nimport { CharacterAvatar, ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { elements } from '#src/utils/elements'\nimport { GI_WeaponType, weaponTypes } from '#src/utils/weapons'\nimport { CharacterPickerMobile } from './mobile-character-picker'\n\nimport './character-picker.scss'\n\nfunction CharacterPickerDesktop({ weaponTypes }: { weaponTypes: GI_WeaponType[] }) {\n\treturn (\n\t\t<>\n\t\t\t{elements.map((el, i, arr) => {\n\t\t\t\tconst isLastRowClass = i + 1 === arr.length ? 'rounded-bottom' : ''\n\t\t\t\treturn (\n\t\t\t\t\t<div className=\"row\" key={el.code}>\n\t\t\t\t\t\t<div className=\"col col-2 pt-3 pb-2 opacity-50 rounded-start\">\n\t\t\t\t\t\t\t<ItemAvatar classes=\"d-block mx-auto\" isNoBg={true} src={el.imgSrc} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{weaponTypes.map(wType => (\n\t\t\t\t\t\t\t<div className={`col col-2 pt-3 pb-2 px-2 ${isLastRowClass}`} key={wType.code}>\n\t\t\t\t\t\t\t\t{charactersShortList\n\t\t\t\t\t\t\t\t\t.filter(x => x.elementCode === el.code && x.weaponTypeCode === wType.code)\n\t\t\t\t\t\t\t\t\t.map(x => (\n\t\t\t\t\t\t\t\t\t\t<CharacterAvatar\n\t\t\t\t\t\t\t\t\t\t\tkey={x.code}\n\t\t\t\t\t\t\t\t\t\t\tcode={x.code}\n\t\t\t\t\t\t\t\t\t\t\trarity={x.rarity}\n\t\t\t\t\t\t\t\t\t\t\thref={'/builds/' + x.code}\n\t\t\t\t\t\t\t\t\t\t\tclasses={`mb-1 me-1 mb-xxl-2 me-xxl-2`}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t})}\n\t\t</>\n\t)\n}\n\nexport function CharacterPicker() {\n\treturn (\n\t\t<div className=\"character-picker\">\n\t\t\t<div class=\"d-none d-xl-block container overflow-hidden big-table\">\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-2 pb-3 pt-2\"></div>\n\t\t\t\t\t{weaponTypes.map((wt, i) => (\n\t\t\t\t\t\t<div className=\"col col-2 pb-3 pt-2 rounded-top \" key={wt.code}>\n\t\t\t\t\t\t\t<ItemAvatar classes=\"d-block mx-auto\" isNoBg={true} src={wt.imgSrc} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t\t<CharacterPickerDesktop weaponTypes={weaponTypes} />\n\t\t\t</div>\n\t\t\t<div class=\"d-xl-none\">\n\t\t\t\t<CharacterPickerMobile />\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { useEffect, useMemo } from 'preact/hooks'\n\nimport { charactersShortList } from '#src/api/generated'\nimport { I18N_FAV_CHARACTERS } from '#src/i18n/i18n'\nimport { MAX_SMTHS_TO_STORE } from '#src/modules/builds/common'\nimport { useVersionedStorage } from '#src/utils/hooks'\nimport { SV_FAV_CHAR_CODES } from '#src/utils/local-storage-keys'\nimport { CharacterAvatar } from '../item-cards/item-avatars'\n\nconst shortListReversed = charactersShortList.reverse()\nexport function FavoriteCharacters({\n\tclasses = '',\n\tonCharacterSelect,\n\tshoudSelectFirst,\n\tnavigateToCharacter,\n\tselectedCharacterCode,\n\tblockLabel = I18N_FAV_CHARACTERS,\n}: {\n\tclasses?: string\n\tonCharacterSelect?(characterCode: string): void\n\tshoudSelectFirst?: boolean\n\tnavigateToCharacter: boolean\n\tselectedCharacterCode?: string\n\tblockLabel?: string\n}): JSX.Element {\n\tconst [favCharCodes] = useVersionedStorage(SV_FAV_CHAR_CODES)\n\t//todo sort characters by release date\n\tconst charactersShortListCodes = useMemo(\n\t\t() => shortListReversed.map(c => c.code).filter(c => (~favCharCodes.indexOf(c) ? false : c)),\n\t\t[favCharCodes],\n\t)\n\tconst characterCodes =\n\t\tfavCharCodes.length < MAX_SMTHS_TO_STORE\n\t\t\t? favCharCodes.concat(charactersShortListCodes.slice(0, MAX_SMTHS_TO_STORE - favCharCodes.length))\n\t\t\t: favCharCodes.slice(0, MAX_SMTHS_TO_STORE)\n\t// const optsForSelect = useMemo(\n\t// \t//todo выпилить или вставить нормальные имена\n\t// \t() =>\n\t// \t\t(characterCodes.length > 4 ? characterCodes.slice(4, characterCodes.length) : []).map(c => {\n\t// \t\t\treturn { title: c, code: c }\n\t// \t\t}),\n\t// \t[characterCodes],\n\t// )\n\t// const onSelectViaSelect = useCallback(\n\t// \topt => {\n\t// \t\tonCharacterSelect && onCharacterSelect(opt.code)\n\t// \t},\n\t// \t[onCharacterSelect],\n\t// )\n\n\tuseEffect(() => {\n\t\tshoudSelectFirst && onCharacterSelect && onCharacterSelect(characterCodes[0])\n\t}, [onCharacterSelect, characterCodes, shoudSelectFirst])\n\n\tconst charactersElems = useMemo(\n\t\t() =>\n\t\t\tcharacterCodes.map(code => (\n\t\t\t\t<CharacterAvatar\n\t\t\t\t\tcode={code}\n\t\t\t\t\t// rarity={charactersShortList.find(x => x.code === code)?.rarity ?? 5}\n\t\t\t\t\tclasses={`me-1 small-avatar ${\n\t\t\t\t\t\tselectedCharacterCode && selectedCharacterCode !== code && 'opacity-50'\n\t\t\t\t\t}`}\n\t\t\t\t\tkey={code}\n\t\t\t\t\thref={navigateToCharacter ? '/builds/' + code : undefined}\n\t\t\t\t\tonClick={() => onCharacterSelect && onCharacterSelect(code)}\n\t\t\t\t/>\n\t\t\t)),\n\t\t[characterCodes, onCharacterSelect, navigateToCharacter, selectedCharacterCode],\n\t)\n\treturn (\n\t\t<div className={`favorite-characters ${classes}`}>\n\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{blockLabel}:</label>\n\t\t\t<br className=\"d-xl-none\" />\n\t\t\t{charactersElems}\n\t\t\t{/* {optsForSelect.length ? (\n\t\t\t\t<SimpleSelect\n\t\t\t\t\tclasses=\"d-inline w-auto align-top\"\n\t\t\t\t\toptions={optsForSelect}\n\t\t\t\t\tonOptionSelect={onSelectViaSelect}\n\t\t\t\t\tselectedOption={null}\n\t\t\t\t/>\n\t\t\t) : null} */}\n\t\t</div>\n\t)\n}\n","import './characters.scss'\n\nexport function CharacterPortrait({ src, classes = '' }: { src: string; classes?: string }): JSX.Element {\n\treturn <img className={`character-portrait ${classes}`} src={src} />\n}\n","import { useCallback, useMemo } from 'preact/hooks'\n\nimport { arrOrItemToArr } from '#lib/utils/collections'\nimport { CharacterFullInfoWithRelated } from '#src/../../lib/parsing/combine'\nimport { getAllRelated, MapAllByCode } from '#src/api/utils'\nimport { BlockHeader } from '#src/components/block-header'\nimport { CharacterPortrait } from '#src/components/characters'\nimport { CentredSpinner } from '#src/components/placeholders'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport { OtherItemCard, WeaponCard } from '#src/containers/item-cards/dd-cards'\nimport { ItemAvatar, ItemsDataContext, LabeledItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport {\n\tI18N_ART_STATS_PRIORITY,\n\tI18N_ART_TYPE,\n\tI18N_ARTIFACTS,\n\tI18N_ASC_MATERIALS,\n\tI18N_BACK,\n\tI18N_CONJUCTIONS,\n\tI18N_NOTES,\n\tI18N_STAT_NAME,\n\tI18N_SUBSTATS_PRIORITY,\n\tI18N_TALENT_NAME,\n\tI18N_TALENTS_PRIORITY,\n\tI18N_WEAPON_REFINE,\n\tI18N_WEAPON_STACKS_COUNT,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { A } from '#src/routes/router'\nimport { getArtifactTypeIconSrc } from '#src/utils/artifacts'\nimport {\n\tgetCharacterAvatarLargeSrc,\n\tgetCharacterPortraitSrc,\n\tgetCharacterSilhouetteSrc,\n} from '#src/utils/characters'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { getWeaponIconSrc } from '#src/utils/weapons'\nimport {\n\tBuildRoleOrDummy,\n\tCIRCLET_GOBLET_SANDS,\n\tgenArtifactAdvice,\n\tgenArtMainStatDetail,\n\tgenNotes,\n\tgenSeeCharNotes,\n\tgenSimpleList,\n\tgetRoleData,\n\tItemsJoinerWrap,\n\tItemsListGroupWrap,\n\tmakeRoleTitle,\n\tnotesToJSX,\n\tToggleCharFav,\n} from './common'\n\nimport './character-build-detailed.scss'\n\nexport function CharacterBuildDetailed({\n\tbuild,\n\tisUpdating,\n}: {\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>\n\tisUpdating: boolean\n}): JSX.Element {\n\tconst roleTabs: BuildRoleOrDummy[] = build.character.roles\n\tconst characterCode = build.character.code\n\tconst [selectedRoleTab, setSelectedRoleTab] = useSelectable(roleTabs, [characterCode])\n\tconst goBack = useCallback(() => {\n\t\thistory.back()\n\t}, [])\n\tconst weaponListBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\t\treturn role.weapons.advices.map((advice, i) => {\n\t\t\tconst isInList = advice.similar.length > 1\n\t\t\tconst map = advice.similar.map((item, i) => {\n\t\t\t\tconst weapon = build.weapons.find(x => x.code === item.code)\n\t\t\t\tif (!weapon) return null\n\t\t\t\tconst isLastInList = i >= advice.similar.length - 1\n\t\t\t\treturn (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<LabeledItemAvatar\n\t\t\t\t\t\t\timgSrc={getWeaponIconSrc(weapon.code)}\n\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\tweapon.name +\n\t\t\t\t\t\t\t\t(item.refine === null ? '' : ` [${I18N_WEAPON_REFINE(item.refine)}]`) +\n\t\t\t\t\t\t\t\t(item.stacks === null ? '' : ` (${I18N_WEAPON_STACKS_COUNT(item.stacks)})`)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\tavatarClasses=\"with-padding\"\n\t\t\t\t\t\t\tclasses={`small ${!isInList || isLastInList ? 'mb-1' : ''}`}\n\t\t\t\t\t\t\tddComponent={<WeaponCard weapon={weapon} related={build.maps} />}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{genNotes(item)}\n\t\t\t\t\t\t{genSeeCharNotes(item)}\n\t\t\t\t\t\t{isInList && !isLastInList && (\n\t\t\t\t\t\t\t<ItemsJoinerWrap>{I18N_CONJUCTIONS.or}</ItemsJoinerWrap>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</>\n\t\t\t\t)\n\t\t\t})\n\t\t\treturn (\n\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t{isInList ? <ItemsListGroupWrap>{map}</ItemsListGroupWrap> : map}\n\t\t\t\t</li>\n\t\t\t)\n\t\t})\n\t}, [build, selectedRoleTab])\n\n\tconst artifactsListBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\n\t\treturn role.artifacts.sets.map((set, i) => {\n\t\t\treturn (\n\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t{genArtifactAdvice(set.arts, build)}\n\t\t\t\t\t{genNotes(set)}\n\t\t\t\t\t{genSeeCharNotes(set)}\n\t\t\t\t</li>\n\t\t\t)\n\t\t})\n\t}, [build, selectedRoleTab])\n\tconst artifactStatsAndSkillsBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<BlockHeader>{I18N_ART_STATS_PRIORITY}</BlockHeader>\n\t\t\t\t<ul className=\"mb-1 list-unstyled ms-1 small\">\n\t\t\t\t\t{CIRCLET_GOBLET_SANDS.map(ac => (\n\t\t\t\t\t\t<li className=\"my-1 ms-1\">\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tsrc={getArtifactTypeIconSrc(ac)}\n\t\t\t\t\t\t\t\tisNoBg={true}\n\t\t\t\t\t\t\t\tclasses=\"small-avatar small with-padding align-middle\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<b className=\"text-muted\">{I18N_ART_TYPE(ac)} — </b>\n\t\t\t\t\t\t\t{genArtMainStatDetail(role, ac)}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t))}\n\t\t\t\t</ul>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.mainStats.notes)} {genSeeCharNotes(role.mainStats)}\n\t\t\t\t</div>\n\t\t\t\t<BlockHeader classes=\"mt-3\">{I18N_SUBSTATS_PRIORITY}</BlockHeader>\n\t\t\t\t<ol className=\"mb-1 small\">\n\t\t\t\t\t{role.subStats.advices.map(advice => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t{genSimpleList(advice.codes.map(I18N_STAT_NAME))} {genNotes(advice)}\n\t\t\t\t\t\t\t\t{genSeeCharNotes(advice)}\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.subStats.notes)} {genSeeCharNotes(role.subStats)}\n\t\t\t\t</div>\n\t\t\t\t<BlockHeader classes=\"mt-3\">{I18N_TALENTS_PRIORITY}</BlockHeader>\n\t\t\t\t<ol className=\"small\">\n\t\t\t\t\t{role.talents.advices.map(advice => {\n\t\t\t\t\t\treturn <li>{arrOrItemToArr(advice).map(I18N_TALENT_NAME).join(', ')}</li>\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.talents.notes)} {genSeeCharNotes(role.subStats)}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst notesBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className=\"mb-2\">{notesToJSX(role.tips)}</div>\n\t\t\t\t<div className=\"mb-2\">{notesToJSX(role.notes)}</div>\n\t\t\t\t<div>{notesToJSX(build.character.credits)}</div>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst materialsBlock = useMemo(() => {\n\t\tconst materials = getAllRelated(build.maps.items, build.character.materialCodes)\n\t\treturn (\n\t\t\t<div className=\"w-100 d-flex flex-wrap justify-content-between\">\n\t\t\t\t{materials.map(m => (\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 mx-1 small-avatar with-padding\"\n\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\tddComponent={<OtherItemCard item={m} related={build.maps} />}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t)\n\t}, [build])\n\tconst CharacterDetailDesktop = (\n\t\t<div className=\"d-none d-xl-block\">\n\t\t\t<div className=\"container\">\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-3 p-0\">\n\t\t\t\t\t\t<button className=\"btn btn-secondary align-self-center\" onClick={goBack}>\n\t\t\t\t\t\t\t<span className=\"fs-4 lh-1 opacity-75\">‹ </span> {I18N_BACK}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col col-9\">\n\t\t\t\t\t\t<Tabs\n\t\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-3 pt-3\">\n\t\t\t\t\t\t<div className=\"position-relative\">\n\t\t\t\t\t\t\t<CharacterPortrait src={getCharacterPortraitSrc(characterCode)} classes=\"w-100\" />\n\t\t\t\t\t\t\t<div className=\"mt-3\">{materialsBlock}</div>\n\t\t\t\t\t\t\t<ToggleCharFav\n\t\t\t\t\t\t\t\tclasses=\"fs-3 position-absolute top-0 end-0\"\n\t\t\t\t\t\t\t\tcharacterCode={characterCode}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col col-9\">\n\t\t\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_WEAPONS}</BlockHeader>\n\t\t\t\t\t\t\t\t<ol className=\"items-list\">{weaponListBlock}</ol>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_ARTIFACTS}</BlockHeader>\n\t\t\t\t\t\t\t\t<ol className=\"items-list\">{artifactsListBlock}</ol>\n\t\t\t\t\t\t\t\t<div></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">{artifactStatsAndSkillsBlock}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"w-100\">\n\t\t\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_NOTES}</BlockHeader>\n\t\t\t\t\t\t\t\t<div className=\"text-muted\">{notesBlock}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n\tconst CharacterDetailMobile = (\n\t\t<div className=\"d-xl-none\">\n\t\t\t<CharacterPortrait\n\t\t\t\tsrc={getCharacterSilhouetteSrc(characterCode)}\n\t\t\t\tclasses=\"w-75 character-portrait-mobile\"\n\t\t\t/>\n\t\t\t<BtnTabGroup\n\t\t\t\ttabs={roleTabs}\n\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\tclasses=\"w-100 btn-group-sm mt-3 mb-0\"\n\t\t\t/>\n\t\t\t<div className=\"\">\n\t\t\t\t<div className=\"my-3\">\n\t\t\t\t\t<BlockHeader>{I18N_ASC_MATERIALS}</BlockHeader>\n\t\t\t\t\t{materialsBlock}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-3\">\n\t\t\t\t\t<BlockHeader>{I18N_ARTIFACTS}</BlockHeader>\n\t\t\t\t\t<ol className=\"items-list\">{artifactsListBlock}</ol>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-3\">{artifactStatsAndSkillsBlock}</div>\n\t\t\t\t<div className=\"my-3\">\n\t\t\t\t\t<BlockHeader>{I18N_WEAPONS}</BlockHeader>\n\t\t\t\t\t<ol className=\"items-list\">{weaponListBlock}</ol>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<BlockHeader>{I18N_NOTES}</BlockHeader>\n\t\t\t\t<div className=\"opacity-75\">{notesBlock}</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n\treturn (\n\t\t<ItemsDataContext.Provider value={build.maps}>\n\t\t\t<div className=\"character-build-detailed mt-2 mb-3 position-relative\">\n\t\t\t\t<div className=\"d-flex d-xl-none mt-3\">\n\t\t\t\t\t<A className=\"btn btn-secondary align-self-center\" type=\"submit\" href=\"/builds\">\n\t\t\t\t\t\t<span className=\"fs-4 lh-1 opacity-75\">‹ </span> {I18N_BACK}\n\t\t\t\t\t</A>\n\t\t\t\t\t<h5 className=\"ps-3 pe-1 m-0 align-self-center w-50 d-inline-block overflow-hidden text-truncate text-wrap\">\n\t\t\t\t\t\t{build.character.name}\n\t\t\t\t\t</h5>\n\t\t\t\t\t<div className=\"align-self-end ms-auto d-flex\">\n\t\t\t\t\t\t<ToggleCharFav classes=\"fs-3\" characterCode={characterCode} />\n\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\tsrc={getCharacterAvatarLargeSrc(characterCode)}\n\t\t\t\t\t\t\tclasses=\"large-avatar mt-n5 align-self-end\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{isUpdating ? <CentredSpinner /> : null}\n\t\t\t\t<div className={isUpdating ? 'opacity-50 pe-none' : ''}>\n\t\t\t\t\t{CharacterDetailDesktop}\n\t\t\t\t\t{CharacterDetailMobile}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</ItemsDataContext.Provider>\n\t)\n}\n","import { useState } from 'preact/hooks'\r\n\r\ninterface AccordionItem {\r\n\tcode: string\r\n\ttitle: string\r\n\tcontent: JSX.Element\r\n}\r\nexport function Accordion({\r\n\tclasses = '',\r\n\texpandedItemCode,\r\n\titems,\r\n}: {\r\n\tclasses?: string\r\n\texpandedItemCode?: string\r\n\titems: AccordionItem[]\r\n}): JSX.Element {\r\n\tconst [expandedItemCodeLocal, setexpandedItemCode] = useState<string | undefined>(expandedItemCode)\r\n\treturn (\r\n\t\t<div className={`accordion ${classes}`}>\r\n\t\t\t{items.map(ai => {\r\n\t\t\t\tconst isThisExpanded = expandedItemCodeLocal === ai.code\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"accordion-item\">\r\n\t\t\t\t\t\t<h2 className=\"accordion-header\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName={`accordion-button ${isThisExpanded ? '' : 'collapsed'}`}\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tonClick={() => setexpandedItemCode(isThisExpanded ? undefined : ai.code)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ai.title}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t{isThisExpanded ? (\r\n\t\t\t\t\t\t\t<div className={`accordion-collapse collapse show`}>\r\n\t\t\t\t\t\t\t\t<div className=\"accordion-body\">{ai.content}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useCallback, useEffect, useMemo, useState } from 'preact/hooks'\n\nimport { ArtifactRegularInfo } from '#lib/parsing/combine'\nimport { GI_ARTIFACT_TYPE_CODES, GI_ArtifactTypeCode } from '#src/../../lib/genshin'\nimport { apiGetArtifact } from '#src/api/endpoints'\nimport { getAllRelated } from '#src/api/utils'\nimport { Accordion } from '#src/components/accordion'\nimport { BlockHeader } from '#src/components/block-header'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { CentredSpinner, Spinner } from '#src/components/placeholders'\nimport { BtnTabGroup } from '#src/components/tabs'\nimport {\n\tI18N_ART_TYPE,\n\tI18N_COLLAPSE,\n\tI18N_ITEM_STORY,\n\tI18N_MAIN_INFO,\n\tI18N_PIECE_BONUS,\n\tI18N_PIECES_BONUS,\n} from '#src/i18n/i18n'\nimport { notesToJSX } from '#src/modules/builds/common'\nimport { ARTIFACT_ROW_CARD_HASH_KEY, genEquipmentHash } from '#src/modules/equipment/common'\nimport { getArtifactIconLargeSrc, getArtifactIconSrc } from '#src/utils/artifacts'\nimport { isLoaded, useFetch, useHashValue, useScrollTo } from '#src/utils/hooks'\nimport { BULLET, DASH, ELLIPSIS } from '#src/utils/typography'\nimport { addMarkerGroupsByDomains, addMarkerGroupsByEnemies, CardMap, CardMapMarkerGroup } from '../card-map'\nimport { RecommendedTo } from '../common'\nimport { ItemAvatar } from '../item-avatars'\n\nimport './line-cards.scss'\n\nconst dummyMarkerGroups: CardMapMarkerGroup[] = [\n\t{\n\t\tcode: '',\n\t\ttitle: ELLIPSIS,\n\t\tmarkers: [{ mapCode: 'teyvat', x: 0, y: 0, icon: '' }],\n\t},\n]\n\ntype ArtifactRowProps = {\n\tartifact: ArtifactRegularInfo\n\tgroup: number\n\tisExpanded: boolean\n}\ntype ArtTypeTab = { code: GI_ArtifactTypeCode; title: string }\nconst artTypeTabs: ArtTypeTab[] = GI_ARTIFACT_TYPE_CODES.map(at => {\n\treturn { code: at, title: I18N_ART_TYPE(at) }\n})\n\nfunction ArtifactCardLine({\n\tartifact,\n\tonClose,\n}: {\n\tartifact: ArtifactRegularInfo\n\tonClose: () => unknown\n}): JSX.Element {\n\tconst [selectedArtTypeTab, setSelectedArtTypeTab] = useState<ArtTypeTab>(artTypeTabs[0])\n\n\tconst artifactFull = useFetch(sig => apiGetArtifact(artifact.code, sig), [artifact])\n\tconst artTypeTabsFiltered = useMemo(() => {\n\t\treturn isLoaded(artifactFull)\n\t\t\t? artTypeTabs.filter(att => artifactFull.artifact.pieces[att.code])\n\t\t\t: artTypeTabs\n\t}, [artifactFull])\n\n\tuseEffect(() => {\n\t\tsetSelectedArtTypeTab(artTypeTabsFiltered[0])\n\t}, [artTypeTabsFiltered])\n\n\tconst dataForMap = useMemo(() => {\n\t\tif (!isLoaded(artifactFull)) return { markerGroups: dummyMarkerGroups }\n\t\tconst srcs = artifact.obtainSources\n\t\tconst markerGroups: CardMapMarkerGroup[] = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(artifactFull.maps.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(artifactFull.maps.enemies, srcs.enemyCodes))\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: artifact,\n\t\t\t\timgSrc: getArtifactIconSrc(artifact.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [artifactFull, artifact])\n\tconst mainInfoColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div>\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 me-2 large-avatar float-start\"\n\t\t\t\t\t\trarity={artifact.rarity}\n\t\t\t\t\t\tsrc={getArtifactIconLargeSrc(artifact.code)}\n\t\t\t\t\t/>\n\t\t\t\t\t<h4 className=\"mb-0\">{artifact.name}</h4>\n\t\t\t\t\t<div className=\"overflow-hidden\">\n\t\t\t\t\t\t<span className=\"mb-2 text-muted\">\n\t\t\t\t\t\t\t{/* {BULLET} {artifact.obtainSources.map(I18N_WEAPON_OBTAIN_SOURCE_NAME).join(', ')} */}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mt-1 mb-2\">\n\t\t\t\t\t<RecommendedTo\n\t\t\t\t\t\tnavigateToCharacter={true}\n\t\t\t\t\t\tisAvatarWithBorder={true}\n\t\t\t\t\t\tcharCodes={artifact.recommendedTo}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-fill overflow-auto small lh-sm mt-1\">\n\t\t\t\t\t{artifact.sets[1] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECE_BONUS(1)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(artifact.sets[1])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{artifact.sets[2] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(2)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(artifact.sets[2])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{artifact.sets[4] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(4)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(artifact.sets[4])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t)\n\t}, [artifact])\n\tconst loreInfoColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className=\"opacity-75\">{I18N_ITEM_STORY}</div>\n\t\t\t\t{isLoaded(artifactFull) ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\t\ttabs={artTypeTabsFiltered}\n\t\t\t\t\t\t\tonTabSelect={setSelectedArtTypeTab}\n\t\t\t\t\t\t\tselectedTab={selectedArtTypeTab}\n\t\t\t\t\t\t\tclasses=\"w-100 my-1 btn-group-sm\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div className=\"fst-italic my-1 small lh-sm text-muted\">\n\t\t\t\t\t\t\t{notesToJSX(\n\t\t\t\t\t\t\t\tartifactFull.artifact.pieces[selectedArtTypeTab.code]?.description || null,\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex-fill my-1 overflow-auto small lh-sm opacity-75\">\n\t\t\t\t\t\t\t{notesToJSX(artifactFull.artifact.pieces[selectedArtTypeTab.code]?.story || null)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\t<Spinner />\n\t\t\t\t)}\n\t\t\t</>\n\t\t)\n\t}, [artifactFull, selectedArtTypeTab, setSelectedArtTypeTab, artTypeTabsFiltered])\n\tconst locationColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<div className=\"d-flex flex-fill flex-column location-col-inner position-relative\">\n\t\t\t\t{dataForMap.markerGroups === dummyMarkerGroups ? (\n\t\t\t\t\t<CentredSpinner />\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className=\"flex-fill mt-2\">\n\t\t\t\t\t\t\t<CardMap isFatHead={true} {...dataForMap} classes=\"h-100\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t)\n\t}, [dataForMap])\n\n\tconst cellClass = 'w-33 d-flex px-2 pb-3 pt-2 flex-column'\n\tconst forAccordion = useMemo(() => {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttitle: `${artifact.name} ${BULLET} ${I18N_MAIN_INFO}`,\n\t\t\t\tcode: 'mainInfoColInner',\n\t\t\t\tcontent: mainInfoColInner,\n\t\t\t},\n\t\t\t{ title: I18N_ITEM_STORY, code: 'loreInfoColInner', content: loreInfoColInner },\n\t\t\t{ title: 'todo', code: 'locationColInner', content: locationColInner },\n\t\t]\n\t}, [mainInfoColInner, loreInfoColInner, locationColInner, artifact])\n\treturn (\n\t\t<MobileDesktopSwitch\n\t\t\tchildrenDesktop={\n\t\t\t\t<div className=\"bg-dark rounded-start border border-secondary d-flex w-100 line-card-desktop\">\n\t\t\t\t\t<div className={cellClass}>{mainInfoColInner}</div>\n\t\t\t\t\t<div className={cellClass}>\n\t\t\t\t\t\t<div className=\"invisible pe-none\">\n\t\t\t\t\t\t\t{/* to make the same padding-top as on the next cell */}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"btn-close btn-sm ms-auto \"\n\t\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{loreInfoColInner}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={cellClass}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn-close btn-sm ms-auto\"\n\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t></button>\n\t\t\t\t\t\t{locationColInner}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tchildrenMobile={\n\t\t\t\t<>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"ms-auto d-flex justify-content-end align-items-center mb-2 me-3\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t>\n\t\t\t\t\t\t<label className=\"small text-muted c-pointer\">{I18N_COLLAPSE}</label>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn-close btn-sm d-inline-block ms-1\"\n\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"bg-dark rounded border overflow-hidden border-secondary d-flex w-100 line-card-mobile\">\n\t\t\t\t\t\t<Accordion\n\t\t\t\t\t\t\tclasses=\"accordion-flush w-100\"\n\t\t\t\t\t\t\titems={forAccordion}\n\t\t\t\t\t\t\texpandedItemCode={forAccordion[0].code}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t}\n\t\t/>\n\t)\n}\n\nexport function ArtifactCardTableRow({ artifact, isExpanded, group }: ArtifactRowProps): JSX.Element {\n\tconst [, setSelectedArtifactCode] = useHashValue<string | null>(ARTIFACT_ROW_CARD_HASH_KEY, null)\n\n\tconst toggleExpand = useCallback(() => {\n\t\tisExpanded ? setSelectedArtifactCode(null) : setSelectedArtifactCode(artifact.code)\n\t}, [isExpanded, setSelectedArtifactCode, artifact.code])\n\tconst bgClass = group === 1 ? 'bg-dark' : 'bg-secondary'\n\n\tconst [cardRef] = useScrollTo<HTMLTableCellElement>(isExpanded)\n\n\tconst expandedRow = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colSpan={5} className=\"p-2\" ref={cardRef}>\n\t\t\t\t\t\t<ArtifactCardLine artifact={artifact} onClose={toggleExpand} />\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</>\n\t\t)\n\t}, [artifact, toggleExpand, cardRef])\n\tconst collapsededRow = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<tr className={'small lh-sm ' + bgClass}>\n\t\t\t\t\t<td colSpan={1}>\n\t\t\t\t\t\t<div className=\"d-flex c-pointer\" onClick={toggleExpand}>\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tclasses=\"me-2 small-avatar align-self-center flex-shrink-0\"\n\t\t\t\t\t\t\t\trarity={artifact.rarity}\n\t\t\t\t\t\t\t\tsrc={getArtifactIconLargeSrc(artifact.code)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref={genEquipmentHash('artifact', artifact.code)}\n\t\t\t\t\t\t\t\tclassName=\"align-self-center\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{artifact.name}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td className=\"opacity-75\">{artifact.sets[4] ? notesToJSX(artifact.sets[4]) : DASH}</td>\n\t\t\t\t\t<MobileDesktopSwitch\n\t\t\t\t\t\tchildrenDesktop={\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<td className=\"opacity-75\">\n\t\t\t\t\t\t\t\t\t{artifact.sets[2] ? notesToJSX(artifact.sets[2]) : DASH}\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td className=\"opacity-75\">\n\t\t\t\t\t\t\t\t\t{artifact.sets[1] ? notesToJSX(artifact.sets[1]) : DASH}\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchildrenMobile={null}\n\t\t\t\t\t/>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div className=\"c-pointer\" onClick={toggleExpand}>\n\t\t\t\t\t\t\t<button className=\"btn\">\n\t\t\t\t\t\t\t\t<span className=\"btn-expand-inner\"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</>\n\t\t)\n\t}, [artifact, toggleExpand, bgClass])\n\treturn isExpanded ? expandedRow : collapsededRow\n}\n","import { apiGetArtifacts } from '#src/api/endpoints'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { Spinner } from '#src/components/placeholders'\nimport { ArtifactCardTableRow } from '#src/containers/item-cards/line-cards/artifact-card'\nimport { I18N_NAME, I18N_PIECES_BONUS, I18N_PIECE_BONUS } from '#src/i18n/i18n'\nimport { isLoaded, useFetch, useHashValue } from '#src/utils/hooks'\nimport { useMemo } from 'preact/hooks'\nimport { ARTIFACT_ROW_CARD_HASH_KEY } from './common'\n\nexport function ArtifactsList(): JSX.Element {\n\tconst artifacts = useFetch(apiGetArtifacts, [])\n\tconst [selectedArtifactCode] = useHashValue(ARTIFACT_ROW_CARD_HASH_KEY, null)\n\n\tconst artifactsSorted = useMemo(() => {\n\t\tif (!isLoaded(artifacts)) return []\n\t\tconst artifactsLocal = [...artifacts]\n\t\tartifactsLocal.sort((a, b) => b.rarity - a.rarity)\n\t\treturn artifactsLocal\n\t}, [artifacts])\n\tif (!isLoaded(artifacts)) return <Spinner />\n\treturn (\n\t\t<>\n\t\t\t<table className=\"table table-sm\">\n\t\t\t\t<thead className=\"bg-dark\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_NAME}</th>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_PIECES_BONUS(4)}</th>\n\t\t\t\t\t\t<MobileDesktopSwitch\n\t\t\t\t\t\t\tchildrenDesktop={\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<th scope=\"col\">{I18N_PIECES_BONUS(2)}</th>\n\t\t\t\t\t\t\t\t\t<th scope=\"col\">{I18N_PIECE_BONUS(1)}</th>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchildrenMobile={null}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<th scope=\"col\"></th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{isLoaded(artifacts)\n\t\t\t\t\t\t? artifactsSorted.map((a, i) => (\n\t\t\t\t\t\t\t\t<ArtifactCardTableRow\n\t\t\t\t\t\t\t\t\tartifact={a}\n\t\t\t\t\t\t\t\t\tkey={a.code}\n\t\t\t\t\t\t\t\t\tgroup={i % 2}\n\t\t\t\t\t\t\t\t\tisExpanded={a.code === selectedArtifactCode}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t  ))\n\t\t\t\t\t\t: null}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</>\n\t)\n}\n","import { useCallback, useEffect, useMemo, useState } from 'preact/hooks'\n\nimport { ItemShortInfo, WeaponRegularInfo } from '#lib/parsing/combine'\nimport { apiGetWeapon } from '#src/api/endpoints'\nimport { getAllRelated } from '#src/api/utils'\nimport { Accordion } from '#src/components/accordion'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { CentredSpinner, Spinner } from '#src/components/placeholders'\nimport {\n\tI18N_ASC_MATERIALS,\n\tI18N_BASE_ATTACK,\n\tI18N_COLLAPSE,\n\tI18N_ITEM_STORY,\n\tI18N_MAIN_INFO,\n\tI18N_STAT_NAME,\n\tI18N_WEAPON_OBTAIN_SOURCE_NAME,\n} from '#src/i18n/i18n'\nimport { notesToJSX } from '#src/modules/builds/common'\nimport { genEquipmentHash, WEAPON_ROW_CARD_HASH_KEY } from '#src/modules/equipment/common'\nimport { isLoaded, useFetch, useHashValue, useScrollTo } from '#src/utils/hooks'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { BULLET, DASH, ELLIPSIS } from '#src/utils/typography'\nimport { getWeaponIconLageSrc } from '#src/utils/weapons'\nimport { addMarkerGroupsByDomains, addMarkerGroupsByEnemies, CardMap, CardMapMarkerGroup } from '../card-map'\nimport { AscMaterials, RecommendedTo } from '../common'\nimport { ItemAvatar } from '../item-avatars'\n\nimport './line-cards.scss'\n\ntype WeaponRowProps = {\n\tweapon: WeaponRegularInfo\n\tgroup: number\n\tisExpanded: boolean\n}\n\nconst dummyMarkerGroups: CardMapMarkerGroup[] = [\n\t{\n\t\tcode: '',\n\t\ttitle: ELLIPSIS,\n\t\tmarkers: [{ mapCode: 'teyvat', x: 0, y: 0, icon: '' }],\n\t},\n]\n\nfunction WeaponCardLine({\n\tweapon,\n\tonClose,\n}: {\n\tweapon: WeaponRegularInfo\n\tonClose: () => unknown\n}): JSX.Element {\n\tconst weaponFull = useFetch(sig => apiGetWeapon(weapon.code, sig), [weapon])\n\tconst [materialOnMap, setMaterialOnMap] = useState<ItemShortInfo | undefined>()\n\tconst dataForMap = useMemo(() => {\n\t\tif (!isLoaded(weaponFull) || !materialOnMap) return { markerGroups: dummyMarkerGroups }\n\t\tconst srcs = materialOnMap.obtainSources\n\t\tconst markerGroups: CardMapMarkerGroup[] = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(weaponFull.maps.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(weaponFull.maps.enemies, srcs.enemyCodes))\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: materialOnMap,\n\t\t\t\timgSrc: getItemIconSrc(materialOnMap.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [weaponFull, materialOnMap])\n\n\tconst materials = useMemo(() => {\n\t\tif (!isLoaded(weaponFull)) return []\n\t\treturn getAllRelated(weaponFull.maps.items, weaponFull.weapon.materialCodes)\n\t}, [weaponFull])\n\n\tuseEffect(() => {\n\t\tsetMaterialOnMap(materials[0])\n\t}, [materials])\n\n\tconst mainInfoColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div>\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 me-2 large-avatar float-start\"\n\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\tsrc={getWeaponIconLageSrc(weapon.code)}\n\t\t\t\t\t/>\n\t\t\t\t\t<h4 className=\"mb-0\">{weapon.name}</h4>\n\t\t\t\t\t<div className=\"overflow-hidden\">\n\t\t\t\t\t\t<span className=\"mb-2 text-muted\">\n\t\t\t\t\t\t\t{BULLET} {weapon.obtainSources.map(I18N_WEAPON_OBTAIN_SOURCE_NAME).join(', ')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t<div className=\"me-2\">\n\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_BASE_ATTACK}</div>\n\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t{weapon.atk.base} / {weapon.atk.max}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t{weapon.subStat && (\n\t\t\t\t\t\t<div className=\"ms-1\">\n\t\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_STAT_NAME(weapon.subStat.code)}</div>\n\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t{weapon.subStat.base} / {weapon.subStat.max}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mt-1\">\n\t\t\t\t\t<RecommendedTo\n\t\t\t\t\t\tisInline={true}\n\t\t\t\t\t\tnavigateToCharacter={true}\n\t\t\t\t\t\tisAvatarWithBorder={true}\n\t\t\t\t\t\tcharCodes={weapon.recommendedTo}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-fill overflow-auto small lh-sm\">{weapon.passiveStat}</div>\n\t\t\t</>\n\t\t)\n\t}, [weapon])\n\tconst loreInfoColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className=\"opacity-75\">{I18N_ITEM_STORY}</div>\n\t\t\t\t{isLoaded(weaponFull) ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className=\"fst-italic my-1 small lh-sm text-muted\">\n\t\t\t\t\t\t\t{weaponFull.weapon.description}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex-fill my-1 overflow-auto small lh-sm opacity-75\">\n\t\t\t\t\t\t\t{notesToJSX(weaponFull.weapon.story)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\t<Spinner />\n\t\t\t\t)}\n\t\t\t</>\n\t\t)\n\t}, [weaponFull])\n\tconst locationColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<div className=\"d-flex flex-fill flex-column location-col-inner position-relative\">\n\t\t\t\t{dataForMap.markerGroups === dummyMarkerGroups ? (\n\t\t\t\t\t<CentredSpinner />\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<AscMaterials\n\t\t\t\t\t\t\t\tmaterials={materials}\n\t\t\t\t\t\t\t\tselectedMat={materialOnMap}\n\t\t\t\t\t\t\t\tonMatSelect={setMaterialOnMap}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex-fill\">\n\t\t\t\t\t\t\t<CardMap isFatHead={true} isItemFavable={true} {...dataForMap} classes=\"h-100\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t)\n\t}, [dataForMap, materials, materialOnMap])\n\n\tconst cellClass = 'w-33 d-flex px-2 pb-3 pt-2 flex-column'\n\tconst forAccordion = useMemo(() => {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttitle: `${weapon.name} ${BULLET} ${I18N_MAIN_INFO}`,\n\t\t\t\tcode: 'mainInfoColInner',\n\t\t\t\tcontent: mainInfoColInner,\n\t\t\t},\n\t\t\t{ title: I18N_ITEM_STORY, code: 'loreInfoColInner', content: loreInfoColInner },\n\t\t\t{ title: I18N_ASC_MATERIALS, code: 'locationColInner', content: locationColInner },\n\t\t]\n\t}, [mainInfoColInner, loreInfoColInner, locationColInner, weapon])\n\treturn (\n\t\t<MobileDesktopSwitch\n\t\t\tchildrenDesktop={\n\t\t\t\t<div className=\"bg-dark rounded-start border border-secondary d-flex w-100 line-card-desktop\">\n\t\t\t\t\t<div className={cellClass}>{mainInfoColInner}</div>\n\t\t\t\t\t<div className={cellClass}>\n\t\t\t\t\t\t<div className=\"invisible pe-none\">\n\t\t\t\t\t\t\t{/* to make the same padding-top as on the next cell */}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"btn-close btn-sm ms-auto \"\n\t\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{loreInfoColInner}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={cellClass}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn-close btn-sm ms-auto\"\n\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t></button>\n\t\t\t\t\t\t{locationColInner}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tchildrenMobile={\n\t\t\t\t<>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"ms-auto d-flex justify-content-end align-items-center mb-2 me-3\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t>\n\t\t\t\t\t\t<label className=\"small text-muted c-pointer\">{I18N_COLLAPSE}</label>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn-close btn-sm d-inline-block ms-1\"\n\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"bg-dark rounded border overflow-hidden border-secondary d-flex w-100 line-card-mobile\">\n\t\t\t\t\t\t<Accordion\n\t\t\t\t\t\t\tclasses=\"accordion-flush w-100\"\n\t\t\t\t\t\t\titems={forAccordion}\n\t\t\t\t\t\t\texpandedItemCode={forAccordion[0].code}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t}\n\t\t/>\n\t)\n}\nexport function WeaponCardTableRow({ weapon, isExpanded, group }: WeaponRowProps): JSX.Element {\n\tconst [, setSelectedWeaponCode] = useHashValue<string | null>(WEAPON_ROW_CARD_HASH_KEY, null)\n\n\tconst toggleExpand = useCallback(() => {\n\t\tisExpanded ? setSelectedWeaponCode(null) : setSelectedWeaponCode(weapon.code)\n\t}, [isExpanded, setSelectedWeaponCode, weapon.code])\n\n\tconst [cardRef] = useScrollTo<HTMLTableCellElement>(isExpanded)\n\tconst bgClass = group === 1 ? 'bg-dark' : 'bg-secondary'\n\n\tconst expandedRow = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colSpan={6} className=\"p-2\" ref={cardRef}>\n\t\t\t\t\t\t<WeaponCardLine weapon={weapon} onClose={toggleExpand} />\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</>\n\t\t)\n\t}, [weapon, toggleExpand, cardRef])\n\tconst collapsededRow = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<tr className={'small lh-sm ' + bgClass}>\n\t\t\t\t\t<td colSpan={1}>\n\t\t\t\t\t\t<div className=\"d-flex c-pointer\" onClick={toggleExpand}>\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tclasses=\"me-2 small-avatar align-self-center flex-shrink-0\"\n\t\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\t\tsrc={getWeaponIconLageSrc(weapon.code)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<a href={genEquipmentHash('weapon', weapon.code)} className=\"align-self-center\">\n\t\t\t\t\t\t\t\t{weapon.name}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{weapon.atk.base} / {weapon.atk.max}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{weapon.subStat ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{I18N_STAT_NAME(weapon.subStat.code)} <br />\n\t\t\t\t\t\t\t\t{`${weapon.subStat.base} / ${weapon.subStat.max}`}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\tDASH\n\t\t\t\t\t\t)}\n\t\t\t\t\t</td>\n\t\t\t\t\t<MobileDesktopSwitch\n\t\t\t\t\t\tchildrenDesktop={\n\t\t\t\t\t\t\t<td className=\"opacity-75\">{weapon.passiveStat ? weapon.passiveStat : DASH}</td>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchildrenMobile={null}\n\t\t\t\t\t/>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div className=\"c-pointer\" onClick={toggleExpand}>\n\t\t\t\t\t\t\t<button className=\"btn\">\n\t\t\t\t\t\t\t\t<span className=\"btn-expand-inner\"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</>\n\t\t)\n\t}, [weapon, toggleExpand, bgClass])\n\treturn isExpanded ? expandedRow : collapsededRow\n}\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { GI_WeaponObtainSource, GI_WeaponTypeCode } from '#src/../../lib/genshin'\nimport { WeaponRegularInfo } from '#src/../../lib/parsing/combine'\nimport { arrSimpleUniq, toggleInArr } from '#src/../../lib/utils/collections'\nimport { apiGetWeapons } from '#src/api/endpoints'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { Spinner } from '#src/components/placeholders'\nimport { WeaponTypeFilter } from '#src/components/weapon-type-filter'\nimport { WeaponCardTableRow } from '#src/containers/item-cards/line-cards/weapon-card'\nimport {\n\tI18N_NAME,\n\tI18N_NOTHING_TO_SHOW,\n\tI18N_OBTAIN_SOURCES,\n\tI18N_RARITY,\n\tI18N_SECONDARY_STAT,\n\tI18N_SORT_BY,\n\tI18N_STAT_NAME,\n\tI18N_SUBSTAT,\n\tI18N_WEAPON_OBTAIN_SOURCE_NAME,\n\tI18N_WEAPON_TYPE,\n\tI18N_WEAPON_TYPE_FILTER_TIP,\n} from '#src/i18n/i18n'\nimport { isLoaded, useFetch, useHashValue, useUniqKey } from '#src/utils/hooks'\nimport { WEAPON_ROW_CARD_HASH_KEY } from './common'\n\nconst WEAPON_SORT_CODES = ['rarity', 'atk', 'subStat']\nconst WEAPON_SORT_NAMES = { rarity: I18N_RARITY, atk: I18N_STAT_NAME('atk'), subStat: I18N_SUBSTAT }\nconst WEAPON_SORT_FUNCS = {\n\trarity: (a: WeaponRegularInfo, b: WeaponRegularInfo) => {\n\t\treturn b.rarity - a.rarity\n\t},\n\tatk: (a: WeaponRegularInfo, b: WeaponRegularInfo) => {\n\t\treturn b.atk.max - a.atk.max\n\t},\n\tsubStat: (a: WeaponRegularInfo, b: WeaponRegularInfo) => {\n\t\treturn (b.subStat ? b.subStat.max : 0) - (a.subStat ? a.subStat.max : 0)\n\t},\n}\nfunction WeaponSort({\n\tselectedSortCode,\n\tonSortCodeSelect,\n\tclasses = '',\n}: {\n\tselectedSortCode: string\n\tonSortCodeSelect: (typeCode: string) => unknown\n\tclasses?: string\n}): JSX.Element {\n\tconst key = useUniqKey()\n\treturn (\n\t\t<div className={classes}>\n\t\t\t{WEAPON_SORT_CODES.map(c => (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"form-check form-check-inline c-pointer  pe-1\"\n\t\t\t\t\tkey={c}\n\t\t\t\t\tonClick={() => onSortCodeSelect(c)}\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"form-check-input c-pointer\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tname={`inlineRadioOptions-${key}`}\n\t\t\t\t\t\tid={`radio-${c}-${key}`}\n\t\t\t\t\t\tchecked={selectedSortCode === c}\n\t\t\t\t\t/>\n\t\t\t\t\t<label className=\"form-check-label c-pointer text-lowercase\" for={`radio-${c}-${key}`}>\n\t\t\t\t\t\t{WEAPON_SORT_NAMES[c]}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\ntype ObtainSourceForFilter = GI_WeaponObtainSource | 'other'\nconst WEAPON_FILTER_OBTAIN_SOURCE: ObtainSourceForFilter[] = [\n\t'wishes',\n\t'event-wishes',\n\t'events',\n\t'battle-pass',\n\t'in-game-shop',\n\t'forging',\n\t'other',\n]\ntype FilterOption<T> = { code: T; title: string }\n\nfunction WeaponFilter<T>({\n\tselectedSortCodes,\n\tonFilterCodeSelect,\n\tfilterVariants,\n\tclasses = '',\n}: {\n\tselectedSortCodes: T[]\n\tonFilterCodeSelect: (newSelectedCodes: T[]) => unknown\n\tfilterVariants: FilterOption<T>[]\n\tclasses?: string\n}): JSX.Element {\n\tconst key = useUniqKey()\n\treturn (\n\t\t<div className={classes}>\n\t\t\t{filterVariants.map(v => (\n\t\t\t\t<div className=\"form-check form-switch form-check-inline pe-1\" key={v.code}>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"form-check-input c-pointer\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\trole=\"switch\"\n\t\t\t\t\t\tid={`flexSwitch-${v.code}-${key}`}\n\t\t\t\t\t\tchecked={selectedSortCodes.includes(v.code)}\n\t\t\t\t\t\tonChange={() => onFilterCodeSelect(toggleInArr([...selectedSortCodes], v.code))}\n\t\t\t\t\t/>\n\t\t\t\t\t<label className=\"form-check-label c-pointer\" for={`flexSwitch-${v.code}-${key}`}>\n\t\t\t\t\t\t{v.title}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\nexport function WeaponsList() {\n\tconst [selectedWeaponTypeCode, setSelectedWeaponTypeCode] = useState<null | GI_WeaponTypeCode>(null)\n\tconst selectWeaponTypeCode = code =>\n\t\tsetSelectedWeaponTypeCode(selectedWeaponTypeCode === code ? null : code)\n\n\tconst [selectedSortCode, setSelectedSortCode] = useState<string>(WEAPON_SORT_CODES[0])\n\tconst [selectedWeaponCode] = useHashValue(WEAPON_ROW_CARD_HASH_KEY, null)\n\tconst [selectedObtainSourceCodes, setSelectedObtainSourceCodes] =\n\t\tuseState<ObtainSourceForFilter[]>(WEAPON_FILTER_OBTAIN_SOURCE)\n\n\tconst weapons = useFetch(apiGetWeapons, [])\n\tconst otherObtainSourceCodes = useMemo(() => {\n\t\tif (!isLoaded(weapons)) return []\n\t\tconst scs = weapons\n\t\t\t.reduce((p, c) => {\n\t\t\t\tp.push(c.obtainSources)\n\t\t\t\treturn p\n\t\t\t}, [] as GI_WeaponObtainSource[][])\n\t\t\t.flat()\n\t\treturn arrSimpleUniq(scs).filter(sc => !WEAPON_FILTER_OBTAIN_SOURCE.includes(sc))\n\t}, [weapons])\n\tconst weaponsFilteredSorted = useMemo(() => {\n\t\tif (!isLoaded(weapons)) return []\n\t\tconst weaponsLocal = weapons.filter(w => {\n\t\t\treturn (\n\t\t\t\t(selectedWeaponTypeCode ? w.typeCode === selectedWeaponTypeCode : true) && //по типу\n\t\t\t\t(w.obtainSources.find(s => selectedObtainSourceCodes.includes(s)) || //по основным сорсам\n\t\t\t\t\t(selectedObtainSourceCodes.includes('other')\n\t\t\t\t\t\t? w.obtainSources.find(s => otherObtainSourceCodes.includes(s))\n\t\t\t\t\t\t: false)) //по всем остальным сорсам\n\t\t\t)\n\t\t})\n\t\tweaponsLocal.sort(WEAPON_SORT_FUNCS[selectedSortCode])\n\t\treturn weaponsLocal\n\t}, [weapons, selectedWeaponTypeCode, selectedSortCode, selectedObtainSourceCodes, otherObtainSourceCodes])\n\tif (!isLoaded(weapons)) return <Spinner />\n\treturn (\n\t\t<>\n\t\t\t<div className=\"mb-2\">\n\t\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_OBTAIN_SOURCES}:</label>\n\t\t\t\t<WeaponFilter\n\t\t\t\t\tclasses=\"ms-1\"\n\t\t\t\t\tselectedSortCodes={selectedObtainSourceCodes}\n\t\t\t\t\tonFilterCodeSelect={setSelectedObtainSourceCodes}\n\t\t\t\t\tfilterVariants={WEAPON_FILTER_OBTAIN_SOURCE.map(s => {\n\t\t\t\t\t\treturn { code: s, title: I18N_WEAPON_OBTAIN_SOURCE_NAME(s) }\n\t\t\t\t\t})}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"mb-2\">\n\t\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_SORT_BY}:</label>\n\t\t\t\t<WeaponSort\n\t\t\t\t\tclasses=\"ms-1\"\n\t\t\t\t\tselectedSortCode={selectedSortCode}\n\t\t\t\t\tonSortCodeSelect={setSelectedSortCode}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"mb-2\">\n\t\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_WEAPON_TYPE}:</label>\n\t\t\t\t<div className=\"d-flex align-items-center\">\n\t\t\t\t\t<WeaponTypeFilter\n\t\t\t\t\t\tselectedWeaponTypeCode={selectedWeaponTypeCode}\n\t\t\t\t\t\tonTypeCodeSelect={selectWeaponTypeCode}\n\t\t\t\t\t/>\n\t\t\t\t\t<label className=\"text-muted\">{`${\n\t\t\t\t\t\tselectedWeaponTypeCode\n\t\t\t\t\t\t\t? I18N_WEAPON_TYPE_FILTER_TIP[selectedWeaponTypeCode]\n\t\t\t\t\t\t\t: I18N_WEAPON_TYPE_FILTER_TIP.everything\n\t\t\t\t\t} (${weaponsFilteredSorted.length})`}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<table className=\"table table-sm\">\n\t\t\t\t<thead className=\"bg-dark\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_NAME}</th>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_STAT_NAME('atk')}</th>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_SUBSTAT}</th>\n\t\t\t\t\t\t<MobileDesktopSwitch\n\t\t\t\t\t\t\tchildrenDesktop={<th scope=\"col\">{I18N_SECONDARY_STAT}</th>}\n\t\t\t\t\t\t\tchildrenMobile={null}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<th scope=\"col\"></th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{isLoaded(weapons)\n\t\t\t\t\t\t? weaponsFilteredSorted.map((w, i) => (\n\t\t\t\t\t\t\t\t<WeaponCardTableRow\n\t\t\t\t\t\t\t\t\tweapon={w}\n\t\t\t\t\t\t\t\t\tkey={w.code}\n\t\t\t\t\t\t\t\t\tgroup={i % 2}\n\t\t\t\t\t\t\t\t\tisExpanded={w.code === selectedWeaponCode}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t  ))\n\t\t\t\t\t\t: null}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t\t{isLoaded(weapons) && !weaponsFilteredSorted.length && (\n\t\t\t\t<div className=\"text-center text-muted fst-italic small\">{I18N_NOTHING_TO_SHOW}</div>\n\t\t\t)}\n\t\t</>\n\t)\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { LightBtnTabGroup, Tabs } from '#src/components/tabs'\nimport {\n\tI18N_ARTIFACTS,\n\tI18N_CHAR_EQUIPMENT,\n\tI18N_EQUIPMENT_PAGE_DESCRIPTION,\n\tI18N_PAGE_TITLE_POSTFIX,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { useDocumentTitle, usePageDescription } from '#src/utils/hooks'\nimport { ArtifactsList } from './artifacts-list'\nimport { WeaponsList } from './weapons-list'\n\nconst cats = [\n\t{ title: I18N_WEAPONS, code: 'weapons', href: '/weapons' },\n\t{ title: I18N_ARTIFACTS, code: 'artifacts', href: '/artifacts' },\n]\n\nexport function Equipment({ code }: { code: 'weapons' | 'artifacts' }) {\n\tconst selectedCat = useMemo(() => cats.find(c => c.code === code) || cats[0], [code])\n\n\tuseDocumentTitle(selectedCat.title + I18N_PAGE_TITLE_POSTFIX)\n\n\tusePageDescription(() => I18N_EQUIPMENT_PAGE_DESCRIPTION(code))\n\n\treturn (\n\t\t<div className=\"equipment container\">\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">{I18N_CHAR_EQUIPMENT}</h1>\n\t\t\t<div className=\"d-none d-xl-flex\">\n\t\t\t\t<Tabs classes=\"w-100 mt-3\" tabs={cats} selectedTab={selectedCat} />\n\t\t\t</div>\n\t\t\t<div className=\"d-block d-xl-none\">\n\t\t\t\t<LightBtnTabGroup\n\t\t\t\t\ttabs={cats}\n\t\t\t\t\tselectedTab={selectedCat}\n\t\t\t\t\tclasses=\"w-100 mt-3 mb-2 btn-group-sm\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{code === 'weapons' ? <WeaponsList /> : <ArtifactsList />}\n\t\t</div>\n\t)\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { getRegionTime, GI_ROTATION_WEEKDAY_CODES } from '#lib/genshin'\nimport { arrGetAfter } from '#lib/utils/collections'\nimport { mustBeDefined } from '#src/../../lib/utils/values'\nimport { apiMaterialsTimetable } from '#src/api/endpoints'\nimport { Spinner } from '#src/components/placeholders'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport {\n\tI18N_DUNGEONS,\n\tI18N_TALENTS,\n\tI18N_TODAY,\n\tI18N_TOMORROW,\n\tI18N_WEAPONS,\n\tI18N_WEEKDAYS,\n\tI18N_WHY_ADD_TO_FAVS_TIP,\n} from '#src/i18n/i18n'\nimport { isLoaded, useFetch, useForceUpdate, useVersionedStorage, useVisibleTicker } from '#src/utils/hooks'\nimport { getItemIconLargeSrc, getItemIconSrc } from '#src/utils/items'\nimport {\n\tSV_FAV_CHAR_CODES,\n\tSV_FAV_TALENT_MATERIAL_CODES,\n\tSV_FAV_WEAPON_PRIMARY_MATERIAL_CODES,\n\tSV_SELECTED_REGION_CODE,\n} from '#src/utils/local-storage-keys'\nimport { HEART } from '#src/utils/typography'\nimport { OtherItemCard } from './item-cards/dd-cards'\nimport { CharacterAvatar, ItemAvatar } from './item-cards/item-avatars'\n\nimport './farm-today.scss'\n\nexport function FarmToday({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst ttData = useFetch(apiMaterialsTimetable, [])\n\tconst [selectedRegionCode] = useVersionedStorage(SV_SELECTED_REGION_CODE)\n\tconst { weekdayMonSun, weekdayCode } = getRegionTime(selectedRegionCode)\n\tconst tomorrowCode = arrGetAfter(GI_ROTATION_WEEKDAY_CODES, weekdayCode)\n\tconst [favCharCodes] = useVersionedStorage(SV_FAV_CHAR_CODES)\n\tconst [favTalMaterialCodes] = useVersionedStorage(SV_FAV_TALENT_MATERIAL_CODES)\n\t// const [favWeaponDatas] = useLocalStorage<STORAGE_WEAPON_DATA[]>(SK_FAV_WEAPON_DATAS, [])\n\t// const favWeapMatCodes = useMemo(() => [...favWeaponDatas.map(wd => wd[1])], [favWeaponDatas])\n\tconst [favWeapPrimMatCodes] = useVersionedStorage(SV_FAV_WEAPON_PRIMARY_MATERIAL_CODES)\n\tconst forceUpdate = useForceUpdate()\n\tuseVisibleTicker(() => {\n\t\tforceUpdate()\n\t}, 60 * 1000)\n\tconst tabs = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\tcode: weekdayCode,\n\t\t\t\ttitle: `${I18N_WEEKDAYS[weekdayMonSun]}, ${I18N_TODAY}`,\n\t\t\t},\n\t\t\t{ code: tomorrowCode, title: I18N_TOMORROW },\n\t\t],\n\t\t[weekdayCode, tomorrowCode, weekdayMonSun],\n\t)\n\tconst [selectedTab, setSelectedTab] = useSelectable(tabs, [selectedRegionCode])\n\n\treturn (\n\t\t<div className={`farm-today ${classes}`}>\n\t\t\t{!BUNDLE_ENV.IS_SSR && (\n\t\t\t\t<>\n\t\t\t\t\t<div className=\"d-none d-xl-flex\">\n\t\t\t\t\t\t<h5 className=\"py-2 m-0 me-2 d-block \">{I18N_DUNGEONS}</h5>\n\t\t\t\t\t\t<Tabs\n\t\t\t\t\t\t\ttabs={tabs}\n\t\t\t\t\t\t\tselectedTab={selectedTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedTab}\n\t\t\t\t\t\t\tclasses=\"mb-2 flex-grow-1\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"d-block d-xl-none\">\n\t\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\t\ttabs={tabs}\n\t\t\t\t\t\t\tselectedTab={selectedTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedTab}\n\t\t\t\t\t\t\tclasses=\"w-100 mb-2 btn-group-sm\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{isLoaded(ttData) && !BUNDLE_ENV.IS_SSR ? (\n\t\t\t\t<>\n\t\t\t\t\t<h6 className=\"opacity-75 text-capitalize\">{I18N_TALENTS}</h6>\n\t\t\t\t\t<div className=\"talents-wrap pt-1\">\n\t\t\t\t\t\t{ttData.timetable[selectedTab.code].characterAscensions.map(asc => (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<div className=\"mb-3 ps-2 ms-1 d-flex align-items-center\" key={asc.itemCode}>\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\t\t\tsrc={getItemIconLargeSrc(asc.itemCode)}\n\t\t\t\t\t\t\t\t\t\t\tclasses=\"me-3 vertical-align-middle\"\n\t\t\t\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t\t\t\t~favTalMaterialCodes.indexOf(asc.itemCode) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger\">{HEART}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tddComponent={\n\t\t\t\t\t\t\t\t\t\t\t\t<OtherItemCard\n\t\t\t\t\t\t\t\t\t\t\t\t\titem={mustBeDefined(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tttData.items.find(i => i.code === asc.itemCode),\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\trelated={ttData.maps}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"d-flex flex-wrap align-self-center pt-2\">\n\t\t\t\t\t\t\t\t\t\t{asc.characterCodes.map(c => (\n\t\t\t\t\t\t\t\t\t\t\t<CharacterAvatar\n\t\t\t\t\t\t\t\t\t\t\t\tkey={c}\n\t\t\t\t\t\t\t\t\t\t\t\tcode={c}\n\t\t\t\t\t\t\t\t\t\t\t\tisNoBg={true}\n\t\t\t\t\t\t\t\t\t\t\t\tclasses={`small-avatar mb-2 me-2 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t~favCharCodes.indexOf(c) ? 'order-1' : 'order-2'\n\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t\t\t\t\t~favCharCodes.indexOf(c) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger\">{HEART}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<h6 class=\"opacity-75 text-capitalize\">{I18N_WEAPONS}</h6>\n\t\t\t\t\t<div className=\"ps-2 ms-1\">\n\t\t\t\t\t\t{ttData.timetable[selectedTab.code].weaponMaterialCodes.map(code => (\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tkey={code}\n\t\t\t\t\t\t\t\tsrc={getItemIconSrc(code)}\n\t\t\t\t\t\t\t\tclasses=\"small-avatar me-3 with-padding\"\n\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t~favWeapPrimMatCodes.indexOf(code) ? (\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger\">{HEART}</span>\n\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tddComponent={\n\t\t\t\t\t\t\t\t\t<OtherItemCard\n\t\t\t\t\t\t\t\t\t\titem={mustBeDefined(ttData.items.find(i => i.code === code))}\n\t\t\t\t\t\t\t\t\t\trelated={ttData.maps}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t\t<div className=\"text-muted small text-center px-2 mx-1 py-3\">{I18N_WHY_ADD_TO_FAVS_TIP}</div>\n\t\t</div>\n\t)\n}\n","import { useCallback, useMemo } from 'preact/hooks'\n\nimport { GI_ServerRegionCode } from '#src/../../lib/genshin'\nimport { SimpleSelect } from '#src/components/select'\nimport { I18N_ASIA, I18N_EUROPE, I18N_NORH_AMERICA } from '#src/i18n/i18n'\nimport { useVersionedStorage } from '#src/utils/hooks'\nimport { SV_SELECTED_REGION_CODE } from '#src/utils/local-storage-keys'\n\ntype Opt = { title: string; code: GI_ServerRegionCode }\nconst europeOpt: Opt = { title: I18N_EUROPE, code: 'europe' }\nconst options: Opt[] = [\n\teuropeOpt,\n\t{ title: I18N_ASIA, code: 'asia' },\n\t{ title: I18N_NORH_AMERICA, code: 'north-america' },\n]\n\nexport function RegionSwitch({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedRegionCode, setSelectedRegionCode] = useVersionedStorage(SV_SELECTED_REGION_CODE)\n\tconst selectedOption = useMemo(\n\t\t() => options.find(o => o.code === selectedRegionCode) || europeOpt,\n\t\t[selectedRegionCode],\n\t)\n\tconst onOptSelectLocal = useCallback(o => setSelectedRegionCode(o.code), [setSelectedRegionCode])\n\treturn (\n\t\t<SimpleSelect options={options} selectedOption={selectedOption} onOptionSelect={onOptSelectLocal} />\n\t)\n}\n","import { getRegionTime } from '#lib/genshin'\nimport { I18N_MS_TO_HM_WORDS } from '#src/i18n/i18n'\nimport { useForceUpdate, useVersionedStorage, useVisibleTicker } from '#src/utils/hooks'\nimport { SV_SELECTED_REGION_CODE } from '#src/utils/local-storage-keys'\nimport { BULLET, ELLIPSIS } from '#src/utils/typography'\n\nexport function TimeUntilDayReset({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedRegionCode] = useVersionedStorage(SV_SELECTED_REGION_CODE)\n\tconst { resetIn } = getRegionTime(selectedRegionCode)\n\tconst forceUpdate = useForceUpdate()\n\tuseVisibleTicker(() => {\n\t\tforceUpdate()\n\t}, 60 * 1000)\n\treturn (\n\t\t<div className={`time-until-day-reset ${classes}`}>\n\t\t\t{BUNDLE_ENV.IS_SSR ? ELLIPSIS : I18N_MS_TO_HM_WORDS(resetIn)}\n\t\t\t<span className=\"animation-time-glow ps-1\">{BULLET}</span>\n\t\t</div>\n\t)\n}\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { arrOrItemToArr } from '#src/../../lib/utils/collections'\nimport { useBuildWithDelayedLocs } from '#src/api'\nimport { getAllRelated } from '#src/api/utils'\nimport { CentredSpinner, Spinner } from '#src/components/placeholders'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport { FavoriteCharacters } from '#src/containers/character-picker/favorite-characters'\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport {\n\tI18N_ART_STATS_PRIORITY,\n\tI18N_ARTIFACTS,\n\tI18N_ASC_MATERIALS,\n\tI18N_FULL_BUILD_INFO,\n\tI18N_MORE_ON_BUILDS_PAGE,\n\tI18N_STAT_NAME,\n\tI18N_SUBSTATS_PRIORITY,\n\tI18N_TALENT_NAME,\n\tI18N_TALENTS_PRIORITY,\n\tI18N_CHOOSE_FROM_FAV,\n} from '#src/i18n/i18n'\nimport { A } from '#src/routes/router'\nimport { getArtifactTypeIconSrc } from '#src/utils/artifacts'\nimport { isLoaded } from '#src/utils/hooks'\nimport { getItemIconSrc } from '#src/utils/items'\nimport {\n\tBuildRoleOrDummy,\n\tCIRCLET_GOBLET_SANDS,\n\tDUMMY_ROLES,\n\tgenArtifactAdvice,\n\tgenArtMainStatDetail,\n\tgenSimpleList,\n\tgetRoleData,\n\tmakeRoleTitle,\n} from './common'\n\nimport './character-build-preview.scss'\nimport { OtherItemCard } from '#src/containers/item-cards/dd-cards'\n\nfunction CharacterBuildPreview({ characterCode }: { characterCode: string }): JSX.Element {\n\tconst [build, isUpdating] = useBuildWithDelayedLocs(characterCode)\n\tconst displayingCharacterCode = isLoaded(build) ? build.character.code : characterCode\n\tconst roleTabs: BuildRoleOrDummy[] = isLoaded(build) ? build.character.roles : DUMMY_ROLES\n\tconst [selectedRoleTab, setSelectedRoleTab] = useSelectable(roleTabs, [displayingCharacterCode])\n\n\tconst artifactsListBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return []\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\t\tconst listTimit = 1\n\t\treturn (\n\t\t\t<ol>\n\t\t\t\t{role.artifacts.sets.map((set, i) => {\n\t\t\t\t\tif (i > listTimit) return\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t\t\t{genArtifactAdvice(set.arts, build, false)}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t\t{role.artifacts.sets.length > listTimit ? (\n\t\t\t\t\t<li className=\"pt-1\">\n\t\t\t\t\t\t<A className=\"link-secondary text-muted small\" href={`/builds/` + characterCode}>\n\t\t\t\t\t\t\t{I18N_MORE_ON_BUILDS_PAGE}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</li>\n\t\t\t\t) : null}\n\t\t\t</ol>\n\t\t)\n\t}, [characterCode, build, selectedRoleTab])\n\n\tconst artifactMainStatsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<ul className=\"mb-1 list-unstyled ms-1 pt-1 ps-1 small\">\n\t\t\t\t{CIRCLET_GOBLET_SANDS.map(ac => (\n\t\t\t\t\t<li className=\"my-1 ms-1\">\n\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\tsrc={getArtifactTypeIconSrc(ac)}\n\t\t\t\t\t\t\tisNoBg={true}\n\t\t\t\t\t\t\tclasses=\"small-avatar with-padding align-middle\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{genArtMainStatDetail(role, ac, true)}\n\t\t\t\t\t</li>\n\t\t\t\t))}\n\t\t\t</ul>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst artifactSubStatsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<ol className=\"mb-1 pt-2 small\">\n\t\t\t\t{role.subStats.advices.map(advice => {\n\t\t\t\t\treturn <li>{genSimpleList(advice.codes.map(I18N_STAT_NAME))}</li>\n\t\t\t\t})}\n\t\t\t</ol>\n\t\t)\n\t}, [build, selectedRoleTab])\n\n\tconst talentsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<ol className=\"small\">\n\t\t\t\t\t{role.talents.advices.map(advice => {\n\t\t\t\t\t\treturn <li>{arrOrItemToArr(advice).map(I18N_TALENT_NAME)}</li>\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\n\tconst materialsBlock = useMemo(() => {\n\t\t//todo только главные\n\t\tif (!isLoaded(build)) return null\n\t\tconst materials = getAllRelated(build.maps.items, build.character.materialCodes)\n\t\treturn (\n\t\t\t<div className=\"d-flex justify-content-between flex-wrap px-2\">\n\t\t\t\t{materials.map(m => (\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 mx-1 small-avatar with-padding flex-shrink-0\"\n\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\tddComponent={<OtherItemCard item={m} related={build.maps} />}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t)\n\t}, [build])\n\tif (!isLoaded(build)) return <Spinner />\n\treturn (\n\t\t<div className=\"character-build-preview position-relative\">\n\t\t\t{/* <div className=\"d-none d-xl-block\">\n\t\t\t\t<CharacterPortrait src={getCharacterPortraitSrc(characterCode)} classes=\"w-100\" />\n\t\t\t</div>\n\t\t\t<div className=\"d-xl-none\">\n\t\t\t\t<CharacterPortrait\n\t\t\t\t\tsrc={getCharacterSilhouetteSrc(characterCode)}\n\t\t\t\t\tclasses=\"w-75 character-portrait-mobile\"\n\t\t\t\t/>\n\t\t\t</div> */}\n\t\t\t{isUpdating ? <CentredSpinner /> : null}\n\t\t\t<div className={isUpdating ? 'opacity-50 pe-none' : ''}>\n\t\t\t\t<div className=\"d-none d-xl-flex \">\n\t\t\t\t\t<h5 className=\"py-2 m-0 me-2 d-block \">{build.character.name}</h5>\n\t\t\t\t\t<Tabs\n\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\tclasses=\"mb-2 flex-grow-1\"\n\t\t\t\t\t\tkey={displayingCharacterCode}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"d-flex d-xl-none align-items-center\">\n\t\t\t\t\t<h5 className=\"mb-0 pt-2 me-2\">{build.character.name}</h5>\n\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\tclasses=\"w-100 mt-3 mb-2 btn-group-sm\"\n\t\t\t\t\t\tkey={displayingCharacterCode}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"row small gy-2\">\n\t\t\t\t\t<div className=\"col-lg-4 col-12\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_ARTIFACTS}</h6>\n\t\t\t\t\t\t<div>{artifactsListBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_ART_STATS_PRIORITY}</h6>\n\t\t\t\t\t\t<div>{artifactMainStatsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_SUBSTATS_PRIORITY}</h6>\n\t\t\t\t\t\t<div>{artifactSubStatsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_TALENTS_PRIORITY}</h6>\n\t\t\t\t\t\t<div>{talentsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-8 col-6\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_ASC_MATERIALS}</h6>\n\t\t\t\t\t\t<div>{materialsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-12\">\n\t\t\t\t\t\t<A\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn btn-link btn-sm w-100\"\n\t\t\t\t\t\t\thref={`/builds/` + characterCode}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{I18N_FULL_BUILD_INFO}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</div>\n\t\t\t\t\t{/* TODO */}\n\t\t\t\t\t{/* <div className=\"col-6\">\n\t\t\t\t\t\t<A type=\"button\" className=\"btn btn-link btn-sm w-100\">\n\t\t\t\t\t\t\t{I18N_CHAR_LORE}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</div> */}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\nexport function BuildsPreviewsWrap({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedCharacterCode, setSelectedCharacterCode] = useState<string | undefined>(undefined)\n\treturn (\n\t\t<div className={`character-build-preview ${classes}`}>\n\t\t\t<FavoriteCharacters\n\t\t\t\tonCharacterSelect={setSelectedCharacterCode}\n\t\t\t\tshoudSelectFirst={!selectedCharacterCode}\n\t\t\t\tselectedCharacterCode={selectedCharacterCode}\n\t\t\t\tnavigateToCharacter={false}\n\t\t\t\tblockLabel={I18N_CHOOSE_FROM_FAV}\n\t\t\t\tclasses=\"mb-2\"\n\t\t\t/>\n\t\t\t{selectedCharacterCode ? (\n\t\t\t\t<CharacterBuildPreview characterCode={selectedCharacterCode} />\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t</div>\n\t)\n}\n","import { AlchemyCalculator } from '#src/containers/alchemy-calculator'\nimport { FarmToday } from '#src/containers/farm-today'\nimport { RegionSwitch } from '#src/containers/region-switch'\nimport { TimeUntilDayReset } from '#src/containers/time-until-day-reset'\nimport {\n\tI18N_ALCHEMY_CALC,\n\tI18N_BUILDS,\n\tI18N_DASHBOARD,\n\tI18N_FRONT_PAGE_DESCRIPTION,\n\tI18N_PAGE_TITLE_POSTFIX,\n\tI18N_REGION,\n\tI18N_UNTIL_DAY_RESET,\n\tI18N_WHAT_TO_FARM,\n} from '#src/i18n/i18n'\nimport { BuildsPreviewsWrap } from '#src/modules/builds/character-build-preview'\nimport { useDocumentTitle, usePageDescription } from '#src/utils/hooks'\n\nfunction Fieldset({ children, legend, classes = '' }) {\n\treturn (\n\t\t<fieldset className={`my-2 ${classes}`}>\n\t\t\t<legend className=\"opacity-75 mb-2\">{legend}</legend>\n\t\t\t{children}\n\t\t</fieldset>\n\t)\n}\nexport function FrontPage(): JSX.Element {\n\tuseDocumentTitle(I18N_DASHBOARD + I18N_PAGE_TITLE_POSTFIX)\n\n\tusePageDescription(() => I18N_FRONT_PAGE_DESCRIPTION)\n\n\treturn (\n\t\t<div className=\"dashboard container \">\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">{I18N_DASHBOARD}</h1>\n\t\t\t<div className=\"row\">\n\t\t\t\t<Fieldset legend={I18N_REGION} classes=\"col-lg-3 col-12\">\n\t\t\t\t\t<RegionSwitch />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset legend={I18N_UNTIL_DAY_RESET} classes=\"col-lg-3 col-12\">\n\t\t\t\t\t<TimeUntilDayReset classes=\"fs-4\" />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset legend={I18N_ALCHEMY_CALC} classes=\"col-lg-6 col-12 \">\n\t\t\t\t\t<AlchemyCalculator />\n\t\t\t\t</Fieldset>\n\t\t\t</div>\n\t\t\t<div className=\"row\">\n\t\t\t\t<Fieldset classes=\"col-lg-6 col-12\" legend={I18N_WHAT_TO_FARM}>\n\t\t\t\t\t<FarmToday />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset classes=\"col-lg-6 col-12\" legend={I18N_BUILDS}>\n\t\t\t\t\t<BuildsPreviewsWrap />\n\t\t\t\t</Fieldset>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { GoUpBtn } from './components/go-up-btn'\nimport { PageWrap } from './components/page-wrap'\nimport { Footer } from './containers/footer'\nimport { Header } from './containers/header'\nimport { AboutPage } from './pages/about'\nimport { BuildsPage_BuildDetail, BuildsPage_CharSelect } from './pages/builds'\nimport { ArtifactsPage, WeaponsPage } from './pages/equipment'\nimport { FrontPage } from './pages/front-page'\nimport { paths } from './routes/paths'\nimport { route, useRouter } from './routes/router'\n\nimport './App.scss'\nimport './animations.scss'\n\nconst routes = [\n\troute(paths.front, FrontPage),\n\troute(paths.builds, BuildsPage_CharSelect),\n\troute(paths.buildCharacters, BuildsPage_BuildDetail),\n\troute(paths.weapons, WeaponsPage),\n\troute(paths.artifacts, ArtifactsPage),\n\troute(paths.about, AboutPage),\n]\n\nexport function App(): JSX.Element {\n\tconst page = useRouter(routes)\n\treturn (\n\t\t<div class=\"d-flex flex-column app-container\">\n\t\t\t<Header />\n\t\t\t<main>\n\t\t\t\t<PageWrap>{page}</PageWrap>\n\t\t\t</main>\n\t\t\t<Footer />\n\t\t\t<GoUpBtn />\n\t\t</div>\n\t)\n}\n","import { useEffect } from 'preact/hooks'\n\nimport { GI_RarityCode } from '#lib/genshin'\nimport { ArtifactRegularInfo, CharacterFullInfoWithRelated } from '#lib/parsing/combine'\nimport { CompactTextParagraphs, getInlineText, isParagraphArr } from '#lib/parsing/helperteam/text'\nimport { CharacterBuildInfoRole } from '#lib/parsing/helperteam/types'\nimport { useBuildWithDelayedLocs } from '#src/api'\nimport { MapAllByCode } from '#src/api/utils'\nimport { Spinner } from '#src/components/placeholders'\nimport { CharacterPicker } from '#src/containers/character-picker/character-picker'\nimport { FavoriteCharacters } from '#src/containers/character-picker/favorite-characters'\nimport {\n\tI18N_BUILD_RECS_FOR,\n\tI18N_BUILDS_PAGE_DESCRIPTION,\n\tI18N_CHAR_BUILD_RECS,\n\tI18N_CHARACTER_PAGE_DESCRIPTION,\n\tI18N_LOADING,\n\tI18N_PAGE_TITLE_POSTFIX,\n\tI18N_RECOMMENDED_RU_ONLY,\n\tI18N_SELECT_CHAR_BELOW,\n} from '#src/i18n/i18n'\nimport { CharacterBuildDetailed } from '#src/modules/builds/character-build-detailed'\nimport { isLoaded, useDocumentTitle, usePageDescription } from '#src/utils/hooks'\n\nexport function BuildsPage_CharSelect(): JSX.Element {\n\tuseDocumentTitle(I18N_CHAR_BUILD_RECS + I18N_PAGE_TITLE_POSTFIX)\n\n\tusePageDescription(() => I18N_BUILDS_PAGE_DESCRIPTION)\n\n\treturn (\n\t\t<div className=\"builds container\">\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">{I18N_CHAR_BUILD_RECS}</h1>\n\t\t\t<h5 className=\"mt-2 mb-3 opacity-75\">{I18N_SELECT_CHAR_BELOW}</h5>\n\t\t\t<FavoriteCharacters navigateToCharacter={true} classes=\"mb-2\" />\n\t\t\t<CharacterPicker />\n\t\t</div>\n\t)\n}\nexport function BuildsPage_BuildDetail({ code }: { code: string }): JSX.Element {\n\tconst [build, isUpdating] = useBuildWithDelayedLocs(code)\n\n\tuseEffect(() => {\n\t\twindow.scrollTo(0, 0)\n\t}, [])\n\n\tuseDocumentTitle(\n\t\tisLoaded(build)\n\t\t\t? build.character.name + ' ' + I18N_BUILD_RECS_FOR + I18N_PAGE_TITLE_POSTFIX\n\t\t\t: I18N_LOADING + I18N_PAGE_TITLE_POSTFIX,\n\t)\n\n\tusePageDescription(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = build.character.roles.find(x => x.isRecommended) ?? build.character.roles[0]\n\t\tif (!role) return null\n\t\tconst weaponR5 = findWeaponWithRarity(build, role, 5)\n\t\tconst weaponR4 = findWeaponWithRarity(build, role, 4)\n\t\tconst art = findFirtArtifact(build, role)\n\t\treturn I18N_CHARACTER_PAGE_DESCRIPTION(\n\t\t\tbuild.character.name,\n\t\t\tparagraphsToInline(role.name),\n\t\t\tweaponR5?.name,\n\t\t\tweaponR4?.name,\n\t\t\tart?.name,\n\t\t\tparagraphsToInline(role.tips),\n\t\t\tparagraphsToInline(role.notes),\n\t\t)\n\t})\n\n\tif (!isLoaded(build)) return <Spinner />\n\n\treturn (\n\t\t<div className=\"builds container\">\n\t\t\t<h1 className={`my-1 letter-spacing-1 ${BUNDLE_ENV.LANG === 'en' ? 'text-capitalize' : ''}`}>\n\t\t\t\t<span className=\"d-none d-xl-inline\">{build.character.name}</span>\n\t\t\t\t<span className=\"d-xl-none\">{I18N_RECOMMENDED_RU_ONLY}</span> {I18N_BUILD_RECS_FOR}\n\t\t\t</h1>\n\t\t\t<FavoriteCharacters navigateToCharacter={true} selectedCharacterCode={code} />\n\t\t\t<CharacterBuildDetailed build={build} isUpdating={isUpdating} />\n\t\t</div>\n\t)\n}\n\nfunction findWeaponWithRarity(\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>,\n\trole: CharacterBuildInfoRole<'monolang'>,\n\trarity: GI_RarityCode,\n) {\n\tfor (const item of role.weapons.advices)\n\t\tfor (const weapon of item.similar) {\n\t\t\tconst data = build.maps.weapons.get(weapon.code)\n\t\t\tif (data && data.rarity === rarity) return data\n\t\t}\n\treturn null\n}\n\nfunction findFirtArtifact(\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>,\n\trole: CharacterBuildInfoRole<'monolang'>,\n) {\n\treturn (function iter(arts): ArtifactRegularInfo | null {\n\t\tfor (const item of arts) {\n\t\t\tif ('op' in item) return iter(item.arts)\n\t\t\tconst data = build.maps.artifacts.get(item.code)\n\t\t\tif (data) return data\n\t\t}\n\t\treturn null\n\t})(role.artifacts.sets.map(x => x.arts))\n}\n\nfunction paragraphsToInline(node: CompactTextParagraphs | null): string {\n\tif (node === null) return ''\n\tif (typeof node !== 'string') {\n\t\tif (isParagraphArr(node)) return node.map(x => paragraphsToInline(x)).join(' ')\n\t\tif ('p' in node) return paragraphsToInline(node.p)\n\t}\n\tlet text = getInlineText(node)\n\ttext = text.trim().replaceAll('\\n', ': ') //двоеточие после подзаголовков\n\treturn text\n}\n","import { Equipment } from '#src/modules/equipment'\n\nexport function WeaponsPage() {\n\treturn <Equipment code={'weapons'} />\n}\nexport function ArtifactsPage() {\n\treturn <Equipment code={'artifacts'} />\n}\n","import { I18N_ABOUT_SITE_CONTENT, I18N_ABOUT_SITE_EPIGRAPH } from '#src/i18n/about-site'\r\nimport { I18N_ABOUT_SITE, I18N_PAGE_TITLE_POSTFIX } from '#src/i18n/i18n'\r\nimport { useDocumentTitle } from '#src/utils/hooks'\r\n\r\nexport function AboutPage(): JSX.Element {\r\n\tuseDocumentTitle(I18N_ABOUT_SITE + I18N_PAGE_TITLE_POSTFIX)\r\n\treturn (\r\n\t\t<div className=\"builds container\">\r\n\t\t\t<h1 className={`my-1 letter-spacing-1 ${BUNDLE_ENV.LANG === 'en' ? 'text-capitalize' : ''}`}>\r\n\t\t\t\t{I18N_ABOUT_SITE}\r\n\t\t\t</h1>\r\n\t\t\t<div className=\"row\">\r\n\t\t\t\t{/* todo ссылки на страницы, перевод */}\r\n\t\t\t\t<figure className=\"text-end\">\r\n\t\t\t\t\t<blockquote className=\"blockquote\">\r\n\t\t\t\t\t\t<p>{I18N_ABOUT_SITE_EPIGRAPH.quote}</p>\r\n\t\t\t\t\t</blockquote>\r\n\t\t\t\t\t<figcaption className=\"blockquote-footer\">\r\n\t\t\t\t\t\t{I18N_ABOUT_SITE_EPIGRAPH.footer} <cite>{I18N_ABOUT_SITE_EPIGRAPH.cite}</cite>\r\n\t\t\t\t\t</figcaption>\r\n\t\t\t\t</figure>\r\n\t\t\t\t<div className=\"col-md-7 offset-md-1\">{I18N_ABOUT_SITE_CONTENT}</div>\r\n\t\t\t\t<div className=\"text-muted text-end\">28.03.2022</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","if (process.env.NODE_ENV === 'development') {\n\trequire('preact/debug')\n}\n\n// должно быть одним из первых\nimport '#src/errors/catch'\n\nimport { render } from 'preact'\n\nimport { App } from './App'\nimport { I18N_UNSUPPORTED_LOCATION_WARNING } from './i18n/i18n'\n\nexport type SSRRenderFunc = () => Promise<string>\n\nexport const renderContent: void | SSRRenderFunc = BUNDLE_ENV.IS_SSR\n\t? // Импортировать preact-render-to-string в начале нельзя,\n\t  // т.к. Терсер видит где-то там побочные эффекты и не выкидывает код из продакшн-бандла.\n\t  // А от require(...) что-то падает в недрах преактовых хуков.\n\t  () => import('preact-render-to-string').then(x => x.renderToString(<App />, null, { pretty: false }))\n\t: isOnExpectedDomain()\n\t? render(<App />, document.querySelector('body .app') as Element)\n\t: insertUnsupportedLocationWarning()\n\nfunction isOnExpectedDomain() {\n\tif (BUNDLE_ENV.SUPPORTED_DOMAINS === null) return true\n\treturn BUNDLE_ENV.SUPPORTED_DOMAINS.some(x => location.hostname.endsWith(x))\n}\n\nfunction insertUnsupportedLocationWarning() {\n\tconst wrap = document.createElement('div')\n\twrap.className = 'py-1 bg-danger text-white text-center'\n\twrap.textContent = I18N_UNSUPPORTED_LOCATION_WARNING\n\tdocument.body.prepend(wrap)\n}\n"],"names":["inProgress","n","l","u","t","o","r","f","e","c","s","a","h","parentNode","removeChild","v","i","arguments","length","children","call","defaultProps","y","type","props","key","ref","__k","__","__b","__e","__d","__c","__h","constructor","__v","vnode","d","_","this","context","k","indexOf","b","base","m","push","g","__r","debounceRendering","sort","some","__P","j","__n","ownerSVGElement","z","w","p","A","Array","isArray","x","P","N","M","appendChild","nextSibling","insertBefore","$","setProperty","test","H","style","cssText","replace","toLowerCase","slice","addEventListener","T","I","removeEventListener","setAttribute","removeAttribute","event","contextType","value","__E","prototype","render","O","sub","state","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","forEach","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","L","diffed","localName","nodeType","document","createTextNode","createElementNS","createElement","is","data","childNodes","dangerouslySetInnerHTML","attributes","name","__html","innerHTML","C","checked","current","unmount","componentWillUnmount","S","firstChild","D","Consumer","Provider","splice","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","Promise","then","bind","resolve","setTimeout","__H","F","shift","clearTimeout","cancelAnimationFrame","requestAnimationFrame","filter","__source","__self","ContextProvider","Portal","_this","container","_container","_temp","_vnode","child","before","comparer","shouldUpdate","nextProps","updateRef","shallowDiffers","Memoed","displayName","isReactComponent","_forwarded","mustBeDefined","val","undefined","Error","mustBeNever","values","staticNever","clamp","min","max","promiseNever","isPromise","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","definition","Object","defineProperty","enumerable","get","chunkId","all","keys","reduce","promises","miniCssF","obj","prop","hasOwnProperty","url","done","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","timeout","nc","src","onScriptComplete","prev","onerror","onload","doneFns","fn","target","head","Symbol","toStringTag","installedChunks","installedChunkData","promise","reject","error","errorType","realSrc","message","request","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","id","chunkLoadingGlobal","self","sendNewItem","level","fingerprint","rollbarBody","body","JSON","stringify","environment","code_version","platform","location","href","client","javascript","browser","navigator","userAgent","fetch","method","headers","json","resp","err","logErrorExt","anyError","silent","console","class_","trace","frames","exception","class","sendError","stack","catch","logError","window","filename","lineno","colno","reason","mappedArrPush","map","set","arrShallowEqual","arrGetAfter","arr","item","direction","index","arrOrItemToArr","BS_BreakpointsCodes","BS_BreakpointsMap","xs","sm","md","lg","xl","xxl","BS_getCurrBreakpoint","screenWidth","find","PENDING","isLoaded","useFetch","loadFunc","args","controller","prevArgs","foceUpdate","useForceUpdate","abort","ac","AbortController","res","signal","finally","useClickAway","refs","callback","handleClick","every","HTMLElement","contains","useWindowSize","windowSize","setWindowSize","width","innerWidth","height","innerHeight","breakpoint","handleResize","versions","setVal","initialValue","setValueInner","curRecord","localStorage","getItem","parse","ex","setValueAndSave","setItem","dispatchEvent","CustomEvent","detail","onStorage","log","useLocalStorage","version","setValInner","setValue","useUniqKey","Math","random","useVisibleTicker","interval","isVisible","setIsVisible","visibilityState","onVisibilityChange","onPageHide","onPageShow","useWindowVisibility","callbackInner","Date","now","useDocumentTitle","title","shouldRestoreOnUnmount","defaultTitle","useHashValue","defaultValue","getHashValue","setHashValue","onHashChange","setValAndHash","URLSearchParams","hash","params","delete","toString","origin","pathname","search","history","replaceState","useScrollTo","shouldScrollToArg","scrollParams","shouldScrollTo","setShouldScrollTo","behavior","scrollIntoView","DASH","GoUpBtn","classes","onClick","scrollTo","scrollPosition","setScrollPosition","setScrollPositionLocal","pageYOffset","useScrollPosition","className","position","PageWrap","LINK_DISCORD_INVITE","I18N_LANG_NAMES","en","ru","I18N_LANG_NAME","I18N_PAGE_TITLE_POSTFIX","I18N_COLLAPSE","I18N_ALCHEMY_CALC","I18N_BUILDS","I18N_WEEKDAYS","I18N_WEAPONS","I18N_MAIN_INFO","add","remove","weapon","character","material","I18N_ARTIFACTS","I18N_ART_STATS_PRIORITY","I18N_SUBSTATS_PRIORITY","I18N_TALENTS_PRIORITY","I18N_ASC_MATERIALS","I18N_BACK","I18N_NOTES","artTypeNamesRU","flower","plume","sands","goblet","circlet","I18N_ART_TYPE","code","statNamesRu","def","dmg","atk","hp","em","er","healing","I18N_STAT_NAME","talentTypesNamesRU","attack","skill","burst","I18N_TALENT_NAME","I18N_CONJUCTIONS","or","and","I18N_REPORT_BUG_GUIDE","I18N_PIECE_BONUS","I18N_PIECES_BONUS","I18N_BASE_ATTACK","I18N_ITEM_STORY","I18N_SECONDARY_STAT","I18N_MAP_CODES_NAME","teyvat","enkanomiya","chasm","I18N_CHAR_BUILD_RECS","I18N_BUILD_RECS_FOR","I18N_ABOUT_SITE","I18N_REPORT_BUG","I18N_NOTHING_TO_SHOW","weaponTypeNamesRU","claymore","sword","catalyst","polearm","bow","weaponObtainSourceNamesRU","wishes","events","forging","fishing","chests","quests","puzzles","investigation","playstation","other","I18N_WEAPON_OBTAIN_SOURCE_NAME","I18N_ART_GROUP_NAME","I18N_ITEM_DETAIL","I18N_NAME","I18N_SUBSTAT","I18N_WEAPON_TYPE_FILTER_TIP","everything","I18N_MS_TO_HM_WORDS","duration","minutes","floor","hours","pluralizeRU","pluralizeHours","pluralizeMinutes","w0","w1","w3","modalsEl","GET_MODALS_EL","querySelector","ReportBugModal","onClickAway","setMessage","isInvalid","setIsInvalid","onMessageChange","modalRef","tryToSendMessage","msg","alert","placeholder","rows","onInput","Footer","isReportBugModalVisible","setIsReportBugModalVisible","onRepBugBtnClick","closeRepBugModal","role","charactersShortList","ART_GROUP_CODES","paths","front","builds","buildCharacters","weapons","artifacts","about","matchPath","path","rem","part","matched","withoutPrefix","variants","variant","prefix","startsWith","URL_LANG_PREFIX","makeUrlLangPrefix","findRoutedComponent","routes","route","comp","pathSearchHash","tryRouteToPage","hashChanged","pushState","lang","makeLocationHrefForLang","curPrefix","newUrl","assign","innerRef","isExternal","GlobeIcon","viewBox","fill","xmlns","isPageActive","routs","isOnRoute","Nav","isNavExpanded","EquipmentDd","DonationDd","LangSelect","SUPPORT_DD_LINKS","HeadDd","ddLinks","EQUIPMENT_DD_LINKS","ddLinksLocal","isActive","isExpanded","setIsExpanded","ddRef","closeDd","openDd","isActiveLang","GI_ROTATION_WEEKDAY_CODES","GI_ARTIFACT_GROUP_CODES","_GI_STAT_PERCENT","_GI_STAT_DMG_PEFIXES","GI_REGION_TIMEZONE_OFFSET","concat","europe","asia","getRegionTime","regionCode","offsetHours","lastResetDate","setHours","getHours","weekdayMonSun","weekday","getUTCDay","setUTCHours","nextResetDate","setDate","getDate","weekdayCode","resetIn","resetAt","locEnc_code2map","E","decodeLocations","encodedLocations","downsample","parseInt","locs","mapCode","len3","decodeLocNum","str","decodeObjLocations","_locsEnc","locations","mapAllByCode","maps","attr","Map","decodeRelatedLocations","rel","items","enemies","enemy","getAllRelated","codes","getLang","apiGetJSONFile","_map","func","apiGetArtifacts","apiGetWeapons","apiMaterialsTimetable","apiGetSearchData","BlockHeader","Spinner","CentredSpinner","CentredLabel","label","keyMap","artifact","genEquipmentHash","artifactTypes","imgSrc","getArtifactTypeIconSrc","artifactTypeCode","at","isGroup","getArtifactIconSrc","artifactCode","getArtifactIconLargeSrc","getAllArtifacts","artsMap","getAllOrNone","calcPosForDd","parentRect","ddRect","isAbsolute","isCentered","shouldFitInScreen","tWidth","tHeight","scrollTopFix","scrollY","centredFix","top","left","layoutPositionX","layoutPositionY","layoutPosition","unprefixTraveler","getCharacterAvatarSrc","getCharacterAvatarLargeSrc","getCharacterSilhouetteSrc","weaponTypes","getWeaponIconSrc","weaponCode","getWeaponIconLageSrc","targetEl","wrapRef","defClassName","arrowStyle","setArrowStyle","onResize","wrapEl","pos","getBoundingClientRect","offsetWidth","MobileDesktopSwitch","childrenDesktop","childrenMobile","br","tabTitleFromName","Tabs","tabs","titleFunc","selectedTab","onTabSelect","preventDefault","BtnTabGroup","visibleTabsLength","tabsGrouped","disabled","LightBtnTabGroup","btnClass","useSelectable","tabCodes","setTabCodes","argsInner","tab","setTab","ItemDetailDdPortal","contentKey","shouldScrollToTop","elTop","ItemDetailDdMobilePortal","getItemIconSrc","itemCode","DEF_ANCESTRY_CODES","AlchemyCalculator","ancestryCodes","setValues","onValueChange","dataset","isFirst","isLast","rarity","ItemAvatar","endRoundClass","SimpleSelect","options","selectedOption","onOptionSelect","size","handleChange","onChange","selected","hidden","LazyTeyvatMap","dummyMarkerGroups","markers","icon","addMarkerGroupsByDomains","markerGroups","domains","domain","loc","addMarkerGroupsByEnemies","CardMap","itemData","isItemFavable","isFatHead","TeyvatMap","markerGroupsLocal","isMapEmpty","selectedSource","setSelectedSource","visibleMapCodeTabs","mapCodes","Set","marker","from","selectedMapCodeTab","setMapCodeTab","selectedMapCode","setSourceAndFixMapCode","sourceSelectEl","isItemWeaponPrimaryMaterial","types","opacity","ToggleWeaponPrimaryMaterialFav","LabeledItemAvatar","isNoBg","avatarClasses","for","SV_SELECTED_REGION_CODE","language","curOffset","getTimezoneOffset","guessCurrentRegion","favCodes","SV_FAV_CHAR_CODES","SV_FAV_TALENT_MATERIAL_CODES","SV_FAV_WEAPON_PRIMARY_MATERIAL_CODES","RecommendedTo","charCodes","isInline","isAvatarWithBorder","navigateToCharacter","favCharCodes","charLists","groupsMap","count","groups","entries","countA","countB","reverse","CharacterAvatar","badgeTopStart","AscMaterials","materials","selectedMat","onMatSelect","matList","CardDescMobileWrap","Card","titleEl","selectorEl","bodyEl","mapEl","DdContext","ddContext","ArtifactCard","related","selectedArt","setSelectedArt","dataForMap","srcs","obtainSources","domainCodes","enemyCodes","sets","notesToJSX","recommendedTo","WeaponCard","materialCodes","materialOnMap","setMaterialOnMap","typeCode","join","subStat","passiveStat","OtherItemCard","isItemCharTalentMaterial","codesForCalc","ToggleTalentMaterialFav","DUMMY_ROLES","makeRoleTitle","isRecommended","CIRCLET_GOBLET_SANDS","getRoleData","build","selectedCode","roles","genArtMainStatDetail","isShort","genSimpleList","mainStats","genNotes","notes","tips","processObj","tip","split","flat","ItemLabelWithDd","getCoverArtifactForSet","artsForDd","coverArt","genArtifactAdvice","artifactsForDd","avatarTopEndBadge","ddComponent","ItemsListGroupWrap","arts","art","isLastInList","ItemsJoinerWrap","op","ToggleSmthFav","smthCode","storageKey","tipFav","tipNotFav","favSmthCodes","setFavSmthCodes","elRef","isHovered","node","handleMouseOver","handleMouseOut","isFav","toggleFav","ToggleCharFav","characterCode","badgeTopEnd","rarityClass","pointerClass","onClickLocal","codeToBadge","classesLocal","ItemLabel","ItemDd","ItemsDataContext","ddComp","coverArtifact","interactiveLabelClass","avatarTopStartBadge","getIconForItem","strIndexOrInf","searchStr","Infinity","sortInItem","nameLC","nameEnLC","itemTypes","MegaSearch","setSearchStr","searchData","searchDataGrouped","searchDataLocal","si","toLocaleLowerCase","nameEn","targetRef","clearSearch","shouldBlur","blur","ddEl","searchResults","searchResultsLocal","it","includes","searchInItem","clearSearchAndBlurLocal","onKeyPress","onSearchValueChange","currentTarget","SearchResultsWrap","searckTypeTitleMap","switchSearchType","offset","fromIndex","itemsLen","ctrlKey","altKey","shiftKey","metaKey","results","len","mainItemHrefMap","dispatchRouteTo","SearchItemCard","isSelected","highlightPartOfText","regexp","text","String","block","RegExp","nameWithHighlight","nameEnWithHighlight","mainItemHref","Header","setIsNavExpanded","I18N_ABOUT_SITE_EPIGRAPH","I18N_ABOUT_SITE_CONTENT","useBuildWithDelayedLocs","isUpdating","prevDataRef","sig","useFetchWithPrev","buildIsLoaded","fullInfo","locsInfo","applyItemsLocationsImmut","applyFullInfoLocationsImmut","locItems","resItems","WeaponTypeFilter","selectedWeaponTypeCode","onTypeCodeSelect","wt","CharacterPickerMobile","selectedElementCode","setSelectedElementCode","setSelectedWeaponTypeCode","element","characters","elementCode","weaponTypeCode","el","selectElement","CharacterPickerDesktop","isLastRowClass","wType","CharacterPicker","shortListReversed","FavoriteCharacters","onCharacterSelect","shoudSelectFirst","selectedCharacterCode","blockLabel","charactersShortListCodes","characterCodes","charactersElems","CharacterPortrait","CharacterBuildDetailed","roleTabs","selectedRoleTab","setSelectedRoleTab","goBack","back","weaponListBlock","advices","advice","isInList","similar","refine","stacks","artifactsListBlock","artifactStatsAndSkillsBlock","subStats","talents","notesBlock","credits","materialsBlock","CharacterDetailDesktop","CharacterDetailMobile","Accordion","expandedItemCode","expandedItemCodeLocal","setexpandedItemCode","ai","isThisExpanded","content","artTypeTabs","ArtifactCardLine","onClose","selectedArtTypeTab","setSelectedArtTypeTab","artifactFull","apiGetArtifact","artTypeTabsFiltered","att","pieces","mainInfoColInner","loreInfoColInner","description","story","locationColInner","cellClass","forAccordion","ArtifactCardTableRow","group","setSelectedArtifactCode","toggleExpand","bgClass","cardRef","expandedRow","colSpan","collapsededRow","ArtifactsList","selectedArtifactCode","artifactsSorted","artifactsLocal","scope","WeaponCardLine","weaponFull","apiGetWeapon","WeaponCardTableRow","setSelectedWeaponCode","WEAPON_SORT_CODES","WEAPON_SORT_NAMES","WEAPON_SORT_FUNCS","WeaponSort","selectedSortCode","onSortCodeSelect","WEAPON_FILTER_OBTAIN_SOURCE","WeaponFilter","selectedSortCodes","onFilterCodeSelect","filterVariants","WeaponsList","setSelectedSortCode","selectedWeaponCode","selectedObtainSourceCodes","setSelectedObtainSourceCodes","otherObtainSourceCodes","sc","weaponsFilteredSorted","weaponsLocal","cats","Equipment","selectedCat","FarmToday","ttData","selectedRegionCode","tomorrowCode","favTalMaterialCodes","favWeapPrimMatCodes","setSelectedTab","timetable","characterAscensions","asc","weaponMaterialCodes","europeOpt","RegionSwitch","setSelectedRegionCode","onOptSelectLocal","TimeUntilDayReset","CharacterBuildPreview","displayingCharacterCode","artifactMainStatsBlock","artifactSubStatsBlock","talentsBlock","BuildsPreviewsWrap","setSelectedCharacterCode","Fieldset","legend","I18N_DASHBOARD","I18N_LOADING","hostname","endsWith","page","handled","button","Element","closest","URL","handleAnchorClick","onRouteTo","onPopState","Comp","useRouter","wrap","textContent","prepend","insertUnsupportedLocationWarning"],"sourceRoot":""}