{"version":3,"file":"main.ssr.js","mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA,aAAa,mCAAmC;AAChD;;AAEA;AACA;AACA;AACA;AACA,KAAK,wCAAwC;AAC7C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,qBAAqB;AAChC;AACO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa,QAAQ;AACrB;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2BAA2B,YAAY;AACvC,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAqB;AACpC;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAmC,IAAI;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mCAAmC,IAAI;AACvC;AACA;AACA;;AAEA,aAAa,QAAQ;AACrB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAyB,aAAa;AACtC;;AAEA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAyB,QAAQ;AACjC;;AAEA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA2B,8BAA8B;AACzD,eAAe,QAAQ;AACvB,YAAY,GAAG;AACf,YAAY;AACZ;AACA,yBAAyB;AACzB;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,WAAW,qBAAqB;AACzB;AACP;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;AACF;;AAEA,WAAW,qBAAqB;AACzB;AACP;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE;AACF;;AAEA,WAAW,qBAAqB;AACzB;AACP;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjhBA,cAAc,wCAAwC;AACtD,cAAc,sCAAsC;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA,WAAW,4CAA4C;AACvD;AACO;AACP,YAAY,SAAS;AACrB,YAAY,aAAa;AACzB,YAAY,aAAa;AACzB,YAAY,cAAc;;AAE1B,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;;AAEjB,SAAS,wDAAwD;AACjE,SAAS,yCAAyC;;AAElD,0BAA0B,aAAa;;AAEvC;;AAEA,sDAAsD,YAAY;AAClE;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF,sDAAsD,YAAY;AAClE;AACA,EAAE;;AAEF,kDAAkD,YAAY;AAC9D;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF,gEAAgE,YAAY;AAC5E;AACA,EAAE;;AAEF,wDAAwD,YAAY;AACpE;AACA,EAAE;;AAEF,wDAAwD,YAAY;AACpE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF,sDAAsD,YAAY;AAClE;AACA;AACA;AACA;AACA,EAAE;;AAEF,oDAAoD,YAAY;AAChE;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF,0DAA0D,YAAY;AACtE;AACA,EAAE;;AAEF,qCAAqC,aAAa;AAClD;AACA;AACA;AACA;;AAEA,4BAA4B,KAAK;AACjC,4BAA4B,KAAK;AACjC,0BAA0B,KAAK;AAC/B,6BAA6B,KAAK;AAClC,6BAA6B,KAAK;AAClC,6BAA6B,KAAK;AAClC,4BAA4B,KAAK;AACjC,2BAA2B,KAAK;AAChC,8BAA8B,KAAK;;AAEnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA,WAAW,gBAAgB;AAC3B;AACO;AACP;;AAEA,YAAY,cAAc;;AAE1B;AACA;;AAEA,qCAAqC,cAAc;AACnD;AACA;;AAEA,8BAA8B,KAAK;;AAEnC;AACA,EAAE;AACF;;AAEA;AACA,WAAW,6DAA6D;AACxE;AACO;AACP,YAAY,SAAS;AACrB,YAAY,aAAa;AACzB,YAAY,aAAa;AACzB,YAAY,cAAc;;AAE1B,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,KAAK;;AAEjB,SAAS,wDAAwD;AACjE,SAAS,wDAAwD;AACjE,SAAS,0DAA0D;;AAEnE,6BAA6B,UAAU;;AAEvC;;AAEA,sDAAsD,YAAY;AAClE;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF,sDAAsD,YAAY;AAClE;AACA,EAAE;;AAEF,kDAAkD,YAAY;AAC9D;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF,gEAAgE,YAAY;AAC5E;AACA,EAAE;;AAEF,wDAAwD,YAAY;AACpE;AACA,EAAE;;AAEF,wDAAwD,YAAY;AACpE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B,aAAa;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF,sDAAsD,YAAY;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF,oCAAoC,SAAS;AAC7C,oDAAoD,YAAY;AAChE;AACA;;AAEA;AACA;;AAEA;AACA,oCAAoC,QAAQ;AAC5C,mBAAmB,6BAA6B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B,aAAa;AAC1C;AACA;AACA;AACA;AACA,EAAE;;AAEF,0DAA0D,YAAY;AACtE;AACA,EAAE;;AAEF;;AAEA,qCAAqC,aAAa;AAClD;AACA;AACA;AACA;;AAEA,4BAA4B,KAAK;AACjC,4BAA4B,KAAK;AACjC,0BAA0B,KAAK;AAC/B,wBAAwB,KAAK;AAC7B,6BAA6B,KAAK;AAClC,6BAA6B,KAAK;AAClC,6BAA6B,KAAK;AAClC,4BAA4B,KAAK;AACjC,2BAA2B,KAAK;AAChC,8BAA8B,KAAK;;AAEnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;;AAEA;AACA,WAAW,8BAA8B;AACzC;AACA;AACA;AACA,eAAe,OAAO;AACtB,YAAY,2CAA2C;AACvD,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,oBAAoB;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,oCAAoC;AAC/C,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,wFAAwF;AACnG,WAAW,iGAAiG;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,YAAY;AACxD;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA,WAAW,gCAAgC;AAC3C,aAAa;AACb;AACA;AACA,wBAAwB,gBAAgB;;AAExC;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,WAAW,WAAW;AACtB,WAAW,QAAQ;AACnB;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,QAAQ;AACnB;AACA;AACA;AACA,+CAA+C,IAAI;AACnD;AACA;;AAEA,YAAY,KAAK;AACjB;AACA,iDAAiD,+BAA+B;AAChF;;AAEA,YAAY,KAAK;AACjB;AACA,oDAAoD,eAAe;AACnE;;;AClfA;AACA;AACA;AACA,YAAY,MAAM;AAClB,aAAa;AACb;AACO;AACP;AACA;;AAEA,WAAW,8BAA8B;AAClC;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,QAAQ;AACnB,WAAW,8BAA8B;AACzC;AACO;AACP;AACA;AACA;AACA,CAAC,iBAAW;AACZ;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACO;AACP;AACA;;AAEA;AACA,WAAW,aAAa;AACxB,WAAW,8BAA8B;AACzC;AACO,SAAS,iBAAW;AAC3B,wDAAwD,OAAO;AAC/D;;;AClD0C;AACK;;AAE/C;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,aAAa,IAAI;AAC7B,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,OAAO;AAC9B;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACO;;AAEP;AACA;AACA;AACA,YAAY,0BAA0B;AACtC;AACO;AACP,SAAS,iBAAiB;AAC1B,aAAa,gBAAgB;AAC7B;;AAEA;AACA;;AAEA;AACA;AACA,uCAAuC,iDAAiD;;AAExF;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,sBAAsB;AAC1C,oBAAoB,mBAAmB;AACvC;AACA,kDAAkD,YAAY,EAAE;;AAEhE;AACA;AACA;AACA;AACA;AACA,gBAAgB,eAAe;AAC/B,YAAY,KAAK;AACjB,YAAY,QAAQ;AACpB,cAAc;AACd;AACA;AACA;AACA;AACA,6BAA6B,GAAG;AAChC;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,sBAAsB;AACxC;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,wBAAwB;AACpC,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA,YAAY,KAAK;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,uBAAuB;AACnC,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;;AAEA,SAAS,aAAa;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,uBAAuB;AACpD;AACA;AACA,IAAI;AACJ;AACA;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,UAAU;AACvC;AACA,IAAI;AACJ;AACA;AACA;AACA,2BAA2B,uCAAuC;AAClE;AACA;AACA;AACA;AACA,gCAAgC,0BAA0B;AAC1D,OAAO;AACP;AACA;AACA;AACA,qDAAqD,0BAA0B;AAC/E;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,0BAA0B;AACvD;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,0BAA0B;AACxD;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,2BAA2B,UAAU;AACrC;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,MAAM;AACN,+BAA+B,6BAA6B;AAC5D;AACA;AACA,IAAI;AACJ;AACA,8BAA8B,MAAM;AACpC,IAAI;AACJ,GAAG;AACH;AACA;AACA,GAAG;AACH;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACO;AACP,SAAS,sBAAsB;AAC/B,YAAY,8BAA8B;AAC1C;AACA;;AAEA,aAAa,wBAAwB;AACrC,uCAAuC,cAAc;AACrD;;AAEA;AACA,UAAU,2BAA2B;AACrC,UAAU,gBAAgB;AAC1B;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ,+BAA+B,KAAK,+BAA+B;AAC3E;AACA,WAAW,2CAA2C;AACtD,WAAW,4CAA4C;AACvD;AACO;AACP;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;AACA;;AAEA;AACA,qDAAqD,6BAA6B,IAAI,uBAAuB;AAC7G;AACA;AACA,WAAW,QAAQ;AACnB,6BAA6B,sBAAsB;AACnD,WAAW,QAAQ;AACnB;AACA,YAAY,+BAA+B;AAC3C;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;AACA,aAAa,wBAAwB;AACrC;AACA;AACA;;AAEA,YAAY,kCAAkC;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA,eAAe,2BAA2B;AAC1C;AACO;AACP;AACA;;;ACteA;AACA;AACA;AACA;AACA;AACA,cAAc,mCAAmC;AACjD,cAAc,yGAAyG;AACvH;;AAEA,cAAc,YAAY;AAC1B,cAAc,0CAA0C;AACxD,cAAc,mBAAmB;;AAEjC,cAAc,uEAAuE;AACrF,cAAc,oEAAoE;AAClF,cAAc,0CAA0C;AACxD,cAAc,+HAA+H;;AAE7I;AACA,WAAW,8BAA8B;AACzC,aAAa;AACb;AACA;AACA;AACA;;AAEA,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA,YAAY,aAAa;AACzB;AACA;AACA;;AAEA;AACA,WAAW,8BAA8B;AACzC,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA,WAAW,EAAE,GAAG,EAAE,GAAG,EAAE;AACvB;;AAEA;AACA,oEAAoE,oBAAoB;AACxF;AACA,WAAW,QAAQ;AACnB,WAAW,iBAAiB;AAC5B,UAAU,yBAAyB,WAAW;AAC9C,WAAW,yBAAyB;AACpC;AACA,oBAAoB,kCAAkC;AACtD;AACO;AACP,0BAA0B,qBAAqB;;AAE/C,gCAAgC,aAAa;AAC7C,+CAA+C,UAAU;;AAEzD,YAAY,0EAA0E;AACtF;;AAEA;;AAEA;AACA,YAAY,wBAAwB;AACpC,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,cAAc;AACd;AACA;AACA,0BAA0B,SAAS;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,YAAY,wBAAwB;AACpC,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,wBAAwB;AACpC,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa,SAAS;AACtB;AACA;AACA;;AAEA,aAAa,SAAS;AACtB;AACA;AACA;;AAEA,aAAa,SAAS;AACtB;AACA;AACA,UAAU,UAAU;AACpB;AACA;;AAEA;AACA,YAAY,wBAAwB;AACpC,YAAY,SAAS;AACrB,YAAY,SAAS;AACrB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,wBAAwB;AACpC,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,SAAS;AACrB,YAAY,SAAS;AACrB,cAAc;AACd;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,wBAAwB;AACpC,YAAY,SAAS;AACrB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,SAAS;AACrB,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY,wBAAwB;AACpC,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA4B,eAAe;AAC3C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAS;AAC/B,uBAAuB,SAAS;AAChC;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,wCAAwC;AAC3D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,YAAY,wBAAwB;AACpC,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kCAAkC,sBAAsB;AACxD,mCAAmC,sBAAsB;AACzD;AACA;;AAEA;AACA,kBAAkB,YAAY;AAC9B,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAwB,0CAA0C;AAClE;AACA;AACA;AACA;AACA;AACA,qCAAqC,QAAQ;AAC7C;AACA;AACA,IAAI;AACJ;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,wBAAwB,IAAI,+BAA+B;AAC/E,WAAW,cAAc;AACzB,8BAA8B,qBAAqB,0BAA0B,EAAE,GAAG,EAAE,GAAG,EAAE;AACzF,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,wBAAwB,OAAO,wBAAwB;AACvE;AACA;AACA,WAAW,iBAAiB;AAC5B,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;;AC9bA;AACA,aAAa,QAAQ;AACrB,UAAU,eAAe;AACzB,UAAU,cAAc;AACxB,UAAU;AACV;AACA;AACA,sCAAsC;AACtC;;AAEA;AACA,+BAA+B,wBAAwB;AACvD;AACA;AACA,WAAW,eAAe,8CAA8C;AACxE;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,wBAAwB;AACpC,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;;AAEA,aAAa,wBAAwB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,YAAY,kCAAkC;AAC9C;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;ACtFwB;AACU;AACC;AACJ;AACD;AACK;AACa;AACf;;;;;;;;;;ACIlB;AACiC;AACc;AAGrB;AACc;AACR;AAE/C,MAAM,eAAe,GAAG,GAAG;AAC3B,MAAM,kBAAkB,GAAG,GAAG,EAAC,sCAAsC;AACrE,MAAM,SAAS,GAAG,CAAC,GAAG;AACtB,MAAM,SAAS,GAAG,CAAC;AACnB,MAAM,aAAa,GAAG,CAAC,GAAG;AAC1B,MAAM,6BAA6B,GAAG,GAAG;AACzC,MAAM,mBAAmB,GAAG,EAAE;AAI9B,IAAI,OAAO,GAAY,KAAK;AAC5B,IAAI,KAAkB;IAAE,EAAuD;AAE/E,MAAM,UAAU,GAAG,sDAAsD;AAEzE,SAAS,YAAY,CAAC,CAAS,EAAE,CAAS,EAAE,CAAS,EAAE,OAAgB;IACtE,OAAO,GAAG,UAAU,IAAI,OAAO,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,OAAO,EAAE;AACvE,CAAC;AAED,MAAM,SAAS,GAAuE,EAAE;AACxF,IAAI,KAAkB;IACrB,EAIG;AAEJ,MAAM,aAAa,GAAwB;IAC1C,KAAK,CAAC,CAAC,EAAE,IAAI;QACZ,OAAO,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,kBAAkB;IACvC,CAAC;IACD,KAAK,CAAC,CAAC,EAAE,IAAI;QACZ,OAAO,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,kBAAkB;IACvC,CAAC;IAED,KAAK,CAAC,GAAG,EAAE,IAAI;QACd,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,kBAAkB;IACzC,CAAC;IACD,KAAK,CAAC,GAAG,EAAE,IAAI;QACd,OAAO,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,kBAAkB;IACzC,CAAC;IAED,cAAc,CAAC,GAAG,EAAE,IAAI;QACvB,OAAO,IAAI,GAAG,kBAAkB;IACjC,CAAC;CACD;AAaM,MAAM,SAAS,GAAG,6BAAI,CAAC,SAAS,SAAS,CAAC,EAChD,OAAO,EACP,OAAO,EACP,GAAG,EACH,OAAO,GAMP;IACA,MAAM,OAAO,GAAG,wBAAM,CAAiB,IAAI,CAAC;IAC5C,MAAM,MAAM,GAAG,wBAAM,CAIX,IAAI,CAAC;IACf,MAAM,UAAU,GAAG,wBAAM,CAAU,QAAQ,CAAC;IAE5C,2BAAS,CAAC,GAAG,EAAE;QACd,IAAI,CAAC,OAAO,CAAC,OAAO;YAAE,OAAM;QAE5B,SAAS,cAAc,CAAC,CAAS,EAAE,CAAS,EAAE,CAAS;YACtD,MAAM,IAAI,GAAG,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC;YAC1C,OAAO,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;QAC9B,CAAC;QAED,MAAM,mBAAmB,GAA4B,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE;YACjG,IAAI,cAAc,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;gBAAE,uBAAuB,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC;QAC/F,CAAC;QAED,MAAM,aAAa,GAAG,aAAa,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,UAAU,CAAC,OAAO,CAAC,CAAC;QAC3F,MAAM,QAAQ,GAAoB,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,EAAE;YACvD,IAAI,cAAc,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;gBAAE,aAAa,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC;QAC9D,CAAC;QACD,MAAM,aAAa,GAAG,IAAI,mBAAmB,CAAC,eAAe,EAAE,QAAQ,EAAE,mBAAmB,CAAC;QAE7F,MAAM,GAAG,GAAG,IAAI,MAAM,CAAC,OAAO,CAAC,OAAO,EAAE,aAAa,CAAC;QACtD,MAAM,YAAY,GAAG,IAAI,YAAY,EAAE;QACvC,GAAG,CAAC,YAAY,CAAC,CAAC,IAAI,SAAS,GAAG,kBAAkB,EAAE,CAAC,IAAI,SAAS,GAAG,kBAAkB,CAAC;QAC1F,GAAG,CAAC,QAAQ,CAAC,IAAI,SAAS,CAAC,aAAa,CAAC,CAAC;QAC1C,GAAG,CAAC,QAAQ,CAAC,YAAY,CAAC;QAC1B,GAAG,CAAC,QAAQ,CAAC,IAAI,YAAY,EAAE,CAAC;QAChC,GAAG,CAAC,aAAa,EAAE;QACnB,GAAG,CAAC,MAAM,EAAE;QAEZ,gBAAgB,CAAC,QAAQ,EAAE,GAAG,CAAC,MAAM,CAAC;QACtC,MAAM,CAAC,OAAO,GAAG,EAAE,GAAG,EAAE,YAAY,EAAE,aAAa,EAAE;QAErD,OAAO,GAAG,EAAE;YACX,GAAG,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC;YACvC,mBAAmB,CAAC,QAAQ,EAAE,GAAG,CAAC,MAAM,CAAC;YACzC,MAAM,CAAC,OAAO,GAAG,IAAI;QACtB,CAAC;IACF,CAAC,EAAE,EAAE,CAAC;IAEN,2BAAS,CAAC,GAAG,EAAE;QACd,MAAM,CAAC,GAAG,MAAM,CAAC,OAAO;QACxB,UAAU,CAAC,OAAO,GAAG,OAAO;QAC5B,CAAC,EAAE,YAAY,CAAC,UAAU,CAAC,OAAO,CAAC;QACnC,CAAC,EAAE,aAAa,CAAC,UAAU,EAAE;QAC7B,CAAC,EAAE,GAAG,CAAC,aAAa,EAAE;IACvB,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;IAEb,2BAAS,CAAC,GAAG,EAAE;QACd,MAAM,CAAC,OAAO,EAAE,YAAY,CAAC,UAAU,CAAC,OAAO,IAAI,EAAE,CAAC;IACvD,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;IAEb,2BAAS,CAAC,GAAG,EAAE;QACd,MAAM,GAAG,GAAG,MAAM,CAAC,OAAO,EAAE,GAAG;QAC/B,IAAI,CAAC,GAAG;YAAE,OAAM;QAChB,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,GAAG,GAAG,KAAK,MAAM,CAAC,CAAC,CAAC,gBAAgB,CAAC,GAAG,EAAE,OAAO,IAAI,EAAE,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG;QAC5F,GAAG,CAAC,cAAc,CAAC,CAAC,EAAE,CAAC,EAAE,kBAAkB,GAAG,CAAC,IAAI,KAAK,CAAC;IAC1D,CAAC,EAAE,CAAC,GAAG,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;IAE3B,OAAO,oCAAK,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,aAAa,GAAG,OAAO,WAAQ;AACjE,CAAC,CAAC;AAEF,SAAS,gBAAgB,CAAC,GAAW,EAAE,OAAuB,EAAE,OAAgB;IAC/E,IAAI,IAAI,GAAG,IAAI;IACf,IAAI,IAAI,GAAG,CAAC,IAAI;IAChB,IAAI,IAAI,GAAG,IAAI;IACf,IAAI,IAAI,GAAG,CAAC,IAAI;IAChB,KAAK,MAAM,MAAM,IAAI,OAAO,EAAE;QAC7B,IAAI,MAAM,CAAC,OAAO,KAAK,OAAO;YAAE,SAAQ;QACxC,IAAI,IAAI,GAAG,MAAM,CAAC,CAAC;YAAE,IAAI,GAAG,MAAM,CAAC,CAAC;QACpC,IAAI,IAAI,GAAG,MAAM,CAAC,CAAC;YAAE,IAAI,GAAG,MAAM,CAAC,CAAC;QACpC,IAAI,IAAI,GAAG,MAAM,CAAC,CAAC;YAAE,IAAI,GAAG,MAAM,CAAC,CAAC;QACpC,IAAI,IAAI,GAAG,MAAM,CAAC,CAAC;YAAE,IAAI,GAAG,MAAM,CAAC,CAAC;KACpC;IAED,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,GAAG,CAAC,cAAc,EAAE;IACnC,MAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,CAAC,GAAG,6BAA6B;IAC3F,gDAAgD;IAChD,IAAI,KAAK,GAAG,IAAI,KAAK,QAAQ,IAAI,IAAI,GAAG,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;IAC3E,KAAK,GAAG,wBAAK,CAAC,SAAS,EAAE,KAAK,EAAE,SAAS,CAAC;IAE1C,OAAO,EAAE,CAAC,EAAE,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,EAAE;AAC7D,CAAC;AAED,MAAM,YAAY;IACT,GAAG,GAAkB,IAAI;IACzB,OAAO,GAAgB,EAAE;IACzB,SAAS,GAA+B,IAAI,GAAG,EAAE;IACjD,OAAO,GAAY,QAAQ;IAE3B,aAAa,CAAC,GAAW,EAAE,KAAqB;QACvD,MAAM,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,KAAK;QAC7B,MAAM,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC;QAC1C,IAAI,UAAU,EAAE;YACf,IAAI,UAAU,CAAC,GAAG;gBAAE,IAAI,CAAC,GAAG,EAAE,aAAa,EAAE;YAC7C,OAAO,UAAU;SACjB;aAAM;YACN,MAAM,GAAG,GAAG,IAAI,KAAK,EAAE;YACvB,MAAM,IAAI,GAAkB,EAAE,GAAG,EAAE,IAAI,EAAE;YACzC,GAAG,CAAC,GAAG,GAAG,GAAG;YACb,GAAG,CAAC,MAAM,GAAG,GAAG,EAAE;gBACjB,IAAI,CAAC,GAAG;oBACP,KAAK,KAAK,SAAS;wBAClB,CAAC,CAAC,oBAAoB,CAAC,GAAG,EAAE,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE;wBAC1C,CAAC,CAAC,GAAG;gBACP,IAAI,CAAC,GAAG,EAAE,aAAa,EAAE;YAC1B,CAAC;YACD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC;YAC7B,OAAO,IAAI;SACX;IACF,CAAC;IAED,UAAU,CAAC,OAAgB;QAC1B,IAAI,CAAC,OAAO,GAAG,OAAO;IACvB,CAAC;IAED,UAAU,CAAC,UAA0B;QACpC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC;QACvB;YACC,MAAM,KAAK,GAAG,IAAI,CAAC,SAAS;YAC5B,KAAK,MAAM,GAAG,IAAI,KAAK,CAAC,IAAI,EAAE,EAAE;gBAC/B,IAAI,KAAK,CAAC,IAAI,GAAG,EAAE;oBAAE,MAAK;gBAC1B,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC;aACjB;SACD;QACD,KAAK,MAAM,GAAG,IAAI,UAAU,EAAE;YAC7B,MAAM,MAAM,GAAG,EAAE,GAAG,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,IAAI,EAAE,GAAG,CAAC,KAAK,CAAC,EAAE,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE;YAC1F,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC;SACzB;IACF,CAAC;IAED,MAAM,CAAC,GAAW;QACjB,MAAM,EAAE,GAAG,GAAG,CAAC,YAAY,EAAE;QAC7B,IAAI,CAAC,EAAE;YAAE,OAAM;QAEf,MAAM,CAAC,KAAK,EAAE,KAAK,CAAC,GAAG,GAAG,CAAC,eAAe,EAAE;QAC5C,MAAM,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,eAAe,GAAG,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QAEhF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,OAAO,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAChE,MAAM,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC;YACzB,IAAI,MAAM,CAAC,OAAO,KAAK,IAAI,CAAC,OAAO;gBAAE,SAAQ;YAE7C,MAAM,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,KAAK;YACrC,MAAM,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,KAAK;YACrC,MAAM,IAAI,GAAG,mBAAmB,GAAG,aAAa;YAChD,MAAM,KAAK,GAAG,GAAG,GAAG,aAAa;YACjC,MAAM,SAAS,GAAG,MAAM,CAAC,KAAK,KAAK,QAAQ;YAE3C,IAAI,SAAS,EAAE;gBACd,EAAE,CAAC,SAAS,EAAE;gBACd,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,CAAC;gBAChE,EAAE,CAAC,SAAS,GAAG,MAAM;gBACrB,EAAE,CAAC,IAAI,EAAE;aACT;YAED,MAAM,GAAG,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG;YAC3B,IAAI,GAAG,KAAK,IAAI,EAAE;gBACjB,MAAM,KAAK,GAAG,cAAc,IAAI,GAAG;gBACnC,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK;gBAC/C,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM;gBACjD,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,GAAG,EAAE,EAAE,IAAI,GAAG,EAAE,CAAC;gBAC5C,MAAM,CAAC,GAAG,EAAE,GAAG,KAAK;gBACpB,MAAM,CAAC,GAAG,EAAE,GAAG,KAAK;gBACpB,IAAI,SAAS,EAAE;oBACd,EAAE,CAAC,IAAI,EAAE;oBACT,EAAE,CAAC,SAAS,EAAE;oBACd,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,GAAG,IAAI,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,CAAC;oBAChE,EAAE,CAAC,IAAI,EAAE;iBACT;gBACD,EAAE,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;gBAC7C,IAAI,SAAS,EAAE;oBACd,EAAE,CAAC,OAAO,EAAE;iBACZ;aACD;YAED,IAAI,SAAS,EAAE;gBACd,EAAE,CAAC,SAAS,EAAE;gBACd,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,GAAG,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK,CAAC;gBAC7C,EAAE,CAAC,WAAW,GAAG,OAAO;gBACxB,EAAE,CAAC,SAAS,GAAG,KAAK;gBACpB,EAAE,CAAC,MAAM,EAAE;aACX;SACD;IACF,CAAC;IAED,QAAQ,CAAC,GAAW;QACnB,IAAI,CAAC,GAAG,GAAG,GAAG;IACf,CAAC;IAED,UAAU,CAAC,GAAW;QACrB,IAAI,CAAC,GAAG,GAAG,IAAI;QACf,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC;IACxB,CAAC;CACD;AAED,SAAS,oBAAoB,CAAC,GAAqB,EAAE,IAAY,EAAE,KAAa;IAC/E,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC;IAC/C,MAAM,CAAC,KAAK,GAAG,GAAG,CAAC,YAAY;IAC/B,MAAM,CAAC,MAAM,GAAG,GAAG,CAAC,aAAa;IACjC,MAAM,EAAE,GAAG,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC;IAClC,IAAI,EAAE,EAAE;QACP,EAAE,CAAC,UAAU,GAAG,IAAI;QACpB,EAAE,CAAC,WAAW,GAAG,KAAK;QACtB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;YAAE,EAAE,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;KACnD;IACD,OAAO,MAAM;AACd,CAAC;;;;;;;;;;;;;;;;;;AC5SD;AACA;AACA;AACA,WAAW,GAAG;AACd,WAAW,GAAG;AACd,aAAa;AACb;AACO,SAAS,WAAM;AACtB;AACA,mBAAmB,OAAO;AAC1B;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;;;AC3BuC;AACC;;AAExC;AACA;AACA;AACA,WAAW,wCAAwC;AACnD,WAAW,yCAAyC;AACpD,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU,cAAc;AACxB;;AAEA;AACA;;AAEA;AACA;AACA,SAAS,gCAAa;AACtB;AACA;AACA;AACA;AACA;AACA;;;ACjC+C;;AAE/C;AACA,WAAW,4CAA4C,cAAc,GAAG;AACxE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU;AACV,WAAW,2BAA2B;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE,yBAAM;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE,yBAAM;AACR,GAAG,gCAAa,oBAAoB,wBAAwB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,4BAA4B;AACvC,WAAW,oCAAoC;AAC/C;AACO;AACP,QAAQ,gCAAa,WAAW,sCAAsC;AACtE;;;AC/EA,yEAAyE;AACzE,yHAAyH;AAC3C;AACmB;AAK1F,MAAM,0BAAY,GAAG,YAAwC;AAC7D,MAAM,kBAAI,GAAG,IAAwB;;;;;;;;;;;;;;;;;ACT5C;AACA;AACA,WAAW,QAAQ;AACnB,aAAa;AACb;AACO;AACP;AACA;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,aAAa;AACb;AACO;AACP;AACA;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,aAAa;AACb;AACO;AACP;AACA;;AAEA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACO;AACP;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,SAAS;AACpB,aAAa;AACb;AACO;AACP;AACA;;AAEA;AACA,WAAW,SAAS;AACpB,WAAW,SAAS;AACp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ACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3SyD;;AAElD,yBAAyB,OAAO;AACvC;AACA;AACA,wCAAwC,uBAAuB;AAC/D;AACA,CAAC;;AAED;AACA,WAAW,8BAA8B;AACzC,WAAW,QAAQ;AACnB,aAAa;AACb;AACO;AACP;AACA;AACA,yBAAyB,uBAAuB,MAAM;AACtD;AACA;AACA;AACA,IAAI;AACJ,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,8BAA8B;AACzC,WAAW,QAAQ;AACnB,aAAa;AACb;AACO;AACP;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;;;;AC/D8C;AACI;AAEf;AAkBnC,MAAM,eAAe,GAAG,iBAAiB,CAAC,gBAAe,CAAC;AAE1D,SAAS,mBAAmB,CAAC,MAAc,EAAE,GAAW;IACvD,KAAK,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,IAAI,MAAM,EAAE;QACnC,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,EAAE,GAAG,CAAC;QACnC,IAAI,KAAK;YAAE,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC;KAC/B;IACD,OAAO,IAAI;AACZ,CAAC;AAED,SAAS,cAAc,CAAC,GAAuD;IAC9E,OAAO,GAAG,CAAC,QAAQ,GAAG,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC,IAAI;AAC5C,CAAC;AAED,SAAS,iBAAiB,CAAC,CAAa,EAAE,MAAc;IACvD,IAAI,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,QAAQ,IAAI,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC;QAAE,OAAM;IAE9E,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,YAAY,OAAO,IAAI,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC;IAC9D,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,MAAM,KAAK,OAAO,CAAC,EAAE;QACvD,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;QAC3B,IAAI,GAAG,CAAC,MAAM,KAAK,QAAQ,CAAC,MAAM,EAAE;YACnC,IAAI,mBAAmB,CAAC,MAAM,EAAE,GAAG,CAAC,QAAQ,CAAC,EAAE;gBAC9C,IAAI,cAAc,CAAC,QAAQ,CAAC,KAAK,cAAc,CAAC,GAAG,CAAC;oBACnD,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,EAAE,EAAE,cAAc,CAAC,GAAG,CAAC,CAAC;gBACjD,CAAC,CAAC,cAAc,EAAE;gBAClB,OAAO,IAAI;aACX;SACD;KACD;AACF,CAAC;AAEM,SAAS,SAAS,CAAC,MAAc;IACvC,MAAM,CAAC,EAAE,WAAW,CAAC,GAAG,0BAAQ,CAAC,CAAC,CAAC;IAEnC,2BAAS,CAAC,GAAG,EAAE;QACd,SAAS,OAAO,CAAC,CAAa;YAC7B,MAAM,OAAO,GAAG,iBAAiB,CAAC,CAAC,EAAE,MAAM,CAAC;YAC5C,IAAI,OAAO;gBAAE,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QACrC,CAAC;QACD,SAAS,UAAU,CAAC,CAAgB;YACnC,WAAW,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;QACxB,CAAC;QACD,gBAAgB,CAAC,OAAO,EAAE,OAAO,CAAC;QAClC,gBAAgB,CAAC,UAAU,EAAE,UAAU,CAAC;QACxC,OAAO,GAAG,EAAE;YACX,mBAAmB,CAAC,OAAO,EAAE,OAAO,CAAC;YACrC,mBAAmB,CAAC,UAAU,EAAE,UAAU,CAAC;QAC5C,CAAC;IACF,CAAC,EAAE,CAAC,MAAM,CAAC,CAAC;IAEZ,MAAM,GAAG,GAAG,mBAAmB,CAAC,MAAM,EAAE,QAAQ,CAAC,QAAQ,CAAC;IAC1D,IAAI,CAAC,GAAG;QAAE,OAAO,KAAK;IACtB,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,GAAG,GAAG;IACzB,OAAO,2BAAC,IAAI,OAAK,KAAK,WAAI;AAC3B,CAAC;AAEM,MAAM,KAAK,GAAG,CACpB,IAAW,EACX,IAAqC,EACR,EAAE,CAAC,CAAC,CAAC,eAAe,EAAE,GAAG,IAAI,CAAC,EAAE,IAAqB,CAAC;AAEpF,SAAS,iBAAiB,CAAC,IAAY;IACtC,OAAO,IAAI,KAAK,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK;AAClC,CAAC;AAEM,SAAS,uBAAuB,CAAC,IAAY;IACnD,MAAM,GAAG,GAAG,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC,IAAI;IAC/D,MAAM,SAAS,GAAG,eAAe;IACjC,MAAM,SAAS,GAAG,iBAAiB,CAAC,IAAI,CAAC;IACzC,IAAI,MAAM,GAAG,SAAS,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;IACxF,IAAI,MAAM,KAAK,EAAE;QAAE,MAAM,GAAG,GAAG;IAC/B,OAAO,MAAM;AACd,CAAC;AAEM,SAAS,CAAC,CAChB,KAAyG;IAEzG,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC;IAChC,aAAa;IACb,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,QAAQ;IAC1B,OAAO,KAAK,CAAC,QAAQ;IACrB,IAAI,KAAK,CAAC,IAAI;QAAE,KAAK,CAAC,IAAI,GAAG,eAAe,GAAG,KAAK,CAAC,IAAI;IACzD,qDAAqD;IACrD,iEAAiE;IACjE,OAAO,YAAC,CAAC,GAAG,EAAE,KAAgC,CAAC;AAChD,CAAC;;;AC1GD;AACA;AACA,WAAW,KAAK;AAChB,aAAa;AACb;AACO;AACP,8BAA8B,QAAQ;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,aAAa;AACb;AACO;AACP,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa;AACb;AACO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,qBAAqB;AAChC,aAAa;AACb;AACO;AACP,uBAAuB,MAAM;AAC7B,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,WAAW;AACtB,WAAW,WAAW;AACtB;AACO;AACP;AACA,iBAAiB,cAAc;AAC/B;AACA;;AAEA;AACA,WAAW,WAAW;AACtB,WAAW,WAAW;AACtB;AACO;AACP;AACA,iBAAiB,cAAc;AAC/B;AACA;;AAEA;AACA,cAAc,QAAQ;AACtB;AACA,WAAW,oBAAoB;AAC/B,WAAW,0CAA0C;AACrD,aAAa;AACb;AACO;AACP,2BAA2B,cAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,GAAG;AACd,WAAW,MAAM;AACjB,aAAa;AACb;AACO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,WAAW,MAAM;AACjB,WAAW,YAAY;AACvB,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAc,QAAQ;AACtB;AACA,WAAW,6BAA6B;AACxC,WAAW,MAAM;AACjB,WAAW,YAAY;AACvB,aAAa;AACb;AACO;AACP;AACA;AACA;AACA;AACA,kBAAkB,KAAK;AACvB;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,aAAa;AACb;AACO;AACP;AACA;;;;;AClJO,MAAM,mBAAmB,GAAwB,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE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","sources":["webpack://gi_builds/./node_modules/locmap/src/map.js","webpack://gi_builds/./node_modules/js-control/src/index.js","webpack://gi_builds/./node_modules/locmap/src/utils.js","webpack://gi_builds/./node_modules/locmap/src/control_layer.js","webpack://gi_builds/./node_modules/locmap/src/tile_container.js","webpack://gi_builds/./node_modules/locmap/src/tile_layer.js","webpack://gi_builds/./node_modules/locmap/src/index.js","webpack://gi_builds/./www/src/components/teyvat-map.tsx","webpack://gi_builds/./node_modules/preact/compat/src/util.js","webpack://gi_builds/./node_modules/preact/compat/src/memo.js","webpack://gi_builds/./node_modules/preact/compat/src/portals.js","webpack://gi_builds/./www/src/utils/preact-compat.tsx","webpack://gi_builds/./lib/utils/values.js","webpack://gi_builds/./node_modules/preact/dist/preact.mjs","webpack://gi_builds/./node_modules/preact/hooks/dist/hooks.mjs","webpack://gi_builds/./node_modules/preact/jsx-runtime/dist/jsxRuntime.mjs","webpack://gi_builds/webpack/bootstrap","webpack://gi_builds/webpack/runtime/define property getters","webpack://gi_builds/webpack/runtime/hasOwnProperty shorthand","webpack://gi_builds/webpack/runtime/make namespace object","webpack://gi_builds/webpack/runtime/publicPath","webpack://gi_builds/./node_modules/preact-render-to-string/dist/index.mjs","webpack://gi_builds/./www/src/components/page-wrap.tsx","webpack://gi_builds/./www/src/i18n/i18n.tsx","webpack://gi_builds/./www/src/containers/footer.tsx","webpack://gi_builds/./www/src/api/generated.js","webpack://gi_builds/./www/src/routes/paths.js","webpack://gi_builds/./www/src/routes/router.tsx","webpack://gi_builds/./lib/utils/collections.js","webpack://gi_builds/./www/src/utils/bootstrap.tsx","webpack://gi_builds/./www/src/utils/hooks.tsx","webpack://gi_builds/./www/src/utils/typography.tsx","webpack://gi_builds/./www/src/components/globe-icon.tsx","webpack://gi_builds/./www/src/components/nav.tsx","webpack://gi_builds/./www/src/containers/header.tsx","webpack://gi_builds/./lib/utils/date.js","webpack://gi_builds/./lib/genshin.js","webpack://gi_builds/./www/src/api/utils.ts","webpack://gi_builds/./www/src/api/endpoints.ts","webpack://gi_builds/./www/src/api/index.ts","webpack://gi_builds/./www/src/components/spinners.tsx","webpack://gi_builds/./www/src/media/circlet.png","webpack://gi_builds/./www/src/media/flower.png","webpack://gi_builds/./www/src/media/goblet.png","webpack://gi_builds/./www/src/media/plume.png","webpack://gi_builds/./www/src/media/sands.png","webpack://gi_builds/./www/src/utils/artifacts.tsx","webpack://gi_builds/./www/src/components/block-header.tsx","webpack://gi_builds/./www/src/components/select.tsx","webpack://gi_builds/./www/src/components/tabs.tsx","webpack://gi_builds/./www/src/utils/calc-pos-for-dd.tsx","webpack://gi_builds/./www/src/containers/item-cards/item-detail-dd-portal.tsx","webpack://gi_builds/./www/src/components/tooltip.tsx","webpack://gi_builds/./www/src/utils/local-storage-keys.tsx","webpack://gi_builds/./www/src/modules/builds/common.tsx","webpack://gi_builds/./www/src/utils/characters.tsx","webpack://gi_builds/./www/src/utils/domains.tsx","webpack://gi_builds/./www/src/utils/enemies.tsx","webpack://gi_builds/./www/src/utils/items.tsx","webpack://gi_builds/./www/src/media/Icon_Bow.png","webpack://gi_builds/./www/src/media/Icon_Catalyst.png","webpack://gi_builds/./www/src/media/Icon_Claymore.png","webpack://gi_builds/./www/src/media/Icon_Polearm.png","webpack://gi_builds/./www/src/media/Icon_Sword.png","webpack://gi_builds/./www/src/utils/weapons.tsx","webpack://gi_builds/./www/src/containers/alchemy-calculator.tsx","webpack://gi_builds/./www/src/containers/item-cards/dd-cards.tsx","webpack://gi_builds/./www/src/containers/item-cards/item-avatars.tsx","webpack://gi_builds/./www/src/media/Element_Anemo.png","webpack://gi_builds/./www/src/media/Element_Cryo.png","webpack://gi_builds/./www/src/media/Element_Electro.png","webpack://gi_builds/./www/src/media/Element_Geo.png","webpack://gi_builds/./www/src/media/Element_Hydro.png","webpack://gi_builds/./www/src/media/Element_Pyro.png","webpack://gi_builds/./www/src/utils/elements.tsx","webpack://gi_builds/./www/src/containers/character-picker/mobile-character-picker.tsx","webpack://gi_builds/./www/src/containers/character-picker/character-picker.tsx","webpack://gi_builds/./www/src/containers/character-picker/favorite-characters.tsx","webpack://gi_builds/./www/src/components/characters.tsx","webpack://gi_builds/./www/src/utils/strings.ts","webpack://gi_builds/./www/src/modules/builds/character-build-detailed.tsx","webpack://gi_builds/./www/src/pages/builds.tsx","webpack://gi_builds/./www/src/modules/equipment/weapons-list.tsx","webpack://gi_builds/./www/src/modules/equipment/equipment.tsx","webpack://gi_builds/./www/src/pages/equipment.tsx","webpack://gi_builds/./www/src/containers/farm-today.tsx","webpack://gi_builds/./www/src/containers/region-switch.tsx","webpack://gi_builds/./www/src/utils/dates.tsx","webpack://gi_builds/./www/src/containers/time-until-day-reset.tsx","webpack://gi_builds/./www/src/modules/builds/character-build-preview.tsx","webpack://gi_builds/./www/src/pages/front-page.tsx","webpack://gi_builds/./www/src/App.tsx","webpack://gi_builds/./www/src/index.tsx"],"sourcesContent":["/**\n * @typedef {{\n *   x2lon(x:number, zoom:number):number,\n *   y2lat(y:number, zoom:number):number,\n *   lon2x(lon:number, zoom:number):number,\n *   lat2y(lat:number, zoom:number):number,\n *   meters2pixCoef(lat:number, zoom:number):number,\n * }} ProjectionConverter\n */\n\n/**\n * @template T\n * @typedef {(map:LocMap, params:T) => unknown} MapEventHandler\n */\n\n/**\n * @typedef {{\n *   [K in keyof import('./common_types').MapEventHandlersMap]?:\n *     MapEventHandler<import('./common_types').MapEventHandlersMap[K]>\n * } & Record<string, MapEventHandler<any>>} MapEventHandlers\n */\n\n/**\n * @typedef {{\n *   register?(map:LocMap): unknown,\n *   unregister?(map:LocMap): unknown,\n *   update?(map:LocMap): unknown,\n *   redraw?(map:LocMap): unknown,\n *   onEvent?: MapEventHandlers,\n * }} MapLayer\n */\n\n/**\n * Core map engine. Manages location, layers and some transition animations.\n * @class\n * @param {HTMLElement} wrap main map element, should be relative/absolute for canvas to scale correctly\n * @param {ProjectionConverter} conv projection config, usually `ProjectionMercator`\n */\nexport function LocMap(wrap, conv) {\n\tconst rect = wrap.getBoundingClientRect()\n\tlet curWidth = rect.width\n\tlet curHeight = rect.height\n\n\tlet lon = 0\n\tlet lat = 0\n\tlet zoom = 256\n\tlet xShift = 0\n\tlet yShift = 0\n\tlet minZoom = 0\n\tlet maxZoom = Infinity\n\n\tthis.getLon = () => lon\n\tthis.getLat = () => lat\n\tthis.getZoom = () => zoom\n\tthis.getProjConv = () => conv\n\t/**\n\t * Map top-left edge offset from the view center (in pixels)\n\t * @returns {[x:number, y:number]}\n\t */\n\tthis.getShift = () => [xShift, yShift]\n\t/** Returns current projection config */\n\t/**\n\t * Map top-left edge offset from the view top-left edge (in pixels)\n\t * @returns {[x:number, y:number]}\n\t */\n\tthis.getViewBoxShift = () => [xShift - curWidth / 2, yShift - curHeight / 2]\n\t/**\n\t * Map view size\n\t * @returns {[x:number, y:number]}\n\t */\n\tthis.getViewBoxSize = () => [curWidth, curHeight]\n\n\t/**\n\t * Returns min and max zoom\n\t * @returns {[min:number, max:number]}\n\t */\n\tthis.getZoomRange = () => [minZoom, maxZoom]\n\t/**\n\t * Sets min and max zoom. Does not clamp current zoom.\n\t * @param {number} min\n\t * @param {number} max\n\t */\n\tthis.setZoomRange = (min, max) => {\n\t\tminZoom = min\n\t\tmaxZoom = max\n\t}\n\n\tconst canvas = document.createElement('canvas')\n\tcanvas.className = 'locmap-canvas'\n\tcanvas.style.position = 'absolute'\n\tcanvas.style.left = '0'\n\tcanvas.style.top = '0'\n\tcanvas.style.width = '100%'\n\tcanvas.style.height = '100%'\n\twrap.appendChild(canvas)\n\tconst rc = canvas.getContext('2d')\n\n\tthis.getWrap = () => wrap\n\tthis.getCanvas = () => canvas\n\tthis.get2dContext = () => rc\n\n\tfunction pos_screen2map() {\n\t\tlon = conv.x2lon(xShift, zoom)\n\t\tlat = conv.y2lat(yShift, zoom)\n\t}\n\tfunction pos_map2screen() {\n\t\txShift = conv.lon2x(lon, zoom)\n\t\tyShift = conv.lat2y(lat, zoom)\n\t}\n\n\t/** @param {number} lon */\n\tthis.lon2x = lon => {\n\t\treturn conv.lon2x(lon, zoom)\n\t}\n\t/** @param {number} lat */\n\tthis.lat2y = lat => {\n\t\treturn conv.lat2y(lat, zoom)\n\t}\n\t/** @param {number} lat */\n\tthis.meters2pixCoef = lat => {\n\t\treturn conv.meters2pixCoef(lat, zoom)\n\t}\n\t/** @param {number} x */\n\tthis.x2lon = x => {\n\t\treturn conv.x2lon(x, zoom)\n\t}\n\t/** @param {number} y */\n\tthis.y2lat = y => {\n\t\treturn conv.y2lat(y, zoom)\n\t}\n\n\t//----------\n\t// core\n\t//----------\n\n\tconst layers = /** @type {MapLayer[]} */ ([])\n\t/** @param {MapLayer} layer */\n\tthis.register = layer => {\n\t\tif (layers.includes(layer)) throw new Error('already registered')\n\t\tlayers.push(layer)\n\t\tif (layer.register) layer.register(this)\n\t}\n\t/** @param {MapLayer} layer */\n\tthis.unregister = layer => {\n\t\tconst pos = layers.indexOf(layer)\n\t\tif (pos === -1) throw new Error('not registered yet')\n\t\tlayers.splice(pos, 1)\n\t\tif (layer.unregister) layer.unregister(this)\n\t}\n\t/** @returns {readonly MapLayer[]} */\n\tthis.getLayers = () => layers\n\n\t/**\n\t * Instantly update map location and zoom.\n\t * @param {number} lon_\n\t * @param {number} lat_\n\t * @param {number} zoom_\n\t */\n\tthis.updateLocation = (lon_, lat_, zoom_) => {\n\t\tlon = lon_\n\t\tlat = lat_\n\t\tzoom = zoom_\n\t\tpos_map2screen()\n\t\tupdateLayers()\n\t\trequestRedraw()\n\t}\n\n\tconst updateLayers = () => {\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tconst layer = layers[i]\n\t\t\tif (layer.update) layer.update(this)\n\t\t}\n\t}\n\tconst drawLayers = () => {\n\t\tif (rc === null) return\n\t\trc.clearRect(0, 0, canvas.width, canvas.height)\n\t\trc.scale(devicePixelRatio, devicePixelRatio)\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tconst layer = layers[i]\n\t\t\tif (layer.redraw) layer.redraw(this)\n\t\t}\n\t\trc.scale(1 / devicePixelRatio, 1 / devicePixelRatio)\n\t}\n\n\tconst ZOOM_ANIM_MODE_SMOOTH = 0\n\tconst ZOOM_ANIM_MODE_INERTIA = 1\n\tconst zoomAnimationMinSpeed = 0.0001 //zoom_change/ms\n\tconst zoomInertiaDeceleration = 0.993\n\tconst zoomSmoothDeceleration = 0.983\n\tlet zoomAnimationMode = /**@type {0|1}*/ (ZOOM_ANIM_MODE_SMOOTH)\n\tlet zoomAnimationPrevStamp = 0\n\tlet zoomAnimationX = 0\n\tlet zoomAnimationY = 0\n\tlet zoomAnimationDelta = 1\n\n\tconst MOVE_ANIM_MODE_SMOOTH = 0\n\tconst MOVE_ANIM_MODE_INERTIA = 1\n\tconst moveInertiaDeceleration = 0.993 //relative speed decrease per 1ms\n\tconst moveSmoothDeceleration = 0.985\n\tconst moveAnimationMinSpeed = 0.01 //pixels/ms\n\tlet moveAnimationMode = /**@type {0|1}*/ (MOVE_ANIM_MODE_SMOOTH)\n\tlet moveAnimationPrevStamp = 0\n\tlet moveAnimationX = 0\n\tlet moveAnimationY = 0\n\n\t/** @param {number} frameTime */\n\tconst smoothIfNecessary = frameTime => {\n\t\tconst now = performance.now()\n\n\t\tif (Math.abs(zoomAnimationDelta - 1) > zoomAnimationMinSpeed) {\n\t\t\tconst elapsed = now - zoomAnimationPrevStamp\n\n\t\t\tlet dz\n\t\t\tif (zoomAnimationMode === ZOOM_ANIM_MODE_INERTIA) {\n\t\t\t\tdz = zoomAnimationDelta ** elapsed\n\t\t\t\tconst inertiaK = zoomInertiaDeceleration ** elapsed\n\t\t\t\tzoomAnimationDelta = 1 + (zoomAnimationDelta - 1) * inertiaK\n\t\t\t} else {\n\t\t\t\tconst smoothK = zoomSmoothDeceleration ** elapsed\n\t\t\t\tlet newSmoothDelta = 1 + (zoomAnimationDelta - 1) * smoothK\n\t\t\t\tif (Math.abs(newSmoothDelta - 1) <= zoomAnimationMinSpeed) newSmoothDelta = 1\n\t\t\t\tdz = zoomAnimationDelta / newSmoothDelta\n\t\t\t\tzoomAnimationDelta = newSmoothDelta\n\t\t\t}\n\n\t\t\tthis.zoom(zoomAnimationX, zoomAnimationY, dz)\n\t\t\tzoomAnimationPrevStamp = now\n\t\t}\n\n\t\tif (moveAnimationX ** 2 + moveAnimationY ** 2 > moveAnimationMinSpeed ** 2) {\n\t\t\tconst elapsed = now - moveAnimationPrevStamp\n\n\t\t\tlet dx, dy\n\t\t\tif (moveAnimationMode === MOVE_ANIM_MODE_INERTIA) {\n\t\t\t\tdx = moveAnimationX * elapsed\n\t\t\t\tdy = moveAnimationY * elapsed\n\t\t\t\tconst k = moveInertiaDeceleration ** elapsed\n\t\t\t\tmoveAnimationX *= k\n\t\t\t\tmoveAnimationY *= k\n\t\t\t} else {\n\t\t\t\tlet k = moveSmoothDeceleration ** elapsed\n\t\t\t\tlet newX = moveAnimationX * k\n\t\t\t\tlet newY = moveAnimationY * k\n\t\t\t\tif (newX ** 2 + newY ** 2 < moveAnimationMinSpeed ** 2) k = 0\n\t\t\t\tdx = moveAnimationX * (1 - k)\n\t\t\t\tdy = moveAnimationY * (1 - k)\n\t\t\t\tmoveAnimationX *= k\n\t\t\t\tmoveAnimationY *= k\n\t\t\t}\n\n\t\t\tthis.move(dx, dy)\n\t\t\tmoveAnimationPrevStamp = now\n\t\t}\n\t}\n\n\tlet animFrameRequested = false\n\tfunction requestRedraw() {\n\t\tif (!animFrameRequested) {\n\t\t\tanimFrameRequested = true\n\t\t\trequestAnimationFrame(onAnimationFrame)\n\t\t}\n\t}\n\t/** @param {number} frameTime */\n\tfunction onAnimationFrame(frameTime) {\n\t\tanimFrameRequested = false\n\t\tsmoothIfNecessary(frameTime)\n\t\tdrawLayers()\n\t}\n\t/** Schedules map redraw (unless already scheduled). Can be safelyl called multiple times per frame. */\n\tthis.requestRedraw = requestRedraw\n\n\t//-------------------\n\t// control inner\n\t//-------------------\n\n\t/**\n\t * Should be called after map element (`wrap`) resize to update internal state and canvas.\n\t */\n\tthis.resize = () => {\n\t\tconst rect = wrap.getBoundingClientRect()\n\n\t\tcanvas.width = rect.width * devicePixelRatio\n\t\tcanvas.height = rect.height * devicePixelRatio\n\n\t\tcurWidth = rect.width\n\t\tcurHeight = rect.height\n\n\t\trequestRedraw()\n\t}\n\n\t/**\n\t * Zoom in `delta` times using `(x,y)` as a reference point\n\t * (stays in place when zooming, usually mouse position).\n\t * `0 < zoom < 1` for zoom out.\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} delta\n\t */\n\tthis.zoom = (x, y, delta) => {\n\t\tconst prevZoom = zoom\n\t\tzoom = mutlClamp(minZoom, maxZoom, zoom, delta)\n\t\tconst actualDelta = zoom / prevZoom\n\t\txShift += (-x + curWidth / 2 - xShift) * (1 - actualDelta)\n\t\tyShift += (-y + curHeight / 2 - yShift) * (1 - actualDelta)\n\t\tpos_screen2map()\n\n\t\tupdateLayers()\n\t\trequestRedraw()\n\t\tthis.emit('mapZoom', { x, y, delta })\n\t}\n\n\t/**\n\t * Zoom in `delta` times smoothly using `(x,y)` as a reference point.\n\t * Motion resembles `ease-out`, i.e. slowing down to the end.\n\t * Useful for handling zoom buttons and mouse wheel.\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} delta\n\t * @param {number} stamp zoom start time, usually `event.timeStamp` or `performance.now()`\n\t */\n\tthis.zoomSmooth = (x, y, delta, stamp) => {\n\t\tif (zoomAnimationMode !== ZOOM_ANIM_MODE_SMOOTH) zoomAnimationDelta = 1\n\t\tzoomAnimationDelta = mutlClamp(minZoom / zoom, maxZoom / zoom, zoomAnimationDelta, delta)\n\t\tzoomAnimationX = x\n\t\tzoomAnimationY = y\n\t\tzoomAnimationPrevStamp = stamp\n\t\tzoomAnimationMode = ZOOM_ANIM_MODE_SMOOTH\n\t\tsmoothIfNecessary(stamp)\n\t}\n\n\t/**\n\t * Move map view by `(dx,dy)` pixels.\n\t * @param {number} dx\n\t * @param {number} dy\n\t */\n\tthis.move = (dx, dy) => {\n\t\txShift -= dx\n\t\tyShift -= dy\n\t\tpos_screen2map()\n\n\t\tupdateLayers()\n\t\trequestRedraw()\n\t\tthis.emit('mapMove', { dx, dy })\n\t}\n\n\t/**\n\t * Move map view smoothly by `(dx,dy)` pixels.\n\t * Motion resembles `ease-out`, i.e. slowing down to the end.\n\t * Useful for handling move buttons.\n\t * @param {number} dx\n\t * @param {number} dy\n\t * @param {number} stamp move start time, usually `event.timeStamp` or `performance.now()`\n\t */\n\tthis.moveSmooth = (dx, dy, stamp) => {\n\t\tif (moveAnimationMode !== MOVE_ANIM_MODE_SMOOTH) moveAnimationX = moveAnimationY = 0\n\t\tmoveAnimationX += dx\n\t\tmoveAnimationY += dy\n\t\tmoveAnimationPrevStamp = stamp\n\t\tmoveAnimationMode = MOVE_ANIM_MODE_SMOOTH\n\t\tsmoothIfNecessary(stamp)\n\t}\n\n\t/**\n\t * Start moving map view with a certain speed and a gradual slowdown.\n\t * Useful for mouse/touch handling.\n\t * @param {number} dx horizontal speed in px/ms\n\t * @param {number} dy vertival speed in px/ms\n\t * @param {number} stamp move start time, usually `event.timeStamp` or `performance.now()`\n\t */\n\tthis.applyMoveInertia = (dx, dy, stamp) => {\n\t\tmoveAnimationX = dx\n\t\tmoveAnimationY = dy\n\t\tmoveAnimationPrevStamp = stamp\n\t\tmoveAnimationMode = MOVE_ANIM_MODE_INERTIA\n\t\tsmoothIfNecessary(stamp)\n\t}\n\t/**\n\t * Start zoomin map with a certain speed and a gradual slowdown around `(x,y)` reference point.\n\t * Useful for multitouch pinch-zoom handling.\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} delta zoom speed, times per ms.\n\t * @param {number} stamp zoom start time, usually `event.timeStamp` or `performance.now()`\n\t */\n\tthis.applyZoomInertia = (x, y, delta, stamp) => {\n\t\tzoomAnimationDelta = delta\n\t\tzoomAnimationX = x\n\t\tzoomAnimationY = y\n\t\tzoomAnimationPrevStamp = stamp\n\t\tzoomAnimationMode = ZOOM_ANIM_MODE_INERTIA\n\t\tsmoothIfNecessary(stamp)\n\t}\n\n\t//------------\n\t// events\n\t//------------\n\n\t// TODO: if it could be overloaded, `K` may be `keyof MapEventHandlersMap`\n\t//       and editor will provide `name` completions (like with `addEventListener`)\n\t//       https://github.com/microsoft/TypeScript/issues/25590\n\t/**\n\t * Emits a built-in (see {@linkcode MapEventHandlersMap}) or custom event with some arguments.\n\t * @template {string} K\n\t * @param {K} name\n\t * @param {K extends keyof import('./common_types').MapEventHandlersMap\n\t *           ? import('./common_types').MapEventHandlersMap[K]\n\t *           : unknown} params\n\t */\n\tthis.emit = (name, params) => {\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tconst layer = layers[i]\n\t\t\tconst handler = layer.onEvent && layer.onEvent[name]\n\t\t\tif (handler) handler(this, params)\n\t\t}\n\t}\n\n\t//-----------\n\t// setup\n\t//-----------\n\n\tpos_map2screen()\n}\n\n/** @type {ProjectionConverter} */\nexport const ProjectionFlat = {\n\tx2lon(x, zoom) {\n\t\treturn x / zoom\n\t},\n\ty2lat(y, zoom) {\n\t\treturn y / zoom\n\t},\n\n\tlon2x(lon, zoom) {\n\t\treturn lon * zoom\n\t},\n\tlat2y(lat, zoom) {\n\t\treturn lat * zoom\n\t},\n\n\tmeters2pixCoef(lat, zoom) {\n\t\treturn zoom\n\t},\n}\n\n/** @type {ProjectionConverter} */\nexport const ProjectionMercator = {\n\tx2lon(x, z) {\n\t\treturn (x / z) * 360 - 180\n\t},\n\ty2lat(y, z) {\n\t\tconst n = Math.PI - (2 * Math.PI * y) / z\n\t\treturn (180 / Math.PI) * Math.atan(0.5 * (Math.exp(n) - Math.exp(-n)))\n\t},\n\n\tlon2x(lon, zoom) {\n\t\treturn ((lon + 180) / 360) * zoom\n\t},\n\tlat2y(lat, zoom) {\n\t\treturn (\n\t\t\t((1 - Math.log(Math.tan((lat * Math.PI) / 180) + 1 / Math.cos((lat * Math.PI) / 180)) / Math.PI) /\n\t\t\t\t2) *\n\t\t\tzoom\n\t\t)\n\t},\n\n\tmeters2pixCoef(lat, zoom) {\n\t\tlat *= Math.PI / 180\n\t\treturn zoom / 40075000 / Math.abs(Math.cos(lat))\n\t},\n}\n\n/** @type {ProjectionConverter} */\nexport const ProjectionYandexMercator = {\n\t// http://www.geofaq.ru/forum/index.php?action=vthread&forum=2&topic=7&page=5#msg1152\n\t// http://habrahabr.ru/post/151103/\n\tx2lon(x, zoom) {\n\t\treturn (x / zoom) * 360 - 180\n\t},\n\ty2lat(y, zoom) {\n\t\tconst ty = Math.exp((y / zoom) * Math.PI * 2 - Math.PI)\n\t\tconst m = 5.328478445e-11\n\t\tconst h = 1.764564338702e-8\n\t\tconst k = 0.00000657187271079536\n\t\tconst n = 0.003356551468879694\n\t\tconst g = Math.PI / 2 - 2 * Math.atan(ty)\n\t\t// prettier-ignore\n\t\tconst l = g + n*Math.sin(2*g) + k*Math.sin(4*g) + h*Math.sin(6*g) + m*Math.sin(8*g);\n\t\treturn (l * 180) / Math.PI\n\t},\n\n\tlon2x(lon, zoom) {\n\t\treturn ((lon + 180) / 360) * zoom\n\t},\n\tlat2y(lat, zoom) {\n\t\tconst l = (lat * Math.PI) / 180\n\t\tconst k = 0.0818191908426\n\t\tconst t = k * Math.sin(l)\n\t\t// prettier-ignore\n\t\treturn (\n\t\t\t1 -\n\t\t\tMath.log(\n\t\t\t\tMath.tan(Math.PI/4 + l/2)\n\t\t\t) / Math.PI +\n\t\t\tk*Math.log(\n\t\t\t\tMath.tan(\n\t\t\t\t\tMath.PI/4 +\n\t\t\t\t\tMath.asin(t)/2\n\t\t\t\t)\n\t\t\t) / Math.PI\n\t\t) / 2 * zoom\n\t},\n\n\tmeters2pixCoef(lat, zoom) {\n\t\tlat *= Math.PI / 180\n\t\treturn zoom / 40075000 / Math.abs(Math.cos(lat))\n\t},\n}\n\n/**\n * @param {number} min\n * @param {number} max\n * @param {number} val\n * @param {number} delta\n */\nfunction mutlClamp(min, max, val, delta) {\n\tval *= delta\n\tif (delta < 1 && val < min) val = min\n\tif (delta > 1 && val > max) val = max\n\treturn val\n}\n","/** @typedef {[EventTarget, string, (e:any) => void]} Evt */\n/** @typedef {[allEents:Evt[], autoOnEvents:Evt[]]} EvtGroup */\n\n/**\n * @template TElemsCfg\n * @typedef {{\n *   readonly isOn: boolean,\n *   on(elems: TElemsCfg): ControlToggler<TElemsCfg>,\n *   off(): ControlToggler<TElemsCfg>,\n * }} ControlToggler\n */\n\n/**\n * @typedef {{\n *   singleDown?: (e:MouseEvent|TouchEvent, id:'mouse'|number, x:number, y:number) => boolean|void,\n *   singleMove?: (e:MouseEvent|TouchEvent, id:'mouse'|number, x:number, y:number) => void|boolean,\n *   singleUp?:   (e:MouseEvent|TouchEvent, id:'mouse'|number) => void|boolean,\n * }} SingleMoveCallbacks\n */\n\n/**\n * @typedef {{\n *   singleHover?: (e:MouseEvent, x:number, y:number) => void|boolean,\n *   singleLeave?: (e:MouseEvent, x:number, y:number) => void|boolean,\n * }} SingleHoverCallbacks\n */\n\n/**\n * @typedef {{\n *   singleDown?: (e:MouseEvent|TouchEvent, id:'mouse'|number, x:number, y:number, isSwitching:boolean) => boolean|void,\n *   singleMove?: (e:MouseEvent|TouchEvent, id:'mouse'|number, x:number, y:number) => void|boolean,\n *   singleUp?:   (e:MouseEvent|TouchEvent, id:'mouse'|number, isSwitching:boolean) => void|boolean,\n *   doubleDown?: (e:TouchEvent, id0:number, x0:number, y0:number, id1:number, x1:number, y1:number) => void|boolean,\n *   doubleMove?: (e:TouchEvent, id0:number, x0:number, y0:number, id1:number, x1:number, y1:number) => void|boolean,\n *   doubleUp?:   (e:TouchEvent, id0:number, id1:number) => void|boolean,\n * }} DoubleMoveCallbacks\n */\n\n/**\n * @typedef {{\n *   wheelRot?: (e:WheelEvent, deltaX:number, deltaY:number, deltaZ:number, x:number, y:number) => void|boolean,\n * }} WheelCallbacks\n */\n\n/**\n * @typedef {{\n *   startElem: Element,\n *   moveElem?: EventTarget|null,\n *   leaveElem?: EventTarget|null,\n *   offsetElem?: Element|null|'no-offset',\n * }} MoveElemsCfg\n */\n\n/**\n * @typedef {{\n *   startElem: Element,\n *   offsetElem?: Element|null|'no-offset',\n * }} WheelElemsCfg\n */\n\n/**\n * @param {SingleMoveCallbacks & SingleHoverCallbacks} callbacks\n */\nexport function controlSingle(callbacks) {\n\t/** @type {Element} */ let startElem\n\t/** @type {EventTarget} */ let moveElem\n\t/** @type {EventTarget} */ let leaveElem\n\t/** @type {Element|null} */ let offsetElem\n\n\t/** @type {Evt} */ let mouseDownEvt\n\t/** @type {Evt} */ let mouseMoveEvt\n\t/** @type {Evt} */ let mouseUpEvt\n\t/** @type {Evt} */ let mouseHoverEvt\n\t/** @type {Evt} */ let mouseLeaveEvt\n\t/** @type {Evt} */ let touchStartEvt\n\t/** @type {Evt} */ let touchMoveEvt\n\t/** @type {Evt} */ let touchEndEvt\n\t/** @type {Evt} */ let touchCancelEvt\n\n\tconst { singleDown = noop, singleMove = noop, singleUp = noop } = callbacks\n\tconst { singleHover = noop, singleLeave = noop } = callbacks\n\n\tlet touchId = /** @type {number|null} */ (null)\n\n\tconst wrap = makeOffsetWrapper(() => offsetElem)\n\n\tconst mousedown = wrap(function mousedown(/** @type {MouseEvent} */ e, dx, dy) {\n\t\tif (e.button !== 0) return false\n\t\taddListener(mouseMoveEvt)\n\t\taddListener(mouseUpEvt)\n\t\tremoveListener(mouseHoverEvt)\n\t\treturn singleDown(e, 'mouse', e.clientX + dx, e.clientY + dy)\n\t})\n\n\tconst mousemove = wrap(function mousemove(/** @type {MouseEvent} */ e, dx, dy) {\n\t\treturn singleMove(e, 'mouse', e.clientX + dx, e.clientY + dy)\n\t})\n\n\tconst mouseup = wrap(function mouseup(/** @type {MouseEvent} */ e, dx, dy) {\n\t\tif (e.button !== 0) return false\n\t\tremoveListener(mouseMoveEvt)\n\t\tremoveListener(mouseUpEvt)\n\t\taddListener(mouseHoverEvt)\n\t\treturn singleUp(e, 'mouse')\n\t})\n\n\tconst mousemoveHover = wrap(function mousemoveHover(/** @type {MouseEvent} */ e, dx, dy) {\n\t\treturn singleHover(e, e.clientX + dx, e.clientY + dy)\n\t})\n\n\tconst mouseleave = wrap(function mouseleave(/** @type {MouseEvent} */ e, dx, dy) {\n\t\treturn singleLeave(e, e.clientX + dx, e.clientY + dy)\n\t})\n\n\tconst touchstart = wrap(function touchstart(/** @type {TouchEvent} */ e, dx, dy) {\n\t\tif (touchId !== null) return false\n\n\t\taddListener(touchMoveEvt)\n\t\taddListener(touchEndEvt)\n\t\taddListener(touchCancelEvt)\n\n\t\tconst t = e.changedTouches[0]\n\t\ttouchId = t.identifier\n\t\treturn singleDown(e, touchId, t.clientX + dx, t.clientY + dy)\n\t})\n\n\tconst touchmove = wrap(function touchmove(/** @type {TouchEvent} */ e, dx, dy) {\n\t\tif (touchId === null) return false\n\t\tconst touch = findTouch(e.changedTouches, touchId)\n\t\tif (touch === null) return false\n\t\treturn singleMove(e, touchId, touch.clientX + dx, touch.clientY + dy)\n\t})\n\n\tconst touchend = wrap(function touchend(/** @type {TouchEvent} */ e, dx, dy) {\n\t\tif (touchId === null) return false\n\n\t\tconst releasedTouch = findTouch(e.changedTouches, touchId)\n\t\tif (releasedTouch === null) return false\n\n\t\ttouchId = null\n\n\t\tremoveListener(touchMoveEvt)\n\t\tremoveListener(touchEndEvt)\n\t\tremoveListener(touchCancelEvt)\n\n\t\treturn singleUp(e, releasedTouch.identifier)\n\t})\n\n\tconst touchcancel = wrap(function touchcancel(/** @type {TouchEvent} */ e, dx, dy) {\n\t\ttouchend(e)\n\t})\n\n\treturn makeEventsToggler((/**@type {MoveElemsCfg}*/ elems) => {\n\t\tstartElem = elems.startElem\n\t\tmoveElem = elems.moveElem ?? window\n\t\tleaveElem = elems.leaveElem ?? startElem\n\t\toffsetElem = nullUnlessOffset(elems.offsetElem, startElem)\n\n\t\tmouseDownEvt = /** @type {Evt} */ ([startElem, 'mousedown', mousedown])\n\t\tmouseMoveEvt = /** @type {Evt} */ ([moveElem, 'mousemove', mousemove])\n\t\tmouseUpEvt = /** @type {Evt} */ ([moveElem, 'mouseup', mouseup])\n\t\tmouseHoverEvt = /** @type {Evt} */ ([moveElem, 'mousemove', mousemoveHover])\n\t\tmouseLeaveEvt = /** @type {Evt} */ ([leaveElem, 'mouseleave', mouseleave])\n\t\ttouchStartEvt = /** @type {Evt} */ ([startElem, 'touchstart', touchstart])\n\t\ttouchMoveEvt = /** @type {Evt} */ ([moveElem, 'touchmove', touchmove])\n\t\ttouchEndEvt = /** @type {Evt} */ ([moveElem, 'touchend', touchend])\n\t\ttouchCancelEvt = /** @type {Evt} */ ([moveElem, 'touchcancel', touchcancel])\n\n\t\t// prettier-ignore\n\t\tconst events = [\n\t\t\tmouseDownEvt, mouseMoveEvt, mouseUpEvt, mouseHoverEvt, mouseLeaveEvt,\n\t\t\ttouchStartEvt, touchMoveEvt, touchEndEvt, touchCancelEvt,\n\t\t]\n\t\tconst autoOnEvents = [mouseDownEvt, touchStartEvt, mouseHoverEvt, mouseLeaveEvt]\n\t\treturn [events, autoOnEvents]\n\t})\n}\n\n/**\n * @param {WheelCallbacks} callbacks\n */\nexport function controlWheel(callbacks) {\n\tconst wheelRot = callbacks.wheelRot ?? noop\n\n\t/** @type {Element|null} */ let offsetElem\n\n\tconst wrap = makeOffsetWrapper(() => offsetElem)\n\tconst mousewheel = makeWheelListener(wrap, wheelRot)\n\n\treturn makeEventsToggler((/**@type {WheelElemsCfg}*/ elems) => {\n\t\tconst startElem = elems.startElem\n\t\toffsetElem = nullUnlessOffset(elems.offsetElem, startElem)\n\n\t\tconst wheelEvt = /** @type {Evt} */ ([startElem, 'wheel', mousewheel])\n\n\t\treturn [[wheelEvt], [wheelEvt]]\n\t})\n}\n\n/**\n * @param {DoubleMoveCallbacks & SingleHoverCallbacks & WheelCallbacks} callbacks\n */\nexport function controlDouble(callbacks) {\n\t/** @type {Element} */ let startElem\n\t/** @type {EventTarget} */ let moveElem\n\t/** @type {EventTarget} */ let leaveElem\n\t/** @type {Element|null} */ let offsetElem\n\n\t/** @type {Evt} */ let mouseDownEvt\n\t/** @type {Evt} */ let mouseMoveEvt\n\t/** @type {Evt} */ let mouseUpEvt\n\t/** @type {Evt} */ let wheelEvt\n\t/** @type {Evt} */ let mouseHoverEvt\n\t/** @type {Evt} */ let mouseLeaveEvt\n\t/** @type {Evt} */ let touchStartEvt\n\t/** @type {Evt} */ let touchMoveEvt\n\t/** @type {Evt} */ let touchEndEvt\n\t/** @type {Evt} */ let touchCancelEvt\n\n\tconst { singleDown = noop, singleMove = noop, singleUp = noop } = callbacks\n\tconst { doubleDown = noop, doubleMove = noop, doubleUp = noop } = callbacks\n\tconst { singleHover = noop, singleLeave = noop, wheelRot = noop } = callbacks\n\n\tconst touchIds = /** @type {number[]} */ ([])\n\n\tconst wrap = makeOffsetWrapper(() => offsetElem)\n\n\tconst mousedown = wrap(function mousedown(/** @type {MouseEvent} */ e, dx, dy) {\n\t\tif (e.button !== 0) return false\n\t\taddListener(mouseMoveEvt)\n\t\taddListener(mouseUpEvt)\n\t\tremoveListener(mouseHoverEvt)\n\t\treturn singleDown(e, 'mouse', e.clientX + dx, e.clientY + dy, false)\n\t})\n\n\tconst mousemove = wrap(function mousemove(/** @type {MouseEvent} */ e, dx, dy) {\n\t\treturn singleMove(e, 'mouse', e.clientX + dx, e.clientY + dy)\n\t})\n\n\tconst mouseup = wrap(function mouseup(/** @type {MouseEvent} */ e, dx, dy) {\n\t\tif (e.button !== 0) return false\n\t\tremoveListener(mouseMoveEvt)\n\t\tremoveListener(mouseUpEvt)\n\t\taddListener(mouseHoverEvt)\n\t\treturn singleUp(e, 'mouse', false)\n\t})\n\n\tconst mousemoveHover = wrap(function mousemoveHover(/** @type {MouseEvent} */ e, dx, dy) {\n\t\treturn singleHover(e, e.clientX + dx, e.clientY + dy)\n\t})\n\n\tconst mouseleave = wrap(function mouseleave(/** @type {MouseEvent} */ e, dx, dy) {\n\t\treturn singleLeave(e, e.clientX + dx, e.clientY + dy)\n\t})\n\n\tconst touchstart = wrap(function touchstart(/** @type {TouchEvent} */ e, dx, dy) {\n\t\tconst curCount = touchIds.length\n\t\tif (curCount === 2) return false\n\t\tconst changedTouches = e.changedTouches\n\n\t\tif (curCount === 0) {\n\t\t\taddListener(touchMoveEvt)\n\t\t\taddListener(touchEndEvt)\n\t\t\taddListener(touchCancelEvt)\n\t\t}\n\n\t\tif (curCount === 0 && changedTouches.length === 1) {\n\t\t\tconst t = e.changedTouches[0]\n\t\t\ttouchIds.push(t.identifier)\n\t\t\treturn singleDown(e, touchIds[0], t.clientX + dx, t.clientY + dy, false)\n\t\t}\n\n\t\tlet t0, t1\n\t\tlet prevent = /**@type {void|boolean}*/ (false)\n\t\tif (curCount === 0) {\n\t\t\t// and changedTouches.length >= 2\n\t\t\tt0 = changedTouches[0]\n\t\t\tt1 = changedTouches[1]\n\t\t\ttouchIds.push(t0.identifier)\n\t\t\tprevent = singleDown(e, t0.identifier, t0.clientX + dx, t0.clientY + dy, false)\n\t\t} else {\n\t\t\t// curCount === 1 and changedTouches.length >= 1\n\t\t\tt0 = mustFindTouch(e.touches, touchIds[0])\n\t\t\tt1 = e.changedTouches[0]\n\t\t}\n\t\ttouchIds.push(t1.identifier)\n\t\tconst prevetUp = singleUp(e, t0.identifier, true)\n\t\tprevent = prevent || prevetUp\n\n\t\tconst x0 = t0.clientX + dx\n\t\tconst y0 = t0.clientY + dy\n\t\tconst x1 = t1.clientX + dx\n\t\tconst y1 = t1.clientY + dy\n\t\tconst preventDouble = doubleDown(e, touchIds[0], x0, y0, touchIds[1], x1, y1)\n\t\treturn prevent || preventDouble\n\t})\n\n\tconst touchmove = wrap(function touchmove(/** @type {TouchEvent} */ e, dx, dy) {\n\t\tconst curCount = touchIds.length\n\t\tif (curCount === 1) {\n\t\t\tconst t0 = findTouch(e.changedTouches, touchIds[0])\n\t\t\tif (t0 === null) return false\n\t\t\treturn singleMove(e, touchIds[0], t0.clientX + dx, t0.clientY + dy)\n\t\t}\n\t\tif (curCount === 2) {\n\t\t\t// can not use e.changedTouches: one of touches may have not changed\n\t\t\tconst t0 = mustFindTouch(e.touches, touchIds[0])\n\t\t\tconst t1 = mustFindTouch(e.touches, touchIds[1])\n\t\t\tconst x0 = t0.clientX + dx\n\t\t\tconst y0 = t0.clientY + dy\n\t\t\tconst x1 = t1.clientX + dx\n\t\t\tconst y1 = t1.clientY + dy\n\t\t\treturn doubleMove(e, touchIds[0], x0, y0, touchIds[1], x1, y1)\n\t\t}\n\t})\n\n\tconst releasedTouches = /** @type {Touch[]} */ ([])\n\tconst touchend = wrap(function touchend(/** @type {TouchEvent} */ e, dx, dy) {\n\t\tconst curCount = touchIds.length\n\t\tif (curCount === 0) return false\n\n\t\tconst tid0 = touchIds[0]\n\t\tconst tid1 = touchIds[1]\n\n\t\treleasedTouches.length = 0\n\t\tfor (let j = touchIds.length - 1; j >= 0; j--) {\n\t\t\tfor (let i = 0; i < e.changedTouches.length; i++) {\n\t\t\t\tconst t = e.changedTouches[i]\n\t\t\t\tif (t.identifier === touchIds[j]) {\n\t\t\t\t\ttouchIds.splice(j, 1)\n\t\t\t\t\treleasedTouches.push(t)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (releasedTouches.length === 0) return false\n\n\t\tif (curCount === releasedTouches.length) {\n\t\t\tremoveListener(touchMoveEvt)\n\t\t\tremoveListener(touchEndEvt)\n\t\t\tremoveListener(touchCancelEvt)\n\t\t}\n\n\t\tif (curCount === 1) {\n\t\t\t// and releasedTouches.length === 1\n\t\t\treturn singleUp(e, releasedTouches[0].identifier, false)\n\t\t}\n\n\t\t// curCount === 2 and releasedTouches.length >= 1\n\t\tconst tLast =\n\t\t\treleasedTouches.length === 1 ? mustFindTouch(e.touches, touchIds[0]) : releasedTouches[1]\n\n\t\tconst preventUp2 = doubleUp(e, tid0, tid1)\n\t\tconst preventDown1 = singleDown(e, tLast.identifier, tLast.clientX + dx, tLast.clientY + dy, true)\n\t\tlet preventUp1 = /**@type {void|boolean}*/ (false)\n\t\tif (curCount === 2 && releasedTouches.length === 2) {\n\t\t\tpreventUp1 = singleUp(e, tLast.identifier, false)\n\t\t}\n\t\treturn preventUp2 || preventDown1 || preventUp1\n\t})\n\n\tconst touchcancel = wrap(function touchcancel(/** @type {TouchEvent} */ e, dx, dy) {\n\t\ttouchend(e)\n\t})\n\n\tconst mousewheel = makeWheelListener(wrap, wheelRot)\n\n\treturn makeEventsToggler((/**@type {MoveElemsCfg}*/ elems) => {\n\t\tstartElem = elems.startElem\n\t\tmoveElem = elems.moveElem ?? window\n\t\tleaveElem = elems.leaveElem ?? startElem\n\t\toffsetElem = nullUnlessOffset(elems.offsetElem, startElem)\n\n\t\tmouseDownEvt = /** @type {Evt} */ ([startElem, 'mousedown', mousedown])\n\t\tmouseMoveEvt = /** @type {Evt} */ ([moveElem, 'mousemove', mousemove])\n\t\tmouseUpEvt = /** @type {Evt} */ ([moveElem, 'mouseup', mouseup])\n\t\twheelEvt = /** @type {Evt} */ ([startElem, 'wheel', mousewheel])\n\t\tmouseHoverEvt = /** @type {Evt} */ ([moveElem, 'mousemove', mousemoveHover])\n\t\tmouseLeaveEvt = /** @type {Evt} */ ([leaveElem, 'mouseleave', mouseleave])\n\t\ttouchStartEvt = /** @type {Evt} */ ([startElem, 'touchstart', touchstart])\n\t\ttouchMoveEvt = /** @type {Evt} */ ([moveElem, 'touchmove', touchmove])\n\t\ttouchEndEvt = /** @type {Evt} */ ([moveElem, 'touchend', touchend])\n\t\ttouchCancelEvt = /** @type {Evt} */ ([moveElem, 'touchcancel', touchcancel])\n\n\t\t// prettier-ignore\n\t\tconst events = [\n\t\t\tmouseDownEvt, mouseMoveEvt, mouseUpEvt, mouseHoverEvt, mouseLeaveEvt, wheelEvt,\n\t\t\ttouchStartEvt, touchMoveEvt, touchEndEvt, touchCancelEvt,\n\t\t]\n\t\tconst autoOnEvents = [mouseDownEvt, touchStartEvt, mouseHoverEvt, mouseLeaveEvt, wheelEvt]\n\t\treturn [events, autoOnEvents]\n\t})\n}\n\nfunction noop() {}\n\n/**\n * @param {() => Element|null|undefined} getOffsetElem\n */\nfunction makeOffsetWrapper(getOffsetElem) {\n\t/**\n\t * @template {Event} T\n\t * @param {(e:T, x:number, y:number) => boolean|void} func\n\t * @returns {(e:T) => void}\n\t */\n\tfunction wrap(func) {\n\t\treturn e => {\n\t\t\tlet dx = 0\n\t\t\tlet dy = 0\n\t\t\tconst elem = getOffsetElem()\n\t\t\tif (elem) ({ left: dx, top: dy } = elem.getBoundingClientRect())\n\t\t\tfunc(e, -dx, -dy) && e.preventDefault()\n\t\t}\n\t}\n\treturn wrap\n}\n\n/**\n * @param {Element|null|undefined|'no-offset'} elem\n * @param {Element} defaultElem\n */\nfunction nullUnlessOffset(elem, defaultElem) {\n\tif (elem === 'no-offset') return null\n\treturn elem ?? defaultElem\n}\n\n/**\n * @param {(func: (e:WheelEvent, x:number, y:number) => boolean|void) => ((e:WheelEvent) => void)} wrap\n * @param {(e:WheelEvent, deltaX:number, deltaY:number, deltaZ:number, x:number, y:number) => void|boolean} wheelRot\n */\nfunction makeWheelListener(wrap, wheelRot) {\n\tconst deltaMode2pixels = []\n\tdeltaMode2pixels[WheelEvent.DOM_DELTA_PIXEL] = 1\n\tdeltaMode2pixels[WheelEvent.DOM_DELTA_LINE] = 20\n\tdeltaMode2pixels[WheelEvent.DOM_DELTA_PAGE] = 50 // а это вообще как?\n\treturn wrap(function mousewheel(/** @type {WheelEvent} */ e, dx, dy) {\n\t\tconst k = deltaMode2pixels[e.deltaMode]\n\t\treturn wheelRot(e, e.deltaX * k, e.deltaY * k, e.deltaZ * k, e.clientX + dx, e.clientY + dy)\n\t})\n}\n\n/**\n * @template TElemsCfg\n * @param {(elems: TElemsCfg) => EvtGroup} getEvents\n * @returns {ControlToggler<TElemsCfg>}\n */\nfunction makeEventsToggler(getEvents) {\n\tlet events = /**@type {(EvtGroup|null)}*/ (null)\n\n\treturn {\n\t\tget isOn() {\n\t\t\treturn !!events\n\t\t},\n\t\ton(elems) {\n\t\t\tif (!events) {\n\t\t\t\tevents = getEvents(elems)\n\t\t\t\tconst autoOnEvents = events[1]\n\t\t\t\tautoOnEvents.map(addListener)\n\t\t\t}\n\t\t\treturn this\n\t\t},\n\t\toff() {\n\t\t\tif (events) {\n\t\t\t\tconst allEents = events[0]\n\t\t\t\tallEents.map(removeListener)\n\t\t\t\tevents = null\n\t\t\t}\n\t\t\treturn this\n\t\t},\n\t}\n}\n\n/**\n * @param {TouchList} list\n * @param {number} id\n */\nfunction findTouch(list, id) {\n\tfor (let i = 0; i < list.length; i++) if (list[i].identifier === id) return list[i]\n\treturn null\n}\n/**\n * @param {TouchList} list\n * @param {number} id\n */\nfunction mustFindTouch(list, id) {\n\tconst touch = findTouch(list, id)\n\tif (touch === null) throw new Error(`touch #${id} not found`)\n\treturn touch\n}\n\n/** @param {Evt} event */\nfunction addListener(event) {\n\tevent[0].addEventListener(event[1], event[2], { capture: true, passive: false })\n}\n\n/** @param {Evt} event */\nfunction removeListener(event) {\n\tevent[0].removeEventListener(event[1], event[2], { capture: true })\n}\n","/**\n * Chooses and returns random argument.\n * @template T\n * @param  {...T} args\n * @returns {T}\n */\nexport function oneOf(...args) {\n\treturn args[(args.length * Math.random()) | 0]\n}\n\n/** @type {Partial<CSSStyleDeclaration>} */\nexport const CREDIT_BOTTOM_RIGHT = {\n\tposition: 'absolute',\n\tright: '0',\n\tbottom: '0',\n\tfont: '11px/1.5 sans-serif',\n\tbackground: 'white',\n\tpadding: '0 5px',\n\topacity: '0.75',\n}\n\n/**\n * Shortcut for appending some HTML at the right-bottom of another element.\n * @param {HTMLElement} wrap parent element, usually `map.getWrap()`\n * @param {string} html content as HTML (won't be escaped)\n * @param {Partial<CSSStyleDeclaration>} [style=CREDIT_BOTTOM_RIGHT] custom style object\n */\nexport function appendCredit(wrap, html, style = CREDIT_BOTTOM_RIGHT) {\n\tconst elem = document.createElement('div')\n\telem.className = 'map-credit'\n\telem.innerHTML = html\n\tapplyStyles(elem, style)\n\twrap.appendChild(elem)\n}\n\n/**\n * @param {number} a\n * @param {number} b\n * @param {number} x\n */\nexport function clamp(a, b, x) {\n\treturn Math.max(a, Math.min(b, x))\n}\n\n/**\n * @param {HTMLElement} elem\n * @param {Partial<CSSStyleDeclaration>} style\n */\nexport function applyStyles(elem, style) {\n\tfor (const name in style) elem.style[name] = /**@type {string}*/ (style[name])\n}\n","import { controlDouble } from 'js-control'\nimport { applyStyles, clamp } from './utils.js'\n\n/**\n * @param {number} x1\n * @param {number} y1\n * @param {number} x2\n * @param {number} y2\n */\nfunction point_distance(x1, y1, x2, y2) {\n\treturn Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1))\n}\n\n/**\n * Returns `attr` speed prediction for `timeStamp` moment by\n * calculating acceleration of values `items[i][attr]` (with linear approximation).\n * @param {{stamp:number}[]} items\n * @param {string} attr\n * @param {number} timeStamp\n */\nfunction getApproximatedSpeed(items, attr, timeStamp) {\n\t// https://prog-cpp.ru/mnk/\n\tlet sumx = 0\n\tlet sumy = 0\n\tlet sumx2 = 0\n\tlet sumxy = 0\n\tlet n = 0\n\tconst len = items.length\n\tconst now = performance.now()\n\tconst last = items[len - 1]\n\tlet cur = last\n\tfor (let i = len - 1; i > 0; i--) {\n\t\tconst prev = items[i - 1]\n\t\tif (now - prev.stamp > 150) break\n\t\tconst dtime = cur.stamp - prev.stamp\n\t\tconst dattr = cur[attr] - prev[attr]\n\t\tif (dtime === 0) continue\n\n\t\tconst x = cur.stamp\n\t\tconst y = /**@type {number}*/ (dattr / dtime)\n\t\tsumx += x\n\t\tsumy += y\n\t\tsumx2 += x * x\n\t\tsumxy += x * y\n\t\tn++\n\t\tcur = prev\n\t}\n\n\tif (n === 1) {\n\t\t// Got only two usable items (the last movement was too short),\n\t\t// just returning average speed between them.\n\t\tconst dtime = last.stamp - cur.stamp\n\t\tconst dattr = last[attr] - cur[attr]\n\t\tif (dtime < 4) return 0 //in case events are too close or have the same time\n\t\treturn dattr / dtime\n\t}\n\tif (n === 0) return 0\n\n\tconst aDenom = n * sumx2 - sumx * sumx\n\tif (aDenom === 0) return 0\n\tconst a = (n * sumxy - sumx * sumy) / aDenom\n\tconst b = (sumy - a * sumx) / n\n\tlet k = a * timeStamp + b\n\n\tconst dattr = last[attr] - cur[attr]\n\tif (k * dattr < 0) k = 0 //if acceleration changes the sign (i.e. flips direction), movement should be stopped\n\treturn k\n}\n\n/**\n * \"default timing in Windows is 500ms\" https://stackoverflow.com/a/29917394\n */\nexport const DBL_CLICK_MAX_DELAY = 500\n\n/**\n * Enables mouse and touch input: gragging, wheel- and pinch-zooming.\n * @class\n * @param {{doNotInterfere?:boolean}} [opts]\n */\nexport function PointerControlLayer(opts) {\n\tconst { doNotInterfere } = opts || {}\n\t/** @type {{off():unknown}} */\n\tlet control\n\n\tlet mouseX = 0\n\tlet mouseY = 0\n\n\tlet moveDistance = 0\n\tlet lastSingleClickAt = 0\n\tlet lastDoubleTouchParams = /**@type {[number,number,number,number,number,number]|null}*/ (null)\n\n\tlet lastDoubleTouch_cx = 0\n\tlet lastDoubleTouch_cy = 0\n\tlet lastDoubleTouch_dx = 0\n\tlet lastDoubleTouch_dy = 0\n\tlet lastDoubleTouch_dist = 1\n\tlet lastDoubleTouch_stamp = 0\n\n\tlet lastMoves = [{ x: 0, y: 0, stamp: 0 }]\n\tlet lastZooms = [{ dist: 0, stamp: 0 }]\n\tfor (const arr of [lastMoves, lastZooms])\n\t\twhile (arr.length < 5) arr.push(Object.assign({}, /**@type {*}*/ (arr[0])))\n\n\t/**\n\t * If stamp is new, pops the first array element, pushes in back and returns it.\n\t * If stamp is same, just returns the last array element.\n\t * Useful for Safari (and maybe some others) where sometimes a bunch of touch events\n\t * come with same timeStamp. In that case we should just update last element, not push anything.\n\t * @template {{stamp:number}} T\n\t * @param {T[]} arr\n\t * @param {number} stamp\n\t * @returns {T}\n\t */\n\tfunction peekOrShift(arr, stamp) {\n\t\tconst last = arr[arr.length - 1]\n\t\tif (last.stamp === stamp) return last\n\t\tconst newLast = /** @type {*} */ (arr.shift())\n\t\tarr.push(newLast)\n\t\treturn newLast\n\t}\n\t/** @param {number} stamp */\n\tfunction recordMousePos(stamp) {\n\t\tconst last = peekOrShift(lastMoves, stamp)\n\t\tlast.x = mouseX\n\t\tlast.y = mouseY\n\t\tlast.stamp = stamp\n\t}\n\t/** Shifts all lastMoves so that the last recorded move will be at mouse(x,y) */\n\tfunction moveRecordedMousePos() {\n\t\tconst last = lastMoves[lastMoves.length - 1]\n\t\tconst dx = mouseX - last.x\n\t\tconst dy = mouseY - last.y\n\t\tfor (let i = 0; i < lastMoves.length; i++) {\n\t\t\tlastMoves[i].x += dx\n\t\t\tlastMoves[i].y += dy\n\t\t}\n\t}\n\t/** @param {number} stamp */\n\tfunction recordTouchDist(stamp) {\n\t\tconst last = peekOrShift(lastZooms, stamp)\n\t\tlast.dist = lastDoubleTouch_dist\n\t\tlast.stamp = stamp\n\t}\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {number} timeStamp\n\t */\n\tfunction applyInertia(map, timeStamp) {\n\t\tconst dx = getApproximatedSpeed(lastMoves, 'x', timeStamp)\n\t\tconst dy = getApproximatedSpeed(lastMoves, 'y', timeStamp)\n\t\tconst dz = getApproximatedSpeed(lastZooms, 'dist', timeStamp) / lastDoubleTouch_dist + 1\n\t\tmap.applyMoveInertia(dx, dy, lastMoves[lastMoves.length - 1].stamp)\n\t\tmap.applyZoomInertia(mouseX, mouseY, dz, lastZooms[lastZooms.length - 1].stamp)\n\t}\n\n\t/**\n\t * Sets mouse(x,y) to (x,y) with special post-double-touch correction.\n\t *\n\t * Two fingers do not lift simultaneously, so there is (almost) always two-touches -> one-touch -> no touch.\n\t * This may cause a problem if two touches move in opposite directions (zooming):\n\t * while they both are down, there is a little movement,\n\t * but when first touch lift, second (still down) starts to move map aside with significant speed.\n\t * Then second touch lifts too and speed reduces again (because of smoothing and inertia).\n\t * All that makes motion at the end of zoom gesture looks trembling.\n\t *\n\t * This function tries to fix that by continuing double-touch motion for a while.\n\t * Used only for movement: zooming should remain smooth thanks to applyInertia() at the end of doubleUp().\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} stamp\n\t */\n\tfunction setCorrectedSinglePos(x, y, stamp) {\n\t\tconst timeDelta = stamp - lastDoubleTouch_stamp\n\t\tconst duration = 150\n\t\tconst k = clamp(0, 1, ((duration - timeDelta) / duration) * 2)\n\t\tmouseX = (lastDoubleTouch_cx + lastDoubleTouch_dx * timeDelta) * k + x * (1 - k)\n\t\tmouseY = (lastDoubleTouch_cy + lastDoubleTouch_dy * timeDelta) * k + y * (1 - k)\n\t}\n\n\t/**\n\t * For some reason FF return same touchMove event for each touch\n\t * (two events with same timeStamps and coords for two touches, thee for thee, etc.)\n\t * @param {number} centerX\n\t * @param {number} centerY\n\t * @param {number} distance\n\t * @param {number} stamp\n\t */\n\tfunction doubleMoveHasChanged(centerX, centerY, distance, stamp) {\n\t\treturn (\n\t\t\tmouseX !== centerX ||\n\t\t\tmouseY !== centerY ||\n\t\t\tlastDoubleTouch_dist !== distance ||\n\t\t\tlastMoves[lastMoves.length - 1].stamp !== stamp\n\t\t)\n\t}\n\n\t/**\n\t * @param {MouseEvent|TouchEvent} e\n\t * @param {'mouse'|number} id\n\t */\n\tfunction shouldShowTwoFingersHint(e, id) {\n\t\treturn doNotInterfere && id !== 'mouse' && e.timeStamp - lastDoubleTouch_stamp > 1000\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tconst makeControl = map => {\n\t\tconst canvas = map.getCanvas()\n\t\tcanvas.style.cursor = 'grab'\n\n\t\treturn controlDouble({\n\t\t\tsingleDown(e, id, x, y, isSwitching) {\n\t\t\t\tif (shouldShowTwoFingersHint(e, id)) return false\n\t\t\t\tmap.getWrap().focus()\n\t\t\t\tsetCorrectedSinglePos(x, y, e.timeStamp)\n\t\t\t\tif (isSwitching) moveRecordedMousePos()\n\t\t\t\tif (!isSwitching) {\n\t\t\t\t\trecordMousePos(e.timeStamp)\n\t\t\t\t\tmap.applyMoveInertia(0, 0, 0)\n\t\t\t\t\tmap.applyZoomInertia(0, 0, 1, 0)\n\t\t\t\t\tmoveDistance = 0\n\t\t\t\t\tlastDoubleTouchParams = null\n\t\t\t\t}\n\t\t\t\tmap.emit('singleDown', { x, y, id, isSwitching })\n\t\t\t\tcanvas.style.cursor = 'grabbing'\n\t\t\t\treturn true\n\t\t\t},\n\t\t\tsingleMove(e, id, x, y) {\n\t\t\t\tif (shouldShowTwoFingersHint(e, id)) {\n\t\t\t\t\tmap.emit('controlHint', { type: 'use_two_fingers' })\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t\tconst oldX = mouseX\n\t\t\t\tconst oldY = mouseY\n\t\t\t\tsetCorrectedSinglePos(x, y, e.timeStamp)\n\t\t\t\tmoveDistance += point_distance(oldX, oldY, mouseX, mouseY)\n\t\t\t\tmap.move(mouseX - oldX, mouseY - oldY)\n\t\t\t\trecordMousePos(e.timeStamp)\n\t\t\t\tmap.emit('singleMove', { x, y, id })\n\t\t\t\treturn true\n\t\t\t},\n\t\t\tsingleUp(e, id, isSwitching) {\n\t\t\t\tconst stamp = e.timeStamp\n\t\t\t\tif (!isSwitching) applyInertia(map, stamp)\n\t\t\t\tmap.emit('singleUp', { x: mouseX, y: mouseY, id, isSwitching })\n\t\t\t\tif (moveDistance < 5 && !isSwitching) {\n\t\t\t\t\tif (lastDoubleTouchParams) {\n\t\t\t\t\t\tmap.zoomSmooth(mouseX, mouseY, 0.5, stamp)\n\t\t\t\t\t\tconst [id0, x0, y0, id1, x1, y1] = lastDoubleTouchParams\n\t\t\t\t\t\tmap.emit('doubleClick', { id0, x0, y0, id1, x1, y1 })\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst isDbl = lastSingleClickAt > stamp - DBL_CLICK_MAX_DELAY\n\t\t\t\t\t\tlastSingleClickAt = stamp\n\t\t\t\t\t\tif (isDbl) map.zoomSmooth(mouseX, mouseY, 2, stamp)\n\t\t\t\t\t\tmap.emit(isDbl ? 'dblClick' : 'singleClick', { x: mouseX, y: mouseY, id })\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcanvas.style.cursor = 'grab'\n\t\t\t\treturn true\n\t\t\t},\n\t\t\tdoubleDown(e, id0, x0, y0, id1, x1, y1) {\n\t\t\t\tmouseX = (x0 + x1) * 0.5\n\t\t\t\tmouseY = (y0 + y1) * 0.5\n\t\t\t\tlastDoubleTouch_dist = point_distance(x0, y0, x1, y1)\n\t\t\t\tlastDoubleTouch_cx = mouseX\n\t\t\t\tlastDoubleTouch_cy = mouseY\n\t\t\t\tmoveRecordedMousePos()\n\t\t\t\tlastDoubleTouchParams = [id0, x0, y0, id1, x1, y1]\n\t\t\t\tmap.emit('doubleDown', { id0, x0, y0, id1, x1, y1 })\n\t\t\t\treturn true\n\t\t\t},\n\t\t\tdoubleMove(e, id0, x0, y0, id1, x1, y1) {\n\t\t\t\tconst cx = (x0 + x1) * 0.5\n\t\t\t\tconst cy = (y0 + y1) * 0.5\n\t\t\t\tconst cd = point_distance(x0, y0, x1, y1)\n\t\t\t\tif (doubleMoveHasChanged(cx, cy, cd, e.timeStamp)) {\n\t\t\t\t\tmap.move(cx - mouseX, cy - mouseY)\n\t\t\t\t\tmap.zoom(cx, cy, cd / lastDoubleTouch_dist)\n\t\t\t\t\tmoveDistance +=\n\t\t\t\t\t\tpoint_distance(mouseX, mouseY, cx, cy) + Math.abs(cd - lastDoubleTouch_dist)\n\t\t\t\t\tlastDoubleTouchParams = [id0, x0, y0, id1, x1, y1]\n\t\t\t\t\tmouseX = cx\n\t\t\t\t\tmouseY = cy\n\t\t\t\t\tlastDoubleTouch_dist = cd\n\t\t\t\t\tlastDoubleTouch_cx = cx\n\t\t\t\t\tlastDoubleTouch_cy = cy\n\t\t\t\t\trecordMousePos(e.timeStamp)\n\t\t\t\t\trecordTouchDist(e.timeStamp)\n\t\t\t\t\tmap.emit('doubleMove', { id0, x0, y0, id1, x1, y1 })\n\t\t\t\t}\n\t\t\t\treturn true\n\t\t\t},\n\t\t\tdoubleUp(e, id0, id1) {\n\t\t\t\tconst stamp = e.timeStamp\n\t\t\t\tlastDoubleTouch_dx = getApproximatedSpeed(lastMoves, 'x', stamp)\n\t\t\t\tlastDoubleTouch_dy = getApproximatedSpeed(lastMoves, 'y', stamp)\n\t\t\t\tlastDoubleTouch_stamp = e.timeStamp\n\t\t\t\tmap.emit('doubleUp', { id0, id1 })\n\t\t\t\treturn true\n\t\t\t},\n\t\t\twheelRot(e, deltaX, deltaY, deltaZ, x, y) {\n\t\t\t\tif (!doNotInterfere || e.ctrlKey || e.metaKey) {\n\t\t\t\t\tmap.zoomSmooth(x, y, Math.pow(2, -deltaY / 240), e.timeStamp)\n\t\t\t\t\treturn true\n\t\t\t\t} else {\n\t\t\t\t\tmap.emit('controlHint', { type: 'use_control_to_zoom' })\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t},\n\t\t\tsingleHover(e, x, y) {\n\t\t\t\tmap.emit('singleHover', { x, y })\n\t\t\t},\n\t\t}).on({\n\t\t\t// not map.getWrap(): so this layer will not prevent events from reaching other layers\n\t\t\tstartElem: canvas,\n\t\t})\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.register = map => {\n\t\tcontrol = makeControl(map)\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.unregister = map => {\n\t\tcontrol.off()\n\t}\n}\n\n/**\n * Enables keyboard controls: arrows for movement, +/- for zoom. Shift can be used for speedup.\n * Makes map element focusable.\n * @class\n * @param {object} [opts]\n * @param {string|null} [opts.outlineFix] value that will be set to `map.getWrap().style.outline`.\n *   It's a workaround for mobile Safari 14 (at least) bug where `canvas` performance\n *   drops significantly after changing parent `tabIndex` attribute.\n *   'none' (default) seems fixing the issue.\n */\nexport function KeyboardControlLayer(opts) {\n\tconst { outlineFix = 'none' } = opts || {}\n\t/** @type {(e:KeyboardEvent) => unknown} */\n\tlet handler\n\tlet oldTabIndex = -1\n\n\t/** @param {import('./map').LocMap} map */\n\tconst makeHandler = map => (/**@type {KeyboardEvent}*/ e) => {\n\t\tif (e.ctrlKey || e.altKey) return\n\n\t\tlet shouldPrevent = true\n\t\tconst { key, shiftKey, timeStamp } = e\n\t\tconst { width, height } = map.getCanvas()\n\t\tconst moveDelta = 75 * (shiftKey ? 3 : 1)\n\t\tconst zoomDelta = 2 * (shiftKey ? 2 : 1)\n\n\t\tif (key === 'ArrowUp') {\n\t\t\tmap.moveSmooth(0, moveDelta, timeStamp)\n\t\t} else if (key === 'ArrowDown') {\n\t\t\tmap.moveSmooth(0, -moveDelta, timeStamp)\n\t\t} else if (key === 'ArrowLeft') {\n\t\t\tmap.moveSmooth(moveDelta, 0, timeStamp)\n\t\t} else if (key === 'ArrowRight') {\n\t\t\tmap.moveSmooth(-moveDelta, 0, timeStamp)\n\t\t} else if (key === '=' || key === '+') {\n\t\t\tmap.zoomSmooth(width / 2, height / 2, zoomDelta, timeStamp)\n\t\t} else if (key === '-' || key === '_') {\n\t\t\tmap.zoomSmooth(width / 2, height / 2, 1 / zoomDelta, timeStamp)\n\t\t} else {\n\t\t\tshouldPrevent = false\n\t\t}\n\n\t\tif (shouldPrevent) e.preventDefault()\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.register = map => {\n\t\tconst wrap = map.getWrap()\n\t\toldTabIndex = wrap.tabIndex\n\t\twrap.tabIndex = 1\n\t\tif (outlineFix !== null) wrap.style.outline = outlineFix\n\t\thandler = makeHandler(map)\n\t\twrap.addEventListener('keydown', handler)\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.unregister = map => {\n\t\tconst wrap = map.getWrap()\n\t\twrap.tabIndex = oldTabIndex\n\t\twrap.removeEventListener('keydown', handler)\n\t}\n}\n\n/**\n * Layer for pointer (mouse/touch) and keyboard input.\n * See {@linkcode PointerControlLayer} and {@linkcode KeyboardControlLayer}.\n * @class\n * @param {Parameters<typeof PointerControlLayer>[0]} [mouseOpts]\n * @param {Parameters<typeof KeyboardControlLayer>[0]} [kbdOpts]\n */\nexport function ControlLayer(mouseOpts, kbdOpts) {\n\tconst items = [new PointerControlLayer(mouseOpts), new KeyboardControlLayer(kbdOpts)]\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.register = map => {\n\t\tfor (const item of items) item.register(map)\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.unregister = map => {\n\t\tfor (const item of items) item.unregister(map)\n\t}\n}\n\n/**\n * Should be used with `doNotInterfere:true` set on {@linkcode MouseControlLayer} or {@linkcode ControlLayer}.\n * Shows a text over the map when user input is ignored.\n * @class\n * @param {string} controlText text to be shown when `Ctrl`/`⌘` key is required to zoom.\n *   For example: `` `hold ${controlHintKeyName()} to zoom` ``.\n * @param {string} twoFingersText text to be shown when two fingers are required to drag.\n *   For example: `'use two fingers to drag'`.\n * @param {{styles:Record<string,string>}} [opts] text box style overrides\n */\nexport function ControlHintLayer(controlText, twoFingersText, opts) {\n\tconst elem = document.createElement('div')\n\telem.className = 'map-control-hint'\n\tapplyStyles(elem, {\n\t\tposition: 'absolute',\n\t\twidth: '100%',\n\t\theight: '100%',\n\t\tdisplay: 'flex',\n\t\talignItems: 'center',\n\t\tjustifyContent: 'center',\n\t\ttextAlign: 'center',\n\t\tcolor: 'rgba(0,0,0,0.7)',\n\t\tbackgroundColor: 'rgba(127,127,127,0.7)',\n\t\ttransition: 'opacity 0.25s ease',\n\t\topacity: '0',\n\t\tpointerEvents: 'none',\n\t\tfontSize: '42px',\n\t})\n\tif (opts?.styles) applyStyles(elem, opts?.styles)\n\n\tlet timeout = -1\n\tfunction showHint(text) {\n\t\tclearTimeout(timeout)\n\t\telem.textContent = text\n\t\telem.style.opacity = '1'\n\t\ttimeout = window.setTimeout(hideHint, 1000)\n\t}\n\tfunction hideHint() {\n\t\tclearTimeout(timeout)\n\t\telem.style.opacity = '0'\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.register = map => {\n\t\tmap.getWrap().appendChild(elem)\n\t}\n\t/** @param {import('./map').LocMap} map */\n\tthis.unregister = map => {\n\t\tmap.getWrap().removeChild(elem)\n\t}\n\n\t/** @type {import('./map').MapEventHandlers} */\n\tthis.onEvent = {\n\t\tmapMove: hideHint,\n\t\tmapZoom: hideHint,\n\t\tcontrolHint(map, e) {\n\t\t\tswitch (e.type) {\n\t\t\t\tcase 'use_control_to_zoom':\n\t\t\t\t\tshowHint(controlText)\n\t\t\t\t\tbreak\n\t\t\t\tcase 'use_two_fingers':\n\t\t\t\t\tshowHint(twoFingersText)\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t},\n\t}\n}\n\n/**\n * Returns `⌘` on MacOS/iOS and `Ctrl` on other platforms.\n * Useful for {@linkcode ControlHintLayer}.\n */\nexport function controlHintKeyName() {\n\treturn navigator.userAgent.includes('Macintosh') ? '⌘' : 'Ctrl'\n}\n","/**\n * When `img` is `null`, the tile is considerend blank and not drawn (may be replaced by placeholder).\n *\n * When `img` is not `null`, the tile is considerend ready to be drawn.\n *\n * @template {HTMLImageElement|ImageBitmap|null} TImg\n * @typedef {{img:TImg, clear:(()=>unknown)|null, x:number, y:number, z:number, appearAt:number, lastDrawIter:number}} Tile\n */\n\n/** @typedef {Tile<null>} BlankTile */\n/** @typedef {Tile<HTMLImageElement>|Tile<ImageBitmap>} ImgTile */\n/** @typedef {BlankTile|ImgTile} AnyTile */\n\n/** @typedef {(img:HTMLImageElement|ImageBitmap|null, clear:()=>unknown) => unknown} TileUpdateFunc */\n/** @typedef {(x:number, y:number, z:number, onUpdate:TileUpdateFunc) => unknown} TileImgLoadFunc */\n/** @typedef {(x:number, y:number, z:number) => string} TilePathFunc */\n/** @typedef {(map:import('./map').LocMap, x:number, y:number, z:number, drawX:number, drawY:number, tileW:number, scale:number) => unknown} TilePlaceholderDrawFunc */\n\n/**\n * @param {HTMLImageElement|ImageBitmap} img\n * @returns {img is HTMLImageElement}\n */\nfunction isHtmlImg(img) {\n\treturn 'src' in img\n}\n\n/** @param {HTMLImageElement} img */\nfunction clearHtmlImg(img) {\n\timg.src = ''\n}\n/** @param {ImageBitmap} img */\nfunction clearBitmapImg(img) {\n\timg.close()\n}\n\n/**\n * @param {HTMLImageElement|ImageBitmap} img\n * @returns {number}\n */\nfunction getImgWidth(img) {\n\treturn isHtmlImg(img) ? img.naturalWidth : img.width\n}\n\n/**\n * @param {number} x\n * @param {number} y\n * @param {number} z\n * @returns {string}\n */\nfunction getTileKey(x, y, z) {\n\treturn `${x}|${y}|${z}`\n}\n\n/**\n * Loads, caches and draws tiles with transitions. To be used with {@linkcode TileLayer}.\n * @class\n * @param {number} tileW tile display size\n * @param {TileImgLoadFunc} tileLoadFunc loads tile image,\n *   see {@linkcode loadTileImage} and maybe {@linkcode clampEarthTiles}\n * @param {TilePlaceholderDrawFunc} [tilePlaceholderDrawFunc]\n *   draws placeholder when tile is not ready or has failed to load\n *   (for example, {@linkcode drawRectTilePlaceholder})\n */\nexport function SmoothTileContainer(tileW, tileLoadFunc, tilePlaceholderDrawFunc) {\n\tconst cache = /** @type {Map<string,AnyTile>} */ (new Map())\n\n\tlet lastDrawnTiles = /**@type {Set<ImgTile>}*/ (new Set())\n\tconst lastDrawnUnderLevelTilesArr = /**@type {ImgTile[]}*/ ([])\n\n\t/** @type {[iFrom:number, jFrom:number, iCount:number, jCount:number, level:number]} */\n\tlet prevTileRegion = [0, 0, 0, 0, 0]\n\n\tlet drawIter = 0\n\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} z\n\t * @returns {AnyTile}\n\t */\n\tfunction makeTile(map, x, y, z) {\n\t\tconst tile = /** @type {AnyTile} */ ({\n\t\t\timg: null,\n\t\t\tclear: null,\n\t\t\tx,\n\t\t\ty,\n\t\t\tz,\n\t\t\tappearAt: 0,\n\t\t\t// writing here last iter (instead of 0), so if tile load will abort/fail,\n\t\t\t// this tile won't be the \"oldest\" one in the cache and won't be quickly removed\n\t\t\tlastDrawIter: drawIter,\n\t\t})\n\t\ttileLoadFunc(x, y, z, (img, clear) => {\n\t\t\ttile.img = img\n\t\t\ttile.clear = clear\n\t\t\tmap.requestRedraw()\n\t\t})\n\t\treturn tile\n\t}\n\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {number} i\n\t * @param {number} j\n\t * @param {number} level\n\t * @param {boolean} loadIfMissing\n\t */\n\tfunction findTile(map, i, j, level, loadIfMissing) {\n\t\tconst key = getTileKey(i, j, level)\n\t\tlet tile = cache.get(key)\n\t\tif (!tile && loadIfMissing) {\n\t\t\ttile = makeTile(map, i, j, level)\n\t\t\tcache.set(key, tile)\n\t\t}\n\t\treturn tile\n\t}\n\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {number} i\n\t * @param {number} j\n\t * @param {number} level\n\t * @param {boolean} useOpacity\n\t */\n\tfunction canFullyDrawRecentTile(map, i, j, level, useOpacity) {\n\t\tconst tile = findTile(map, i, j, level, false)\n\t\treturn (\n\t\t\t!!tile &&\n\t\t\t!!tile.img &&\n\t\t\t// if tile not drawn recently, it will became transparent on next draw\n\t\t\ttileDrawnRecently(tile) &&\n\t\t\t(!useOpacity || getTileOpacity(tile) >= 1)\n\t\t)\n\t}\n\n\t/** @param {AnyTile} tile */\n\tfunction getTileOpacity(tile) {\n\t\treturn (performance.now() - tile.appearAt) / 150\n\t}\n\n\t/** @param {AnyTile} tile */\n\tfunction tileDrawnRecently(tile) {\n\t\treturn tile.lastDrawIter >= drawIter - 1\n\t}\n\n\t/** @param {AnyTile} tile */\n\tfunction tileWasOutsideOnCurLevel(tile) {\n\t\tconst [iFrom, jFrom, iCount, jCount, level] = prevTileRegion\n\t\tconst { x, y, z } = tile\n\t\treturn z === level && (x < iFrom || x >= iFrom + iCount || y < jFrom || y >= jFrom + jCount)\n\t}\n\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {ImgTile} tile\n\t * @param {boolean} withOpacity\n\t * @param {number} sx\n\t * @param {number} sy\n\t * @param {number} sw\n\t * @param {number} sh\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} w\n\t * @param {number} h\n\t */\n\tfunction drawTile(map, tile, withOpacity, sx, sy, sw, sh, x, y, w, h) {\n\t\tconst rc = map.get2dContext()\n\t\tif (!rc) return\n\n\t\tif (!tileDrawnRecently(tile)) {\n\t\t\t// Preventing fade-in animation for loaded tiles which appeared on sides while moving the map.\n\t\t\t// This works only for tiles on current level but is simplier and is enough for most cases.\n\t\t\tif (tileWasOutsideOnCurLevel(tile)) tile.appearAt = 0\n\t\t\t// making it \"appear\" a bit earlier, so now tile won't be fully transparent\n\t\t\telse tile.appearAt = performance.now() - 16\n\t\t}\n\t\ttile.lastDrawIter = drawIter\n\t\tlastDrawnTiles.add(tile)\n\n\t\tconst s = devicePixelRatio\n\t\t// rounding to real canvas pixels\n\t\tconst rx = Math.round(x * s) / s\n\t\tconst ry = Math.round(y * s) / s\n\t\tw = Math.round((x + w) * s) / s - rx\n\t\th = Math.round((y + h) * s) / s - ry\n\t\tconst alpha = withOpacity ? getTileOpacity(tile) : 1\n\n\t\tif (alpha < 1) rc.globalAlpha = alpha\n\t\trc.drawImage(tile.img, sx, sy, sw, sh, rx, ry, w, h)\n\t\t// rc.fillText(tile.x + '/' + tile.y, rx, ry + 12)\n\t\tif (alpha < 1) {\n\t\t\trc.globalAlpha = 1\n\t\t\tmap.requestRedraw()\n\t\t}\n\t}\n\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} scale\n\t * @param {number} i\n\t * @param {number} j\n\t * @param {number} level\n\t * @param {number} tileX\n\t * @param {number} tileY\n\t * @param {number} tileZ\n\t * @param {boolean} loadIfMissing\n\t * @param {boolean} useOpacity\n\t * @returns {boolean}\n\t */\n\tfunction tryDrawTile(map, x, y, scale, i, j, level, tileX, tileY, tileZ, loadIfMissing, useOpacity) {\n\t\tconst tile = findTile(map, tileX, tileY, tileZ, loadIfMissing)\n\t\treturn !!tile && tryDrawTileObj(map, tile, x, y, scale, i, j, level, useOpacity)\n\t}\n\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {AnyTile} tile\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} scale\n\t * @param {number} i\n\t * @param {number} j\n\t * @param {number} level\n\t * @param {boolean} useOpacity\n\t * @returns {boolean}\n\t */\n\tfunction tryDrawTileObj(map, tile, x, y, scale, i, j, level, useOpacity) {\n\t\tif (!tile.img) return false\n\t\tconst dlevel = tile.z - level\n\t\tconst dzoom = 2 ** dlevel\n\t\tconst di = tile.x - i * dzoom\n\t\tconst dj = tile.y - j * dzoom\n\t\tconst imgW = getImgWidth(tile.img)\n\n\t\tlet sx, sy, sw, dw\n\t\tif (dlevel >= 0) {\n\t\t\tif (di < 0 || dj < 0 || di >= dzoom || dj >= dzoom) return false\n\t\t\tdw = (tileW * scale) / dzoom\n\t\t\tx += di * dw\n\t\t\ty += dj * dw\n\t\t\tsx = 0\n\t\t\tsy = 0\n\t\t\tsw = imgW\n\t\t} else {\n\t\t\tsw = imgW * dzoom\n\t\t\tsx = -di * imgW\n\t\t\tsy = -dj * imgW\n\t\t\tif (sx < 0 || sy < 0 || sx >= imgW || sy >= imgW) return false\n\t\t\tdw = tileW * scale\n\t\t}\n\n\t\tdrawTile(map, tile, useOpacity,\n\t\t         sx,sy, sw,sw,\n\t\t         x,y, dw,dw) //prettier-ignore\n\t\treturn true\n\t}\n\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {number} x\n\t * @param {number} y\n\t * @param {number} scale\n\t * @param {number} i\n\t * @param {number} j\n\t * @param {number} level\n\t * @param {boolean} shouldLoad\n\t */\n\tfunction drawOneTile(map, x, y, scale, i, j, level, shouldLoad) {\n\t\tif (!canFullyDrawRecentTile(map, i, j, level, true)) {\n\t\t\t//prettier-ignore\n\t\t\tconst canFillByQuaters =\n\t\t\t\tcanFullyDrawRecentTile(map, i*2,   j*2,   level+1, false) &&\n\t\t\t\tcanFullyDrawRecentTile(map, i*2,   j*2+1, level+1, false) &&\n\t\t\t\tcanFullyDrawRecentTile(map, i*2+1, j*2,   level+1, false) &&\n\t\t\t\tcanFullyDrawRecentTile(map, i*2+1, j*2+1, level+1, false)\n\n\t\t\tlet upperTileDrawn = false\n\t\t\tif (!canFillByQuaters) {\n\t\t\t\t// drawing upper tiles parts\n\t\t\t\tconst topLevel = Math.max(level - 5, Math.log2(map.getZoomRange()[0] / tileW) - 1)\n\t\t\t\tfor (let l = level - 1; l >= topLevel; l--) {\n\t\t\t\t\tconst sub = level - l\n\t\t\t\t\tupperTileDrawn = tryDrawTile(map, x,y,scale, i,j,level, i>>sub,j>>sub,level-sub, false, false) //prettier-ignore\n\t\t\t\t\tif (upperTileDrawn) break\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet lowerTilesDrawn = false\n\t\t\tif (!upperTileDrawn) {\n\t\t\t\ttilePlaceholderDrawFunc?.(map, i, j, level, x, y, tileW, scale)\n\t\t\t\tif (canFillByQuaters) {\n\t\t\t\t\t// drawing lower tiles as 2x2\n\t\t\t\t\tfor (let di = 0; di <= 1; di++)\n\t\t\t\t\t\tfor (let dj = 0; dj <= 1; dj++)\n\t\t\t\t\t\t\ttryDrawTile(map, x, y, scale, i, j, level, i*2+di, j*2+dj, level+1, false, false) //prettier-ignore\n\t\t\t\t\tlowerTilesDrawn = true\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// drawing additional (to 2x2) lower tiles from previous frames, useful for fast zoom-out animation.\n\t\t\tfor (let k = 0; k < lastDrawnUnderLevelTilesArr.length; k++) {\n\t\t\t\tconst tile = lastDrawnUnderLevelTilesArr[k]\n\t\t\t\t// skipping layer+1 if it was handled by upper 2x2\n\t\t\t\tif (!lowerTilesDrawn || tile.z >= level + 2)\n\t\t\t\t\ttryDrawTileObj(map, tile, x, y, scale, i, j, level, true)\n\t\t\t}\n\t\t}\n\n\t\ttryDrawTile(map, x, y, scale, i, j, level, i, j, level, shouldLoad, true)\n\t}\n\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {number} xShift\n\t * @param {number} yShift\n\t * @param {number} scale\n\t * @param {number} iFrom\n\t * @param {number} jFrom\n\t * @param {number} iCount\n\t * @param {number} jCount\n\t * @param {number} level\n\t * @param {boolean} shouldLoad\n\t */\n\tthis.draw = (map, xShift, yShift, scale, iFrom, jFrom, iCount, jCount, level, shouldLoad) => {\n\t\tconst [mapViewWidth, mapViewheight] = map.getViewBoxSize()\n\t\t// view size in tiles (extended a bit: it's needed for larger lastDrawnUnderLevelTilesArr and drawOneTile())\n\t\tconst tileViewSizeExt = Math.ceil(mapViewWidth / tileW + 1) * Math.ceil(mapViewheight / tileW + 1)\n\n\t\t// refilling recent tiles array\n\t\tlastDrawnUnderLevelTilesArr.length = 0\n\t\tlastDrawnTiles.forEach(\n\t\t\tx =>\n\t\t\t\tx.z >= level + 1 &&\n\t\t\t\tlastDrawnUnderLevelTilesArr.length < tileViewSizeExt * 2 && //limiting max lower tile count, just in case\n\t\t\t\tlastDrawnUnderLevelTilesArr.push(x),\n\t\t)\n\t\tlastDrawnTiles.clear()\n\t\tdrawIter++\n\n\t\t// start loading some center tiles first, sometimes useful on slow connections\n\t\tif (shouldLoad)\n\t\t\tfor (let i = (iCount / 3) | 0; i < (iCount * 2) / 3; i++)\n\t\t\t\tfor (let j = (jCount / 3) | 0; j < (jCount * 2) / 3; j++) {\n\t\t\t\t\tfindTile(map, iFrom + i, jFrom + j, level, true)\n\t\t\t\t}\n\n\t\t// drawing tiles\n\t\tfor (let i = 0; i < iCount; i++)\n\t\t\tfor (let j = 0; j < jCount; j++) {\n\t\t\t\tconst x = xShift + i * tileW * scale\n\t\t\t\tconst y = yShift + j * tileW * scale\n\t\t\t\tdrawOneTile(map, x, y, scale, iFrom + i, jFrom + j, level, shouldLoad)\n\t\t\t}\n\n\t\t// limiting cache size\n\t\tconst cacheMaxSize = (8 * tileViewSizeExt) | 0\n\t\tfor (let attempt = 0; attempt < 4 && cache.size > cacheMaxSize; attempt++) {\n\t\t\tlet oldestIter = drawIter - 1 //must not affect recently drawn tiles\n\t\t\tcache.forEach(tile => (oldestIter = Math.min(oldestIter, tile.lastDrawIter)))\n\t\t\tcache.forEach((tile, key) => {\n\t\t\t\tif (tile.lastDrawIter === oldestIter) {\n\t\t\t\t\tcache.delete(key)\n\t\t\t\t\tlastDrawnTiles.delete(/**@type {ImgTile}*/ (tile))\n\t\t\t\t\ttile.clear?.()\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tprevTileRegion = [iFrom, jFrom, iCount, jCount, level]\n\t}\n\n\tthis.getTileWidth = () => tileW\n\n\tthis.clearCache = () => {\n\t\tcache.forEach(x => x.clear?.())\n\t\tcache.clear()\n\t\tlastDrawnTiles.clear()\n\t\tlastDrawnUnderLevelTilesArr.length = 0\n\t}\n}\n\n/**\n * Loads image for {@linkcode TileContainer}s ({@linkcode SmoothTileContainer} for example).\n * @param {TilePathFunc} pathFunc tile path func, for example:\n *   ``(x, y, z) => `http://${oneOf('a', 'b', 'c')}.tile.openstreetmap.org/${z}/${x}/${y}.png` ``\n * @returns {TileImgLoadFunc}\n */\nexport function loadTileImage(pathFunc) {\n\treturn (x, y, z, onUpdate) => {\n\t\tconst img = new Image()\n\t\timg.src = pathFunc(x, y, z)\n\t\tconst clearHtmlImg_ = () => clearHtmlImg(img)\n\t\timg.onload = () => {\n\t\t\tconst createImageBitmap = window.createImageBitmap\n\t\t\tif (createImageBitmap) {\n\t\t\t\t// trying no decode image in parallel thread,\n\t\t\t\t// if failed (beacuse of CORS for example) tryimg to show image anyway\n\t\t\t\tcreateImageBitmap(img).then(\n\t\t\t\t\tx => onUpdate(x, () => clearBitmapImg(x)),\n\t\t\t\t\t() => onUpdate(img, clearHtmlImg_),\n\t\t\t\t)\n\t\t\t} else {\n\t\t\t\tonUpdate(img, clearHtmlImg_)\n\t\t\t}\n\t\t}\n\t\tonUpdate(null, clearHtmlImg_)\n\t}\n}\n\n/**\n * Wrapper for {@linkcode TilePathFunc} (like {@linkcode loadTileImage}).\n * Skips loading tiles outside of the map square (1x1 on level 0, 2x2 on level 1, etc.).\n *\n * @param {TileImgLoadFunc} tileFunc\n * @returns {TileImgLoadFunc}\n */\nexport function clampEarthTiles(tileFunc) {\n\treturn (x, y, z, onUpdate) => {\n\t\tconst w = 2 ** z\n\t\tif (z < 0 || x < 0 || x >= w || y < 0 || y >= w) return\n\t\ttileFunc(x, y, z, onUpdate)\n\t}\n}\n\n/**\n * Draws simple tile placeholder (semi-transparent square).\n *\n * @param {import('./map').LocMap} map\n * @param {number} x tile column index\n * @param {number} y tile row index\n * @param {number} z tile level\n * @param {number} drawX location on canvas\n * @param {number} drawY location on canvas\n * @param {number} tileW current tile size\n * @param {number} scale tile scale relative to it's regular size (displaying size is `tileW*scale`)\n */\nexport function drawRectTilePlaceholder(map, x, y, z, drawX, drawY, tileW, scale) {\n\tconst rc = map.get2dContext()\n\tif (rc === null) return\n\tconst w = tileW * scale\n\tconst margin = 1.5\n\trc.strokeStyle = '#8883'\n\trc.strokeRect(drawX + margin, drawY + margin, w - margin * 2, w - margin * 2)\n}\n","/**\n * @typedef {object} TileContainer\n * @prop {() => unknown} clearCache\n * @prop {() => number} getTileWidth\n * @prop {(map:import('./map').LocMap,\n *   xShift:number, yShift:number, scale:number,\n *   iFrom:number, jFrom:number, iCount:number, jCount:number, level:number,\n *   shouldLoad: boolean) => unknown} draw\n */\n\n/**\n * Loads and draw tiles using {@linkcode TileContainer}.\n * Disables tile load while zooming.\n * @class\n * @param {TileContainer} tileContainer tile cache/drawer, for example {@linkcode SmoothTileContainer}\n */\nexport function TileLayer(tileContainer) {\n\tlet shouldLoadTiles = true\n\tlet lastZoomAt = 0\n\tlet curZoomTotalDelta = 1\n\tlet tileLoadOffTimeout = -1\n\tlet tileLoadPausedAt = 0\n\t/**\n\t * @param {import('./map').LocMap} map\n\t * @param {number} durationMS\n\t */\n\tfunction pauseTileLoad(map, durationMS) {\n\t\tif (shouldLoadTiles) {\n\t\t\ttileLoadPausedAt = performance.now()\n\t\t\tshouldLoadTiles = false\n\t\t}\n\t\tclearTimeout(tileLoadOffTimeout)\n\t\ttileLoadOffTimeout = window.setTimeout(() => {\n\t\t\tshouldLoadTiles = true\n\t\t\tmap.requestRedraw()\n\t\t}, durationMS)\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.unregister = map => {\n\t\ttileContainer.clearCache()\n\t}\n\n\t/** @param {import('./map').LocMap} map */\n\tthis.redraw = map => {\n\t\tconst tileW = tileContainer.getTileWidth()\n\t\t//extra level shift (not 0.5), or on half-level zoom text on tiles may be too small\n\t\tconst level = Math.floor(Math.log2(map.getZoom() / tileW) + 0.4)\n\t\tconst tileGridSize = 2 ** level\n\t\tconst scale = map.getZoom() / tileW / tileGridSize\n\t\tconst blockSize = tileW * scale\n\t\tconst [mapXShift, mapYShift] = map.getViewBoxShift()\n\t\tconst [mapViewWidth, mapViewHeight] = map.getViewBoxSize()\n\n\t\tconst iFrom = Math.floor(mapXShift / blockSize)\n\t\tconst xShift = -mapXShift + iFrom * blockSize\n\n\t\tconst jFrom = Math.floor(mapYShift / blockSize)\n\t\tconst yShift = -mapYShift + jFrom * blockSize\n\n\t\tconst iCount = (((mapViewWidth - xShift) / blockSize) | 0) + 1\n\t\tconst jCount = (((mapViewHeight - yShift) / blockSize) | 0) + 1\n\n\t\ttileContainer.draw(map, xShift, yShift, scale, iFrom, jFrom, iCount, jCount, level, shouldLoadTiles)\n\t}\n\n\t/** @type {import('./map').MapEventHandlers} */\n\tthis.onEvent = {\n\t\tmapZoom(map, { delta }) {\n\t\t\tconst now = performance.now()\n\t\t\tconst timeDelta = now - lastZoomAt\n\t\t\tif (timeDelta > 250) curZoomTotalDelta = 1 //new zoom action started\n\t\t\tlastZoomAt = now\n\t\t\tcurZoomTotalDelta *= delta\n\n\t\t\t// if zoomed enough\n\t\t\tif (curZoomTotalDelta < 1 / 1.2 || curZoomTotalDelta > 1.2) {\n\t\t\t\t// if fast enough\n\t\t\t\tconst isFast = timeDelta === 0 || Math.abs(delta ** (1 / timeDelta) - 1) > 0.0005\n\t\t\t\tif (isFast) {\n\t\t\t\t\t// unpausing periodically in case of long slow zooming\n\t\t\t\t\tif (shouldLoadTiles || now - tileLoadPausedAt > 1000) pauseTileLoad(map, 80)\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t}\n}\n","export * from './map.js'\nexport * from './control_layer.js'\nexport * from './tile_container.js'\nexport * from './tile_layer.js'\nexport * from './url_layer.js'\nexport * from './location_layer.js'\nexport { oneOf, appendCredit } from './utils.js'\nexport * from './common_types.js'\n","import {\n\tControlLayer,\n\tdrawRectTilePlaceholder,\n\tloadTileImage,\n\tLocMap,\n\tProjectionConverter,\n\tSmoothTileContainer,\n\tTileContainer,\n\tTileImgLoadFunc,\n\tTileLayer,\n\tTilePlaceholderDrawFunc,\n} from 'locmap'\nimport { useEffect, useRef } from 'preact/hooks'\nimport { makeTileMaskChecker } from 'teyvat-map/tiles/summary'\n\nimport { MapCode } from '#lib/genshin'\nimport { clamp } from '#lib/utils/values'\nimport { checkAvifSupport } from '#lib/utils/web_media'\nimport { memo } from '#src/utils/preact-compat'\n\nconst TILE_DRAW_WIDTH = 192\nconst TILE_CONTENT_WIDTH = 256 //tile width in game pixels on layer 0\nconst MIN_LEVEL = -5.5\nconst MAX_LEVEL = 1\nconst DEFAULT_LEVEL = -1.2\nconst MARKERS_AUTO_REGION_DOWNSCALE = 1.1\nconst MARKER_ICON_SIZE_PX = 40\n\ntype TileExt = 'jpg' | 'avif'\n\nlet tileExt: TileExt = 'jpg'\nif (!BUNDLE_ENV.IS_SSR) checkAvifSupport().then(ok => ok && (tileExt = 'avif'))\n\nconst TILES_ROOT = `https://genshin-base.github.io/teyvat-map/v2.4/tiles`\n\nfunction tilePathFinc(x: number, y: number, z: number, mapCode: MapCode) {\n\treturn `${TILES_ROOT}/${mapCode}/${tileExt}/${z}/${x}/${y}.${tileExt}`\n}\n\nconst tilesMask: Record<string, ReturnType<typeof makeTileMaskChecker> | undefined> = {}\nif (!BUNDLE_ENV.IS_SSR)\n\tfetch(`${TILES_ROOT}/summary.json`)\n\t\t.then(r => r.json())\n\t\t.then(info => {\n\t\t\tfor (const code in info) tilesMask[code] = makeTileMaskChecker(info[code])\n\t\t})\n\nconst MapProjection: ProjectionConverter = {\n\tx2lon(x, zoom) {\n\t\treturn (x / zoom) * TILE_CONTENT_WIDTH\n\t},\n\ty2lat(y, zoom) {\n\t\treturn (y / zoom) * TILE_CONTENT_WIDTH\n\t},\n\n\tlon2x(lon, zoom) {\n\t\treturn (lon * zoom) / TILE_CONTENT_WIDTH\n\t},\n\tlat2y(lat, zoom) {\n\t\treturn (lat * zoom) / TILE_CONTENT_WIDTH\n\t},\n\n\tmeters2pixCoef(lat, zoom) {\n\t\treturn zoom / TILE_CONTENT_WIDTH\n\t},\n}\n\nexport type MapMarkerStyle = null | undefined | 'circle' | 'outline'\nexport type MapMarkerRaw = { mapCode: MapCode; x: number; y: number; icon: string; style?: MapMarkerStyle }\ntype MapMarkerIcon = { img: null | HTMLImageElement | HTMLCanvasElement }\ntype MapMarker = {\n\tmapCode: MapCode\n\tx: number\n\ty: number\n\ticon: MapMarkerIcon\n\tstyle: MapMarkerStyle\n}\n\nexport const TeyvatMap = memo(function TeyvatMap({\n\tclasses,\n\tmapCode,\n\tpos,\n\tmarkers,\n}: {\n\tclasses?: string\n\tmapCode: MapCode\n\tpos: { x: number; y: number; level: number } | 'auto'\n\tmarkers?: MapMarkerRaw[]\n}) {\n\tconst wrapRef = useRef<HTMLDivElement>(null)\n\tconst mapRef = useRef<{\n\t\tmap: LocMap\n\t\tmarkersLayer: MarkersLayer\n\t\ttileContainer: TileContainer\n\t} | null>(null)\n\tconst mapCodeRef = useRef<MapCode>('teyvat')\n\n\tuseEffect(() => {\n\t\tif (!wrapRef.current) return\n\n\t\tfunction shouldDrawTile(x: number, y: number, z: number) {\n\t\t\tconst mask = tilesMask[mapCodeRef.current]\n\t\t\treturn !mask || mask(x, y, z)\n\t\t}\n\n\t\tconst drawTilePlaceholder: TilePlaceholderDrawFunc = (map, x, y, z, drawX, drawY, tileW, scale) => {\n\t\t\tif (shouldDrawTile(x, y, z)) drawRectTilePlaceholder(map, x, y, z, drawX, drawY, tileW, scale)\n\t\t}\n\n\t\tconst loadTileInner = loadTileImage((x, y, z) => tilePathFinc(x, y, z, mapCodeRef.current))\n\t\tconst loadTile: TileImgLoadFunc = (x, y, z, onUpdate) => {\n\t\t\tif (shouldDrawTile(x, y, z)) loadTileInner(x, y, z, onUpdate)\n\t\t}\n\t\tconst tileContainer = new SmoothTileContainer(TILE_DRAW_WIDTH, loadTile, drawTilePlaceholder)\n\n\t\tconst map = new LocMap(wrapRef.current, MapProjection)\n\t\tconst markersLayer = new MarkersLayer()\n\t\tmap.setZoomRange(2 ** MIN_LEVEL * TILE_CONTENT_WIDTH, 2 ** MAX_LEVEL * TILE_CONTENT_WIDTH)\n\t\tmap.register(new TileLayer(tileContainer))\n\t\tmap.register(markersLayer)\n\t\tmap.register(new ControlLayer())\n\t\tmap.requestRedraw()\n\t\tmap.resize()\n\n\t\taddEventListener('resize', map.resize)\n\t\tmapRef.current = { map, markersLayer, tileContainer }\n\n\t\treturn () => {\n\t\t\tmap.getLayers().forEach(map.unregister)\n\t\t\tremoveEventListener('resize', map.resize)\n\t\t\tmapRef.current = null\n\t\t}\n\t}, [])\n\n\tuseEffect(() => {\n\t\tconst m = mapRef.current\n\t\tmapCodeRef.current = mapCode\n\t\tm?.markersLayer.setMapCode(mapCode)\n\t\tm?.tileContainer.clearCache()\n\t\tm?.map.requestRedraw()\n\t}, [mapCode])\n\n\tuseEffect(() => {\n\t\tmapRef.current?.markersLayer.setMarkers(markers ?? [])\n\t}, [markers])\n\n\tuseEffect(() => {\n\t\tconst map = mapRef.current?.map\n\t\tif (!map) return\n\t\tconst { x, y, level } = pos === 'auto' ? calcAutoPosition(map, markers ?? [], mapCode) : pos\n\t\tmap.updateLocation(x, y, TILE_CONTENT_WIDTH * 2 ** level)\n\t}, [pos, markers, mapCode])\n\n\treturn <div ref={wrapRef} class={'teyvat-map ' + classes}></div>\n})\n\nfunction calcAutoPosition(map: LocMap, markers: MapMarkerRaw[], mapCode: MapCode) {\n\tlet xMin = 1e10\n\tlet xMax = -1e10\n\tlet yMin = 1e10\n\tlet yMax = -1e10\n\tfor (const marker of markers) {\n\t\tif (marker.mapCode !== mapCode) continue\n\t\tif (xMin > marker.x) xMin = marker.x\n\t\tif (xMax < marker.x) xMax = marker.x\n\t\tif (yMin > marker.y) yMin = marker.y\n\t\tif (yMax < marker.y) yMax = marker.y\n\t}\n\n\tconst [w, h] = map.getViewBoxSize()\n\tconst zoom = Math.min(w / (xMax - xMin), h / (yMax - yMin)) / MARKERS_AUTO_REGION_DOWNSCALE\n\t// zoom==inf -> one marker, zoom<0 -> no markers\n\tlet level = zoom === Infinity || zoom < 0 ? DEFAULT_LEVEL : Math.log2(zoom)\n\tlevel = clamp(MIN_LEVEL, level, MAX_LEVEL)\n\n\treturn { x: (xMin + xMax) / 2, y: (yMin + yMax) / 2, level }\n}\n\nclass MarkersLayer {\n\tprivate map: LocMap | null = null\n\tprivate markers: MapMarker[] = []\n\tprivate iconCache: Map<string, MapMarkerIcon> = new Map()\n\tprivate mapCode: MapCode = 'teyvat'\n\n\tprivate loadMarkerImg(src: string, style: MapMarkerStyle) {\n\t\tconst key = src + '|' + style\n\t\tconst cachedIcon = this.iconCache.get(key)\n\t\tif (cachedIcon) {\n\t\t\tif (cachedIcon.img) this.map?.requestRedraw()\n\t\t\treturn cachedIcon\n\t\t} else {\n\t\t\tconst img = new Image()\n\t\t\tconst icon: MapMarkerIcon = { img: null }\n\t\t\timg.src = src\n\t\t\timg.onload = () => {\n\t\t\t\ticon.img =\n\t\t\t\t\tstyle === 'outline'\n\t\t\t\t\t\t? makeCanvasWithShadow(img, 1, 'black') //\n\t\t\t\t\t\t: img\n\t\t\t\tthis.map?.requestRedraw()\n\t\t\t}\n\t\t\tthis.iconCache.set(key, icon)\n\t\t\treturn icon\n\t\t}\n\t}\n\n\tsetMapCode(mapCode: MapCode) {\n\t\tthis.mapCode = mapCode\n\t}\n\n\tsetMarkers(rawMarkers: MapMarkerRaw[]) {\n\t\tthis.markers.length = 0\n\t\t{\n\t\t\tconst cache = this.iconCache\n\t\t\tfor (const key of cache.keys()) {\n\t\t\t\tif (cache.size < 30) break\n\t\t\t\tcache.delete(key)\n\t\t\t}\n\t\t}\n\t\tfor (const raw of rawMarkers) {\n\t\t\tconst marker = { ...raw, icon: this.loadMarkerImg(raw.icon, raw.style), style: raw.style }\n\t\t\tthis.markers.push(marker)\n\t\t}\n\t}\n\n\tredraw(map: LocMap) {\n\t\tconst rc = map.get2dContext()\n\t\tif (!rc) return\n\n\t\tconst [viewX, viewY] = map.getViewBoxShift()\n\t\tconst zoomDownscale = Math.min(1, (map.getZoom() / TILE_DRAW_WIDTH - 1) / 2 + 1)\n\n\t\tfor (let i = 0, markers = this.markers; i < markers.length; i++) {\n\t\t\tconst marker = markers[i]\n\t\t\tif (marker.mapCode !== this.mapCode) continue\n\n\t\t\tconst x = map.lon2x(marker.x) - viewX\n\t\t\tconst y = map.lat2y(marker.y) - viewY\n\t\t\tconst size = MARKER_ICON_SIZE_PX * zoomDownscale\n\t\t\tconst lineW = 1.5 * zoomDownscale\n\t\t\tconst isCircled = marker.style === 'circle'\n\n\t\t\tif (isCircled) {\n\t\t\t\trc.beginPath()\n\t\t\t\trc.arc(x, y, size / 2 + lineW / 2 + 0.75, 0, Math.PI * 2, false)\n\t\t\t\trc.fillStyle = '#333'\n\t\t\t\trc.fill()\n\t\t\t}\n\n\t\t\tconst img = marker.icon.img\n\t\t\tif (img !== null) {\n\t\t\t\tconst isImg = 'naturalWidth' in img\n\t\t\t\tconst nw = isImg ? img.naturalWidth : img.width\n\t\t\t\tconst nh = isImg ? img.naturalHeight : img.height\n\t\t\t\tconst scale = Math.min(size / nw, size / nh)\n\t\t\t\tconst w = nw * scale\n\t\t\t\tconst h = nh * scale\n\t\t\t\tif (isCircled) {\n\t\t\t\t\trc.save()\n\t\t\t\t\trc.beginPath()\n\t\t\t\t\trc.arc(x, y, size / 2 - lineW / 2 - 0.75, 0, Math.PI * 2, false)\n\t\t\t\t\trc.clip()\n\t\t\t\t}\n\t\t\t\trc.drawImage(img, x - w / 2, y - h / 2, w, h)\n\t\t\t\tif (isCircled) {\n\t\t\t\t\trc.restore()\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (isCircled) {\n\t\t\t\trc.beginPath()\n\t\t\t\trc.arc(x, y, size / 2, 0, Math.PI * 2, false)\n\t\t\t\trc.strokeStyle = 'white'\n\t\t\t\trc.lineWidth = lineW\n\t\t\t\trc.stroke()\n\t\t\t}\n\t\t}\n\t}\n\n\tregister(map: LocMap) {\n\t\tthis.map = map\n\t}\n\n\tunregister(map: LocMap) {\n\t\tthis.map = null\n\t\tthis.markers.length = 0\n\t}\n}\n\nfunction makeCanvasWithShadow(img: HTMLImageElement, blur: number, color: string) {\n\tconst canvas = document.createElement('canvas')\n\tcanvas.width = img.naturalWidth\n\tcanvas.height = img.naturalHeight\n\tconst rc = canvas.getContext('2d')\n\tif (rc) {\n\t\trc.shadowBlur = blur\n\t\trc.shadowColor = color\n\t\tfor (let i = 0; i < 3; i++) rc.drawImage(img, 0, 0)\n\t}\n\treturn canvas\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Check if two objects have a different shape\n * @param {object} a\n * @param {object} b\n * @returns {boolean}\n */\nexport function shallowDiffers(a, b) {\n\tfor (let i in a) if (i !== '__source' && !(i in b)) return true;\n\tfor (let i in b) if (i !== '__source' && a[i] !== b[i]) return true;\n\treturn false;\n}\n\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","import { createElement } from 'preact';\nimport { shallowDiffers } from './util';\n\n/**\n * Memoize a component, so that it only updates when the props actually have\n * changed. This was previously known as `React.pure`.\n * @param {import('./internal').FunctionComponent} c functional component\n * @param {(prev: object, next: object) => boolean} [comparer] Custom equality function\n * @returns {import('./internal').FunctionComponent}\n */\nexport function memo(c, comparer) {\n\tfunction shouldUpdate(nextProps) {\n\t\tlet ref = this.props.ref;\n\t\tlet updateRef = ref == nextProps.ref;\n\t\tif (!updateRef && ref) {\n\t\t\tref.call ? ref(null) : (ref.current = null);\n\t\t}\n\n\t\tif (!comparer) {\n\t\t\treturn shallowDiffers(this.props, nextProps);\n\t\t}\n\n\t\treturn !comparer(this.props, nextProps) || !updateRef;\n\t}\n\n\tfunction Memoed(props) {\n\t\tthis.shouldComponentUpdate = shouldUpdate;\n\t\treturn createElement(c, props);\n\t}\n\tMemoed.displayName = 'Memo(' + (c.displayName || c.name) + ')';\n\tMemoed.prototype.isReactComponent = true;\n\tMemoed._forwarded = true;\n\treturn Memoed;\n}\n","import { createElement, render } from 'preact';\n\n/**\n * @param {import('../../src/index').RenderableProps<{ context: any }>} props\n */\nfunction ContextProvider(props) {\n\tthis.getChildContext = () => props.context;\n\treturn props.children;\n}\n\n/**\n * Portal component\n * @this {import('./internal').Component}\n * @param {object | null | undefined} props\n *\n * TODO: use createRoot() instead of fake root\n */\nfunction Portal(props) {\n\tconst _this = this;\n\tlet container = props._container;\n\n\t_this.componentWillUnmount = function() {\n\t\trender(null, _this._temp);\n\t\t_this._temp = null;\n\t\t_this._container = null;\n\t};\n\n\t// When we change container we should clear our old container and\n\t// indicate a new mount.\n\tif (_this._container && _this._container !== container) {\n\t\t_this.componentWillUnmount();\n\t}\n\n\t// When props.vnode is undefined/false/null we are dealing with some kind of\n\t// conditional vnode. This should not trigger a render.\n\tif (props._vnode) {\n\t\tif (!_this._temp) {\n\t\t\t_this._container = container;\n\n\t\t\t// Create a fake DOM parent node that manages a subset of `container`'s children:\n\t\t\t_this._temp = {\n\t\t\t\tnodeType: 1,\n\t\t\t\tparentNode: container,\n\t\t\t\tchildNodes: [],\n\t\t\t\tappendChild(child) {\n\t\t\t\t\tthis.childNodes.push(child);\n\t\t\t\t\t_this._container.appendChild(child);\n\t\t\t\t},\n\t\t\t\tinsertBefore(child, before) {\n\t\t\t\t\tthis.childNodes.push(child);\n\t\t\t\t\t_this._container.appendChild(child);\n\t\t\t\t},\n\t\t\t\tremoveChild(child) {\n\t\t\t\t\tthis.childNodes.splice(this.childNodes.indexOf(child) >>> 1, 1);\n\t\t\t\t\t_this._container.removeChild(child);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// Render our wrapping element into temp.\n\t\trender(\n\t\t\tcreateElement(ContextProvider, { context: _this.context }, props._vnode),\n\t\t\t_this._temp\n\t\t);\n\t}\n\t// When we come from a conditional render, on a mounted\n\t// portal we should clear the DOM.\n\telse if (_this._temp) {\n\t\t_this.componentWillUnmount();\n\t}\n}\n\n/**\n * Create a `Portal` to continue rendering the vnode tree at a different DOM node\n * @param {import('./internal').VNode} vnode The vnode to render\n * @param {import('./internal').PreactElement} container The DOM node to continue rendering in to.\n */\nexport function createPortal(vnode, container) {\n\treturn createElement(Portal, { _vnode: vnode, _container: container });\n}\n","// direct imports to avoid kilobytes of side-effects from 'preact/compat'\n// normal imports (preact/compat/src/memo) do not work with webpack (it strictly follows 'exports' field in package.json)\nimport { memo as memo_ } from '#src/../../node_modules/preact/compat/src/memo'\nimport { createPortal as createPortal_ } from '#src/../../node_modules/preact/compat/src/portals'\n\nimport type { createPortal as createPortalOrig } from 'preact/compat'\nimport type { memo as memoOrig } from 'preact/compat'\n\nexport const createPortal = createPortal_ as typeof createPortalOrig\nexport const memo = memo_ as typeof memoOrig\n","/**\n * @template T\n * @param {T|null} val\n * @returns {T}\n */\nexport function mustBeNotNull(val) {\n\tif (val === null) throw new Error('value is null, this should not happen')\n\treturn val\n}\n\n/**\n * @template T\n * @param {T|undefined} val\n * @returns {T}\n */\nexport function mustBeDefined(val) {\n\tif (val === undefined) throw new Error('value is undefined, this should not happen')\n\treturn val\n}\n\n/**\n * @template T\n * @param {T|undefined} x\n * @returns {x is T}\n */\nexport function isDefined(x) {\n\treturn x !== undefined\n}\n\n/**\n * @param {never[]} values\n * @returns {never}\n */\nexport function mustBeNever(...values) {\n\tthrow new Error('must not be reachable')\n}\n\n/**\n * @param {string} msg\n * @param {never[]} values\n * @returns {void}\n */\nexport function warnUnlessNever(msg, ...values) {\n\tconsole.warn(msg, ...values)\n}\n\n/**\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport function simpleDeepEqual(a, b) {\n\tif (Array.isArray(a) && Array.isArray(b)) {\n\t\tif (a.length !== b.length) return false\n\t\tfor (let i = 0; i < a.length; i++) {\n\t\t\tif (!simpleDeepEqual(a[i], b[i])) return false\n\t\t}\n\t\treturn true\n\t}\n\tif (typeof a === 'object' && typeof b === 'object' && a !== null && b !== null) {\n\t\tif (Object.keys(a).length !== Object.keys(b).length) return false\n\t\tfor (const attr in a) {\n\t\t\tif (!simpleDeepEqual(a[attr], b[attr])) return false\n\t\t}\n\t\treturn true\n\t}\n\treturn a === b\n}\n\n/**\n * @template TVal\n * @template TKey\n * @param {Iterable<TVal>} items\n * @param {(item:TVal) => TKey} keyFunc\n * @returns {Map<TKey, TVal[]>}\n */\nexport function groupByToMap(items, keyFunc) {\n\tconst map = /**@type {Map<TKey, TVal[]>}*/ (new Map())\n\tfor (const item of items) {\n\t\tconst key = keyFunc(item)\n\t\tconst cur = map.get(key)\n\t\tif (cur) cur.push(item)\n\t\telse map.set(key, [item])\n\t}\n\treturn map\n}\n\n/**\n * @param {number} min\n * @param {number} val\n * @param {number} max\n * @returns {number}\n */\nexport function clamp(min, val, max) {\n\treturn val < min ? min : val > max ? max : val\n}\n\n/** @returns {Promise<never>} */\nexport function promiseNever() {\n\treturn new Promise(() => undefined)\n}\n\n/**\n * @class\n * @template T\n */\nexport function Deferred() {\n\t/** @type {Promise<T>} */\n\tthis.promise = new Promise((res, rej) => {\n\t\tthis.resolve = res\n\t\tthis.reject = rej\n\t})\n}\n\n/**\n * @template T\n * @param {T | Promise<T>} value\n * @returns {value is Promise<T>}\n */\nexport function isPromise(value) {\n\treturn typeof value === 'object' && value !== null && 'then' in value\n}\n","var n,l,u,i,t,o,r,f,e={},c=[],s=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function a(n,l){for(var u in l)n[u]=l[u];return n}function h(n){var l=n.parentNode;l&&l.removeChild(n)}function v(l,u,i){var t,o,r,f={};for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),\"function\"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return y(l,f,t,o,null)}function y(n,i,t,o,r){var f={type:n,props:i,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++u:r};return null==r&&null!=l.vnode&&l.vnode(f),f}function p(){return{current:null}}function d(n){return n.children}function _(n,l){this.props=n,this.context=l}function k(n,l){if(null==l)return n.__?k(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?k(n):null}function b(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return b(n)}}function m(n){(!n.__d&&(n.__d=!0)&&t.push(n)&&!g.__r++||r!==l.debounceRendering)&&((r=l.debounceRendering)||o)(g)}function g(){for(var n;g.__r=t.length;)n=t.sort(function(n,l){return n.__v.__b-l.__v.__b}),t=[],n.some(function(n){var l,u,i,t,o,r;n.__d&&(o=(t=(l=n).__v).__e,(r=l.__P)&&(u=[],(i=a({},t)).__v=t.__v+1,j(r,t,i,l.__n,void 0!==r.ownerSVGElement,null!=t.__h?[o]:null,u,null==o?k(t):o,t.__h),z(u,t),t.__e!=o&&b(t)))})}function w(n,l,u,i,t,o,r,f,s,a){var h,v,p,_,b,m,g,w=i&&i.__k||c,A=w.length;for(u.__k=[],h=0;h<l.length;h++)if(null!=(_=u.__k[h]=null==(_=l[h])||\"boolean\"==typeof _?null:\"string\"==typeof _||\"number\"==typeof _||\"bigint\"==typeof _?y(null,_,null,null,_):Array.isArray(_)?y(d,{children:_},null,null,null):_.__b>0?y(_.type,_.props,_.key,null,_.__v):_)){if(_.__=u,_.__b=u.__b+1,null===(p=w[h])||p&&_.key==p.key&&_.type===p.type)w[h]=void 0;else for(v=0;v<A;v++){if((p=w[v])&&_.key==p.key&&_.type===p.type){w[v]=void 0;break}p=null}j(n,_,p=p||e,t,o,r,f,s,a),b=_.__e,(v=_.ref)&&p.ref!=v&&(g||(g=[]),p.ref&&g.push(p.ref,null,_),g.push(v,_.__c||b,_)),null!=b?(null==m&&(m=b),\"function\"==typeof _.type&&_.__k===p.__k?_.__d=s=x(_,s,n):s=P(n,_,p,w,b,s),\"function\"==typeof u.type&&(u.__d=s)):s&&p.__e==s&&s.parentNode!=n&&(s=k(p))}for(u.__e=m,h=A;h--;)null!=w[h]&&(\"function\"==typeof u.type&&null!=w[h].__e&&w[h].__e==u.__d&&(u.__d=k(i,h+1)),N(w[h],w[h]));if(g)for(h=0;h<g.length;h++)M(g[h],g[++h],g[++h])}function x(n,l,u){for(var i,t=n.__k,o=0;t&&o<t.length;o++)(i=t[o])&&(i.__=n,l=\"function\"==typeof i.type?x(i,l,u):P(u,i,i,t,i.__e,l));return l}function A(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(Array.isArray(n)?n.some(function(n){A(n,l)}):l.push(n)),l}function P(n,l,u,i,t,o){var r,f,e;if(void 0!==l.__d)r=l.__d,l.__d=void 0;else if(null==u||t!=o||null==t.parentNode)n:if(null==o||o.parentNode!==n)n.appendChild(t),r=null;else{for(f=o,e=0;(f=f.nextSibling)&&e<i.length;e+=2)if(f==t)break n;n.insertBefore(t,o),r=o}return void 0!==r?r:t.nextSibling}function C(n,l,u,i,t){var o;for(o in u)\"children\"===o||\"key\"===o||o in l||H(n,o,null,u[o],i);for(o in l)t&&\"function\"!=typeof l[o]||\"children\"===o||\"key\"===o||\"value\"===o||\"checked\"===o||u[o]===l[o]||H(n,o,l[o],u[o],i)}function $(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=null==u?\"\":\"number\"!=typeof u||s.test(l)?u:u+\"px\"}function H(n,l,u,i,t){var o;n:if(\"style\"===l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof i&&(n.style.cssText=i=\"\"),i)for(l in i)u&&l in u||$(n.style,l,\"\");if(u)for(l in u)i&&u[l]===i[l]||$(n.style,l,u[l])}else if(\"o\"===l[0]&&\"n\"===l[1])o=l!==(l=l.replace(/Capture$/,\"\")),l=l.toLowerCase()in n?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?i||n.addEventListener(l,o?T:I,o):n.removeEventListener(l,o?T:I,o);else if(\"dangerouslySetInnerHTML\"!==l){if(t)l=l.replace(/xlink[H:h]/,\"h\").replace(/sName$/,\"s\");else if(\"href\"!==l&&\"list\"!==l&&\"form\"!==l&&\"tabIndex\"!==l&&\"download\"!==l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null!=u&&(!1!==u||\"a\"===l[0]&&\"r\"===l[1])?n.setAttribute(l,u):n.removeAttribute(l))}}function I(n){this.l[n.type+!1](l.event?l.event(n):n)}function T(n){this.l[n.type+!0](l.event?l.event(n):n)}function j(n,u,i,t,o,r,f,e,c){var s,h,v,y,p,k,b,m,g,x,A,P=u.type;if(void 0!==u.constructor)return null;null!=i.__h&&(c=i.__h,e=u.__e=i.__e,u.__h=null,r=[e]),(s=l.__b)&&s(u);try{n:if(\"function\"==typeof P){if(m=u.props,g=(s=P.contextType)&&t[s.__c],x=s?g?g.props.value:s.__:t,i.__c?b=(h=u.__c=i.__c).__=h.__E:(\"prototype\"in P&&P.prototype.render?u.__c=h=new P(m,x):(u.__c=h=new _(m,x),h.constructor=P,h.render=O),g&&g.sub(h),h.props=m,h.state||(h.state={}),h.context=x,h.__n=t,v=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=P.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=a({},h.__s)),a(h.__s,P.getDerivedStateFromProps(m,h.__s))),y=h.props,p=h.state,v)null==P.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==P.getDerivedStateFromProps&&m!==y&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(m,x),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(m,h.__s,x)||u.__v===i.__v){h.props=m,h.state=h.__s,u.__v!==i.__v&&(h.__d=!1),h.__v=u,u.__e=i.__e,u.__k=i.__k,u.__k.forEach(function(n){n&&(n.__=u)}),h.__h.length&&f.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(m,h.__s,x),null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(y,p,k)})}h.context=x,h.props=m,h.state=h.__s,(s=l.__r)&&s(u),h.__d=!1,h.__v=u,h.__P=n,s=h.render(h.props,h.state,h.context),h.state=h.__s,null!=h.getChildContext&&(t=a(a({},t),h.getChildContext())),v||null==h.getSnapshotBeforeUpdate||(k=h.getSnapshotBeforeUpdate(y,p)),A=null!=s&&s.type===d&&null==s.key?s.props.children:s,w(n,Array.isArray(A)?A:[A],u,i,t,o,r,f,e,c),h.base=u.__e,u.__h=null,h.__h.length&&f.push(h),b&&(h.__E=h.__=null),h.__e=!1}else null==r&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=L(i.__e,u,i,t,o,r,f,c);(s=l.diffed)&&s(u)}catch(n){u.__v=null,(c||null!=r)&&(u.__e=e,u.__h=!!c,r[r.indexOf(e)]=null),l.__e(n,u,i)}}function z(n,u){l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function L(l,u,i,t,o,r,f,c){var s,a,v,y=i.props,p=u.props,d=u.type,_=0;if(\"svg\"===d&&(o=!0),null!=r)for(;_<r.length;_++)if((s=r[_])&&\"setAttribute\"in s==!!d&&(d?s.localName===d:3===s.nodeType)){l=s,r[_]=null;break}if(null==l){if(null===d)return document.createTextNode(p);l=o?document.createElementNS(\"http://www.w3.org/2000/svg\",d):document.createElement(d,p.is&&p),r=null,c=!1}if(null===d)y===p||c&&l.data===p||(l.data=p);else{if(r=r&&n.call(l.childNodes),a=(y=i.props||e).dangerouslySetInnerHTML,v=p.dangerouslySetInnerHTML,!c){if(null!=r)for(y={},_=0;_<l.attributes.length;_++)y[l.attributes[_].name]=l.attributes[_].value;(v||a)&&(v&&(a&&v.__html==a.__html||v.__html===l.innerHTML)||(l.innerHTML=v&&v.__html||\"\"))}if(C(l,p,y,o,c),v)u.__k=[];else if(_=u.props.children,w(l,Array.isArray(_)?_:[_],u,i,t,o&&\"foreignObject\"!==d,r,f,r?r[0]:i.__k&&k(i,0),c),null!=r)for(_=r.length;_--;)null!=r[_]&&h(r[_]);c||(\"value\"in p&&void 0!==(_=p.value)&&(_!==l.value||\"progress\"===d&&!_||\"option\"===d&&_!==y.value)&&H(l,\"value\",_,y.value,!1),\"checked\"in p&&void 0!==(_=p.checked)&&_!==l.checked&&H(l,\"checked\",_,y.checked,!1))}return l}function M(n,u,i){try{\"function\"==typeof n?n(u):n.current=u}catch(n){l.__e(n,i)}}function N(n,u,i){var t,o;if(l.unmount&&l.unmount(n),(t=n.ref)&&(t.current&&t.current!==n.__e||M(t,null,u)),null!=(t=n.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(n){l.__e(n,u)}t.base=t.__P=null}if(t=n.__k)for(o=0;o<t.length;o++)t[o]&&N(t[o],u,\"function\"!=typeof n.type);i||null==n.__e||h(n.__e),n.__e=n.__d=void 0}function O(n,l,u){return this.constructor(n,u)}function S(u,i,t){var o,r,f;l.__&&l.__(u,i),r=(o=\"function\"==typeof t)?null:t&&t.__k||i.__k,f=[],j(i,u=(!o&&t||i).__k=v(d,null,[u]),r||e,e,void 0!==i.ownerSVGElement,!o&&t?[t]:r?null:i.firstChild?n.call(i.childNodes):null,f,!o&&t?t:r?r.__e:i.firstChild,o),z(f,u)}function q(n,l){S(n,l,q)}function B(l,u,i){var t,o,r,f=a({},l.props);for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),y(l.type,f,t||l.key,o||l.ref,null)}function D(n,l){var u={__c:l=\"__cC\"+f++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var u,i;return this.getChildContext||(u=[],(i={})[l]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&u.some(m)},this.sub=function(n){u.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u.splice(u.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Provider.__=u.Consumer.contextType=u}n=c.slice,l={__e:function(n,l){for(var u,i,t;l=l.__;)if((u=l.__c)&&!u.__)try{if((i=u.constructor)&&null!=i.getDerivedStateFromError&&(u.setState(i.getDerivedStateFromError(n)),t=u.__d),null!=u.componentDidCatch&&(u.componentDidCatch(n),t=u.__d),t)return u.__E=u}catch(l){n=l}throw n}},u=0,i=function(n){return null!=n&&void 0===n.constructor},_.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=a({},this.state),\"function\"==typeof n&&(n=n(a({},u),this.props)),n&&a(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),m(this))},_.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),m(this))},_.prototype.render=d,t=[],o=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,g.__r=0,f=0;export{S as render,q as hydrate,v as createElement,v as h,d as Fragment,p as createRef,i as isValidElement,_ as Component,B as cloneElement,D as createContext,A as toChildArray,l as options};\n//# sourceMappingURL=preact.module.js.map\n","import{options as n}from\"preact\";var t,u,r,o=0,i=[],c=n.__b,f=n.__r,e=n.diffed,a=n.__c,v=n.unmount;function m(t,r){n.__h&&n.__h(u,t,o||r),o=0;var i=u.__H||(u.__H={__:[],__h:[]});return t>=i.__.length&&i.__.push({}),i.__[t]}function l(n){return o=1,p(w,n)}function p(n,r,o){var i=m(t++,2);return i.t=n,i.__c||(i.__=[o?o(r):w(void 0,r),function(n){var t=i.t(i.__[0],n);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}],i.__c=u),i.__}function y(r,o){var i=m(t++,3);!n.__s&&k(i.__H,o)&&(i.__=r,i.__H=o,u.__H.__h.push(i))}function h(r,o){var i=m(t++,4);!n.__s&&k(i.__H,o)&&(i.__=r,i.__H=o,u.__h.push(i))}function s(n){return o=5,d(function(){return{current:n}},[])}function _(n,t,u){o=6,h(function(){\"function\"==typeof n?n(t()):n&&(n.current=t())},null==u?u:u.concat(n))}function d(n,u){var r=m(t++,7);return k(r.__H,u)&&(r.__=n(),r.__H=u,r.__h=n),r.__}function A(n,t){return o=8,d(function(){return n},t)}function F(n){var r=u.context[n.__c],o=m(t++,9);return o.c=n,r?(null==o.__&&(o.__=!0,r.sub(u)),r.props.value):n.__}function T(t,u){n.useDebugValue&&n.useDebugValue(u?u(t):t)}function q(n){var r=m(t++,10),o=l();return r.__=n,u.componentDidCatch||(u.componentDidCatch=function(n){r.__&&r.__(n),o[1](n)}),[o[0],function(){o[1](void 0)}]}function x(){for(var t;t=i.shift();)if(t.__P)try{t.__H.__h.forEach(g),t.__H.__h.forEach(j),t.__H.__h=[]}catch(u){t.__H.__h=[],n.__e(u,t.__v)}}n.__b=function(n){u=null,c&&c(n)},n.__r=function(n){f&&f(n),t=0;var r=(u=n.__c).__H;r&&(r.__h.forEach(g),r.__h.forEach(j),r.__h=[])},n.diffed=function(t){e&&e(t);var o=t.__c;o&&o.__H&&o.__H.__h.length&&(1!==i.push(o)&&r===n.requestAnimationFrame||((r=n.requestAnimationFrame)||function(n){var t,u=function(){clearTimeout(r),b&&cancelAnimationFrame(t),setTimeout(n)},r=setTimeout(u,100);b&&(t=requestAnimationFrame(u))})(x)),u=null},n.__c=function(t,u){u.some(function(t){try{t.__h.forEach(g),t.__h=t.__h.filter(function(n){return!n.__||j(n)})}catch(r){u.some(function(n){n.__h&&(n.__h=[])}),u=[],n.__e(r,t.__v)}}),a&&a(t,u)},n.unmount=function(t){v&&v(t);var u,r=t.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{g(n)}catch(n){u=n}}),u&&n.__e(u,r.__v))};var b=\"function\"==typeof requestAnimationFrame;function g(n){var t=u,r=n.__c;\"function\"==typeof r&&(n.__c=void 0,r()),u=t}function j(n){var t=u;n.__c=n.__(),u=t}function k(n,t){return!n||n.length!==t.length||t.some(function(t,u){return t!==n[u]})}function w(n,t){return\"function\"==typeof t?t(n):t}export{l as useState,p as useReducer,y as useEffect,h as useLayoutEffect,s as useRef,_ as useImperativeHandle,d as useMemo,A as useCallback,F as useContext,T as useDebugValue,q as useErrorBoundary};\n//# sourceMappingURL=hooks.module.js.map\n","import{options as r,Fragment as _}from\"preact\";export{Fragment}from\"preact\";var o=0;function e(_,e,n,t,f){var l,s,u={};for(s in e)\"ref\"==s?l=e[s]:u[s]=e[s];var a={type:_,props:u,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--o,__source:t,__self:f};if(\"function\"==typeof _&&(l=_.defaultProps))for(s in l)void 0===u[s]&&(u[s]=l[s]);return r.vnode&&r.vnode(a),a}export{e as jsx,e as jsxs,e as jsxDEV};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","import{options as e,Fragment as t}from\"preact\";var r=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,n=/[&<>\"]/;function o(e){var t=String(e);return n.test(t)?t.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\").replace(/\"/g,\"&quot;\"):t}var a=function(e,t){return String(e).replace(/(\\n+)/g,\"$1\"+(t||\"\\t\"))},i=function(e,t,r){return String(e).length>(t||40)||!r&&-1!==String(e).indexOf(\"\\n\")||-1!==String(e).indexOf(\"<\")},l={};function s(e){var t=\"\";for(var n in e){var o=e[n];null!=o&&\"\"!==o&&(t&&(t+=\" \"),t+=\"-\"==n[0]?n:l[n]||(l[n]=n.replace(/([A-Z])/g,\"-$1\").toLowerCase()),t+=\": \",t+=o,\"number\"==typeof o&&!1===r.test(n)&&(t+=\"px\"),t+=\";\")}return t||void 0}function f(e,t){for(var r in t)e[r]=t[r];return e}function u(e,t){return Array.isArray(t)?t.reduce(u,e):null!=t&&!1!==t&&e.push(t),e}var c={shallow:!0},p=[],_=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,v=/[\\s\\n\\\\/='\"\\0<>]/,d=function(){};m.render=m;var g=function(e,t){return m(e,t,c)},h=[];function m(t,r,n){r=r||{},n=n||{};var o=e.__s;e.__s=!0;var a=x(t,r,n);return e.__c&&e.__c(t,h),h.length=0,e.__s=o,a}function x(r,n,l,c,g,h){if(null==r||\"boolean\"==typeof r)return\"\";if(\"object\"!=typeof r)return o(r);var m=l.pretty,y=m&&\"string\"==typeof m?m:\"\\t\";if(Array.isArray(r)){for(var b=\"\",S=0;S<r.length;S++)m&&S>0&&(b+=\"\\n\"),b+=x(r[S],n,l,c,g,h);return b}var w,k=r.type,O=r.props,C=!1;if(\"function\"==typeof k){if(C=!0,!l.shallow||!c&&!1!==l.renderRootComponent){if(k===t){var A=[];return u(A,r.props.children),x(A,n,l,!1!==l.shallowHighOrder,g,h)}var H,j=r.__c={__v:r,context:n,props:r.props,setState:d,forceUpdate:d,__h:[]};if(e.__b&&e.__b(r),e.__r&&e.__r(r),k.prototype&&\"function\"==typeof k.prototype.render){var F=k.contextType,M=F&&n[F.__c],T=null!=F?M?M.props.value:F.__:n;(j=r.__c=new k(O,T)).__v=r,j._dirty=j.__d=!0,j.props=O,null==j.state&&(j.state={}),null==j._nextState&&null==j.__s&&(j._nextState=j.__s=j.state),j.context=T,k.getDerivedStateFromProps?j.state=f(f({},j.state),k.getDerivedStateFromProps(j.props,j.state)):j.componentWillMount&&(j.componentWillMount(),j.state=j._nextState!==j.state?j._nextState:j.__s!==j.state?j.__s:j.state),H=j.render(j.props,j.state,j.context)}else{var $=k.contextType,L=$&&n[$.__c];H=k.call(r.__c,O,null!=$?L?L.props.value:$.__:n)}return j.getChildContext&&(n=f(f({},n),j.getChildContext())),e.diffed&&e.diffed(r),x(H,n,l,!1!==l.shallowHighOrder,g,h)}k=(w=k).displayName||w!==Function&&w.name||function(e){var t=(Function.prototype.toString.call(e).match(/^\\s*function\\s+([^( ]+)/)||\"\")[1];if(!t){for(var r=-1,n=p.length;n--;)if(p[n]===e){r=n;break}r<0&&(r=p.push(e)-1),t=\"UnnamedComponent\"+r}return t}(w)}var E,D,N=\"<\"+k;if(O){var P=Object.keys(O);l&&!0===l.sortAttributes&&P.sort();for(var R=0;R<P.length;R++){var U=P[R],W=O[U];if(\"children\"!==U){if(!v.test(U)&&(l&&l.allAttributes||\"key\"!==U&&\"ref\"!==U&&\"__self\"!==U&&\"__source\"!==U)){if(\"defaultValue\"===U)U=\"value\";else if(\"className\"===U){if(void 0!==O.class)continue;U=\"class\"}else g&&U.match(/^xlink:?./)&&(U=U.toLowerCase().replace(/^xlink:?/,\"xlink:\"));if(\"htmlFor\"===U){if(O.for)continue;U=\"for\"}\"style\"===U&&W&&\"object\"==typeof W&&(W=s(W)),\"a\"===U[0]&&\"r\"===U[1]&&\"boolean\"==typeof W&&(W=String(W));var q=l.attributeHook&&l.attributeHook(U,W,n,l,C);if(q||\"\"===q)N+=q;else if(\"dangerouslySetInnerHTML\"===U)D=W&&W.__html;else if(\"textarea\"===k&&\"value\"===U)E=W;else if((W||0===W||\"\"===W)&&\"function\"!=typeof W){if(!(!0!==W&&\"\"!==W||(W=U,l&&l.xml))){N+=\" \"+U;continue}if(\"value\"===U){if(\"select\"===k){h=W;continue}\"option\"===k&&h==W&&(N+=\" selected\")}N+=\" \"+U+'=\"'+o(W)+'\"'}}}else E=W}}if(m){var z=N.replace(/\\n\\s*/,\" \");z===N||~z.indexOf(\"\\n\")?m&&~N.indexOf(\"\\n\")&&(N+=\"\\n\"):N=z}if(N+=\">\",v.test(k))throw new Error(k+\" is not a valid HTML tag name in \"+N);var I,V=_.test(k)||l.voidElements&&l.voidElements.test(k),Z=[];if(D)m&&i(D)&&(D=\"\\n\"+y+a(D,y)),N+=D;else if(null!=E&&u(I=[],E).length){for(var B=m&&~N.indexOf(\"\\n\"),G=!1,J=0;J<I.length;J++){var K=I[J];if(null!=K&&!1!==K){var Q=x(K,n,l,!0,\"svg\"===k||\"foreignObject\"!==k&&g,h);if(m&&!B&&i(Q)&&(B=!0),Q)if(m){var X=Q.length>0&&\"<\"!=Q[0];G&&X?Z[Z.length-1]+=Q:Z.push(Q),G=X}else Z.push(Q)}}if(m&&B)for(var Y=Z.length;Y--;)Z[Y]=\"\\n\"+y+a(Z[Y],y)}if(Z.length||D)N+=Z.join(\"\");else if(l&&l.xml)return N.substring(0,N.length-1)+\" />\";return!V||I||D?(m&&~N.indexOf(\"\\n\")&&(N+=\"\\n\"),N+=\"</\"+k+\">\"):N=N.replace(/>$/,\" />\"),N}m.shallowRender=g;export default m;export{m as render,m as renderToStaticMarkup,m as renderToString,g as shallowRender};\n//# sourceMappingURL=index.module.js.map\n","export function PageWrap({ children }): JSX.Element {\n\treturn <div className=\"page py-4\">{children}</div>\n}\n","import {\n\tGI_ArtifactTypeCode,\n\tGI_KnownStatBonusCode,\n\tGI_WeaponObtainSource,\n\tGI_WeaponTypeCode,\n\tMapCode,\n} from '#lib/genshin'\nimport { GI_TalentCode } from '#lib/parsing/helperteam/types'\n\ntype Lang = 'en' | 'ru'\nconst LANG = BUNDLE_ENV.LANG as Lang\nexport const I18N_LANG_NAMES: Record<Lang, string> = {\n\ten: 'English',\n\tru: 'Русский',\n}\nexport const I18N_LANG_NAME = I18N_LANG_NAMES[LANG]\n\nexport const I18N_DASHBOARD = { en: 'Dashboard', ru: 'Самое важное' }[LANG]\nexport const I18N_REGION = { en: 'Region', ru: 'Регион' }[LANG]\nexport const I18N_UNTIL_DAY_RESET = { en: 'Until Day Reset', ru: 'До нового дня' }[LANG]\nexport const I18N_ALCHEMY_CALC = { en: 'Alchemy Calculator', ru: 'Калькулятор алхимии' }[LANG]\nexport const I18N_WHAT_TO_FARM = { en: 'What to Farm', ru: 'Что фармить' }[LANG]\nexport const I18N_BUILDS = { en: 'Builds', ru: 'Сборки персонажей' }[LANG]\nexport const I18N_ASIA = { en: 'Asia', ru: 'Азия' }[LANG]\nexport const I18N_NORH_AMERICA = { en: 'North America', ru: 'Северная Америка' }[LANG]\nexport const I18N_EUROPE = { en: 'Europe', ru: 'Европа' }[LANG]\nexport const I18N_MINUTE = { en: 'minute', ru: 'минута' }[LANG]\nexport const I18N_MINUTES = { en: 'minutes', ru: 'минуты' }[LANG]\nexport const I18N_MINUTES_3 = { en: 'minutes', ru: 'минут' }[LANG]\nexport const I18N_HOUR = { en: 'hour', ru: 'час' }[LANG]\nexport const I18N_HOURS = { en: 'hours', ru: 'часа' }[LANG]\nexport const I18N_HOURS_3 = { en: 'hours', ru: 'часов' }[LANG]\nexport const I18N_TODAY = { en: 'today', ru: 'сегодня' }[LANG]\nexport const I18N_WEEKDAYS = {\n\ten: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'],\n\tru: ['Понедельник', 'Вторник', 'Среда', 'Четверг', 'Пятница', 'Суббота', 'Воскресенье'],\n}[LANG]\nexport const I18N_TOMORROW = { en: 'tomorrow', ru: 'завтра' }[LANG]\nexport const I18N_DUNGEONS = { en: 'Dungeons', ru: 'Подземелья' }[LANG]\nexport const I18N_TALENTS = { en: 'Talents', ru: 'Таланты' }[LANG]\nexport const I18N_WEAPONS = { en: 'Weapons', ru: 'Оружие' }[LANG]\nexport const I18N_WHY_ADD_TO_FAVS_TIP = {\n\ten: 'Add characters, weapons or items to your favorites to see them marked here.',\n\tru: 'Добавьте персонажей, оружие и предметы в избранные, чтобы отметить их здесь',\n}[LANG]\nexport const I18N_FAV_CHARACTERS = { en: 'Favorite characters', ru: 'Избранные персонажи' }[LANG]\nexport const I18N_ARTIFACTS = { en: 'Artifacts', ru: 'Артефакты' }[LANG]\nexport const I18N_ART_STATS_PRIORITY = { en: 'Artifact stats priority', ru: 'Приоритетные главстаты' }[LANG]\nexport const I18N_SUBSTATS_PRIORITY = { en: 'Substats priority', ru: 'Приоритетные сабстаты' }[LANG]\nexport const I18N_TALENTS_PRIORITY = { en: 'Talents Priority', ru: 'Приоритетные умения' }[LANG]\nexport const I18N_ASC_MATERIALS = { en: 'Ascension materials', ru: 'Материалы возвышения' }[LANG]\nexport const I18N_FULL_BUILD_INFO = { en: 'Full build info', ru: 'Полная информация о билде' }[LANG]\nexport const I18N_CHAR_LORE = { en: 'Character lore', ru: 'Лор персонажа' }[LANG]\nexport const I18N_MORE_ON_BUILDS_PAGE = {\n\ten: 'more on build page',\n\tru: 'продолжение на странице билда',\n}[LANG]\nexport const I18N_BACK = { en: 'Back', ru: 'Назад' }[LANG]\nexport const I18N_NOTES = { en: 'Notes', ru: 'Примечания' }[LANG]\n\nconst artTypeNamesRU: Record<GI_ArtifactTypeCode, string> = {\n\tflower: 'цветок',\n\tplume: 'перо',\n\tsands: 'часы',\n\tgoblet: 'кубок',\n\tcirclet: 'корона',\n}\nexport const I18N_ART_TYPE = {\n\ten: (code: GI_ArtifactTypeCode) => code as string,\n\tru: (code: GI_ArtifactTypeCode) => artTypeNamesRU[code],\n}[LANG]\n\nconst statNamesRu: Record<GI_KnownStatBonusCode, string> = {\n\tdef: 'защита',\n\t'def%': '% защиты',\n\tdmg: 'урон',\n\t'dmg%': '% урона',\n\tatk: 'атака',\n\t'atk%': '% атаки',\n\thp: 'ХП',\n\t'hp%': '% ХП',\n\tem: 'мастерство стихий',\n\ter: 'восстановление энергии',\n\t'er%': '% восстановления энергии',\n\thealing: 'лечение',\n\t'healing%': '% лечения',\n\t'crit-rate': 'шанс крита',\n\t'crit-rate%': '%шанса крита',\n\t'crit-dmg': 'крит урон',\n\t'crit-dmg%': '% крит урона',\n\t'phys-dmg': 'физ урон',\n\t'cryo-dmg': 'крио урон',\n\t'geo-dmg': 'гео урон',\n\t'anemo-dmg': 'анемо урон',\n\t'hydro-dmg': 'гидро урон',\n\t'electro-dmg': 'электро урон',\n\t'pyro-dmg': 'пиро урон',\n\t'phys-dmg%': '% физ урона',\n\t'cryo-dmg%': '% крио урона',\n\t'geo-dmg%': '% гео урона',\n\t'anemo-dmg%': '% анемо урона',\n\t'hydro-dmg%': '% гидро урона',\n\t'electro-dmg%': '% электро урона',\n\t'pyro-dmg%': '% пиро урона',\n}\nexport const I18N_STAT_NAME = {\n\ten: (code: string) => code.replace(/-/g, ' '),\n\tru: (code: string) => statNamesRu[code] ?? code,\n}[LANG]\n\ntype TalentTypeNames = Record<GI_TalentCode, string>\nconst talentTypesNamesRU: TalentTypeNames = {\n\tattack: 'обычная атака',\n\tskill: 'элементальный навык',\n\tburst: 'взрыв стихии',\n}\nexport const I18N_TALENT_NAME = {\n\ten: (code: GI_TalentCode) => code,\n\tru: (code: GI_TalentCode) => talentTypesNamesRU[code],\n}[LANG]\n\ntype ConjuctionType = 'or' | 'and'\nexport const I18N_CONJUCTIONS: Record<ConjuctionType, string> = {\n\ten: { or: 'or', and: 'and' },\n\tru: { or: 'или', and: 'и' },\n}[LANG]\n\nexport const I18N_RECOMENDED_FOR = { en: 'Recommended for', ru: 'Рекомендуется для' }[LANG]\nexport const I18N_FOR_NOBODY = { en: 'Nobody', ru: 'Никому' }[LANG]\nexport const I18N_SOURCE = { en: 'Source', ru: 'Источник' }[LANG]\nexport const I18N_SCROLL_TO_ZOOM = { en: 'Scroll to zoom', ru: 'Зум колёсиком' }[LANG]\nexport const I18N_PINCH_TO_ZOOM = { en: 'Pinch to zoom', ru: 'Зум щипком' }[LANG]\nexport const I18N_ERROR = { en: 'Error, reload page', ru: 'Ошибка, перезагрузите страницу' }[LANG]\nexport const I18N_PIECE_BONUS = {\n\ten: (n: number) => `${n} piece bonus`,\n\tru: (n: number) => `Бонус ${n} части`,\n}[LANG]\nexport const I18N_PIECES_BONUS = {\n\ten: (n: number) => `${n} pieces bonus`,\n\tru: (n: number) => `Бонус ${n} частей`,\n}[LANG]\nexport const I18N_BASE_ATTACK = { en: 'Base attack', ru: 'Базовая атака' }[LANG]\nexport const I18N_SECONDARY_STAT = { en: 'Secondary Stat', ru: 'Пассивная способность' }[LANG]\ntype MapCodeName = Record<MapCode, string>\nexport const I18N_MAP_CODES_NAME: MapCodeName = {\n\ten: { teyvat: 'Teyvat', enkanomiya: 'Enkanomiya' },\n\tru: { teyvat: 'Тейват', enkanomiya: 'Энканомия' },\n}[LANG]\nexport const I18N_CHAR_BUILD_RECS = {\n\ten: 'Character builds recomendations',\n\tru: 'Рекомендуемые сборки персонажей',\n}[LANG]\nexport const I18N_SELECT_CHAR_ABOVE = { en: 'Select character above', ru: 'Выберите персонажа' }[LANG]\nexport const I18N_BUILD_RECS_FOR = { en: 'build recomendations', ru: 'билд' }[LANG]\nexport const I18N_BASED_ON_GIHT = {\n\ten: \"Based on Genshin Impact Helper Team's Character Builds\",\n\tru: 'Основано на табличке Геншин Импакт Хелпер Тимы (англ.)',\n}[LANG]\nexport const I18N_ABOUT_SITE = { en: 'About', ru: 'О сайте' }[LANG]\nexport const I18N_CREATED_BY_US = {\n\ten: 'Designed and coded by Absolute Evil Studio',\n\tru: 'Задизайнено и закожено в Абсолют Ивел студии',\n}[LANG]\n\ntype WeaponTypeNames = Record<GI_WeaponTypeCode, string>\nconst weaponTypeNamesRU: WeaponTypeNames = {\n\tclaymore: 'Двуручный меч',\n\tsword: 'Меч',\n\tcatalyst: 'Катализатор',\n\tpolearm: 'Копье',\n\tbow: 'Лук',\n}\nexport const I18N_WEAPON_TYPE_NAME = {\n\ten: (code: GI_WeaponTypeCode) => code,\n\tru: (code: GI_WeaponTypeCode) => weaponTypeNamesRU[code],\n}[LANG]\n\ntype WeaponObtainSourceNames = Record<GI_WeaponObtainSource, string>\nconst weaponObtainSourceNamesRU: WeaponObtainSourceNames = {\n\twishes: 'молитвы',\n\t'event-wishes': 'молитвы события',\n\tevents: 'события',\n\t'battle-pass': 'батл-пасс',\n\t'in-game-shop': 'внутриигровой магазин',\n\tforging: 'ковка',\n\tfishing: 'рыболовля',\n\t'npc-shop': 'магазин НПС',\n\tchests: 'сундуки',\n\tquests: 'квесты',\n\tpuzzles: 'паззл',\n\tinvestigation: 'исследование мира',\n\t'adventure-rank-10': '10 ранг приключений',\n\tplaystation: 'плейстейшн',\n}\nexport const I18N_WEAPON_OBTAIN_SOURCE_NAME = {\n\ten: (code: GI_WeaponObtainSource) => code.replace(/-/g, ' ').replace(/\\bnpc\\b/, 'NPC'),\n\tru: (code: GI_WeaponObtainSource) => weaponObtainSourceNamesRU[code],\n}[LANG]\nexport const I18N_OBTAINED_DURING_STORYLINE = {\n\ten: 'Obtained during storyline quests',\n\tru: 'Выдаётся во время прохождения сюжетных заданий',\n}[LANG]\n","import { I18N_CREATED_BY_US } from '#src/i18n/i18n'\n\nexport function Footer() {\n\treturn (\n\t\t<footer className=\"mt-auto bg-dark\">\n\t\t\t<div className=\"container my-3 opacity-75\">\n\t\t\t\t<div className=\"text-center\">{I18N_CREATED_BY_US}</div>\n\t\t\t</div>\n\t\t</footer>\n\t)\n}\n","\nexport const GENERATED_DATA_HASH = \"e30cfc54\"\n\n/** @type {import('#lib/parsing/combine').CharacterShortInfo[]} */\nexport const charactersShortList = [\n\t{\n\t\t\"code\": \"amber\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"barbara\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"beidou\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"bennett\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"chongyun\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"diluc\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"fischl\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"jean\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kaeya\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"keqing\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"klee\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"lisa\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"mona\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ningguang\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"noelle\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"qiqi\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"razor\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"sucrose\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"traveler-anemo\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"traveler-electro\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"traveler-geo\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"venti\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xiangling\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"xingqiu\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"diona\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"tartaglia\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xinyan\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"zhongli\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"albedo\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ganyu\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"hu-tao\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xiao\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"rosaria\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"eula\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"yanfei\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"kazuha\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ayaka\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"sayu\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"yoimiya\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"aloy\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kokomi\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kujou-sara\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"raiden-shogun\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"thoma\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"gorou\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"itto\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"shenhe\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"yun-jin\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"yae-miko\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t}\n]\n","import { charactersShortList } from '../api/generated.js'\n\nexport const paths = /** @type {const} */ ({\n\tfront: [''],\n\tbuilds: ['/builds'],\n\tbuildCharacters: ['/builds/', ['code', charactersShortList.map(x => x.code)]],\n\tequipment: ['/equipment'],\n})\n\n/**\n * @param {import('./router').RoutePath} path\n * @param {string} url\n * @returns {Record<string, string> | null}\n */\nexport function matchPath(path, url) {\n\tif (path.length === 0) return null\n\tlet rem = url\n\tconst props = /**@type {Record<string, string>}*/ ({})\n\tfor (const part of path) {\n\t\tlet matched = true //true на случай пустых variants\n\t\tif (typeof part === 'string') {\n\t\t\t;[rem, matched] = withoutPrefix(rem, part)\n\t\t} else {\n\t\t\tconst [name, variants] = part\n\t\t\tfor (const variant of variants) {\n\t\t\t\t;[rem, matched] = withoutPrefix(rem, variant)\n\t\t\t\tif (matched) {\n\t\t\t\t\tprops[name] = variant\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!matched) return null\n\t}\n\treturn !rem || rem === '/' ? props : null\n}\n\n/**\n * @param {string} prefix\n * @param {import('./router').RoutePath} path\n * @param {number} [fromIndex]\n * @returns {string[]}\n */\nexport function pathToStrings(prefix, path, fromIndex = 0) {\n\tif (path.length === 0) return []\n\tif (fromIndex >= path.length) return [prefix]\n\n\tconst part = path[fromIndex]\n\tif (typeof part === 'string') {\n\t\treturn pathToStrings(prefix + part, path, fromIndex + 1)\n\t} else {\n\t\tconst [, variants] = part\n\t\treturn variants.flatMap(x => pathToStrings(prefix + x, path, fromIndex + 1))\n\t}\n}\n\n/**\n * @param {string} url\n * @param {string} prefix\n * @returns {[string, boolean]}\n */\nfunction withoutPrefix(url, prefix) {\n\treturn url.startsWith(prefix) ? [url.slice(prefix.length), true] : [url, false]\n}\n","import { ComponentType, h, Ref } from 'preact'\nimport { useEffect, useState } from 'preact/hooks'\n\nimport { matchPath } from './paths'\n\nexport type RoutePath = readonly (string | readonly [name: string, variants: readonly string[]])[]\n\ntype Routes = [RoutePath, ComponentType][]\n\ntype SubRoute<T> = readonly [string, readonly T[]]\ntype EmptySubRoute = readonly [string, readonly []]\ntype PathProps<T extends RoutePath> = {\n\t[K in keyof T as T[K] extends EmptySubRoute\n\t\t? never\n\t\t: T[K] extends SubRoute<unknown>\n\t\t? T[K][0]\n\t\t: never]: T[K] extends SubRoute<infer A> ? A : never\n} & {\n\t[K in keyof T as T[K] extends EmptySubRoute ? T[K][0] : never]?: undefined\n}\n\nconst URL_LANG_PREFIX = makeUrlLangPrefix(BUNDLE_ENV.LANG)\n\nfunction findRoutedComponent(routes: Routes, url: string): [ComponentType, Record<string, string>] | null {\n\tfor (const [route, comp] of routes) {\n\t\tconst props = matchPath(route, url)\n\t\tif (props) return [comp, props]\n\t}\n\treturn null\n}\n\nfunction pathSearchHash(url: { pathname: string; search: string; hash: string }) {\n\treturn url.pathname + url.search + url.hash\n}\n\nfunction handleAnchorClick(e: MouseEvent, routes: Routes) {\n\tif (e.ctrlKey || e.altKey || e.shiftKey || e.metaKey || e.button !== 0) return\n\n\tconst a = e.target instanceof Element && e.target.closest('a')\n\tif (a && a.href && (!a.target || a.target === '_self')) {\n\t\tconst url = new URL(a.href)\n\t\tif (url.origin === location.origin) {\n\t\t\tif (findRoutedComponent(routes, url.pathname)) {\n\t\t\t\tif (pathSearchHash(location) !== pathSearchHash(url))\n\t\t\t\t\thistory.pushState(null, '', pathSearchHash(url))\n\t\t\t\te.preventDefault()\n\t\t\t\treturn true\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function useRouter(routes: Routes) {\n\tconst [, forceUpdate] = useState(0)\n\n\tuseEffect(() => {\n\t\tfunction onClick(e: MouseEvent) {\n\t\t\tconst handled = handleAnchorClick(e, routes)\n\t\t\tif (handled) forceUpdate(x => x + 1)\n\t\t}\n\t\tfunction onPopState(e: PopStateEvent) {\n\t\t\tforceUpdate(x => x + 1)\n\t\t}\n\t\taddEventListener('click', onClick)\n\t\taddEventListener('popstate', onPopState)\n\t\treturn () => {\n\t\t\tremoveEventListener('click', onClick)\n\t\t\tremoveEventListener('popstate', onPopState)\n\t\t}\n\t}, [routes])\n\n\tconst res = findRoutedComponent(routes, location.pathname)\n\tif (!res) return '404'\n\tconst [Comp, props] = res\n\treturn <Comp {...props} />\n}\n\nexport const route = <TPath extends RoutePath>(\n\tpath: TPath,\n\tcomp: ComponentType<PathProps<TPath>>,\n): [RoutePath, ComponentType] => [[URL_LANG_PREFIX, ...path], comp as ComponentType]\n\nfunction makeUrlLangPrefix(lang: string): string {\n\treturn lang === 'en' ? '' : '/ru'\n}\n\nexport function makeLocationHrefForLang(lang: string): string {\n\tconst url = location.pathname + location.search + location.hash\n\tconst curPrefix = URL_LANG_PREFIX\n\tconst newPrefix = makeUrlLangPrefix(lang)\n\tlet newUrl = newPrefix + (url.startsWith(curPrefix) ? url.slice(curPrefix.length) : url)\n\tif (newUrl === '') newUrl = '/'\n\treturn newUrl\n}\n\nexport function A(\n\tprops: JSX.HTMLAttributes<HTMLAnchorElement> & { ref?: Ref<typeof A>; innerRef?: Ref<HTMLAnchorElement> },\n): JSX.Element {\n\tprops = Object.assign({}, props)\n\t// @ts-ignore\n\tprops.ref = props.innerRef\n\tdelete props.innerRef\n\tif (props.href) props.href = URL_LANG_PREFIX + props.href\n\t// тайпскриптовый JSX-трансформер какой-то туповатый:\n\t// он для <a {...props}/> генерит лишний Object.assign({}, props)\n\treturn h('a', props as Parameters<typeof h>[1])\n}\n","/**\n * @template T\n * @param {T[]} arr\n * @returns {T[]}\n */\nexport function arrSimpleUniq(arr) {\n\tfor (let i = arr.length - 1; i >= 0; i--) {\n\t\tconst index = arr.indexOf(arr[i], i + 1)\n\t\tif (index < i) arr.splice(i, 1)\n\t}\n\treturn arr\n}\n\n/**\n * @template T\n * @param {T[]} arr\n * @param {T[]} items\n * @returns {number}\n */\nexport function arrPushIfNew(arr, ...items) {\n\tfor (let i = 0; i < items.length; i++)\n\t\tif (!arr.includes(items[i])) {\n\t\t\tarr.push(items[i])\n\t\t}\n\treturn arr.length\n}\n\n/**\n * @template TKey\n * @template TVal\n * @param {Map<TKey, TVal[]>} map\n * @param {TKey} key\n * @param {TVal} val\n * @returns {TVal[]}\n */\nexport function mappedArrPush(map, key, val) {\n\tlet values = map.get(key)\n\tif (values) {\n\t\tvalues.push(val)\n\t} else {\n\t\tvalues = [val]\n\t\tmap.set(key, values)\n\t}\n\treturn values\n}\n\n/**\n * @template T\n * @param {T[]} arr\n * @param {(item:T) => boolean} func\n * @returns {T[][]}\n */\nexport function arrSplitFn(arr, func) {\n\tconst res = /**@type {T[][]}*/ ([[]])\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tconst item = arr[i]\n\t\tif (func(item)) res.push([])\n\t\telse res[res.length - 1].push(item)\n\t}\n\treturn res\n}\n\n/**\n * @param {unknown[]} a\n * @param {unknown[]} b\n */\nexport function arrShallowEqualAsSets(a, b) {\n\tif (a.length !== b.length) return false\n\tfor (let i = 0; i < a.length; i++) if (!b.includes(a[i])) return false\n\treturn true\n}\n\n/**\n * @param {unknown[]} a\n * @param {unknown[]} b\n */\nexport function arrShallowEqual(a, b) {\n\tif (a.length !== b.length) return false\n\tfor (let i = 0; i < a.length; i++) if (a[i] !== b[i]) return false\n\treturn true\n}\n\n/**\n * @template {string} TKey\n * @template TVal\n * @param {Record<TKey, TVal>} obj\n * @param {(a:[TKey,TVal], b:[TKey,TVal]) => number} sortFunc\n * @returns {Record<TKey, TVal>}\n */\nexport function sortObject(obj, sortFunc) {\n\tconst entries = /**@type {[TKey,TVal][]}*/ (Object.entries(obj)).sort(sortFunc)\n\tfor (const key in obj) delete obj[key]\n\tfor (const [key, val] of entries) obj[key] = val\n\treturn obj\n}\n/**\n * @template T\n * @param {T[]} arr\n * @param {T} item\n * @param {1|-1} [direction]\n * @returns {T}\n */\nexport function arrGetAfter(arr, item, direction = 1) {\n\tconst index = arr.indexOf(item)\n\treturn arr[(index + direction + arr.length) % arr.length]\n}\n\n/**\n * @template TKey\n * @template TVal\n * @param {Map<TKey, TVal>} map\n * @param {TKey} key\n * @param {() => TVal} defaultFunc\n * @returns {TVal}\n */\nexport function mapGetOrSet(map, key, defaultFunc) {\n\tlet value = map.get(key)\n\tif (value === undefined) {\n\t\tvalue = defaultFunc()\n\t\tmap.set(key, value)\n\t}\n\treturn value\n}\n\n/**\n * @template {string} TKey\n * @template TVal\n * @param {Partial<Record<TKey, TVal>>} obj\n * @param {TKey} key\n * @param {() => TVal} defaultFunc\n * @returns {TVal}\n */\nexport function objGetOrSet(obj, key, defaultFunc) {\n\tlet value = obj[key]\n\tif (value === undefined) {\n\t\tobj[key] = value = defaultFunc()\n\t}\n\treturn /**@type {TVal}*/ (value)\n}\n\n/**\n * @template T\n * @param {T | T[]} item\n * @returns {T[]}\n */\nexport function arrOrItemToArr(item) {\n\treturn Array.isArray(item) ? item : [item]\n}\n","export type BS_BreakpointCode = 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'xxl'\nexport const BS_BreakpointsCodes: BS_BreakpointCode[] = ['xs', 'sm', 'md', 'lg', 'xl', 'xxl']\n\nexport const BS_BreakpointsMap = { xs: 0, sm: 576, md: 768, lg: 992, xl: 1200, xxl: 1400 }\nexport function BS_getCurrBreakpoint(screenWidth: number): BS_BreakpointCode {\n\treturn (\n\t\t//todo правильные типы\n\t\t(Object.keys(BS_BreakpointsMap).find(k => screenWidth < BS_BreakpointsMap[k]) as BS_BreakpointCode) ||\n\t\t('xxl' as BS_BreakpointCode)\n\t)\n}\nexport function BS_isBreakpointLessThen(br: BS_BreakpointCode, targetBr: BS_BreakpointCode): boolean {\n\treturn BS_BreakpointsCodes.indexOf(br) <= BS_BreakpointsCodes.indexOf(targetBr)\n}\n","import { RefObject } from 'preact'\nimport { useCallback, useEffect, useRef, useState } from 'preact/hooks'\n\nimport { arrShallowEqual } from '#lib/utils/collections'\nimport { isPromise } from '#lib/utils/values'\nimport { BS_BreakpointCode, BS_getCurrBreakpoint } from '#src/utils/bootstrap'\n\ntype Pending = { _type: 'pending' }\n\nexport const PENDING: Pending = {} as never\n\nexport type LoadingState<T> = T | Error | Pending\n\nexport function isLoaded<T>(value: LoadingState<T>): value is T {\n\treturn value !== PENDING && !(value instanceof Error)\n}\n\nexport function useFetch<T>(\n\tloadFunc: (abortSignal: AbortSignal) => T,\n\targs: unknown[],\n): LoadingState<Awaited<T>> {\n\tconst controller = useRef<AbortController | null>(null)\n\tconst prevArgs = useRef<unknown[] | null>(null)\n\tconst data = useRef<LoadingState<Awaited<T>>>(PENDING)\n\tconst foceUpdate = useForceUpdate()\n\n\tif (prevArgs.current === null || !arrShallowEqual(prevArgs.current, args)) {\n\t\tif (controller.current !== null) controller.current.abort()\n\t\tconst ac: AbortController | null = new AbortController()\n\t\tcontroller.current = ac\n\n\t\tconst res = loadFunc(ac.signal)\n\t\tif (isPromise(res)) {\n\t\t\tres.then(res => (data.current = res as Awaited<T>))\n\t\t\t\t.catch(err => (data.current = err))\n\t\t\t\t.finally(foceUpdate)\n\t\t\tdata.current = PENDING\n\t\t} else {\n\t\t\tdata.current = res as Awaited<T>\n\t\t}\n\n\t\tprevArgs.current = args\n\t}\n\n\t// абортим при отмонтировании компонента\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (controller.current !== null) controller.current.abort()\n\t\t}\n\t}, [])\n\treturn data.current\n}\n\nexport function useFetchWithPrev<T>(\n\tloadFunc: (abortSignal: AbortSignal) => Promise<T> | T,\n\targs: unknown[],\n): [data: LoadingState<T>, isUpdating: boolean] {\n\tconst prevDataRef = useRef<LoadingState<T>>(PENDING)\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst data = useFetch(loadFunc, args)\n\tif (isLoaded(data)) prevDataRef.current = data\n\treturn [isLoaded(data) ? data : prevDataRef.current, data === PENDING]\n}\n\nexport const useToggle = (initial: boolean): [boolean, () => void] => {\n\tconst [flagState, setFlagState] = useState(initial)\n\treturn [flagState, useCallback(() => setFlagState(status => !status), [])]\n}\n\nexport const useClickAway = (ref: preact.RefObject<HTMLElement>, callback?: () => void): void => {\n\tconst handleClick = (e: MouseEvent | TouchEvent) => {\n\t\tif (ref.current && e.target instanceof HTMLElement && !ref.current.contains(e.target)) {\n\t\t\tcallback && callback()\n\t\t}\n\t}\n\tuseEffect(() => {\n\t\tdocument.addEventListener('mousedown', handleClick)\n\t\tdocument.addEventListener('touchstart', handleClick)\n\t\t// document.addEventListener('click', handleClick)\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('mousedown', handleClick)\n\t\t\tdocument.removeEventListener('touchstart', handleClick)\n\t\t\t// document.removeEventListener('click', handleClick)\n\t\t}\n\t})\n}\n\ninterface WindowSize {\n\twidth: number | undefined\n\theight: number | undefined\n\tbreakpoint: BS_BreakpointCode\n}\nexport function useWindowSize(): WindowSize {\n\tconst [windowSize, setWindowSize] = useState<WindowSize>({\n\t\twidth: window?.innerWidth,\n\t\theight: window?.innerHeight,\n\t\tbreakpoint: BS_getCurrBreakpoint(window?.innerWidth || 0),\n\t})\n\tuseEffect(() => {\n\t\tfunction handleResize() {\n\t\t\tsetWindowSize({\n\t\t\t\twidth: window.innerWidth,\n\t\t\t\theight: window.innerHeight,\n\t\t\t\tbreakpoint: BS_getCurrBreakpoint(window.innerWidth),\n\t\t\t})\n\t\t}\n\t\twindow.addEventListener('resize', handleResize)\n\t\thandleResize()\n\t\treturn () => window.removeEventListener('resize', handleResize)\n\t}, [])\n\treturn windowSize\n}\n\ndeclare global {\n\tinterface WindowEventMap {\n\t\t'x-local-tab-storage': CustomEvent & { detail: { key: string } }\n\t}\n}\n\nexport function useLocalStorage<T>(key: string, initialValue: T): [T, (val: T) => unknown] {\n\tconst [value, setValueInner] = useState(() => {\n\t\ttry {\n\t\t\tconst curRecord = localStorage.getItem(key) //reading 'localStorage' from window may fail with SecurityError\n\t\t\treturn curRecord ? JSON.parse(curRecord) : initialValue //JSON parsing may fail\n\t\t} catch (ex) {\n\t\t\tconsole.error(ex)\n\t\t\treturn initialValue\n\t\t}\n\t})\n\n\tconst setValueAndSave = useCallback(\n\t\t(val: T) => {\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem(key, JSON.stringify(val)) //reading 'localStorage' from window may fail with SecurityError\n\t\t\t} catch (ex) {\n\t\t\t\t// ¯\\_(ツ)_/¯\n\t\t\t}\n\t\t\tsetValueInner(val)\n\t\t\tdispatchEvent(new CustomEvent('x-local-tab-storage', { detail: { key } }))\n\t\t},\n\t\t[key],\n\t)\n\n\tuseEffect(() => {\n\t\tfunction onStorage(e: StorageEvent | { detail: { key: string } }) {\n\t\t\tconst affectedKey = 'detail' in e ? e.detail.key : e.key\n\t\t\tif (affectedKey === key) {\n\t\t\t\ttry {\n\t\t\t\t\tconst curRecord = localStorage.getItem(key) //reading 'localStorage' from window may fail with SecurityError\n\t\t\t\t\tif (curRecord) setValueInner(JSON.parse(curRecord)) //JSON parsing may fail\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tconsole.log(ex)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\taddEventListener('storage', onStorage)\n\t\taddEventListener('x-local-tab-storage', onStorage)\n\t\treturn () => {\n\t\t\tremoveEventListener('storage', onStorage)\n\t\t\tremoveEventListener('x-local-tab-storage', onStorage)\n\t\t}\n\t}, [key])\n\n\treturn [value, setValueAndSave]\n}\n\nexport function useHover<T extends Element>(): [RefObject<T>, boolean] {\n\tconst [value, setValue] = useState<boolean>(false)\n\tconst ref = useRef<T | null>(null)\n\tuseEffect(\n\t\t() => {\n\t\t\tconst node = ref.current\n\t\t\tif (!node) return\n\n\t\t\tconst handleMouseOver = () => setValue(true)\n\t\t\tconst handleMouseOut = () => setValue(false)\n\t\t\tnode.addEventListener('mouseover', handleMouseOver)\n\t\t\tnode.addEventListener('mouseout', handleMouseOut)\n\t\t\treturn () => {\n\t\t\t\tsetValue(false)\n\t\t\t\tnode.removeEventListener('mouseover', handleMouseOver)\n\t\t\t\tnode.removeEventListener('mouseout', handleMouseOut)\n\t\t\t}\n\t\t},\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t[ref.current],\n\t)\n\treturn [ref, value]\n}\n\nexport const useWindowVisibility = () => {\n\tconst [isVisible, setIsVisible] = useState(\n\t\t// Focus for first render\n\t\tBUNDLE_ENV.IS_SSR ? true : document.visibilityState === 'visible',\n\t)\n\tuseEffect(() => {\n\t\tconst onVisibilityChange = () => setIsVisible(document.visibilityState === 'visible')\n\t\tconst onPageHide = () => setIsVisible(false)\n\t\tconst onPageShow = () => setIsVisible(true)\n\t\tdocument.addEventListener('visibilitychange', onVisibilityChange)\n\t\twindow.addEventListener('pagehide', onPageHide)\n\t\twindow.addEventListener('pageshow ', onPageShow)\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('visibilitychange', onVisibilityChange)\n\t\t\twindow.removeEventListener('pagehide', onPageHide)\n\t\t\twindow.removeEventListener('pageshow ', onPageShow)\n\t\t}\n\t}, [])\n\treturn isVisible\n}\n/*\n * not used\n *\nexport function useInterval(callback: () => void, delay: number | null) {\n\tconst savedCallback = useRef(callback)\n\t// Remember the latest callback if it changes.\n\tuseLayoutEffect(() => {\n\t\tsavedCallback.current = callback\n\t}, [callback])\n\n\t// Set up the interval.\n\tuseEffect(() => {\n\t\t// Don't schedule if no delay is specified.\n\t\t// Note: 0 is a valid value for delay.\n\t\tif (!delay && delay !== 0) {\n\t\t\treturn\n\t\t}\n\n\t\tconst id = setInterval(() => savedCallback.current(), delay)\n\t\treturn () => clearInterval(id)\n\t}, [delay])\n}\n*/\nexport function useForceUpdate(): () => void {\n\tconst setValue = useState(0)[1]\n\treturn useRef(() => setValue(v => ~v)).current\n}\nexport function useVisibleTicker(callback: () => void, interval: number) {\n\tconst isVisible = useWindowVisibility()\n\n\tuseEffect(() => {\n\t\tif (!isVisible) return\n\t\tlet id\n\t\tfunction callbackInner() {\n\t\t\tcallback()\n\t\t\tid = setTimeout(callbackInner, interval - (Date.now() % interval) + 10)\n\t\t}\n\t\tcallbackInner()\n\t\treturn () => clearTimeout(id)\n\t\t// калбек не должен перезапускать таймер\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [interval, isVisible])\n}\n","export const BULLET = '•'\nexport const TIMES = '×'\nexport const LEFT_POINTING = '‹'\nexport const RIGHT_POINTING = '›'\nexport const ELLIPSIS = '…'\nexport const STAR = '★'\nexport const HEART = '♥'\nexport const HEART_EMPTY = '♡'\nexport const VARIATION_SELECTOR = '\\uFE0E'\n","export function GlobeIcon({ classes = '' }) {\n\treturn (\n\t\t<svg\n\t\t\tclass={classes}\n\t\t\twidth=\"24\"\n\t\t\theight=\"24\"\n\t\t\tviewBox=\"0 0 24 24\"\n\t\t\tfill=\"none\"\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t>\n\t\t\t<path\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Zm2.8-2.6a7 7 0 0 0 4.2-5.9c-.8.5-1.9.8-3 1.1-.2 1.9-.6 3.5-1.2 4.8ZM9.2 5.6a7 7 0 0 0-4 4.6l1.2.8 1.6.5c0-2.3.5-4.4 1.2-6Zm.9 8.3c.2 1.5.5 2.7.9 3.7l.8 1.2.2.2.2-.2.8-1.2c.4-1 .7-2.2.9-3.7a20 20 0 0 1-3.8 0Zm-2-.3c.1 1.9.5 3.5 1 4.8a7 7 0 0 1-4-5.9c.7.5 1.8.8 3 1.1Zm5.9-1.7a17.8 17.8 0 0 1-4 0c0-2.2.4-4.2 1-5.5l.8-1.2.2-.2.2.2.8 1.2c.6 1.3 1 3.3 1 5.5Zm2-.4c0-2.3-.5-4.4-1.2-6a7 7 0 0 1 4 4.7l-1.2.8-1.6.5Z\"\n\t\t\t\tfill=\"currentColor\"\n\t\t\t/>\n\t\t</svg>\n\t)\n}\n","import { useCallback, useRef, useState } from 'preact/hooks'\n\nimport { I18N_ABOUT_SITE, I18N_BUILDS, I18N_LANG_NAME, I18N_LANG_NAMES } from '#src/i18n/i18n'\nimport { A, makeLocationHrefForLang } from '#src/routes/router'\nimport { useClickAway } from '#src/utils/hooks'\nimport { VARIATION_SELECTOR } from '#src/utils/typography'\nimport { GlobeIcon } from './globe-icon'\n\ntype Props = { isNavExpanded: boolean }\n\nexport function Nav({ isNavExpanded }: Props): JSX.Element {\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst ddRef = useRef(null)\n\tconst closeDd = useCallback(() => isExpanded && setIsExpanded(false), [setIsExpanded, isExpanded])\n\tconst openDd = useCallback(() => !isExpanded && setIsExpanded(true), [setIsExpanded, isExpanded])\n\n\t// TODO клик мимо компонента\n\tuseClickAway(ddRef, closeDd)\n\n\treturn (\n\t\t<div className={`collapse navbar-collapse ${isNavExpanded ? 'show' : ''}`}>\n\t\t\t<ul className=\"navbar-nav me-auto mb-2 mb-md-0\">\n\t\t\t\t<li className=\"nav-item\">\n\t\t\t\t\t<A className=\"nav-link active\" href=\"/builds\">\n\t\t\t\t\t\t{I18N_BUILDS}\n\t\t\t\t\t</A>\n\t\t\t\t</li>\n\t\t\t\t<li className=\"nav-item\">\n\t\t\t\t\t<A className=\"nav-link active\" href=\"#\">\n\t\t\t\t\t\t{I18N_ABOUT_SITE}\n\t\t\t\t\t</A>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\t<ul className=\"navbar-nav mb-2 mb-md-0 float-md-end\">\n\t\t\t\t<li className=\"nav-item dropdown\">\n\t\t\t\t\t<a\n\t\t\t\t\t\tclassName={`nav-link dropdown-toggle ${isExpanded ? 'show' : ''}`}\n\t\t\t\t\t\tid=\"navbarDropdown\"\n\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\tonClick={openDd}\n\t\t\t\t\t>\n\t\t\t\t\t\t<GlobeIcon />\n\t\t\t\t\t\t{VARIATION_SELECTOR} {I18N_LANG_NAME}\n\t\t\t\t\t</a>\n\t\t\t\t\t{/* todo почему-то не добавляется класс dropdown-menu-end */}\n\t\t\t\t\t<ul\n\t\t\t\t\t\tclassName={`dropdown-menu ${isExpanded ? 'show' : ''}`}\n\t\t\t\t\t\tstyle={'right: 0'}\n\t\t\t\t\t\tref={ddRef}\n\t\t\t\t\t>\n\t\t\t\t\t\t{/* В переключатеях будут неправильные ссылки, если сменится страница,\n\t\t\t\t\t\tа список языков не будет перерендерен (если тут таки появится useMemo).\n\t\t\t\t\t\tТак что явно генерим сожержимое списка после разворачивания дропдауна. */}\n\t\t\t\t\t\t{isExpanded &&\n\t\t\t\t\t\t\tBUNDLE_ENV.LANGS.map(lang => {\n\t\t\t\t\t\t\t\tconst langName = I18N_LANG_NAMES[lang]\n\t\t\t\t\t\t\t\tconst isActiveLang = langName === I18N_LANG_NAME\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<li key={lang}>\n\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\tclassName={`dropdown-item ${isActiveLang ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\t\t\thref={makeLocationHrefForLang(lang)}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{I18N_LANG_NAMES[lang]}\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t</ul>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t)\n}\n","import { A } from '#src/routes/router'\nimport { useState } from 'preact/hooks'\n\nimport { Nav } from '../components/nav'\n\nexport function Header() {\n\tconst [isNavExpanded, setIsNavExpanded] = useState(false)\n\t// TODO клик мимо компонента\n\treturn (\n\t\t<header>\n\t\t\t<div className=\"navbar navbar-expand-md navbar-dark bg-primary\">\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<A className=\"navbar-brand\" href=\"/\">\n\t\t\t\t\t\tGenshin Base\n\t\t\t\t\t</A>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"navbar-toggler\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tonClick={() => setIsNavExpanded(!isNavExpanded)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"navbar-toggler-icon\"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<Nav isNavExpanded={isNavExpanded} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</header>\n\t)\n}\n","/**\n * Конвертирует номер дня недели из вс-пн…-сб в пн-вт…-вс\n * @param {number} weekday\n * @returns {number}\n */\nexport function weekdayAsMonSun(weekday) {\n\treturn weekday === 0 ? 6 : weekday - 1\n}\n\n/**\n * @param {Date} date\n * @returns {number}\n */\nexport function setDayStartUTC(date) {\n\treturn date.setUTCHours(0, 0, 0, 0)\n}\n","import { setDayStartUTC, weekdayAsMonSun } from './utils/date.js'\n\n/** @typedef {'pyro' | 'electro' | 'hydro' | 'dendro' | 'cryo' | 'anemo' | 'geo'} GI_ElementCode */\n/** @typedef {'claymore' | 'sword' | 'catalyst' | 'polearm' | 'bow'} GI_WeaponTypeCode */\n/** @typedef {'flower' | 'plume' | 'sands' | 'goblet' | 'circlet'} GI_ArtifactTypeCode */\n/** @typedef {1 | 2 | 3 | 4 | 5} GI_RarityCode */\n/**\n * @typedef {'wishes'|'event-wishes'|'events'|'battle-pass'|'in-game-shop'|\n *   'forging'|'fishing'|'npc-shop'|'chests'|'quests'|'puzzles'|'investigation'|\n *   'adventure-rank-10'|'playstation'} GI_WeaponObtainSource\n */\n/** @typedef {'limited'|'unlimited'} GI_DomainTypeCode */\n\n/** @typedef {{mapCode:MapCode, x:number, y:number}} MapLocation */\n\n/** @typedef {'teyvat'|'enkanomiya'} MapCode */\n/** @type {MapCode[]} */\nexport const GI_MAP_CODES = ['teyvat', 'enkanomiya']\n\n/** @typedef {'mondstadt'|'liyue'|'inazuma'} GI_RegionCode */\n/** @type {GI_RegionCode[]} */\nexport const GI_REGION_CODES = ['mondstadt', 'liyue', 'inazuma']\n\n/** @typedef {'europe'|'asia'|'north-america'} GI_ServerRegionCode */\n/** @type {GI_ServerRegionCode[]} */\nexport const GI_SERVER_REGIONS = ['europe', 'asia', 'north-america']\n\n/** @typedef {'mon'|'tue'|'wed'|'thu'|'fri'|'sat'|'sun'} WeekdayCode */\n/** @type {WeekdayCode[]} */\nexport const GI_ROTATION_WEEKDAY_CODES = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun']\n\n/** @type {GI_ElementCode[]} */\nexport const GI_ELEMENT_CODES = ['pyro', 'electro', 'hydro', 'dendro', 'cryo', 'anemo', 'geo']\n\n/** @type {GI_WeaponTypeCode[]} */\nexport const GI_WEAPON_TYPE_CODES = ['claymore', 'sword', 'catalyst', 'polearm', 'bow']\n\n/** @type {GI_ArtifactTypeCode[]} */\nexport const GI_ARTIFACT_TYPE_CODES = ['flower', 'plume', 'sands', 'goblet', 'circlet']\n\nexport const ART_GROUP_18_ATK_CODE = '18%-atk'\nexport const ART_GROUP_18_ATK_INSIDE_CODES = ['noblesse-oblige', 'wanderers-troupe'] //todo\nexport const ART_GROUP_20_ER_CODE = '20%-er'\nexport const ART_GROUP_20_ER_INSIDE_CODES = ['thundering-fury', 'crimson-witch-of-flames'] //todo\n/** @type {Record<string, {name:string, rarity:GI_RarityCode}>} */\nexport const ART_GROUP_DETAILS = {\n\t[ART_GROUP_18_ATK_CODE]: { name: '18% atk', rarity: 5 },\n\t[ART_GROUP_20_ER_CODE]: { name: '20% er', rarity: 5 },\n}\n\n/** @type {GI_RarityCode[]} */\nexport const GI_RARITY_CODES = [1, 2, 3, 4, 5]\n\n/** Обычные коды, используются как есть */\nconst _GI_STAT_REGULAR = /**@type {const}*/ (['em'])\n/** Используется как в обычном виде, так и с процентами: <stat> и <stat>% */\nconst _GI_STAT_PERCENT = /**@type {const}*/ (['def', 'dmg', 'atk', 'hp', 'er', 'healing'])\n/** Используются с префиксом 'crit-' */\nconst _GI_STAT_CRIT_SUFFIXES = /**@type {const}*/ (['rate', 'dmg', 'rate%', 'dmg%'])\n/** Используются с суффиксами '-dmg' и '-dmg%' */\nconst _GI_STAT_DMG_PEFIXES = /**@type {const}*/ (['phys', 'cryo', 'geo', 'anemo', 'hydro', 'electro', 'pyro'])\n\n/**\n * @typedef {typeof _GI_STAT_REGULAR[number]\n *   | typeof _GI_STAT_PERCENT[number]\n *   | `${typeof _GI_STAT_PERCENT[number]}%`\n *   | `crit-${typeof _GI_STAT_CRIT_SUFFIXES[number]}`\n *   | `${typeof _GI_STAT_DMG_PEFIXES[number]}-dmg`\n *   | `${typeof _GI_STAT_DMG_PEFIXES[number]}-dmg%`} GI_KnownStatBonusCode\n */\n\nexport const GI_KNOWN_STAT_BONUS_CODES = /**@type {GI_KnownStatBonusCode[]}*/ (\n\t/**@type {readonly string[]}*/ (_GI_STAT_REGULAR)\n\t\t.concat(_GI_STAT_PERCENT)\n\t\t.concat(_GI_STAT_PERCENT.map(x => x + '%'))\n\t\t.concat(_GI_STAT_CRIT_SUFFIXES.map(x => 'crit-' + x))\n\t\t.concat(_GI_STAT_DMG_PEFIXES.map(x => x + '-dmg'))\n\t\t.concat(_GI_STAT_DMG_PEFIXES.map(x => x + '-dmg%'))\n)\n\n/**\n * Сдвиг таймзоны региона относительно UTC (в часах)\n * @type {Record<GI_ServerRegionCode, number>}\n */\nexport const GI_REGION_TIMEZONE_OFFSET = {\n\teurope: 1,\n\tasia: 8,\n\t'north-america': -5,\n}\n/** Время перезапуска сервера (в часах) относительно полуночи по локальному времени региона */\nexport const GI_SERVER_RESET_TIME = 4\n/**\n * @param {GI_ServerRegionCode} regionCode\n * @returns {{weekdayCode:WeekdayCode, weekdayMonSun:number, resetIn:number, resetAt:Date}}\n */\nexport function getRegionTime(regionCode) {\n\tconst now = new Date()\n\t// время до перезапуска сервера относительно конца дня по UTC\n\tconst offsetHours = GI_SERVER_RESET_TIME - GI_REGION_TIMEZONE_OFFSET[regionCode]\n\n\tconst lastResetDate = new Date(now)\n\tlastResetDate.setHours(lastResetDate.getHours() - offsetHours)\n\tconst weekdayMonSun = weekdayAsMonSun(lastResetDate.getUTCDay())\n\tsetDayStartUTC(lastResetDate)\n\tlastResetDate.setUTCHours(offsetHours)\n\n\tconst nextResetDate = new Date(lastResetDate)\n\tnextResetDate.setDate(nextResetDate.getDate() + 1)\n\n\treturn {\n\t\tweekdayMonSun: weekdayMonSun,\n\t\tweekdayCode: GI_ROTATION_WEEKDAY_CODES[weekdayMonSun],\n\t\tresetIn: +nextResetDate - +now,\n\t\tresetAt: nextResetDate,\n\t}\n}\n/**\n * {@link https://www.timeanddate.com/time/map/}\n * @returns {GI_ServerRegionCode}\n */\nexport function guessCurrentRegion() {\n\tif (navigator.language.startsWith('ru')) return 'europe'\n\tconst curOffset = -new Date().getTimezoneOffset() / 60\n\tif (curOffset <= -2) return 'north-america'\n\tif (curOffset >= 5) return 'asia'\n\treturn 'europe'\n}\n\n/** @param {string} name */\nexport function getCharacterCodeFromName(name) {\n\tconst code = name.trim().toLocaleLowerCase().replace(/\\s/g, '-')\n\tif (code === 'childe') return 'tartaglia'\n\tif (code === 'kamisato-ayaka') return 'ayaka'\n\tif (code === 'sangonomiya-kokomi') return 'kokomi'\n\tif (code === 'kaedehara-kazuha') return 'kazuha'\n\tif (code === 'arataki-itto') return 'itto'\n\treturn code\n}\n\n/** @param {string} name */\nexport function getArtifactCodeFromName(name) {\n\treturn name.trim().toLocaleLowerCase().replace(/\\s/g, '-').replace(/'/g, '')\n}\n\n/** @param {string} name */\nexport function getWeaponCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/\\s+/g, '-')\n\t\t.replace(/['\"«»]/g, '')\n}\n\n/** @param {string} name */\nexport function getDomainCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/[\\s:]+/g, '-')\n\t\t.replace(/'/g, '')\n}\n\n/** @param {string} name */\nexport function getItemCodeFromName(name) {\n\treturn name.trim().toLocaleLowerCase().replace(/\\s+/g, '-').replace(/'/g, '')\n}\n\n/** @param {string} name */\nexport function getEnemyCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/[\\s:\\-,]+/g, '-')\n\t\t.replace(/'/g, '')\n}\n\n/**\n * @template {{rarity:GI_RarityCode}} T\n * @param {T[]} items\n * @returns {T}\n */\nexport function getWithMaxRarity(items) {\n\tlet maxItem = items[0]\n\tfor (let i = 0; i < items.length; i++) if (maxItem.rarity < items[i].rarity) maxItem = items[i]\n\treturn maxItem\n}\n\n/** @type {Record<MapCode, string>} */\nconst locEnc_map2code = {\n\tteyvat: 'T',\n\tenkanomiya: 'E',\n}\n/** @type {Record<string, MapCode>} */\nconst locEnc_code2map = {\n\tT: 'teyvat',\n\tE: 'enkanomiya',\n}\n/**\n * @param {MapLocation[]} locations\n * @param {number} [downsample]\n * @returns {string}\n */\nexport function encodeLocations(locations, downsample = 1) {\n\tif (downsample < 1 || downsample > 35 || downsample % 1 !== 0)\n\t\tthrow new Error(`wrong downsample: ${downsample}`)\n\n\tconst sortedLocs = locations.slice().sort((a, b) => a.x - b.x || a.y - b.y)\n\n\tlet res = downsample.toString(36)\n\tfor (const [groupMapCode, groupLetter] of Object.entries(locEnc_map2code)) {\n\t\tlet xx = ''\n\t\tlet yy = ''\n\t\tfor (const { mapCode, x, y } of sortedLocs) {\n\t\t\tif (mapCode === groupMapCode) {\n\t\t\t\txx += encodeLocNum(x, downsample)\n\t\t\t\tyy += encodeLocNum(y, downsample)\n\t\t\t}\n\t\t}\n\t\tif (xx || yy) res += xx + yy + groupLetter\n\t}\n\treturn res\n}\n/**\n * @param {MapLocation[]} locations\n * @param {number} [downsample]\n * @returns {string}\n */\nexport function encodeLocationsChecked(locations, downsample = 1) {\n\tconst res = encodeLocations(locations, downsample)\n\n\tconst codes = Object.keys(locEnc_map2code)\n\tconst sortedLocs = locations\n\t\t.slice()\n\t\t.sort((a, b) => codes.indexOf(a.mapCode) - codes.indexOf(b.mapCode) || a.x - b.x || a.y - b.y)\n\t\t.map(l => ({\n\t\t\t...l,\n\t\t\tx: Math.round(l.x / downsample) * downsample,\n\t\t\ty: Math.round(l.y / downsample) * downsample,\n\t\t}))\n\tconst decodedLocs = decodeLocations(res)\n\tconst inJson = JSON.stringify(sortedLocs)\n\tconst outJson = JSON.stringify(decodedLocs)\n\tif (inJson !== outJson)\n\t\tthrow new Error('wrong decoded locations:\\n> ' + inJson + '\\n> ' + outJson + '\\n> ' + res)\n\n\treturn res\n}\n/**\n * @param {string} encodedLocations\n * @returns {MapLocation[]}\n */\nexport function decodeLocations(encodedLocations) {\n\tconst downsample = parseInt(encodedLocations[0], 36)\n\tencodedLocations = encodedLocations.slice(1)\n\n\tconst locs = /**@type {MapLocation[]}*/ ([])\n\twhile (encodedLocations) {\n\t\tlet i = 0\n\t\tfor (; i < encodedLocations.length; i++) {\n\t\t\tconst mapCode = locEnc_code2map[encodedLocations[i]]\n\t\t\tif (mapCode) {\n\t\t\t\tconst len3 = (i / 2) | 0\n\t\t\t\tfor (let j = 0; j < len3; j += 3) {\n\t\t\t\t\tconst x = decodeLocNum(encodedLocations, j, downsample)\n\t\t\t\t\tconst y = decodeLocNum(encodedLocations, j + len3, downsample)\n\t\t\t\t\tlocs.push({ mapCode, x, y })\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\tencodedLocations = encodedLocations.slice(i + 1)\n\t}\n\treturn locs\n}\nconst LOC_NUM_ENC_OFFSET = 18 * 36 * 36\n/**\n * @param {number} num\n * @param {number} downsample\n */\nfunction encodeLocNum(num, downsample) {\n\tconst numD = Math.round(num / downsample)\n\tif (numD < -LOC_NUM_ENC_OFFSET || numD >= LOC_NUM_ENC_OFFSET)\n\t\tthrow new Error(`location value out of range: ${num} (${numD})`)\n\tconst str = (LOC_NUM_ENC_OFFSET + numD).toString(36)\n\treturn '0'.repeat(3 - str.length) + str\n}\n/**\n * @param {string} str\n * @param {number} i\n * @param {number} downsample\n */\nfunction decodeLocNum(str, i, downsample) {\n\treturn (parseInt(str.slice(i, i + 3), 36) - LOC_NUM_ENC_OFFSET) * downsample\n}\n","import { DomainShortInfo, EnemyShortInfo, ItemShortInfo } from '#lib/parsing/combine'\n\nexport function apiGetJSONFile<T>(path: string, signal?: AbortSignal | null): Promise<T> | T {\n\tif (BUNDLE_ENV.IS_SSR) {\n\t\treturn JSON.parse(global._SSR_READ_PUBLIC(path))\n\t} else {\n\t\treturn fetch(BUNDLE_ENV.ASSET_PATH + path, { method: 'GET', signal }).then(x => x.json())\n\t}\n}\n\ntype MapByCodeInner<T> = T extends (infer A)[] ? (A extends { code: string } ? Map<string, A> : never) : never\n\nexport type MapAllByCode<T> = T & {\n\tmaps: {\n\t\t[K in keyof T as T[K] extends (infer A)[]\n\t\t\t? A extends { code: string }\n\t\t\t\t? K\n\t\t\t\t: never\n\t\t\t: never]: MapByCodeInner<T[K]>\n\t}\n}\n\nexport function mapAllByCode<T>(obj: T): MapAllByCode<T> {\n\t// @ts-ignore\n\tconst maps: MapAllByCode<T>['maps'] = {}\n\tfor (const attr in obj) {\n\t\tconst val = obj[attr]\n\t\tif (Array.isArray(val) && (val.length === 0 || 'code' in val[0])) {\n\t\t\t// @ts-ignore\n\t\t\tmaps[attr] = new Map(val.map(x => [x.code, x]))\n\t\t}\n\t}\n\treturn Object.assign({}, obj, { maps })\n}\n\nexport type RelItemsShort = { items: Map<string, ItemShortInfo> }\nexport type RelDomainsShort = { domains: Map<string, DomainShortInfo> }\nexport type RelEnemiesShort = { enemies: Map<string, EnemyShortInfo> }\n\nexport function getAllRelated<T>(map: Map<string, T>, codes: string[]): T[] {\n\tconst res: T[] = []\n\tfor (const code of codes) {\n\t\tconst item = map.get(code)\n\t\tif (item !== undefined) res.push(item)\n\t}\n\treturn res\n}\n\n/*\ntype MergeNestedInner<TBase, T> = T & {\n\t[K in keyof T as K extends 'materialCodes'\n\t\t? 'materials'\n\t\t: K extends 'domainCodes'\n\t\t? 'domains'\n\t\t: K extends 'enemyCodes'\n\t\t? 'enemies'\n\t\t: K]: K extends 'materialCodes'\n\t\t? TBase extends { items: (infer TItem)[] }\n\t\t\t? TItem[]\n\t\t\t: never\n\t\t: K extends 'domainCodes'\n\t\t? TBase extends { domains: (infer TDomain)[] }\n\t\t\t? TDomain[]\n\t\t\t: never\n\t\t: K extends 'enemyCodes'\n\t\t? TBase extends { enemies: (infer TEnemy)[] }\n\t\t\t? TEnemy[]\n\t\t\t: never\n\t\t: MergeNestedInner<TBase, T[K]>\n}\n\ntype WithNested_<T, TArt, TItem, TDomain, TEnemy> = T & {\n\t[K in keyof T as K extends 'materialCodes'\n\t\t? 'materials'\n\t\t: K extends 'domainCodes'\n\t\t? 'domains'\n\t\t: K extends 'enemyCodes'\n\t\t? 'enemies'\n\t\t: K]: K extends 'materialCodes'\n\t\t? TItem\n\t\t: K extends 'domainCodes'\n\t\t? TDomain\n\t\t: K extends 'enemyCodes'\n\t\t? TEnemy\n\t\t: WithNested_<T[K], TItem, TDomain, TEnemy>\n}\n\ntype WithNestedAuto<T> = WithNested_<\n\tT,\n\tT extends { items: (infer TItem)[] } ? TItem[] : never,\n\tT extends { artifacts: (infer TArt)[] } ? TArt[] : never,\n\tT extends { domains: (infer TDomain)[] } ? TDomain[] : never,\n\tT extends { enemies: (infer TEnemy)[] } ? TEnemy[] : never\n>\n\nexport type WithNested<T> = MergeNestedInner<T, T>\n\nexport function addNested<T>(obj: T): WithNested<T> {\n\tconst mapsCache = {}\n\tfunction getAllByCode(codes, attr) {\n\t\tif (!(attr in obj)) throw new Error(`no attr '${attr}' in obj`)\n\t\tconst map = (mapsCache[attr] = mapsCache[attr] ?? new Map(obj[attr].map(x => [x.code, x])))\n\t\tconst res: unknown[] = []\n\t\tfor (const code of codes) {\n\t\t\tconst item = map.get(code)\n\t\t\tif (item) res.push(item)\n\t\t}\n\t\treturn res\n\t}\n\n\tconst relatedAttrMap = {\n\t\tmaterialCodes: ['materials', 'items'],\n\t\tdomainCodes: ['domains', 'domains'],\n\t\tenemyCodes: ['enemies', 'enemies'],\n\t}\n\tfunction mergeInner(cur) {\n\t\tif (cur === null || typeof cur !== 'object') return cur\n\n\t\tfor (const attr in cur) {\n\t\t\tmergeInner(cur[attr])\n\t\t\tconst rel = relatedAttrMap[attr]\n\t\t\tif (rel) cur[rel[0]] = getAllByCode(cur[attr], rel[1])\n\t\t}\n\t}\n\n\tmergeInner(obj)\n\treturn obj as WithNested<T>\n}\n*/\n\n/*\ntype ItemsWithCodeAttrs<T> = {\n\t[K in keyof T]: T[K] extends (infer A)[] ? (A extends { code: string } ? K : never) : never\n}[keyof T]\n\nexport function mapByCode<T, K extends ItemsWithCodeAttrs<T>>(obj: T, attrs: K[]): MapByCode<T, K> {\n\t// @ts-ignore\n\tconst maps: MapByCode<T, K>['maps'] = {}\n\tfor (const attr of attrs) {\n\t\t// @ts-ignore\n\t\tmaps[attr] = new Map(obj[attr].map(x => [x.code, x]))\n\t}\n\treturn Object.assign({}, obj, { maps })\n}\n*/\n","import { isPromise } from '#lib/utils/values'\nimport { GENERATED_DATA_HASH } from './generated'\nimport { apiGetJSONFile, mapAllByCode, MapAllByCode } from './utils'\n\nimport type {\n\tArtifactsFullInfoWithRelated,\n\tCharacterFullInfoWithRelated,\n\tExtractedLocationsInfo,\n\tMaterialsTimetableWithRelated,\n\tWeaponsFullInfoWithRelated,\n} from '#lib/parsing/combine'\nimport type { ChangelogsTable } from '#lib/parsing/helperteam/types'\n\nconst get = <T>(prefix: string, signal: AbortSignal) =>\n\tapiGetJSONFile<T>(`generated/${prefix}.json?v=${GENERATED_DATA_HASH}`, signal)\n\nconst getLang = <T>(prefix: string, signal: AbortSignal) => get<T>(prefix + '-' + BUNDLE_ENV.LANG, signal)\n\ntype PromiseOrSync<T> = Promise<T> | T\n\nconst _map = <T, R>(val: PromiseOrSync<T>, func: (v: T) => R): PromiseOrSync<R> =>\n\tisPromise(val) ? val.then(func) : func(val)\n\nexport function apiGetCharacter(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<CharacterFullInfoWithRelated>> {\n\treturn _map(getLang<CharacterFullInfoWithRelated>(`characters/${code}`, signal), mapAllByCode)\n}\n\nexport function apiGetCharacterRelatedLocs(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<ExtractedLocationsInfo> {\n\treturn getLang(`characters/${code}-locs`, signal)\n}\n\nexport function apiGetArtifacts(\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<ArtifactsFullInfoWithRelated>> {\n\treturn _map(getLang<ArtifactsFullInfoWithRelated>(`artifacts`, signal), mapAllByCode)\n}\n\nexport function apiGetWeapons(signal: AbortSignal): PromiseOrSync<MapAllByCode<WeaponsFullInfoWithRelated>> {\n\treturn _map(getLang<WeaponsFullInfoWithRelated>(`weapons`, signal), mapAllByCode)\n}\n\nexport function apiMaterialsTimetable(\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<MaterialsTimetableWithRelated>> {\n\treturn _map(getLang<MaterialsTimetableWithRelated>(`timetables/materials`, signal), mapAllByCode)\n}\n\nexport function apiGetChangelogs(onlyRecent: boolean, signal: AbortSignal): PromiseOrSync<ChangelogsTable> {\n\treturn get(`changelogs${onlyRecent ? '-recent' : ''}`, signal)\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { decodeLocations } from '#lib/genshin'\nimport {\n\tCharacterFullInfoWithRelated,\n\tEnemyShortInfo,\n\tExtractedLocationsInfo,\n\tItemShortInfo,\n} from '#lib/parsing/combine'\nimport { promiseNever } from '#lib/utils/values'\nimport { isLoaded, LoadingState, PENDING, useFetch, useFetchWithPrev } from '#src/utils/hooks'\nimport { apiGetCharacter, apiGetCharacterRelatedLocs } from './endpoints'\nimport { MapAllByCode, mapAllByCode } from './utils'\n\nexport function useBuildWithDelayedLocs(\n\tcharacterCode: string,\n): [build: LoadingState<MapAllByCode<CharacterFullInfoWithRelated>>, isUpdating: boolean] {\n\tconst [build, isUpdating] = useFetchWithPrev(sig => apiGetCharacter(characterCode, sig), [characterCode])\n\tconst buildIsLoaded = isLoaded(build)\n\n\tconst locs = useFetch(\n\t\tsig =>\n\t\t\tbuildIsLoaded\n\t\t\t\t? apiGetCharacterRelatedLocs(characterCode, sig) //\n\t\t\t\t: promiseNever(), //не загружаем локации, пока не загрузится до конца билд\n\t\t[characterCode, buildIsLoaded],\n\t)\n\n\tconst buildWithLocs = useMemo(\n\t\t() => (buildIsLoaded && isLoaded(locs) ? applyFullInfoLocationsImmut(build, locs) : build),\n\t\t[build, buildIsLoaded, locs],\n\t)\n\treturn [buildWithLocs, isUpdating]\n}\n\nfunction applyFullInfoLocationsImmut(\n\tfullInfo: MapAllByCode<CharacterFullInfoWithRelated>,\n\tlocsInfo: ExtractedLocationsInfo,\n): MapAllByCode<CharacterFullInfoWithRelated> {\n\tconst items = applyItemsLocationsImmut(fullInfo.items, locsInfo.items)\n\tconst enemies = applyItemsLocationsImmut(fullInfo.enemies, locsInfo.enemies)\n\treturn mapAllByCode({ ...fullInfo, items, enemies })\n}\n\nfunction applyItemsLocationsImmut<T extends ItemShortInfo | EnemyShortInfo>(\n\titems: T[],\n\tlocItems: Record<string, string>,\n): T[] {\n\tlet resItems = items\n\tfor (let i = 0; i < items.length; i++) {\n\t\tconst locs = locItems[items[i].code]\n\t\tif (locs) {\n\t\t\tif (resItems === items) resItems = items.slice()\n\t\t\tresItems[i] = { ...items[i], locations: decodeLocations(locs) }\n\t\t}\n\t}\n\treturn resItems\n}\n","export function Spinner(): JSX.Element {\n\treturn (\n\t\t<div class=\"d-flex justify-content-center\">\n\t\t\t<div class=\"spinner-border\" role=\"status\">\n\t\t\t\t<span class=\"visually-hidden\">Loading...</span>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\nexport function CentredSpinner(): JSX.Element {\n\treturn (\n\t\t<div className=\"position-absolute top-0 bottom-0 start-0 end-0 d-flex justify-content-center align-items-center\">\n\t\t\t<Spinner />\n\t\t</div>\n\t)\n}\n","export default __webpack_public_path__ + \"circlet.a7d84b1e.png\";","export default __webpack_public_path__ + \"flower.695510cb.png\";","export default __webpack_public_path__ + \"goblet.06e92e38.png\";","export default __webpack_public_path__ + \"plume.6851630b.png\";","export default __webpack_public_path__ + \"sands.e69477c6.png\";","import {\n\tART_GROUP_18_ATK_CODE,\n\tART_GROUP_18_ATK_INSIDE_CODES,\n\tART_GROUP_20_ER_CODE,\n\tART_GROUP_20_ER_INSIDE_CODES,\n\tGI_ArtifactTypeCode,\n} from '#lib/genshin'\nimport icon_circlet from '#src/media/circlet.png'\nimport icon_flower from '#src/media/flower.png'\nimport icon_goblet from '#src/media/goblet.png'\nimport icon_plume from '#src/media/plume.png'\nimport icon_sands from '#src/media/sands.png'\n\nexport type GI_ArtifactType = { readonly code: GI_ArtifactTypeCode; imgSrc: string }\nexport const artifactTypes: GI_ArtifactType[] = [\n\t{ code: 'flower' as const, imgSrc: icon_flower },\n\t{ code: 'plume' as const, imgSrc: icon_plume },\n\t{ code: 'sands' as const, imgSrc: icon_sands },\n\t{ code: 'goblet' as const, imgSrc: icon_goblet },\n\t{ code: 'circlet' as const, imgSrc: icon_circlet },\n]\n\nexport function getArtifactTypeIconSrc(artifactTypeCode: string): string {\n\treturn (artifactTypes.find(at => at.code === artifactTypeCode) || artifactTypes[0]).imgSrc\n}\n\nfunction isGroup(code: string) {\n\treturn code === ART_GROUP_18_ATK_CODE || code === ART_GROUP_20_ER_CODE\n}\n\nexport function getArtifactIconSrc(artifactCode: string): string {\n\treturn isGroup(artifactCode) ? icon_flower : BUNDLE_ENV.ASSET_PATH + `media/artifacts/${artifactCode}.png`\n}\n\nexport function getArtifactIconLargeSrc(artifactCode: string): string {\n\treturn isGroup(artifactCode)\n\t\t? icon_flower\n\t\t: BUNDLE_ENV.ASSET_PATH + `media/artifacts/${artifactCode}.large.png`\n}\n\nfunction getAllOrNone<T>(codes: string[], map: Map<string, T>) {\n\tconst res: T[] = []\n\tfor (const code of codes) {\n\t\tconst item = map.get(code)\n\t\tif (!item) return []\n\t\tres.push(item)\n\t}\n\treturn res\n}\nexport function getAllArtifacts<T>(code: string, artsMap: Map<string, T>): T[] {\n\tif (code === ART_GROUP_18_ATK_CODE) return getAllOrNone(ART_GROUP_18_ATK_INSIDE_CODES, artsMap)\n\tif (code === ART_GROUP_20_ER_CODE) return getAllOrNone(ART_GROUP_20_ER_INSIDE_CODES, artsMap)\n\treturn getAllOrNone([code], artsMap)\n}\n","export function BlockHeader({ children, classes = '' }) {\n\treturn <h6 className={`text-uppercase opacity-75 letter-spacing-1 ${classes}`}>{children}</h6>\n}\n","import { useCallback } from 'preact/hooks'\n\nexport type Option = { title: string | JSX.Element; code: string }\n\nexport function SimpleSelect({\n\toptions,\n\tselectedOption,\n\tonOptionSelect,\n\tclasses = '',\n\tsize = 1,\n}: {\n\toptions: Option[]\n\tselectedOption: Option | null\n\tonOptionSelect(Option): unknown\n\tclasses?: string\n\tsize?: number\n}): JSX.Element {\n\tconst handleChange = useCallback(\n\t\te => {\n\t\t\tonOptionSelect(options.find(o => o.code === e.target.value))\n\t\t},\n\t\t[options, onOptionSelect],\n\t)\n\treturn (\n\t\t<select\n\t\t\tclassName={`form-select border-secondary bg-dark text-light c-pointer ${classes}`}\n\t\t\tonChange={handleChange}\n\t\t\tsize={size}\n\t\t>\n\t\t\t<option value=\"\" disabled selected hidden>\n\t\t\t\tSelect…\n\t\t\t</option>\n\t\t\t{options.map(o => (\n\t\t\t\t<option\n\t\t\t\t\tclassName=\"c-pointer\"\n\t\t\t\t\tkey={o.code}\n\t\t\t\t\tvalue={o.code}\n\t\t\t\t\tselected={!!(selectedOption && o.code === selectedOption.code)}\n\t\t\t\t>\n\t\t\t\t\t{o.title}\n\t\t\t\t</option>\n\t\t\t))}\n\t\t</select>\n\t)\n}\n","import { useCallback, useMemo, useState } from 'preact/hooks'\n\nimport { arrShallowEqual } from '#lib/utils/collections'\n\nexport type Tab = { code: string; title?: string | JSX.Element }\n\nexport function tabTitleFromName(obj: { name: string }): string {\n\treturn obj.name\n}\n\nexport function Tabs<T extends Tab>({\n\ttabs,\n\ttitleFunc,\n\tselectedTab,\n\tonTabSelect,\n\tclasses = '',\n}: {\n\ttabs: T[]\n\ttitleFunc?: (tab: T) => string | JSX.Element\n\tselectedTab: T\n\tonTabSelect: (tab: T) => unknown\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ul className={`nav nav-tabs ${classes}`}>\n\t\t\t{tabs.map(t => (\n\t\t\t\t<li className=\"nav-item\" key={t.code}>\n\t\t\t\t\t<a\n\t\t\t\t\t\tclassName={`nav-link ${t.code === selectedTab.code ? 'active' : ''}`}\n\t\t\t\t\t\thref=\"#\"\n\t\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\t\tonTabSelect(t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t))}\n\t\t</ul>\n\t)\n}\n\nexport function BtnTabGroup<T extends Tab>({\n\ttabs,\n\ttitleFunc,\n\tselectedTab,\n\tonTabSelect,\n\tclasses = '',\n}: {\n\ttabs: T[]\n\ttitleFunc?: (tab: T) => string | JSX.Element\n\tselectedTab: T\n\tonTabSelect: (tab: T) => void\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<div class={`btn-group ${classes}`}>\n\t\t\t{tabs.map(t => (\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tdisabled={tabs.length === 1}\n\t\t\t\t\tclassName={`btn btn-sm lh-sm ${\n\t\t\t\t\t\tt.code === selectedTab.code ? 'btn-primary' : 'btn-outline-primary'\n\t\t\t\t\t} `}\n\t\t\t\t\tkey={t.code}\n\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\tonTabSelect(t)\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t</button>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\n/**\n * а) сохраняет выделенную вкладку по коду (после смены вкладок, если выбранного ранее кода\n *    среди новых вкладок нет, возвращает первую вкладку).\n * б) если передан массив args, сохраняет выбранную вкладку для каждого уникального набора args\n *    (полезно, если эти вкладки находятся врутри другого переключателя,\n *    например вкладки ролей, а над ними - переключатель персонажей).\n */\nexport function useSelectable<T extends Tab>(tabs: T[], args?: unknown[]): [T, (tab: T) => unknown] {\n\tconst [tabCodes, setTabCodes] = useState<{ code: string; args: unknown[] }[]>([])\n\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst argsInner = useMemo(() => args ?? [], args)\n\n\tconst item = useMemo(() => tabCodes.find(x => arrShallowEqual(argsInner, x.args)), [argsInner, tabCodes])\n\n\tconst tab = useMemo(() => (item && tabs.find(x => x.code === item.code)) ?? tabs[0], [tabs, item])\n\n\tconst setTab = useCallback(\n\t\t(tab: T) => {\n\t\t\tif (item) {\n\t\t\t\tif (item.code !== tab.code) {\n\t\t\t\t\tsetTabCodes(tabCodes.filter(x => x !== item).concat({ ...item, code: tab.code }))\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetTabCodes(tabCodes.concat({ code: tab.code, args: argsInner }))\n\t\t\t}\n\t\t},\n\t\t[argsInner, item, tabCodes],\n\t)\n\treturn [tab, setTab]\n}\n","// bootstrap edition\nexport function calcPosForDd(\n\tparentRect: DOMRect,\n\tddRect: DOMRect,\n\t{ isAbsolute = false, isCentered = false, shouldFitInScreen = false } = {},\n): { top: number; left: number; layoutPosition: { x: 'end' | 'start'; y: 'top' | 'bottom' } } {\n\tconst tWidth = window.innerWidth\n\tconst tHeight = window.innerHeight\n\tconst scrollTopFix = isAbsolute ? window.scrollY : 0\n\tconst centredFix = isCentered ? (parentRect.width - ddRect.width) / 2 : 0\n\tlet top = 0\n\tlet left = 0\n\tlet layoutPositionX: 'end' | 'start' = 'end'\n\tlet layoutPositionY: 'top' | 'bottom' = 'bottom'\n\tif (parentRect.top + parentRect.height + ddRect.height < tHeight) {\n\t\t// to bottom\n\t\ttop = parentRect.top + parentRect.height + scrollTopFix\n\t\tlayoutPositionY = 'bottom'\n\t} else {\n\t\t// to top\n\t\ttop = parentRect.top - ddRect.height + scrollTopFix\n\t\tlayoutPositionY = 'top'\n\t}\n\tif (parentRect.left + ddRect.width + centredFix < tWidth) {\n\t\t// to right\n\t\tleft = parentRect.left + centredFix\n\t\tlayoutPositionX = 'end'\n\t} else {\n\t\t// to left\n\t\tleft = parentRect.left + parentRect.width - ddRect.width - centredFix\n\t\tlayoutPositionX = 'start'\n\t}\n\tif (shouldFitInScreen) {\n\t\tleft = Math.min(Math.max(0, left), tWidth - ddRect.width)\n\t\ttop = Math.max(top, 0)\n\t}\n\treturn { top, left, layoutPosition: { y: layoutPositionY, x: layoutPositionX } }\n}\n","import { useCallback, useLayoutEffect, useRef, useState } from 'preact/hooks'\n\nimport { calcPosForDd } from '#src/utils/calc-pos-for-dd'\nimport { useClickAway, useWindowSize } from '#src/utils/hooks'\nimport { createPortal } from '#src/utils/preact-compat'\n\nlet modalsEl: Element | null = null\n\nexport const ItemDetailDdPortal = ({\n\tonClickAway,\n\tchildren,\n\tclasses = '',\n\ttargetEl,\n\tcontentKey = null,\n}: {\n\tonClickAway?(): void\n\tchildren: JSX.Nodes\n\tclasses?: string\n\ttargetEl: HTMLElement | null | undefined\n\tcontentKey?: string | null | undefined\n}): JSX.Element => {\n\tmodalsEl ??= document.querySelector('.modals') as Element\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `popover item-detail-popover ${classes}`\n\tconst [arrowStyle, setArrowStyle] = useState('')\n\tconst onResize = useCallback(() => {\n\t\tif (!wrapRef.current) return\n\t\tif (!targetEl) return\n\t\tconst wrapEl = wrapRef.current\n\t\tconst pos = calcPosForDd(targetEl.getBoundingClientRect(), wrapEl.getBoundingClientRect(), {\n\t\t\tisAbsolute: true,\n\t\t\tisCentered: true,\n\t\t\tshouldFitInScreen: true,\n\t\t})\n\t\t;('bs-popover-top bs-popover-bottom')\n\t\twrapEl.className = `${defClassName} bs-popover-${pos.layoutPosition.y}`\n\t\twrapEl.style.left = `${pos.left}px`\n\t\twrapEl.style.top = `${pos.top}px`\n\t\tsetArrowStyle(\n\t\t\t`position: absolute; transform: translate3d(${wrapEl.offsetWidth / 2 - 8}px, 0, 0); left: 0`,\n\t\t)\n\t}, [wrapRef, targetEl, defClassName, setArrowStyle])\n\tuseLayoutEffect(onResize)\n\tuseWindowSize()\n\tuseClickAway(wrapRef, onClickAway)\n\t//todo обновлять позицию, когда загрузилась картинка\n\treturn createPortal(\n\t\t<div class={defClassName} ref={wrapRef}>\n\t\t\t{children}\n\t\t\t<div class=\"popover-arrow\" style={arrowStyle}></div>\n\t\t</div>,\n\t\tmodalsEl,\n\t)\n}\nexport const ItemDetailDdMobilePortal = ({\n\tonClickAway,\n\tchildren,\n\tclasses = '',\n\tcontentKey = null,\n}: {\n\tonClickAway?(): void\n\tchildren: JSX.Nodes\n\tclasses?: string\n\tcontentKey?: string | null | undefined\n}): JSX.Element => {\n\tmodalsEl ??= document.querySelector('.modals') as Element\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `fixed-bottom ${classes}`\n\n\tuseClickAway(wrapRef, onClickAway)\n\n\treturn createPortal(\n\t\t<div class={defClassName} ref={wrapRef}>\n\t\t\t{children}\n\t\t</div>,\n\t\tmodalsEl,\n\t)\n}\n","import { calcPosForDd } from '#src/utils/calc-pos-for-dd'\nimport { useWindowSize } from '#src/utils/hooks'\nimport { createPortal } from '#src/utils/preact-compat'\nimport { useCallback, useLayoutEffect, useRef, useState } from 'preact/hooks'\n\nlet modalsEl: Element | null = null\n\nexport function Tooltip({\n\tchildren,\n\tclasses = '',\n\ttargetEl,\n}: {\n\tchildren: JSX.Node\n\tclasses?: string\n\ttargetEl: HTMLElement | null | undefined\n}): JSX.Element {\n\tmodalsEl ??= document.querySelector('.modals') as Element\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `tooltip fade show ${classes}`\n\tconst [arrowStyle, setArrowStyle] = useState<string>('')\n\tconst onResize = useCallback(() => {\n\t\tif (!wrapRef.current) return\n\t\tif (!targetEl) return\n\t\tconst wrapEl = wrapRef.current\n\t\tconst pos = calcPosForDd(targetEl.getBoundingClientRect(), wrapEl.getBoundingClientRect(), {\n\t\t\tisAbsolute: true,\n\t\t\tisCentered: true,\n\t\t})\n\t\t;('bs-tooltip-top bs-tooltip-bottom')\n\t\twrapEl.className = `${defClassName} bs-tooltip-${pos.layoutPosition.y}`\n\t\twrapEl.style.left = `${Math.max(0, pos.left)}px`\n\t\twrapEl.style.top = `${Math.max(0, pos.top)}px`\n\t\tsetArrowStyle(\n\t\t\t`position: absolute; transform: translate3d(${wrapEl.offsetWidth / 2 - 8}px, 0, 0); left: 0`,\n\t\t)\n\t}, [wrapRef, targetEl, defClassName, setArrowStyle])\n\tuseLayoutEffect(onResize)\n\tuseWindowSize()\n\t//todo обновлять позицию, когда загрузилась картинка\n\treturn createPortal(\n\t\t<div className={defClassName} ref={wrapRef}>\n\t\t\t<div className=\"tooltip-arrow\" style={arrowStyle}></div>\n\t\t\t<div className=\"tooltip-inner\">{children}</div>\n\t\t</div>,\n\t\tmodalsEl,\n\t)\n}\n","import { GI_ServerRegionCode, guessCurrentRegion } from '#lib/genshin'\n\nexport const SK_SELECTED_REGION_CODE = 'selected-region-code'\nexport const SK_DEFAULT_SELECTED_REGION_CODE: GI_ServerRegionCode = guessCurrentRegion()\n\n//sk - storage key\nexport const SK_FAV_CHAR_CODES = 'favoriteCharacterCodes'\nexport const SK_FAV_TALENT_MATERIAL_CODES = 'favoriteTalentMaterialCodes'\nexport const SK_FAV_WEAPON_DATAS = 'favoriteWeaponDatas'\nexport const SK_FAV_WEAPON_PRIMARY_MATERIAL_CODES = 'favoriteWeaponPrimaryMaterialCodes'\nexport type STORAGE_WEAPON_DATA = [weaponCode: string, weaponMaterialCode: string]\n","import { useCallback, useMemo } from 'preact/hooks'\n\nimport { ART_GROUP_DETAILS } from '#lib/genshin'\nimport { CharacterFullInfoWithRelated } from '#lib/parsing/combine'\nimport { CompactTextParagraphs, TextNode } from '#lib/parsing/helperteam/text'\nimport { ArtifactRef, ArtifactRefNode, CharacterBuildInfoRole } from '#lib/parsing/helperteam/types'\nimport { mustBeDefined, warnUnlessNever } from '#lib/utils/values'\nimport { MapAllByCode } from '#src/api/utils'\nimport { Tooltip } from '#src/components/tooltip'\nimport { ArtifactCard } from '#src/containers/item-cards/dd-cards'\nimport { ItemDetailsLabel, LabeledItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { I18N_CONJUCTIONS, I18N_STAT_NAME } from '#src/i18n/i18n'\nimport { getAllArtifacts, getArtifactIconSrc } from '#src/utils/artifacts'\nimport { useHover, useLocalStorage } from '#src/utils/hooks'\nimport {\n\tSK_FAV_CHAR_CODES,\n\tSK_FAV_TALENT_MATERIAL_CODES,\n\tSK_FAV_WEAPON_DATAS,\n\tSK_FAV_WEAPON_PRIMARY_MATERIAL_CODES,\n\tSTORAGE_WEAPON_DATA,\n} from '#src/utils/local-storage-keys'\nimport { HEART, HEART_EMPTY, STAR } from '#src/utils/typography'\n\nexport const DUMMY_ROLE: { code: string; title: string } & Partial<CharacterBuildInfoRole<'monolang'>> = {\n\ttitle: '…',\n\tcode: '',\n}\nexport const DUMMY_ROLES = [DUMMY_ROLE]\n\nexport type BuildRoleOrDummy = CharacterBuildInfoRole<'monolang'> | typeof DUMMY_ROLE\n\nexport function makeRoleTitle(r: BuildRoleOrDummy) {\n\treturn (\n\t\t<span key={r.code}>\n\t\t\t{r.isRecommended && (\n\t\t\t\t<span className=\"fs-4 lh-1 opacity-75 text-warning align-bottom\">{STAR}</span>\n\t\t\t)}\n\t\t\t{r.code}\n\t\t</span>\n\t)\n}\nexport const CIRCLET_GOBLET_SANDS = ['sands', 'goblet', 'circlet'] as const\nexport function getRoleData(build: CharacterFullInfoWithRelated, selectedCode: string) {\n\treturn mustBeDefined(build.character.roles.find(x => x.code === selectedCode))\n}\nexport function genArtMainStatDetail(\n\trole: CharacterBuildInfoRole<'monolang'>,\n\titemCode: 'circlet' | 'goblet' | 'sands',\n\tisShort?: boolean,\n) {\n\treturn (\n\t\t<span className=\"\">\n\t\t\t{genSimpleList(role.mainStats[itemCode].codes.map(I18N_STAT_NAME))}\n\t\t\t{isShort\n\t\t\t\t? ' ' + genNotes(role.mainStats[itemCode]) + genSeeCharNotes(role.mainStats[itemCode])\n\t\t\t\t: null}\n\t\t</span>\n\t)\n}\nexport function genSimpleList(arr: string[]) {\n\treturn arr.join(', ')\n}\nexport function notesWrap(str) {\n\treturn <div className=\"text-muted small\">{str}</div>\n}\nexport function genNotes(item: { notes: CompactTextParagraphs | null }) {\n\treturn item.notes === null ? '' : notesWrap(JSON.stringify(item.notes))\n}\nexport function genSeeCharNotes(item: { seeCharNotes: boolean }) {\n\treturn '' //TODO\n\treturn item.seeCharNotes ? notesWrap(' (see notes)') : ''\n}\nexport function notesToJSX(tips: CompactTextParagraphs | null): JSX.Nodes {\n\tfunction processString(str: string) {\n\t\treturn str\n\t\t\t.split('\\n')\n\t\t\t.map((sub, i, arr) => [sub, i < arr.length - 1 ? <br /> : ''])\n\t\t\t.flat()\n\t\t\t.filter(a => a)\n\t}\n\tfunction processObj(tip: TextNode) {\n\t\tif (typeof tip === 'string') return processString(tip)\n\t\tif ('p' in tip) return <p>{notesToJSX(tip.p)}</p>\n\t\tif ('b' in tip) return <b class=\"opacity-75 text-normal\">{notesToJSX(tip.b)}</b>\n\t\tif ('i' in tip) return <i>{notesToJSX(tip.i)}</i>\n\t\tif ('u' in tip) return <u>{notesToJSX(tip.u)}</u>\n\t\tif ('s' in tip) return <s>{notesToJSX(tip.s)}</s>\n\t\tif ('a' in tip) return <a href={tip.href}>{notesToJSX(tip.a)}</a>\n\t\tif ('weapon' in tip)\n\t\t\treturn (\n\t\t\t\t<ItemDetailsLabel type=\"weapon\" code={tip.code}>\n\t\t\t\t\t{notesToJSX(tip.weapon)}\n\t\t\t\t</ItemDetailsLabel>\n\t\t\t)\n\t\tif ('artifact' in tip)\n\t\t\treturn (\n\t\t\t\t<ItemDetailsLabel type=\"artifact\" code={tip.code}>\n\t\t\t\t\t{notesToJSX(tip.artifact)}\n\t\t\t\t</ItemDetailsLabel>\n\t\t\t)\n\t\tif ('item' in tip) return <>{notesToJSX(tip.item)}</>\n\t\twarnUnlessNever('unknown element type in notes: ', tip)\n\t\treturn <span>{JSON.stringify(tip)}</span>\n\t}\n\tif (!tips) return null\n\tif (Array.isArray(tips)) return tips.map(processObj).flat()\n\treturn processObj(tips)\n}\n\nexport function genArtifactAdvice(\n\tset: ArtifactRef | ArtifactRefNode,\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>,\n\tisLast = true,\n) {\n\t// todo notes\n\tif ('code' in set) {\n\t\t//ArtifactRef\n\t\tconst artifactsForDd = getAllArtifacts(set.code, build.maps.artifacts)\n\t\tif (!artifactsForDd.length) return null\n\t\tconst artifactForList = ART_GROUP_DETAILS[set.code] ?? artifactsForDd[0]\n\t\treturn (\n\t\t\t<LabeledItemAvatar\n\t\t\t\timgSrc={getArtifactIconSrc(set.code)}\n\t\t\t\trarity={artifactForList.rarity}\n\t\t\t\ttitle={artifactForList.name}\n\t\t\t\tkey={set.code}\n\t\t\t\tavatarTopEndBadge={'x' + set.count}\n\t\t\t\tavatarClasses=\"with-padding\"\n\t\t\t\tclasses={`small ${isLast ? 'mb-1' : ''}`}\n\t\t\t\tddComponent={\n\t\t\t\t\t<ArtifactCard\n\t\t\t\t\t\tartifacts={artifactsForDd}\n\t\t\t\t\t\trelated={build.maps}\n\t\t\t\t\t\ttitle={artifactForList.name}\n\t\t\t\t\t/>\n\t\t\t\t}\n\t\t\t/>\n\t\t)\n\t} else {\n\t\t//ArtifactRefNode\n\t\treturn (\n\t\t\t<ItemsListGroupWrap>\n\t\t\t\t{set.arts.map((art, i) => {\n\t\t\t\t\tconst isLastInList = i >= set.arts.length - 1\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{genArtifactAdvice(art, build, isLastInList)}\n\t\t\t\t\t\t\t{!isLastInList && <ItemsJoinerWrap>{I18N_CONJUCTIONS[set.op]}</ItemsJoinerWrap>}\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</ItemsListGroupWrap>\n\t\t)\n\t}\n}\nexport function ItemsJoinerWrap({ children }): JSX.Element {\n\treturn <div className=\"text-start text-muted small px-5 my-n1\">{children}</div>\n}\nexport function ItemsListGroupWrap({\n\tchildren,\n}: {\n\tchildren: JSX.Node | (JSX.Element | null)[]\n}): JSX.Element {\n\treturn <div className=\"border-2 rounded border-secondary border-start ps-2\">{children}</div>\n}\nexport const MAX_SMTHS_TO_STORE = 5\nexport function removeOldSmthsFromList<T>(codes: T[]): T[] {\n\treturn codes.slice(0, MAX_SMTHS_TO_STORE)\n}\nfunction ToggleSmthFav({\n\tsmthCode,\n\tclasses,\n\tstorageKey,\n\ttipFav,\n\ttipNotFav,\n}: {\n\tsmthCode: string\n\tclasses?: string\n\tstorageKey: string\n\ttipFav: string\n\ttipNotFav: string\n}): JSX.Element {\n\tconst [favSmthCodes, setFavSmthCodes] = useLocalStorage<string[]>(storageKey, [])\n\tconst [elRef, isHovered] = useHover<HTMLDivElement>()\n\tconst isFav = ~favSmthCodes.indexOf(smthCode)\n\tconst toggleFav = useCallback(() => {\n\t\tsetFavSmthCodes(\n\t\t\tremoveOldSmthsFromList(\n\t\t\t\tisFav ? favSmthCodes.filter(c => c !== smthCode) : [smthCode, ...favSmthCodes],\n\t\t\t),\n\t\t)\n\t}, [smthCode, setFavSmthCodes, favSmthCodes, isFav])\n\treturn (\n\t\t<div\n\t\t\trole=\"button\"\n\t\t\tclassName={`user-select-none lh-1 ${isFav ? 'text-danger' : 'text-danger opacity-50'} ${classes}`}\n\t\t\tonClick={toggleFav}\n\t\t\tref={elRef}\n\t\t>\n\t\t\t{isFav ? HEART : HEART_EMPTY}\n\t\t\t{elRef.current && isHovered ? (\n\t\t\t\t<Tooltip targetEl={elRef.current}>{isFav ? tipFav : tipNotFav}</Tooltip>\n\t\t\t) : null}\n\t\t</div>\n\t)\n}\n\nexport function ToggleCharFav({\n\tcharacterCode,\n\tclasses,\n}: {\n\tcharacterCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={characterCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SK_FAV_CHAR_CODES}\n\t\t\ttipFav={'Remove character from your favorites'}\n\t\t\ttipNotFav={'Add character to your favorites'}\n\t\t/>\n\t)\n}\nexport function ToggleWeaponPrimaryMaterialFav({\n\titemCode,\n\tclasses,\n}: {\n\titemCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={itemCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SK_FAV_WEAPON_PRIMARY_MATERIAL_CODES}\n\t\t\ttipFav={'Remove material from your favorites'}\n\t\t\ttipNotFav={'Add material to your favorites'}\n\t\t/>\n\t)\n}\nexport function ToggleTalentMaterialFav({\n\titemCode,\n\tclasses,\n}: {\n\titemCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={itemCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SK_FAV_TALENT_MATERIAL_CODES}\n\t\t\ttipFav={'Remove material from your favorites'}\n\t\t\ttipNotFav={'Add material to your favorites'}\n\t\t/>\n\t)\n}\n\n//not used\nexport function ToggleWeaponFav({\n\tweaponCode,\n\tweapMatCode,\n\tclasses,\n}: {\n\tweaponCode: string\n\tweapMatCode: string\n\tclasses?: string\n}): JSX.Element {\n\tconst [favWeaponDatas, setWeaponDatas] = useLocalStorage<STORAGE_WEAPON_DATA[]>(SK_FAV_WEAPON_DATAS, [])\n\tconst favWeaponCodes = useMemo(() => favWeaponDatas.map(wd => wd[0]), [favWeaponDatas])\n\tconst [elRef, isHovered] = useHover<HTMLDivElement>()\n\tconst isFav = ~favWeaponCodes.indexOf(weaponCode)\n\tconst toggleFav = useCallback(() => {\n\t\tsetWeaponDatas(\n\t\t\tremoveOldSmthsFromList(\n\t\t\t\tisFav\n\t\t\t\t\t? favWeaponDatas.filter(d => d[0] !== weaponCode)\n\t\t\t\t\t: [[weaponCode, weapMatCode], ...favWeaponDatas],\n\t\t\t),\n\t\t)\n\t}, [weaponCode, weapMatCode, setWeaponDatas, favWeaponDatas, isFav])\n\treturn (\n\t\t<div\n\t\t\trole=\"button\"\n\t\t\tclassName={`user-select-none lh-1 ${isFav ? 'text-danger' : 'text-danger opacity-50'} ${classes}`}\n\t\t\tonClick={toggleFav}\n\t\t\tref={elRef}\n\t\t>\n\t\t\t{isFav ? HEART : HEART_EMPTY}\n\t\t\t{elRef.current && isHovered ? (\n\t\t\t\t<Tooltip targetEl={elRef.current}>\n\t\t\t\t\t{isFav ? 'Remove weapon from your favorites' : 'Add weapon to your favorites'}\n\t\t\t\t</Tooltip>\n\t\t\t) : null}\n\t\t</div>\n\t)\n}\n","// export type Character = {\n// \tcode: string,\n// \telement:\n// }\n\n// export function getCharactersWithElement = (characters, elementCode) = {\n// \treturn characters.filter(c=> c.element = elementCode)\n// }\n\nfunction unprefixTraveler(code: string) {\n\treturn code.startsWith('traveler-') ? 'traveler' : code\n}\n\nexport function getCharacterAvatarSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/avatars/${unprefixTraveler(code)}.png`\n}\n\nexport function getCharacterAvatarLargeSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/avatars/${unprefixTraveler(code)}.large.png`\n}\n\nexport function getCharacterPortraitSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/portraits/${unprefixTraveler(code)}.png`\n}\n\nexport function getCharacterSilhouetteSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/silhouettes/${unprefixTraveler(code)}.svg`\n}\n","import { GI_DomainTypeCode } from '#lib/genshin'\n\nexport function getDomainIconSrc(domainType: GI_DomainTypeCode): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/domains/${domainType}.png`\n}\n","export function getEnemyIconSrc(enemyCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/enemies/${enemyCode}.png`\n}\n","export function getItemIconSrc(itemCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/items/${itemCode}.png`\n}\n\nexport function getItemIconLargeSrc(itemCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/items/${itemCode}.large.png`\n}\n","export default __webpack_public_path__ + \"Icon_Bow.e7c82786.png\";","export default __webpack_public_path__ + \"Icon_Catalyst.871a7999.png\";","export default __webpack_public_path__ + \"Icon_Claymore.46946e88.png\";","export default __webpack_public_path__ + \"Icon_Polearm.73080ee4.png\";","export default __webpack_public_path__ + \"Icon_Sword.a2824108.png\";","import icon_Bow from '#src/media/Icon_Bow.png'\nimport icon_Catalyst from '#src/media/Icon_Catalyst.png'\nimport icon_Claymore from '#src/media/Icon_Claymore.png'\nimport icon_Polearm from '#src/media/Icon_Polearm.png'\nimport icon_Sword from '#src/media/Icon_Sword.png'\n\nimport type { GI_WeaponTypeCode } from '#lib/genshin'\n\nexport type GI_WeaponType = { readonly code: GI_WeaponTypeCode; imgSrc: string }\nexport const weaponTypes: GI_WeaponType[] = [\n\t{ code: 'sword' as const, imgSrc: icon_Sword },\n\t{ code: 'bow' as const, imgSrc: icon_Bow },\n\t{ code: 'catalyst' as const, imgSrc: icon_Catalyst },\n\t{ code: 'claymore' as const, imgSrc: icon_Claymore },\n\t{ code: 'polearm' as const, imgSrc: icon_Polearm },\n]\n\nexport function getWeaponIconSrc(weaponCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/weapons/${weaponCode}.png`\n}\n\nexport function getWeaponIconLageSrc(weaponCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/weapons/${weaponCode}.large.png`\n}\n","import { useCallback, useEffect, useState } from 'preact/hooks'\nimport { ItemAvatar } from './item-cards/item-avatars'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { GI_RarityCode } from '#src/../../lib/genshin'\n\nconst DEF_ANCESTRY_CODES = [\n\t'agnidus-agate-sliver',\n\t'agnidus-agate-fragment',\n\t'agnidus-agate-chunk',\n\t'agnidus-agate-gemstone',\n]\nexport function AlchemyCalculator({\n\tclasses = '',\n\tancestryCodes = DEF_ANCESTRY_CODES,\n}: {\n\tclasses?: string\n\tancestryCodes?: string[]\n}): JSX.Element {\n\tconst [values, setValues] = useState<number[]>([])\n\tconst onValueChange = useCallback(\n\t\te => {\n\t\t\tconst value = +e.target.value\n\t\t\tconst index = +e.target.dataset.index\n\t\t\tsetValues(values.map((v, i) => (v = Math.floor(3 ** (index - i) * value))))\n\t\t},\n\t\t[setValues, values],\n\t)\n\tuseEffect(() => {\n\t\tsetValues(ancestryCodes.map((c, i) => 3 ** (ancestryCodes.length - 1 - i)))\n\t}, [ancestryCodes])\n\tconst startNotRoundClass = 'not-rounded-start'\n\tconst endNotRoundClass = 'not-rounded-end'\n\tconst endRoundClass = 'rounded-end'\n\treturn (\n\t\t<div className={`alchemy-calculator overflow-hidden ${classes}`}>\n\t\t\t<div className=\"input-group\">\n\t\t\t\t{ancestryCodes.map((c, i) => {\n\t\t\t\t\tconst isFirst = i === 0\n\t\t\t\t\tconst isLast = i === ancestryCodes.length - 1\n\t\t\t\t\tconst rarity = 5 - (ancestryCodes.length - 1 - i)\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{i !== 0 ? (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={`input-group-text text-dark border-light border-top border-bottom bg-${\n\t\t\t\t\t\t\t\t\t\trarity - 1\n\t\t\t\t\t\t\t\t\t} ps-1`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{'='}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t\tclassName={`form-control bg-dark text-light text-end border-secondary pe-1 ${\n\t\t\t\t\t\t\t\t\t!isFirst ? startNotRoundClass : ''\n\t\t\t\t\t\t\t\t} ${endNotRoundClass}`}\n\t\t\t\t\t\t\t\tonInput={onValueChange}\n\t\t\t\t\t\t\t\tvalue={values[i]}\n\t\t\t\t\t\t\t\tdata-index={i}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tsrc={getItemIconSrc(c)}\n\t\t\t\t\t\t\t\trarity={rarity as GI_RarityCode}\n\t\t\t\t\t\t\t\tclasses={`small-avatar with-padding input-group-avatar ${startNotRoundClass} ${\n\t\t\t\t\t\t\t\t\t!isLast ? endNotRoundClass : endRoundClass + ' border-end'\n\t\t\t\t\t\t\t\t} border-top border-bottom border-light`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { GI_DomainTypeCode, GI_MAP_CODES, GI_RarityCode, MapCode, MapLocation } from '#lib/genshin'\nimport { ArtifactFullInfo, ItemShortInfo, WeaponFullInfo } from '#lib/parsing/combine'\nimport { arrGetAfter } from '#lib/utils/collections'\nimport { getAllRelated, RelDomainsShort, RelEnemiesShort, RelItemsShort } from '#src/api/utils'\nimport { BlockHeader } from '#src/components/block-header'\nimport { SimpleSelect } from '#src/components/select'\nimport { Spinner } from '#src/components/spinners'\nimport { BtnTabGroup, tabTitleFromName, useSelectable } from '#src/components/tabs'\nimport {\n\tItemDetailDdMobilePortal,\n\tItemDetailDdPortal,\n} from '#src/containers/item-cards/item-detail-dd-portal'\nimport {\n\tI18N_ALCHEMY_CALC,\n\tI18N_BASE_ATTACK,\n\tI18N_ERROR,\n\tI18N_FOR_NOBODY,\n\tI18N_MAP_CODES_NAME,\n\tI18N_OBTAINED_DURING_STORYLINE,\n\tI18N_PIECE_BONUS,\n\tI18N_PIECES_BONUS,\n\tI18N_PINCH_TO_ZOOM,\n\tI18N_RECOMENDED_FOR,\n\tI18N_SCROLL_TO_ZOOM,\n\tI18N_SECONDARY_STAT,\n\tI18N_SOURCE,\n\tI18N_STAT_NAME,\n\tI18N_WEAPON_OBTAIN_SOURCE_NAME,\n\tI18N_WEAPON_TYPE_NAME,\n} from '#src/i18n/i18n'\nimport {\n\tnotesToJSX,\n\tToggleTalentMaterialFav,\n\tToggleWeaponPrimaryMaterialFav,\n} from '#src/modules/builds/common'\nimport { getArtifactIconLargeSrc, getArtifactIconSrc } from '#src/utils/artifacts'\nimport { BS_isBreakpointLessThen } from '#src/utils/bootstrap'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { getDomainIconSrc } from '#src/utils/domains'\nimport { getEnemyIconSrc } from '#src/utils/enemies'\nimport { isLoaded, useFetch, useWindowSize } from '#src/utils/hooks'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { BULLET, LEFT_POINTING, RIGHT_POINTING, TIMES } from '#src/utils/typography'\nimport { getWeaponIconLageSrc } from '#src/utils/weapons'\nimport { AlchemyCalculator } from '../alchemy-calculator'\nimport { DdContext, ItemAvatar, LabeledItemAvatar } from './item-avatars'\n\nimport type { MapMarkerRaw } from '#src/components/teyvat-map'\nconst LazyTeyvatMap = import('#src/components/teyvat-map')\n\nexport function getRarityBorder(r: GI_RarityCode): string {\n\treturn r === 5 ? 'border-warning' : 'border-light'\n}\n\nfunction RecommendedFor({ charCodes }: { charCodes: string[] }): JSX.Element {\n\treturn (\n\t\t<>\n\t\t\t<BlockHeader>{I18N_RECOMENDED_FOR}</BlockHeader>\n\t\t\t{charCodes.length\n\t\t\t\t? charCodes.map(c => (\n\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\tsrc={getCharacterAvatarSrc(c)}\n\t\t\t\t\t\t\tclasses={`small-avatar mb-2 me-2 border ${getRarityBorder(4)}`}\n\t\t\t\t\t\t/>\n\t\t\t\t  ))\n\t\t\t\t: I18N_FOR_NOBODY}\n\t\t</>\n\t)\n}\n\n//переключалка для мобильного и десктопного вида\nexport function CardDescMobileWrap({\n\tchildren,\n\ttargetEl,\n\tonClickAway,\n}: {\n\tonClickAway: () => void\n\ttargetEl: HTMLElement | null | undefined\n\tchildren: JSX.Element\n}): JSX.Element {\n\tconst windowSize = useWindowSize()\n\treturn BS_isBreakpointLessThen(windowSize.breakpoint, 'xl') ? (\n\t\t<ItemDetailDdMobilePortal onClickAway={onClickAway}>{children}</ItemDetailDdMobilePortal>\n\t) : (\n\t\t<ItemDetailDdPortal onClickAway={onClickAway} targetEl={targetEl}>\n\t\t\t{children}\n\t\t</ItemDetailDdPortal>\n\t)\n}\n// основной макет карточек\nfunction Card({\n\tclasses = '',\n\ttitleEl,\n\tselectorEl,\n\tbodyEl,\n\tmapEl,\n}: {\n\tclasses?: string\n\ttitleEl: JSX.Nodes | string\n\tselectorEl?: JSX.Nodes\n\tbodyEl?: JSX.Nodes\n\tmapEl?: JSX.Nodes\n}): JSX.Element {\n\treturn (\n\t\t<div className={`item-detail-popover-card card ${classes}`}>\n\t\t\t<h3 className=\"card-header fs-4 d-flex\">\n\t\t\t\t<span className=\"flex-fill\">{titleEl}</span>{' '}\n\t\t\t\t<DdContext.Consumer>\n\t\t\t\t\t{ddContext =>\n\t\t\t\t\t\tddContext.onClickAway && (\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclass=\"fs-4 lh-1 opacity-75 float-end ps-2 mt-1 c-pointer\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonClick={ddContext.onClickAway}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{TIMES}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t</DdContext.Consumer>\n\t\t\t</h3>\n\t\t\t{selectorEl && <div class=\"p-3\">{selectorEl}</div>}\n\t\t\t<div\n\t\t\t\tclassName={`card-body overflow-auto flex-shrink-1 hide-if-empty mb-3 pb-0 ${\n\t\t\t\t\tselectorEl ? 'pt-0' : ''\n\t\t\t\t}`}\n\t\t\t>\n\t\t\t\t{bodyEl}\n\t\t\t</div>\n\t\t\t{mapEl}\n\t\t</div>\n\t)\n}\n\ntype MapWrapMarkerGroup = {\n\tcode: string\n\ttitle: string\n\tmarkers: 'external' | MapMarkerRaw[]\n}\n\nfunction addMarkerGroupsByDomains(\n\tmarkerGroups: MapWrapMarkerGroup[],\n\tdomains: { code: string; name: string; type: GI_DomainTypeCode; location: MapLocation }[],\n) {\n\tfor (const domain of domains) {\n\t\tconst loc = domain.location\n\t\tconst icon = getDomainIconSrc(domain.type)\n\t\tmarkerGroups.push({ code: domain.code, title: domain.name, markers: [{ ...loc, icon }] })\n\t}\n}\nfunction addMarkerGroupsByEnemies(\n\tmarkerGroups: MapWrapMarkerGroup[],\n\tenemies: { code: string; name: string; locations: 'external' | MapLocation[] }[],\n) {\n\tfor (const enemy of enemies) {\n\t\tconst markers =\n\t\t\tenemy.locations === 'external'\n\t\t\t\t? 'external'\n\t\t\t\t: enemy.locations.map((loc): MapMarkerRaw => {\n\t\t\t\t\t\tconst icon = getEnemyIconSrc(enemy.code)\n\t\t\t\t\t\treturn { ...loc, icon, style: 'circle' }\n\t\t\t\t  })\n\t\tmarkerGroups.push({ code: enemy.code, title: enemy.name, markers })\n\t}\n}\n\nfunction MapWrap({\n\titemData,\n\tmarkerGroups,\n\tisItemFavable,\n}: {\n\titemData?: {\n\t\timgSrc: string\n\t\titem: ItemShortInfo | ArtifactFullInfo | WeaponFullInfo\n\t}\n\tmarkerGroups: MapWrapMarkerGroup[]\n\tisItemFavable?: boolean\n}): JSX.Element {\n\tconst [selectedSource, setSelectedSource] = useSelectable(markerGroups)\n\n\tconst [selectedMapCode, setMapCode] = useState<MapCode>(GI_MAP_CODES[0])\n\tconst TeyvatMap = useFetch(() => LazyTeyvatMap.then(x => x.TeyvatMap), [])\n\n\tconst setSourceAndFixMapCode = (selectedSource: MapWrapMarkerGroup) => {\n\t\tif (\n\t\t\tselectedSource.markers !== 'external' &&\n\t\t\t!selectedSource.markers.find(m => m.mapCode === selectedMapCode)\n\t\t)\n\t\t\tsetMapCode(selectedSource.markers[0].mapCode)\n\t\tsetSelectedSource(selectedSource)\n\t}\n\tconst goToPrevGroup = () => {\n\t\tsetSourceAndFixMapCode(arrGetAfter(markerGroups, selectedSource, -1))\n\t}\n\tconst goToNextGroup = () => {\n\t\tsetSourceAndFixMapCode(arrGetAfter(markerGroups, selectedSource))\n\t}\n\n\tlet sourceSelectEl\n\tif (!markerGroups.length) {\n\t\tsourceSelectEl = null\n\t} else if (markerGroups.length === 1) {\n\t\tsourceSelectEl = <span className=\"align-self-center lh-1 small\">{markerGroups[0].title}</span>\n\t} else if (markerGroups.length < 3) {\n\t\tsourceSelectEl = (\n\t\t\t<BtnTabGroup\n\t\t\t\ttabs={markerGroups}\n\t\t\t\tselectedTab={selectedSource}\n\t\t\t\tonTabSelect={setSourceAndFixMapCode}\n\t\t\t\tclasses=\"w-100\"\n\t\t\t/>\n\t\t)\n\t} else {\n\t\tsourceSelectEl = (\n\t\t\t<div className=\"btn-group w-100\">\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"btn btn-secondary border-dark border-end-0 text-muted fs-4 lh-1\"\n\t\t\t\t\tonClick={goToPrevGroup}\n\t\t\t\t>\n\t\t\t\t\t{LEFT_POINTING}\n\t\t\t\t</button>\n\t\t\t\t<SimpleSelect\n\t\t\t\t\toptions={markerGroups}\n\t\t\t\t\tselectedOption={selectedSource}\n\t\t\t\t\tonOptionSelect={setSourceAndFixMapCode}\n\t\t\t\t\tclasses=\"w-100 rounded-0\"\n\t\t\t\t/>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"btn btn-secondary border-dark border-start-0 text-muted fs-4 lh-1\"\n\t\t\t\t\tonClick={goToNextGroup}\n\t\t\t\t>\n\t\t\t\t\t{RIGHT_POINTING}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t)\n\t}\n\tconst visibleMapCodes = useMemo(\n\t\t() =>\n\t\t\tGI_MAP_CODES.filter(\n\t\t\t\tc =>\n\t\t\t\t\tselectedSource.markers !== 'external' &&\n\t\t\t\t\tselectedSource.markers.some(m => m.mapCode === c),\n\t\t\t),\n\t\t[selectedSource],\n\t)\n\tconst isItemWeaponPrimaryMaterial = useMemo(\n\t\t() =>\n\t\t\titemData?.item &&\n\t\t\t'types' in itemData.item &&\n\t\t\t~itemData?.item.types?.indexOf('weapon-material-primary'),\n\t\t[itemData?.item],\n\t)\n\treturn (\n\t\t<div className={`map-wrap position-relative mb-3`}>\n\t\t\t<div className=\"map-header position-absolute d-flex flex-row justify-content-between px-3 py-1 w-100\">\n\t\t\t\t<div className=\"map-header-bg position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-75\"></div>\n\t\t\t\t{itemData && (\n\t\t\t\t\t<div className=\"me-2 flex-shrink-1 d-flex align-self-center\">\n\t\t\t\t\t\t{isItemWeaponPrimaryMaterial && isItemFavable ? (\n\t\t\t\t\t\t\t<ToggleWeaponPrimaryMaterialFav\n\t\t\t\t\t\t\t\titemCode={itemData.item.code}\n\t\t\t\t\t\t\t\tclasses=\"align-self-center p-1 flex-fill fs-5\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t<LabeledItemAvatar\n\t\t\t\t\t\t\tclasses=\"small-avatar small\"\n\t\t\t\t\t\t\tavatarClasses=\"with-padding \"\n\t\t\t\t\t\t\timgSrc={itemData.imgSrc}\n\t\t\t\t\t\t\ttitle={itemData.item.name}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{markerGroups.length ? (\n\t\t\t\t\t<div className={`d-flex flex-fill justify-content-end align-self-center`}>\n\t\t\t\t\t\t<label className=\"me-1 text-muted align-self-center small\">{I18N_SOURCE}:</label>\n\t\t\t\t\t\t{sourceSelectEl}\n\t\t\t\t\t</div>\n\t\t\t\t) : null}\n\t\t\t</div>\n\t\t\t<div className=\"map-tip position-absolute px-3 pt-1 lh-1 top-100 start-0 small text-muted opacity-75 user-select-none\">\n\t\t\t\t{visibleMapCodes.map(c => (\n\t\t\t\t\t<div className=\"d-inline me-2\" key={c} onClick={() => setMapCode(c)}>\n\t\t\t\t\t\t{visibleMapCodes.length > 1 ? (\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tclassName=\"lh-1 align-middle c-pointer me-1\"\n\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\tid={c}\n\t\t\t\t\t\t\t\tchecked={c === selectedMapCode}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t<label\n\t\t\t\t\t\t\tclassName={`lh-1 align-middle text-capitalize ${\n\t\t\t\t\t\t\t\tvisibleMapCodes.length > 1 ? 'c-pointer' : ''\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\tfor={c}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{I18N_MAP_CODES_NAME[c]}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t\t<div className=\"map-tip position-absolute px-3 pt-1 lh-1 top-100 end-0 small text-muted opacity-75 pe-none\">\n\t\t\t\t<div class=\"d-none d-xl-block\">{I18N_SCROLL_TO_ZOOM}</div>\n\t\t\t\t<div class=\"d-xl-none\">{I18N_PINCH_TO_ZOOM}</div>\n\t\t\t</div>\n\t\t\t{selectedSource.markers !== 'external' && isLoaded(TeyvatMap) ? (\n\t\t\t\t<TeyvatMap\n\t\t\t\t\tclasses=\"position-relative\"\n\t\t\t\t\tpos=\"auto\"\n\t\t\t\t\tmapCode={selectedMapCode}\n\t\t\t\t\tmarkers={selectedSource.markers}\n\t\t\t\t/>\n\t\t\t) : TeyvatMap instanceof Error ? (\n\t\t\t\t<div>{I18N_ERROR}.</div>\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nexport function ArtifactCard({\n\tclasses,\n\tartifacts,\n\trelated,\n\ttitle,\n}: {\n\tclasses?: string\n\tartifacts: ArtifactFullInfo[]\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n\ttitle: string\n}): JSX.Element {\n\tconst [selectedArt, setSelectedArt] = useSelectable(artifacts)\n\n\tconst dataForMap = useMemo(() => {\n\t\tconst srcs = selectedArt.obtainSources\n\t\tconst markerGroups = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: selectedArt,\n\t\t\t\timgSrc: getArtifactIconSrc(selectedArt.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [selectedArt, related])\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={title}\n\t\t\tclasses={classes}\n\t\t\tselectorEl={\n\t\t\t\tartifacts.length > 1 ? (\n\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\ttabs={artifacts}\n\t\t\t\t\t\ttitleFunc={tabTitleFromName}\n\t\t\t\t\t\tselectedTab={selectedArt}\n\t\t\t\t\t\tonTabSelect={setSelectedArt}\n\t\t\t\t\t\tclasses=\"w-100\"\n\t\t\t\t\t/>\n\t\t\t\t) : null\n\t\t\t}\n\t\t\tbodyEl={\n\t\t\t\t<div className=\"\">\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\trarity={selectedArt.rarity}\n\t\t\t\t\t\tclasses=\"float-end me-2 large-avatar\"\n\t\t\t\t\t\tsrc={getArtifactIconLargeSrc(selectedArt.code)}\n\t\t\t\t\t/>\n\t\t\t\t\t{selectedArt.sets[1] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECE_BONUS(1)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[1])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{selectedArt.sets[2] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(2)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[2])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{selectedArt.sets[4] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(4)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[4])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{<RecommendedFor charCodes={selectedArt.recommendedTo} />}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <MapWrap {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n\nexport function WeaponCard({\n\tclasses,\n\tweapon,\n\trelated,\n}: {\n\tonCloseClick?: () => void\n\tclasses?: string\n\tweapon: WeaponFullInfo\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n}): JSX.Element {\n\tconst materials = getAllRelated(related.items, weapon.materialCodes)\n\tconst [materialOnMap, setMaterialOnMap] = useState(materials[0])\n\tconst dataForMap = useMemo(() => {\n\t\tconst srcs = materialOnMap.obtainSources\n\t\tconst markerGroups = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: materialOnMap,\n\t\t\t\timgSrc: getItemIconSrc(materialOnMap.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [materialOnMap, related])\n\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={\n\t\t\t\tweapon.name\n\t\t\t\t// <>\n\t\t\t\t// \t{weapon.name}{' '}\n\t\t\t\t// \t{ascMaterial && (\n\t\t\t\t// \t\t<ToggleWeaponFav\n\t\t\t\t// \t\t\tweaponCode={weapon.code}\n\t\t\t\t// \t\t\tweapMatCode={ascMaterial.code}\n\t\t\t\t// \t\t\tclasses=\"d-inline align-middle p-1\"\n\t\t\t\t// \t\t/>\n\t\t\t\t// \t)}\n\t\t\t\t// </>\n\t\t\t}\n\t\t\tclasses={classes}\n\t\t\tbodyEl={\n\t\t\t\t<div className=\"\">\n\t\t\t\t\t<div className=\"float-end\">\n\t\t\t\t\t\t<div className=\"d-flex w-100 justify-content-around\">\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\t\tclasses=\"mb-2 large-avatar\"\n\t\t\t\t\t\t\t\tsrc={getWeaponIconLageSrc(weapon.code)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"d-flex justify-content-between w-100\">\n\t\t\t\t\t\t\t{materials.map(m => (\n\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\tkey={m.code}\n\t\t\t\t\t\t\t\t\trarity={2}\n\t\t\t\t\t\t\t\t\tclasses=\"mb-2 mx-1 small-avatar with-padding\"\n\t\t\t\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\t\t\t\tonClick={() => setMaterialOnMap(m)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden\">\n\t\t\t\t\t\t<BlockHeader classes=\"d-inline-block me-1\">\n\t\t\t\t\t\t\t{I18N_WEAPON_TYPE_NAME(weapon.typeCode)}\n\t\t\t\t\t\t</BlockHeader>\n\t\t\t\t\t\t<span className=\"mb-2 text-muted\">\n\t\t\t\t\t\t\t{BULLET} {weapon.obtainSources.map(I18N_WEAPON_OBTAIN_SOURCE_NAME).join(', ')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t\t<div className=\"me-2\">\n\t\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_BASE_ATTACK}</div>\n\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t{weapon.atk.base} / {weapon.atk.max}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{weapon.subStat && (\n\t\t\t\t\t\t\t<div className=\"ms-1\">\n\t\t\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_STAT_NAME(weapon.subStat.code)}</div>\n\t\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t\t{weapon.subStat.base} / {weapon.subStat.max}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t<span className=\"opacity-75\">{I18N_SECONDARY_STAT}</span>\n\t\t\t\t\t\t<div className=\"\">{notesToJSX(weapon.passiveStat)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<RecommendedFor charCodes={weapon.recommendedTo} />\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <MapWrap isItemFavable={true} {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n\nexport function OtherItemCard({\n\tclasses,\n\titem,\n\trelated,\n}: {\n\tonCloseClick?: () => void\n\tclasses?: string\n\titem: ItemShortInfo\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n}): JSX.Element {\n\tconst materials = getAllRelated(related.items, [item.code])\n\tconst materialOnMap = materials[0]\n\tconst dataForMap = useMemo(() => {\n\t\tconst markerGroups: MapWrapMarkerGroup[] = []\n\t\tconst srcs = materialOnMap.obtainSources\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\t\tif (materialOnMap.locations.length > 0) {\n\t\t\tconst icon = getItemIconSrc(materialOnMap.code)\n\t\t\tconst markers =\n\t\t\t\tmaterialOnMap.locations === 'external'\n\t\t\t\t\t? 'external'\n\t\t\t\t\t: materialOnMap.locations.map((loc): MapMarkerRaw => ({ ...loc, icon, style: 'outline' }))\n\t\t\tmarkerGroups.push({ code: materialOnMap.code, title: materialOnMap.name, markers })\n\t\t}\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: materialOnMap,\n\t\t\t\timgSrc: getItemIconSrc(materialOnMap.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [materialOnMap, related])\n\n\tconst isItemCharTalentMaterial = useMemo(() => ~item.types.indexOf('character-material-talent'), [item])\n\tconst isItemWeaponPrimaryMaterial = useMemo(() => ~item.types.indexOf('weapon-material-primary'), [item])\n\tconst codesForCalc = useMemo(() => {\n\t\treturn [...item.ancestryCodes.reverse(), item.code]\n\t}, [item])\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={\n\t\t\t\t<>\n\t\t\t\t\t{item.name}{' '}\n\t\t\t\t\t{isItemCharTalentMaterial ? (\n\t\t\t\t\t\t<ToggleTalentMaterialFav itemCode={item.code} classes=\"d-inline align-middle p-1\" />\n\t\t\t\t\t) : null}\n\t\t\t\t\t{isItemWeaponPrimaryMaterial ? (\n\t\t\t\t\t\t<ToggleWeaponPrimaryMaterialFav\n\t\t\t\t\t\t\titemCode={item.code}\n\t\t\t\t\t\t\tclasses=\"d-inline align-middle p-1\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : null}\n\t\t\t\t</>\n\t\t\t}\n\t\t\tclasses={classes}\n\t\t\tbodyEl={\n\t\t\t\titem.code === 'brilliant-diamond-gemstone' ? (\n\t\t\t\t\tI18N_OBTAINED_DURING_STORYLINE\n\t\t\t\t) : item.ancestryCodes.length > 0 ? (\n\t\t\t\t\t<div className=\"\">\n\t\t\t\t\t\t{/* <ItemAvatar rarity={3} classes=\"large-avatar float-end\" src={getItemIconSrc(item.code)} /> */}\n\t\t\t\t\t\t{/* <BlockHeader>Описание</BlockHeader>\n\t\t\t\t<div className=\"mb-3\">{notesToJSX()}</div> */}\n\t\t\t\t\t\t<BlockHeader>{I18N_ALCHEMY_CALC}</BlockHeader>\n\t\t\t\t\t\t<AlchemyCalculator ancestryCodes={codesForCalc} />\n\t\t\t\t\t</div>\n\t\t\t\t) : null\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <MapWrap {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n","import { createContext } from 'preact'\nimport { useCallback, useContext, useRef, useState } from 'preact/hooks'\n\nimport { ART_GROUP_DETAILS, GI_RarityCode } from '#lib/genshin'\nimport {\n\tArtifactFullInfo,\n\tDomainShortInfo,\n\tEnemyShortInfo,\n\tItemShortInfo,\n\tWeaponFullInfo,\n} from '#lib/parsing/combine'\nimport { mustBeNever } from '#src/../../lib/utils/values'\nimport { A } from '#src/routes/router'\nimport { getAllArtifacts } from '#src/utils/artifacts'\nimport { ArtifactCard, CardDescMobileWrap, WeaponCard } from './dd-cards'\n\nimport './item-cards.scss'\n\nexport function ItemAvatar({\n\tsrc,\n\trarity,\n\tclasses = '',\n\thref,\n\tonClick,\n\tbadgeTopStart,\n\tbadgeTopEnd,\n\tddComponent,\n}: {\n\tsrc: string\n\trarity?: GI_RarityCode\n\tclasses?: string\n\thref?: string\n\tonClick?(): unknown\n\tbadgeTopStart?: string | null | JSX.Node\n\tbadgeTopEnd?: string | null | JSX.Node\n\tddComponent?: JSX.Element\n}): JSX.Element {\n\t;['bg-2', 'bg-3', 'bg-4', 'bg-5']\n\tconst rarityClass = rarity ? 'bg-' + rarity : 'bg-dark'\n\n\tconst elRef = useRef<HTMLAnchorElement>(null)\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst closeDd = useCallback(() => isExpanded && setIsExpanded(false), [setIsExpanded, isExpanded])\n\tconst openDd = useCallback(() => !isExpanded && setIsExpanded(true), [setIsExpanded, isExpanded])\n\tconst pointerClass = ddComponent || onClick ? 'c-pointer' : ''\n\tconst onClickLocal = useCallback(() => {\n\t\topenDd && openDd()\n\t\tonClick && onClick()\n\t}, [openDd, onClick])\n\treturn (\n\t\t<DdContext.Provider value={{ onClickAway: closeDd }}>\n\t\t\t<A\n\t\t\t\thref={href}\n\t\t\t\tclassName={`item-avatar position-relative rounded-circle d-inline-block ${pointerClass} ${rarityClass} ${classes}`}\n\t\t\t\tinnerRef={elRef}\n\t\t\t\tonClick={onClickLocal}\n\t\t\t>\n\t\t\t\t<img className=\"image\" src={src} />\n\t\t\t\t{badgeTopStart && (\n\t\t\t\t\t<span className=\"position-absolute top-0 start-0 translate-middle badge rounded-pill opacity-75 small\">\n\t\t\t\t\t\t{badgeTopStart}\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\t\t\t\t{badgeTopEnd && (\n\t\t\t\t\t<span className=\"position-absolute top-0 start-100 translate-middle badge rounded-pill opacity-75 small\">\n\t\t\t\t\t\t{badgeTopEnd}\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\t\t\t\t{/* <span className=\"position-absolute top-0 start-0 translate-middle badge rounded-pill bg-primary border border-light\">\n\t\t\t\t4\n\t\t\t</span> */}\n\t\t\t\t{isExpanded && elRef.current && ddComponent && (\n\t\t\t\t\t<CardDescMobileWrap onClickAway={closeDd} targetEl={elRef.current}>\n\t\t\t\t\t\t{ddComponent}\n\t\t\t\t\t</CardDescMobileWrap>\n\t\t\t\t)}\n\t\t\t</A>\n\t\t</DdContext.Provider>\n\t)\n}\n\nfunction ItemLabel({\n\trarity,\n\tclasses = '',\n\tchildren,\n}: {\n\trarity?: GI_RarityCode | null\n\tclasses?: string\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst rarityClass =\n\t\trarity === 5 //\n\t\t\t? 'text-warning'\n\t\t\t: rarity === 4\n\t\t\t? 'text-primary'\n\t\t\t: ''\n\t//todo c-pointer text-decoration-underline-dotted для интерактивных\n\treturn <label class={`${classes} ${rarityClass}`}>{children}</label>\n}\n\nfunction ItemDd({\n\tclasses = '',\n\tchildren,\n\tddComponent,\n}: {\n\tclasses?: string\n\tddComponent?: JSX.Element | null\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst elRef = useRef<HTMLButtonElement>(null)\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\n\tconst closeDd = useCallback(() => setIsExpanded(false), [])\n\tconst openDd = useCallback(() => setIsExpanded(true), [])\n\n\tconst pointerClass = ddComponent ? 'c-pointer' : ''\n\treturn (\n\t\t<DdContext.Provider value={{ onClickAway: closeDd }}>\n\t\t\t<button\n\t\t\t\tclassName={`btn-reset ${pointerClass} ${classes}`}\n\t\t\t\tref={elRef}\n\t\t\t\tonClick={openDd}\n\t\t\t\tdisabled={!ddComponent}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t\t{isExpanded && elRef.current && ddComponent && (\n\t\t\t\t\t<CardDescMobileWrap onClickAway={closeDd} targetEl={elRef.current}>\n\t\t\t\t\t\t{ddComponent}\n\t\t\t\t\t</CardDescMobileWrap>\n\t\t\t\t)}\n\t\t\t</button>\n\t\t</DdContext.Provider>\n\t)\n}\n\nexport const ItemsDataContext = createContext({\n\tweapons: new Map<string, WeaponFullInfo>(),\n\tartifacts: new Map<string, ArtifactFullInfo>(),\n\tdomains: new Map<string, DomainShortInfo>(),\n\tenemies: new Map<string, EnemyShortInfo>(),\n\titems: new Map<string, ItemShortInfo>(),\n})\n\nexport function ItemDetailsLabel({\n\tclasses = '',\n\ttype,\n\tcode,\n\tchildren,\n}: {\n\tclasses?: string\n\ttype: 'weapon' | 'artifact'\n\tcode: string\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst maps = useContext(ItemsDataContext)\n\n\tlet ddComp: JSX.Element | undefined = undefined\n\tlet rarity: GI_RarityCode | undefined = undefined\n\tif (type === 'weapon') {\n\t\tconst weapon = maps.weapons.get(code)\n\t\tif (weapon) {\n\t\t\tddComp = <WeaponCard weapon={weapon} related={maps} />\n\t\t\trarity = weapon.rarity\n\t\t}\n\t} else if (type === 'artifact') {\n\t\tconst artifacts = getAllArtifacts(code, maps.artifacts)\n\t\tif (artifacts.length > 0) {\n\t\t\tconst details = ART_GROUP_DETAILS[code] ?? artifacts[0]\n\t\t\tddComp = <ArtifactCard title={details.name} artifacts={artifacts} related={maps} />\n\t\t\trarity = artifacts[0].rarity\n\t\t}\n\t} else mustBeNever(type)\n\n\tconst interactiveLabelClass = ddComp ? 'text-decoration-underline-dotted' : ''\n\treturn (\n\t\t<ItemDd ddComponent={ddComp} classes={`d-inline ${classes}`}>\n\t\t\t<ItemLabel classes={`${interactiveLabelClass} c-inherit`} rarity={rarity}>\n\t\t\t\t{children}\n\t\t\t</ItemLabel>\n\t\t</ItemDd>\n\t)\n}\n\nexport const DdContext = createContext({\n\tonClickAway: () => {\n\t\treturn\n\t},\n})\n\nexport function LabeledItemAvatar({\n\timgSrc,\n\trarity,\n\tclasses = '',\n\tavatarClasses = '',\n\ttitle,\n\tavatarTopStartBadge,\n\tavatarTopEndBadge,\n\tddComponent,\n}: {\n\timgSrc: string\n\trarity?: GI_RarityCode\n\ttitle: string\n\tclasses?: string\n\tavatarClasses?: string\n\tavatarTopStartBadge?: string\n\tavatarTopEndBadge?: string\n\tddComponent?: JSX.Element\n}): JSX.Element {\n\tconst interactiveLabelClass = ddComponent ? 'text-decoration-underline-dotted' : ''\n\treturn (\n\t\t<ItemDd ddComponent={ddComponent} classes={`w-100 text-nowrap ${classes}`}>\n\t\t\t<ItemAvatar\n\t\t\t\tclasses={`small-avatar align-middle ${avatarClasses}`}\n\t\t\t\tsrc={imgSrc}\n\t\t\t\tbadgeTopStart={avatarTopStartBadge}\n\t\t\t\tbadgeTopEnd={avatarTopEndBadge}\n\t\t\t/>\n\t\t\t<ItemLabel\n\t\t\t\tclasses={'text-wrap align-middle lh-1 ps-1 mw-75 c-inherit ' + interactiveLabelClass}\n\t\t\t\trarity={rarity}\n\t\t\t>\n\t\t\t\t{title}\n\t\t\t</ItemLabel>\n\t\t</ItemDd>\n\t)\n}\n","export default __webpack_public_path__ + \"Element_Anemo.f809fde3.png\";","export default __webpack_public_path__ + \"Element_Cryo.019d72f9.png\";","export default __webpack_public_path__ + \"Element_Electro.342332ac.png\";","export default __webpack_public_path__ + \"Element_Geo.94f4e68a.png\";","export default __webpack_public_path__ + \"Element_Hydro.f2f8bd8a.png\";","export default __webpack_public_path__ + \"Element_Pyro.f65c2e38.png\";","import element_Anemo from '#src/media/Element_Anemo.png'\n// import element_Dendro from '#src/media/Element_Dendro.png'\nimport element_Cryo from '#src/media/Element_Cryo.png'\nimport element_Electro from '#src/media/Element_Electro.png'\nimport element_Geo from '#src/media/Element_Geo.png'\nimport element_Hydro from '#src/media/Element_Hydro.png'\nimport element_Pyro from '#src/media/Element_Pyro.png'\n\nimport type { GI_ElementCode } from '#lib/genshin'\n\nexport type GI_Element = { readonly code: GI_ElementCode; imgSrc: string }\nexport const elements: GI_Element[] = [\n\t{ code: 'pyro' as const, imgSrc: element_Pyro },\n\t{ code: 'hydro' as const, imgSrc: element_Hydro },\n\t{ code: 'anemo' as const, imgSrc: element_Anemo },\n\t{ code: 'electro' as const, imgSrc: element_Electro },\n\t// { code: 'dendro' as const , imgSrc: element_Dendro },\n\t{ code: 'cryo' as const, imgSrc: element_Cryo },\n\t{ code: 'geo' as const, imgSrc: element_Geo },\n]\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { GI_ElementCode, GI_WeaponTypeCode } from '#lib/genshin'\nimport { charactersShortList } from '#src/api/generated'\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { elements } from '#src/utils/elements'\nimport { weaponTypes } from '#src/utils/weapons'\n\nexport function CharacterPickerMobile() {\n\tconst [selectedElementCode, setSelectedElementCode] = useState<null | GI_ElementCode>(null)\n\tconst selectElement = el => setSelectedElementCode(selectedElementCode === el.code ? null : el.code)\n\tconst [selectedWeaponTypeCode, setSelectedWeaponTypeCode] = useState<null | GI_WeaponTypeCode>(null)\n\n\tconst selectWeaponType = wp =>\n\t\tsetSelectedWeaponTypeCode(selectedWeaponTypeCode === wp.code ? null : wp.code)\n\n\tconst elementGroups = useMemo(() => {\n\t\tconst filteredElements = selectedElementCode\n\t\t\t? elements.filter(x => x.code === selectedElementCode)\n\t\t\t: elements\n\t\treturn filteredElements\n\t\t\t.map(element => ({\n\t\t\t\telement,\n\t\t\t\tcharacters: charactersShortList.filter(\n\t\t\t\t\tx =>\n\t\t\t\t\t\tx.elementCode === element.code &&\n\t\t\t\t\t\t(selectedWeaponTypeCode === null || x.weaponTypeCode === selectedWeaponTypeCode),\n\t\t\t\t),\n\t\t\t}))\n\t\t\t.filter(x => x.characters.length > 0)\n\t}, [selectedElementCode, selectedWeaponTypeCode])\n\n\tconst rows = elementGroups.map(({ element, characters }) => (\n\t\t<div className=\"row py-2\" key={element.code}>\n\t\t\t<div className=\"col-2 py-1\">\n\t\t\t\t<img className=\"rounded-circle d-block mx-auto muted-icon\" src={element.imgSrc} />\n\t\t\t</div>\n\t\t\t<div className=\"col py-31\">\n\t\t\t\t{characters.map(x => (\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tsrc={getCharacterAvatarSrc(x.code)}\n\t\t\t\t\t\t// rarity={x.rarity}\n\t\t\t\t\t\thref={'/builds/' + x.code}\n\t\t\t\t\t\tclasses={`m-1 border ${x.rarity === 5 ? 'border-warning' : 'border-light'}`}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t))\n\n\treturn (\n\t\t<div className=\"character-picker-mobile\">\n\t\t\t<div className=\"m-auto text-center my-3\">\n\t\t\t\t<div className=\"m-auto\">Filter </div>\n\t\t\t\t<div className=\"d-inline\">\n\t\t\t\t\t<div className=\"d-inline\">\n\t\t\t\t\t\t{elements.map(el => (\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tclassName={`character-avatar small-avatar rounded-circle bg-secondary p-1 m-1 ${\n\t\t\t\t\t\t\t\t\tselectedElementCode && selectedElementCode !== el.code ? 'opacity-25' : ''\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\tkey={el.code}\n\t\t\t\t\t\t\t\tsrc={el.imgSrc}\n\t\t\t\t\t\t\t\tonClick={() => selectElement(el)} //todo почему без стрелки тайпскрипт не пускает?\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<br />\n\t\t\t\t\t<div className=\"d-inline\">\n\t\t\t\t\t\t{weaponTypes.map(wt => (\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tclassName={`character-avatar small-avatar rounded-circle bg-secondary p-1 m-1 ${\n\t\t\t\t\t\t\t\t\tselectedWeaponTypeCode && selectedWeaponTypeCode !== wt.code\n\t\t\t\t\t\t\t\t\t\t? 'opacity-25'\n\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\tkey={wt.code}\n\t\t\t\t\t\t\t\tsrc={wt.imgSrc}\n\t\t\t\t\t\t\t\tonClick={() => selectWeaponType(wt)} //todo почему без стрелки тайпскрипт не пускает?\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{rows.length === 0 ? 'not yet' : rows}\n\t\t</div>\n\t)\n}\n","import { charactersShortList } from '#src/api/generated'\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { elements } from '#src/utils/elements'\nimport { GI_WeaponType, weaponTypes } from '#src/utils/weapons'\nimport { getRarityBorder } from '../item-cards/dd-cards'\nimport { CharacterPickerMobile } from './mobile-character-picker'\n\nimport './character-picker.scss'\n\nfunction CharacterPickerDesktop({ weaponTypes }: { weaponTypes: GI_WeaponType[] }) {\n\treturn (\n\t\t<>\n\t\t\t{elements.map((el, i, arr) => {\n\t\t\t\tconst isLastRowClass = i + 1 === arr.length ? 'rounded-bottom' : ''\n\t\t\t\treturn (\n\t\t\t\t\t<div className=\"row\" key={el.code}>\n\t\t\t\t\t\t<div className=\"col col-2 pt-3 pb-2 opacity-50 rounded-start\">\n\t\t\t\t\t\t\t<img className=\"rounded-circle d-block mx-auto\" src={el.imgSrc} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{weaponTypes.map(wType => (\n\t\t\t\t\t\t\t<div className={`col col-2 pt-3 pb-2 px-2 ${isLastRowClass}`} key={wType.code}>\n\t\t\t\t\t\t\t\t{charactersShortList\n\t\t\t\t\t\t\t\t\t.filter(x => x.elementCode === el.code && x.weaponTypeCode === wType.code)\n\t\t\t\t\t\t\t\t\t.map(x => (\n\t\t\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\t\t\tkey={x.code}\n\t\t\t\t\t\t\t\t\t\t\tsrc={getCharacterAvatarSrc(x.code)}\n\t\t\t\t\t\t\t\t\t\t\t// rarity={x.rarity}\n\t\t\t\t\t\t\t\t\t\t\thref={'/builds/' + x.code}\n\t\t\t\t\t\t\t\t\t\t\tclasses={`mb-1 me-1 mb-xxl-2 me-xxl-2 border ${getRarityBorder(\n\t\t\t\t\t\t\t\t\t\t\t\tx.rarity,\n\t\t\t\t\t\t\t\t\t\t\t)}`}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t})}\n\t\t</>\n\t)\n}\n\nexport function CharacterPicker() {\n\treturn (\n\t\t<div className=\"character-picker\">\n\t\t\t<div class=\"d-none d-xl-block container overflow-hidden big-table\">\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-2 pb-3 pt-2\"></div>\n\t\t\t\t\t{weaponTypes.map((wt, i) => (\n\t\t\t\t\t\t<div className=\"col col-2 pb-3 pt-2 rounded-top \" key={wt.code}>\n\t\t\t\t\t\t\t<img className=\"rounded-circle d-block mx-auto\" src={wt.imgSrc} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t\t<CharacterPickerDesktop weaponTypes={weaponTypes} />\n\t\t\t</div>\n\t\t\t<div class=\"d-xl-none\">\n\t\t\t\t<CharacterPickerMobile />\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { useEffect, useMemo } from 'preact/hooks'\n\nimport { charactersShortList } from '#src/api/generated'\nimport { I18N_FAV_CHARACTERS } from '#src/i18n/i18n'\nimport { MAX_SMTHS_TO_STORE } from '#src/modules/builds/common'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { elements } from '#src/utils/elements'\nimport { useLocalStorage } from '#src/utils/hooks'\nimport { ItemAvatar } from '../item-cards/item-avatars'\n\nconst codeToBadge = (code: string) => {\n\tconst e = elements.find(e => code === `traveler-${e.code}`)\n\treturn e ? <img className=\"badge-element-icon d-block ms-n1 mb-n1\" src={e.imgSrc} /> : null\n}\n\nexport function FavoriteCharacters({\n\tclasses = '',\n\tonCharacterSelect,\n\tshoudSelectFirst,\n\tnavigateToCharacter,\n}: {\n\tclasses?: string\n\tonCharacterSelect?(characterCode: string): void\n\tshoudSelectFirst?: boolean\n\tnavigateToCharacter: boolean\n}): JSX.Element {\n\tconst [favCharCodes] = useLocalStorage<string[]>('favoriteCharacterCodes', [])\n\t//todo sort characters by release date\n\tconst charactersShortListCodes = useMemo(\n\t\t() => charactersShortList.map(c => c.code).filter(c => (~favCharCodes.indexOf(c) ? false : c)),\n\t\t[favCharCodes],\n\t)\n\tconst characterCodes =\n\t\tfavCharCodes.length < MAX_SMTHS_TO_STORE\n\t\t\t? favCharCodes.concat(charactersShortListCodes.slice(0, MAX_SMTHS_TO_STORE - favCharCodes.length))\n\t\t\t: favCharCodes.slice(0, MAX_SMTHS_TO_STORE)\n\t// const optsForSelect = useMemo(\n\t// \t//todo выпилить или вставить нормальные имена\n\t// \t() =>\n\t// \t\t(characterCodes.length > 4 ? characterCodes.slice(4, characterCodes.length) : []).map(c => {\n\t// \t\t\treturn { title: c, code: c }\n\t// \t\t}),\n\t// \t[characterCodes],\n\t// )\n\t// const onSelectViaSelect = useCallback(\n\t// \topt => {\n\t// \t\tonCharacterSelect && onCharacterSelect(opt.code)\n\t// \t},\n\t// \t[onCharacterSelect],\n\t// )\n\n\tuseEffect(() => {\n\t\tshoudSelectFirst && onCharacterSelect && onCharacterSelect(characterCodes[0])\n\t}, [onCharacterSelect, characterCodes, shoudSelectFirst])\n\n\tconst charactersElems = useMemo(\n\t\t() =>\n\t\t\tcharacterCodes.map(code => (\n\t\t\t\t<ItemAvatar\n\t\t\t\t\tsrc={getCharacterAvatarSrc(code)}\n\t\t\t\t\t// rarity={charactersShortList.find(x => x.code === code)?.rarity ?? 5}\n\t\t\t\t\tclasses=\"me-1 small-avatar\"\n\t\t\t\t\tkey={code}\n\t\t\t\t\thref={navigateToCharacter ? '/builds/' + code : undefined}\n\t\t\t\t\tonClick={() => onCharacterSelect && onCharacterSelect(code)}\n\t\t\t\t\tbadgeTopEnd={codeToBadge(code)}\n\t\t\t\t/>\n\t\t\t)),\n\t\t[characterCodes, onCharacterSelect, navigateToCharacter],\n\t)\n\treturn (\n\t\t<div className={`favourite-characters ${classes}`}>\n\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_FAV_CHARACTERS}</label>\n\t\t\t<br className=\"d-xl-none\" />\n\t\t\t{charactersElems}\n\t\t\t{/* {optsForSelect.length ? (\n\t\t\t\t<SimpleSelect\n\t\t\t\t\tclasses=\"d-inline w-auto align-top\"\n\t\t\t\t\toptions={optsForSelect}\n\t\t\t\t\tonOptionSelect={onSelectViaSelect}\n\t\t\t\t\tselectedOption={null}\n\t\t\t\t/>\n\t\t\t) : null} */}\n\t\t</div>\n\t)\n}\n","import './characters.scss'\n\nexport function CharacterPortrait({ src, classes = '' }: { src: string; classes?: string }): JSX.Element {\n\treturn <img className={`character-portrait ${classes}`} src={src} />\n}\n","export function pluralizeEN(n: number, w0: string, w1: string): string {\n\tif (n < 0) n = -n\n\tconst d0 = n % 10\n\tconst d10 = n % 100\n\n\tif (d10 === 11 || d10 === 12 || d0 === 0 || (d0 >= 2 && d0 <= 9)) return w1\n\treturn w0\n}\nexport function pluralizeRU(n: number, w0: string, w1: string, w3: string): string {\n\tif (n < 0) n = -n\n\tif (n % 10 === 1 && n % 100 !== 11) {\n\t\treturn w0\n\t} else if (n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20)) {\n\t\treturn w1\n\t} else {\n\t\treturn w3\n\t}\n\treturn w0\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { arrOrItemToArr } from '#lib/utils/collections'\nimport { CharacterFullInfoWithRelated } from '#src/../../lib/parsing/combine'\nimport { getAllRelated, MapAllByCode } from '#src/api/utils'\nimport { BlockHeader } from '#src/components/block-header'\nimport { CharacterPortrait } from '#src/components/characters'\nimport { CentredSpinner } from '#src/components/spinners'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport { OtherItemCard, WeaponCard } from '#src/containers/item-cards/dd-cards'\nimport { ItemAvatar, ItemsDataContext, LabeledItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport {\n\tI18N_ART_STATS_PRIORITY,\n\tI18N_ART_TYPE,\n\tI18N_ARTIFACTS,\n\tI18N_ASC_MATERIALS,\n\tI18N_BACK,\n\tI18N_CONJUCTIONS,\n\tI18N_NOTES,\n\tI18N_STAT_NAME,\n\tI18N_SUBSTATS_PRIORITY,\n\tI18N_TALENT_NAME,\n\tI18N_TALENTS_PRIORITY,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { A } from '#src/routes/router'\nimport { getArtifactTypeIconSrc } from '#src/utils/artifacts'\nimport {\n\tgetCharacterAvatarLargeSrc,\n\tgetCharacterPortraitSrc,\n\tgetCharacterSilhouetteSrc,\n} from '#src/utils/characters'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { pluralizeEN } from '#src/utils/strings'\nimport { getWeaponIconSrc } from '#src/utils/weapons'\nimport {\n\tBuildRoleOrDummy,\n\tCIRCLET_GOBLET_SANDS,\n\tgenArtifactAdvice,\n\tgenArtMainStatDetail,\n\tgenNotes,\n\tgenSeeCharNotes,\n\tgenSimpleList,\n\tgetRoleData,\n\tItemsJoinerWrap,\n\tItemsListGroupWrap,\n\tmakeRoleTitle,\n\tnotesToJSX,\n\tToggleCharFav,\n} from './common'\n\nimport './character-build-detailed.scss'\n\nexport function CharacterBuildDetailed({\n\tbuild,\n\tisUpdating,\n}: {\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>\n\tisUpdating: boolean\n}): JSX.Element {\n\tconst roleTabs: BuildRoleOrDummy[] = build.character.roles\n\tconst characterCode = build.character.code\n\tconst [selectedRoleTab, setSelectedRoleTab] = useSelectable(roleTabs, [characterCode])\n\n\tconst weaponListBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\t\treturn role.weapons.advices.map((advice, i) => {\n\t\t\tconst isInList = advice.similar.length > 1\n\t\t\tconst map = advice.similar.map((item, i) => {\n\t\t\t\tconst weapon = build.weapons.find(x => x.code === item.code)\n\t\t\t\tif (!weapon) return null\n\t\t\t\tconst isLastInList = i >= advice.similar.length - 1\n\t\t\t\treturn (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<LabeledItemAvatar\n\t\t\t\t\t\t\timgSrc={getWeaponIconSrc(weapon.code)}\n\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\tweapon.name +\n\t\t\t\t\t\t\t\t(item.refine === null ? '' : ` [${item.refine}]`) +\n\t\t\t\t\t\t\t\t(item.stacks === null\n\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t: ` (${item.stacks} ${pluralizeEN(item.stacks, 'stack', 'stacks')})`)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\tavatarClasses=\"with-padding\"\n\t\t\t\t\t\t\tclasses={`small ${!isInList || isLastInList ? 'mb-1' : ''}`}\n\t\t\t\t\t\t\tddComponent={<WeaponCard weapon={weapon} related={build.maps} />}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{genNotes(item)}\n\t\t\t\t\t\t{genSeeCharNotes(item)}\n\t\t\t\t\t\t{isInList && !isLastInList && (\n\t\t\t\t\t\t\t<ItemsJoinerWrap>{I18N_CONJUCTIONS.or}</ItemsJoinerWrap>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</>\n\t\t\t\t)\n\t\t\t})\n\t\t\treturn (\n\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t{isInList ? <ItemsListGroupWrap>{map}</ItemsListGroupWrap> : map}\n\t\t\t\t</li>\n\t\t\t)\n\t\t})\n\t}, [build, selectedRoleTab])\n\n\tconst artifactsListBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\n\t\treturn role.artifacts.sets.map((set, i) => {\n\t\t\treturn (\n\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t{genArtifactAdvice(set.arts, build)}\n\t\t\t\t\t{genNotes(set)}\n\t\t\t\t\t{genSeeCharNotes(set)}\n\t\t\t\t</li>\n\t\t\t)\n\t\t})\n\t}, [build, selectedRoleTab])\n\tconst artifactStatsAndSkillsBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<BlockHeader>{I18N_ART_STATS_PRIORITY}</BlockHeader>\n\t\t\t\t<ul className=\"mb-1 list-unstyled ms-1 small\">\n\t\t\t\t\t{CIRCLET_GOBLET_SANDS.map(ac => (\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tsrc={getArtifactTypeIconSrc(ac)}\n\t\t\t\t\t\t\t\tclasses=\"small-avatar small my-1 mx-1 bg-dark with-padding align-middle\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<b className=\"text-muted\">{I18N_ART_TYPE(ac)} — </b>\n\t\t\t\t\t\t\t{genArtMainStatDetail(role, ac)}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t))}\n\t\t\t\t</ul>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.mainStats.notes)} {genSeeCharNotes(role.mainStats)}\n\t\t\t\t</div>\n\t\t\t\t<BlockHeader classes=\"mt-3\">{I18N_SUBSTATS_PRIORITY}</BlockHeader>\n\t\t\t\t<ol className=\"mb-1 small\">\n\t\t\t\t\t{role.subStats.advices.map(advice => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t{genSimpleList(advice.codes.map(I18N_STAT_NAME))}\n\t\t\t\t\t\t\t\t{' ' + genNotes(advice) + genSeeCharNotes(advice)}\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.subStats.notes)} {genSeeCharNotes(role.subStats)}\n\t\t\t\t</div>\n\t\t\t\t<BlockHeader classes=\"mt-3\">{I18N_TALENTS_PRIORITY}</BlockHeader>\n\t\t\t\t<ol className=\"small\">\n\t\t\t\t\t{role.talents.advices.map(advice => {\n\t\t\t\t\t\treturn <li>{arrOrItemToArr(advice).map(I18N_TALENT_NAME)}</li>\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.talents.notes)} {genSeeCharNotes(role.subStats)}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst notesBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div>{notesToJSX(role.tips)}</div>\n\t\t\t\t<div>{notesToJSX(role.notes)}</div>\n\t\t\t\t<div>{notesToJSX(build.character.credits)}</div>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst materialsBlock = useMemo(() => {\n\t\tconst materials = getAllRelated(build.maps.items, build.character.materialCodes)\n\t\treturn (\n\t\t\t<div className=\"w-100 d-flex flex-wrap justify-content-between\">\n\t\t\t\t{materials.map(m => (\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 mx-1 small-avatar with-padding\"\n\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\tddComponent={<OtherItemCard item={m} related={build.maps} />}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t)\n\t}, [build])\n\tconst CharacterDetailDesktop = (\n\t\t<div className=\"d-none d-xl-block\">\n\t\t\t<div className=\"container\">\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-3 p-0\">\n\t\t\t\t\t\t<A className=\"btn btn-secondary align-self-center\" type=\"submit\" href=\"/builds\">\n\t\t\t\t\t\t\t<span className=\"fs-4 lh-1 opacity-75\">‹ </span> {I18N_BACK}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col col-9\">\n\t\t\t\t\t\t<Tabs\n\t\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-3 pt-3\">\n\t\t\t\t\t\t<div className=\"position-relative\">\n\t\t\t\t\t\t\t<CharacterPortrait src={getCharacterPortraitSrc(characterCode)} classes=\"w-100\" />\n\t\t\t\t\t\t\t<div className=\"mt-3\">{materialsBlock}</div>\n\t\t\t\t\t\t\t<ToggleCharFav\n\t\t\t\t\t\t\t\tclasses=\"fs-3 position-absolute top-0 end-0\"\n\t\t\t\t\t\t\t\tcharacterCode={characterCode}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col col-9\">\n\t\t\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_WEAPONS}</BlockHeader>\n\t\t\t\t\t\t\t\t<ol className=\"items-list\">{weaponListBlock}</ol>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_ARTIFACTS}</BlockHeader>\n\t\t\t\t\t\t\t\t<ol className=\"items-list\">{artifactsListBlock}</ol>\n\t\t\t\t\t\t\t\t<div></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">{artifactStatsAndSkillsBlock}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"w-100\">\n\t\t\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_NOTES}</BlockHeader>\n\t\t\t\t\t\t\t\t<div className=\"text-muted\">{notesBlock}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n\tconst CharacterDetailMobile = (\n\t\t<div className=\"d-xl-none\">\n\t\t\t<CharacterPortrait\n\t\t\t\tsrc={getCharacterSilhouetteSrc(characterCode)}\n\t\t\t\tclasses=\"w-75 character-portrait-mobile\"\n\t\t\t/>\n\t\t\t<BtnTabGroup\n\t\t\t\ttabs={roleTabs}\n\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\tclasses=\"w-100 mt-3 mb-0\"\n\t\t\t/>\n\t\t\t<div className=\"\">\n\t\t\t\t<div className=\"my-3\">\n\t\t\t\t\t<BlockHeader>{I18N_ASC_MATERIALS}</BlockHeader>\n\t\t\t\t\t{materialsBlock}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-3\">\n\t\t\t\t\t<BlockHeader>{I18N_ARTIFACTS}</BlockHeader>\n\t\t\t\t\t<ol className=\"items-list\">{artifactsListBlock}</ol>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-3\">{artifactStatsAndSkillsBlock}</div>\n\t\t\t\t<div className=\"my-3\">\n\t\t\t\t\t<BlockHeader>{I18N_WEAPONS}</BlockHeader>\n\t\t\t\t\t<ol className=\"items-list\">{weaponListBlock}</ol>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<BlockHeader>{I18N_NOTES}</BlockHeader>\n\t\t\t\t<div className=\"opacity-75\">{notesBlock}</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n\treturn (\n\t\t<ItemsDataContext.Provider value={build.maps}>\n\t\t\t<div className=\"character-build-detailed mt-2 mb-3 position-relative\">\n\t\t\t\t<div className=\"d-flex d-xl-none mt-3\">\n\t\t\t\t\t<A className=\"btn btn-secondary align-self-center\" type=\"submit\" href=\"/builds\">\n\t\t\t\t\t\t<span className=\"fs-4 lh-1 opacity-75\">‹ </span> {I18N_BACK}\n\t\t\t\t\t</A>\n\t\t\t\t\t<h5 className=\"ps-3 pe-1 m-0 align-self-center\">{build.character.name}</h5>\n\t\t\t\t\t<ToggleCharFav classes=\"fs-3 align-self-center\" characterCode={characterCode} />\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tsrc={getCharacterAvatarLargeSrc(characterCode)}\n\t\t\t\t\t\tclasses=\"large-avatar align-self-end mt-n5 ms-auto\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t{isUpdating ? <CentredSpinner /> : null}\n\t\t\t\t<div className={isUpdating ? 'opacity-50 pe-none' : ''}>\n\t\t\t\t\t{CharacterDetailDesktop}\n\t\t\t\t\t{CharacterDetailMobile}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</ItemsDataContext.Provider>\n\t)\n}\n","import { useEffect } from 'preact/hooks'\n\nimport { useBuildWithDelayedLocs } from '#src/api'\nimport { Spinner } from '#src/components/spinners'\nimport { CharacterPicker } from '#src/containers/character-picker/character-picker'\nimport { FavoriteCharacters } from '#src/containers/character-picker/favorite-characters'\nimport {\n\tI18N_BASED_ON_GIHT,\n\tI18N_BUILD_RECS_FOR,\n\tI18N_CHAR_BUILD_RECS,\n\tI18N_SELECT_CHAR_ABOVE,\n} from '#src/i18n/i18n'\nimport { CharacterBuildDetailed } from '#src/modules/builds/character-build-detailed'\nimport { isLoaded } from '#src/utils/hooks'\n\nexport function BuildsPage_CharSelect(): JSX.Element {\n\treturn (\n\t\t<div className=\"builds container\">\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">{I18N_CHAR_BUILD_RECS}</h1>\n\t\t\t<h5 className=\"mt-2 mb-3 opacity-75\">{I18N_SELECT_CHAR_ABOVE}</h5>\n\t\t\t<FavoriteCharacters navigateToCharacter={true} classes=\"mb-2\" />\n\t\t\t<CharacterPicker />\n\t\t</div>\n\t)\n}\nexport function BuildsPage_BuildDetail({ code }: { code: string }): JSX.Element {\n\tconst [build, isUpdating] = useBuildWithDelayedLocs(code)\n\tuseEffect(() => {\n\t\twindow.scrollTo(0, 0)\n\t}, [])\n\n\tif (!isLoaded(build)) return <Spinner />\n\treturn (\n\t\t<div className=\"builds container\">\n\t\t\t<h1 className={`my-1 letter-spacing-1 ${BUNDLE_ENV.LANG === 'en' ? 'text-capitalize' : ''}`}>\n\t\t\t\t<span className=\"d-none d-xl-inline\">{build.character.name}</span> {I18N_BUILD_RECS_FOR}\n\t\t\t</h1>\n\t\t\t<FavoriteCharacters navigateToCharacter={true} />\n\t\t\t<CharacterBuildDetailed build={build} isUpdating={isUpdating} />\n\t\t\t<div className=\"col-lg-9 offset-lg-3 col-12\">\n\t\t\t\t<a\n\t\t\t\t\thref=\"https://docs.google.com/spreadsheets/d/1gNxZ2xab1J6o1TuNVWMeLOZ7TPOqrsf3SshP5DLvKzI/pubhtml#\"\n\t\t\t\t\tclassName=\"fs-6 d-block my-3 text-center text-muted small\"\n\t\t\t\t>\n\t\t\t\t\t{I18N_BASED_ON_GIHT}\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { BtnTabGroup } from '#src/components/tabs'\nimport { useCallback, useMemo, useState } from 'preact/hooks'\nconst cats = [\n\t{ title: 'Weapons', code: 'weapons' },\n\t{ title: 'Artifacts', code: 'artifacts' },\n]\nconst weapons = new Array(23).fill('1') //todo\nexport function WeaponsList() {\n\tconst [selectedCatCode, setSelectedCatCode] = useState<string | null>(null)\n\tconst selectCat = useCallback(tab => setSelectedCatCode(tab.code), [setSelectedCatCode])\n\tconst selectedCat = useMemo(\n\t\t() => cats.find(c => c.code === selectedCatCode) || cats[0],\n\t\t[selectedCatCode],\n\t)\n\tconsole.log(weapons)\n\treturn (\n\t\t<div>\n\t\t\t{weapons.map(w => (\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col\">1</div>\n\t\t\t\t\t<div className=\"col\">2</div>\n\t\t\t\t\t<div className=\"col\">3</div>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n","import { Tabs } from '#src/components/tabs'\n\nimport { useCallback, useMemo, useState } from 'preact/hooks'\nimport { WeaponsList } from './weapons-list'\nconst cats = [\n\t{ title: 'Weapons', code: 'weapons' },\n\t{ title: 'Artifacts', code: 'artifacts' },\n]\nexport function Equipment() {\n\tconst [selectedCatCode, setSelectedCatCode] = useState<string | null>(null)\n\tconst selectCat = useCallback(tab => setSelectedCatCode(tab.code), [setSelectedCatCode])\n\tconst selectedCat = useMemo(\n\t\t() => cats.find(c => c.code === selectedCatCode) || cats[0],\n\t\t[selectedCatCode],\n\t)\n\treturn (\n\t\t<div className=\"equipment container\">\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">Character equipment</h1>\n\t\t\t<Tabs classes=\"w-100\" tabs={cats} onTabSelect={selectCat} selectedTab={selectedCat} />\n\t\t\t<WeaponsList />\n\t\t</div>\n\t)\n}\n","import { Equipment } from '#src/modules/equipment/equipment'\n\nexport function EquipmentPage() {\n\treturn <Equipment />\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { getRegionTime, GI_ROTATION_WEEKDAY_CODES, GI_ServerRegionCode } from '#lib/genshin'\nimport { arrGetAfter } from '#lib/utils/collections'\nimport { mustBeDefined } from '#src/../../lib/utils/values'\nimport { apiMaterialsTimetable } from '#src/api/endpoints'\nimport { Spinner } from '#src/components/spinners'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport {\n\tI18N_DUNGEONS,\n\tI18N_TALENTS,\n\tI18N_TODAY,\n\tI18N_TOMORROW,\n\tI18N_WEAPONS,\n\tI18N_WEEKDAYS,\n\tI18N_WHY_ADD_TO_FAVS_TIP,\n} from '#src/i18n/i18n'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { isLoaded, useFetch, useForceUpdate, useLocalStorage, useVisibleTicker } from '#src/utils/hooks'\nimport { getItemIconLargeSrc, getItemIconSrc } from '#src/utils/items'\nimport {\n\tSK_DEFAULT_SELECTED_REGION_CODE,\n\tSK_FAV_CHAR_CODES,\n\tSK_FAV_TALENT_MATERIAL_CODES,\n\tSK_FAV_WEAPON_PRIMARY_MATERIAL_CODES,\n\tSK_SELECTED_REGION_CODE,\n} from '#src/utils/local-storage-keys'\nimport { HEART } from '#src/utils/typography'\nimport { OtherItemCard } from './item-cards/dd-cards'\nimport { ItemAvatar } from './item-cards/item-avatars'\n\nimport './farm-today.scss'\n\nexport function FarmToday({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst ttData = useFetch(apiMaterialsTimetable, [])\n\tconst [selectedRegionCode] = useLocalStorage<GI_ServerRegionCode>(\n\t\tSK_SELECTED_REGION_CODE,\n\t\tSK_DEFAULT_SELECTED_REGION_CODE,\n\t)\n\tconst { weekdayMonSun, weekdayCode } = getRegionTime(selectedRegionCode)\n\tconst tomorrowCode = arrGetAfter(GI_ROTATION_WEEKDAY_CODES, weekdayCode)\n\tconst [favCharCodes] = useLocalStorage<string[]>(SK_FAV_CHAR_CODES, [])\n\tconst [favTalMaterialCodes] = useLocalStorage<string[]>(SK_FAV_TALENT_MATERIAL_CODES, [])\n\t// const [favWeaponDatas] = useLocalStorage<STORAGE_WEAPON_DATA[]>(SK_FAV_WEAPON_DATAS, [])\n\t// const favWeapMatCodes = useMemo(() => [...favWeaponDatas.map(wd => wd[1])], [favWeaponDatas])\n\tconst [favWeapPrimMatCodes] = useLocalStorage<string[]>(SK_FAV_WEAPON_PRIMARY_MATERIAL_CODES, [])\n\tconst forceUpdate = useForceUpdate()\n\tuseVisibleTicker(() => {\n\t\tforceUpdate()\n\t}, 60 * 1000)\n\tconst tabs = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\tcode: weekdayCode,\n\t\t\t\ttitle: `${I18N_WEEKDAYS[weekdayMonSun]}, ${I18N_TODAY}`,\n\t\t\t},\n\t\t\t{ code: tomorrowCode, title: I18N_TOMORROW },\n\t\t],\n\t\t[weekdayCode, tomorrowCode, weekdayMonSun],\n\t)\n\tconst [selectedTab, setSelectedTab] = useSelectable(tabs, [selectedRegionCode])\n\n\treturn (\n\t\t<div className={`farm-today ${classes}`}>\n\t\t\t{!BUNDLE_ENV.IS_SSR && (\n\t\t\t\t<>\n\t\t\t\t\t<div className=\"d-none d-xl-flex\">\n\t\t\t\t\t\t<h5 className=\"py-2 m-0 me-2 d-block \">{I18N_DUNGEONS}</h5>\n\t\t\t\t\t\t<Tabs\n\t\t\t\t\t\t\ttabs={tabs}\n\t\t\t\t\t\t\tselectedTab={selectedTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedTab}\n\t\t\t\t\t\t\tclasses=\"mb-2 flex-grow-1\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"d-block d-xl-none\">\n\t\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\t\ttabs={tabs}\n\t\t\t\t\t\t\tselectedTab={selectedTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedTab}\n\t\t\t\t\t\t\tclasses=\"w-100 mb-2\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{isLoaded(ttData) && !BUNDLE_ENV.IS_SSR ? (\n\t\t\t\t<>\n\t\t\t\t\t<h6 className=\"opacity-75 text-capitalize\">{I18N_TALENTS}</h6>\n\t\t\t\t\t<div className=\"talents-wrap pt-1\">\n\t\t\t\t\t\t{ttData.timetable[selectedTab.code].characterAscensions.map(asc => (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<div className=\"mb-3 ps-2 ms-1 d-flex align-items-center\" key={asc.itemCode}>\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\t\t\tsrc={getItemIconLargeSrc(asc.itemCode)}\n\t\t\t\t\t\t\t\t\t\t\tclasses=\"me-3 vertical-align-middle\"\n\t\t\t\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t\t\t\t~favTalMaterialCodes.indexOf(asc.itemCode) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger\">{HEART}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tddComponent={\n\t\t\t\t\t\t\t\t\t\t\t\t<OtherItemCard\n\t\t\t\t\t\t\t\t\t\t\t\t\titem={mustBeDefined(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tttData.items.find(i => i.code === asc.itemCode),\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\trelated={ttData.maps}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"d-flex flex-wrap align-self-center pt-2\">\n\t\t\t\t\t\t\t\t\t\t{asc.characterCodes.map(c => (\n\t\t\t\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\t\t\t\tkey={c}\n\t\t\t\t\t\t\t\t\t\t\t\tsrc={getCharacterAvatarSrc(c)}\n\t\t\t\t\t\t\t\t\t\t\t\tclasses={`small-avatar mb-2 me-2 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t~favCharCodes.indexOf(c) ? 'order-1' : 'order-2'\n\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t\t\t\t\t~favCharCodes.indexOf(c) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger\">{HEART}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<h6 class=\"opacity-75 text-capitalize\">{I18N_WEAPONS}</h6>\n\t\t\t\t\t<div className=\"ps-2 ms-1\">\n\t\t\t\t\t\t{ttData.timetable[selectedTab.code].weaponMaterialCodes.map(code => (\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tkey={code}\n\t\t\t\t\t\t\t\tsrc={getItemIconSrc(code)}\n\t\t\t\t\t\t\t\tclasses=\"small-avatar me-3 with-padding\"\n\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t~favWeapPrimMatCodes.indexOf(code) ? (\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger\">{HEART}</span>\n\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tddComponent={\n\t\t\t\t\t\t\t\t\t<OtherItemCard\n\t\t\t\t\t\t\t\t\t\titem={mustBeDefined(ttData.items.find(i => i.code === code))}\n\t\t\t\t\t\t\t\t\t\trelated={ttData.maps}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t\t<div className=\"text-muted small text-center px-2 mx-1 py-3\">{I18N_WHY_ADD_TO_FAVS_TIP}</div>\n\t\t</div>\n\t)\n}\n","import { GI_ServerRegionCode } from '#src/../../lib/genshin'\nimport { SimpleSelect } from '#src/components/select'\nimport { I18N_ASIA, I18N_EUROPE, I18N_NORH_AMERICA } from '#src/i18n/i18n'\nimport { useLocalStorage } from '#src/utils/hooks'\nimport { SK_DEFAULT_SELECTED_REGION_CODE, SK_SELECTED_REGION_CODE } from '#src/utils/local-storage-keys'\nimport { useCallback, useMemo } from 'preact/hooks'\n\ntype Opt = { title: string; code: GI_ServerRegionCode }\nconst europeOpt: Opt = { title: I18N_EUROPE, code: 'europe' }\nconst options: Opt[] = [\n\teuropeOpt,\n\t{ title: I18N_ASIA, code: 'asia' },\n\t{ title: I18N_NORH_AMERICA, code: 'north-america' },\n]\nexport function RegionSwitch({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedRegionCode, setSelectedRegionCode] = useLocalStorage<GI_ServerRegionCode>(\n\t\tSK_SELECTED_REGION_CODE,\n\t\tSK_DEFAULT_SELECTED_REGION_CODE,\n\t)\n\tconst selectedOption = useMemo(\n\t\t() => options.find(o => o.code === selectedRegionCode) || europeOpt,\n\t\t[selectedRegionCode],\n\t)\n\tconst onOptSelectLocal = useCallback(o => setSelectedRegionCode(o.code), [setSelectedRegionCode])\n\treturn (\n\t\t<SimpleSelect options={options} selectedOption={selectedOption} onOptionSelect={onOptSelectLocal} />\n\t)\n}\n","import {\n\tI18N_HOUR,\n\tI18N_HOURS,\n\tI18N_HOURS_3,\n\tI18N_MINUTE,\n\tI18N_MINUTES,\n\tI18N_MINUTES_3,\n} from '#src/i18n/i18n'\nimport { pluralizeEN, pluralizeRU } from './strings'\n\nexport function msToHmWords(duration: number): string {\n\tconst minutes = Math.floor((duration / (1000 * 60)) % 60),\n\t\thours = Math.floor((duration / (1000 * 60 * 60)) % 24)\n\tconst pluralizeFunc = BUNDLE_ENV.LANG === 'en' ? pluralizeEN : pluralizeRU\n\treturn `${hours} ${pluralizeFunc(hours, I18N_HOUR, I18N_HOURS, I18N_HOURS_3)} ${minutes} ${pluralizeFunc(\n\t\tminutes,\n\t\tI18N_MINUTE,\n\t\tI18N_MINUTES,\n\t\tI18N_MINUTES_3,\n\t)}`\n}\n","import { getRegionTime, GI_ServerRegionCode } from '#lib/genshin'\nimport { msToHmWords } from '#src/utils/dates'\nimport { useForceUpdate, useLocalStorage, useVisibleTicker } from '#src/utils/hooks'\nimport { SK_DEFAULT_SELECTED_REGION_CODE, SK_SELECTED_REGION_CODE } from '#src/utils/local-storage-keys'\nimport { BULLET, ELLIPSIS } from '#src/utils/typography'\n\nexport function TimeUntilDayReset({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedRegionCode] = useLocalStorage<GI_ServerRegionCode>(\n\t\tSK_SELECTED_REGION_CODE,\n\t\tSK_DEFAULT_SELECTED_REGION_CODE,\n\t)\n\tconst { resetIn } = getRegionTime(selectedRegionCode)\n\tconst forceUpdate = useForceUpdate()\n\tuseVisibleTicker(() => {\n\t\tforceUpdate()\n\t}, 60 * 1000)\n\treturn (\n\t\t<div className={`time-until-day-reset ${classes}`}>\n\t\t\t{BUNDLE_ENV.IS_SSR ? ELLIPSIS : msToHmWords(resetIn)}\n\t\t\t<span className=\"animation-time-glow ps-1\">{BULLET}</span>\n\t\t</div>\n\t)\n}\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { arrOrItemToArr } from '#src/../../lib/utils/collections'\nimport { useBuildWithDelayedLocs } from '#src/api'\nimport { getAllRelated } from '#src/api/utils'\nimport { CentredSpinner, Spinner } from '#src/components/spinners'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport { FavoriteCharacters } from '#src/containers/character-picker/favorite-characters'\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport {\n\tI18N_ART_STATS_PRIORITY,\n\tI18N_ARTIFACTS,\n\tI18N_ASC_MATERIALS,\n\tI18N_FULL_BUILD_INFO,\n\tI18N_MORE_ON_BUILDS_PAGE,\n\tI18N_STAT_NAME,\n\tI18N_SUBSTATS_PRIORITY,\n\tI18N_TALENT_NAME,\n\tI18N_TALENTS_PRIORITY,\n} from '#src/i18n/i18n'\nimport { A } from '#src/routes/router'\nimport { getArtifactTypeIconSrc } from '#src/utils/artifacts'\nimport { isLoaded } from '#src/utils/hooks'\nimport { getItemIconSrc } from '#src/utils/items'\nimport {\n\tBuildRoleOrDummy,\n\tCIRCLET_GOBLET_SANDS,\n\tDUMMY_ROLES,\n\tgenArtifactAdvice,\n\tgenArtMainStatDetail,\n\tgenSimpleList,\n\tgetRoleData,\n\tmakeRoleTitle,\n} from './common'\n\nimport './character-build-preview.scss'\nimport { OtherItemCard } from '#src/containers/item-cards/dd-cards'\n\nfunction CharacterBuildPreview({ characterCode }: { characterCode: string }): JSX.Element {\n\tconst [build, isUpdating] = useBuildWithDelayedLocs(characterCode)\n\tconst displayingCharacterCode = isLoaded(build) ? build.character.code : characterCode\n\tconst roleTabs: BuildRoleOrDummy[] = isLoaded(build) ? build.character.roles : DUMMY_ROLES\n\tconst [selectedRoleTab, setSelectedRoleTab] = useSelectable(roleTabs, [displayingCharacterCode])\n\n\tconst artifactsListBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return []\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\t\tconst listTimit = 1\n\t\treturn (\n\t\t\t<ol>\n\t\t\t\t{role.artifacts.sets.map((set, i) => {\n\t\t\t\t\tif (i > listTimit) return\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t\t\t{genArtifactAdvice(set.arts, build, false)}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t\t{role.artifacts.sets.length > listTimit ? (\n\t\t\t\t\t<li className=\"pt-1 text-muted\">\n\t\t\t\t\t\t<A className=\"link-secondary text-muted\" href={`/builds/` + characterCode}>\n\t\t\t\t\t\t\t{I18N_MORE_ON_BUILDS_PAGE}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</li>\n\t\t\t\t) : null}\n\t\t\t</ol>\n\t\t)\n\t}, [characterCode, build, selectedRoleTab])\n\n\tconst artifactMainStatsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<ul className=\"mb-1 list-unstyled ms-1 pt-1 ps-2 small\">\n\t\t\t\t{CIRCLET_GOBLET_SANDS.map(ac => (\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\tsrc={getArtifactTypeIconSrc(ac)}\n\t\t\t\t\t\t\tclasses=\"mb-1 mx-1 small-avatar bg-dark with-padding align-middle\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{genArtMainStatDetail(role, ac, true)}\n\t\t\t\t\t</li>\n\t\t\t\t))}\n\t\t\t</ul>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst artifactSubStatsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<ol className=\"mb-1 pt-2 small\">\n\t\t\t\t{role.subStats.advices.map(advice => {\n\t\t\t\t\treturn <li>{genSimpleList(advice.codes.map(I18N_STAT_NAME))}</li>\n\t\t\t\t})}\n\t\t\t</ol>\n\t\t)\n\t}, [build, selectedRoleTab])\n\n\tconst talentsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<ol className=\"small\">\n\t\t\t\t\t{role.talents.advices.map(advice => {\n\t\t\t\t\t\treturn <li>{arrOrItemToArr(advice).map(I18N_TALENT_NAME)}</li>\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\n\tconst materialsBlock = useMemo(() => {\n\t\t//todo только главные\n\t\tif (!isLoaded(build)) return null\n\t\tconst materials = getAllRelated(build.maps.items, build.character.materialCodes)\n\t\treturn (\n\t\t\t<div className=\"d-flex justify-content-between flex-wrap px-2\">\n\t\t\t\t{materials.map(m => (\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 mx-1 small-avatar with-padding flex-shrink-0\"\n\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\tddComponent={<OtherItemCard item={m} related={build.maps} />}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t)\n\t}, [build])\n\tif (!isLoaded(build)) return <Spinner />\n\treturn (\n\t\t<div className=\"character-build-preview position-relative\">\n\t\t\t{/* <div className=\"d-none d-xl-block\">\n\t\t\t\t<CharacterPortrait src={getCharacterPortraitSrc(characterCode)} classes=\"w-100\" />\n\t\t\t</div>\n\t\t\t<div className=\"d-xl-none\">\n\t\t\t\t<CharacterPortrait\n\t\t\t\t\tsrc={getCharacterSilhouetteSrc(characterCode)}\n\t\t\t\t\tclasses=\"w-75 character-portrait-mobile\"\n\t\t\t\t/>\n\t\t\t</div> */}\n\t\t\t{isUpdating ? <CentredSpinner /> : null}\n\t\t\t<div className={isUpdating ? 'opacity-50 pe-none' : ''}>\n\t\t\t\t<div className=\"d-none d-xl-flex \">\n\t\t\t\t\t<h5 className=\"py-2 m-0 me-2 d-block \">{build.character.name}</h5>\n\t\t\t\t\t<Tabs\n\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\tclasses=\"mb-2 flex-grow-1\"\n\t\t\t\t\t\tkey={displayingCharacterCode}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"d-flex d-xl-none align-items-center\">\n\t\t\t\t\t<h5 className=\"mb-0 pt-2 me-2\">{build.character.name}</h5>\n\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\tclasses=\"w-100 mt-3 mb-2\"\n\t\t\t\t\t\tkey={displayingCharacterCode}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"row small gy-2\">\n\t\t\t\t\t<div className=\"col-lg-4 col-12\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_ARTIFACTS}</h6>\n\t\t\t\t\t\t<div>{artifactsListBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_ART_STATS_PRIORITY}</h6>\n\t\t\t\t\t\t<div>{artifactMainStatsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_SUBSTATS_PRIORITY}</h6>\n\t\t\t\t\t\t<div>{artifactSubStatsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_TALENTS_PRIORITY}</h6>\n\t\t\t\t\t\t<div>{talentsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-8 col-6\">\n\t\t\t\t\t\t<h6 className=\"opacity-75\">{I18N_ASC_MATERIALS}</h6>\n\t\t\t\t\t\t<div>{materialsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-12\">\n\t\t\t\t\t\t<A\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn btn-link btn-sm w-100\"\n\t\t\t\t\t\t\thref={`/builds/` + characterCode}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{I18N_FULL_BUILD_INFO}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</div>\n\t\t\t\t\t{/* TODO */}\n\t\t\t\t\t{/* <div className=\"col-6\">\n\t\t\t\t\t\t<A type=\"button\" className=\"btn btn-link btn-sm w-100\">\n\t\t\t\t\t\t\t{I18N_CHAR_LORE}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</div> */}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\nexport function BuildsPreviewsWrap({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedCharacterCode, setSelectedCharacterCode] = useState<string | null>(null)\n\treturn (\n\t\t<div className={`character-build-preview ${classes}`}>\n\t\t\t<FavoriteCharacters\n\t\t\t\tonCharacterSelect={setSelectedCharacterCode}\n\t\t\t\tshoudSelectFirst={!selectedCharacterCode}\n\t\t\t\tnavigateToCharacter={false}\n\t\t\t\tclasses=\"mb-2\"\n\t\t\t/>\n\t\t\t{selectedCharacterCode ? (\n\t\t\t\t<CharacterBuildPreview characterCode={selectedCharacterCode} />\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t</div>\n\t)\n}\n","import { AlchemyCalculator } from '#src/containers/alchemy-calculator'\nimport { FarmToday } from '#src/containers/farm-today'\nimport { RegionSwitch } from '#src/containers/region-switch'\nimport { TimeUntilDayReset } from '#src/containers/time-until-day-reset'\nimport {\n\tI18N_ALCHEMY_CALC,\n\tI18N_BUILDS,\n\tI18N_DASHBOARD,\n\tI18N_REGION,\n\tI18N_UNTIL_DAY_RESET,\n\tI18N_WHAT_TO_FARM,\n} from '#src/i18n/i18n'\nimport { BuildsPreviewsWrap } from '#src/modules/builds/character-build-preview'\n\nfunction Fieldset({ children, legend, classes = '' }) {\n\treturn (\n\t\t<fieldset className={`my-2 ${classes}`}>\n\t\t\t<legend className=\"opacity-75 mb-2\">{legend}</legend>\n\t\t\t{children}\n\t\t</fieldset>\n\t)\n}\nexport function FrontPage(): JSX.Element {\n\treturn (\n\t\t<div className=\"dashboard container \">\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">{I18N_DASHBOARD}</h1>\n\t\t\t<div className=\"row\">\n\t\t\t\t<Fieldset legend={I18N_REGION} classes=\"col-lg-3 col-12\">\n\t\t\t\t\t<RegionSwitch />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset legend={I18N_UNTIL_DAY_RESET} classes=\"col-lg-3 col-12\">\n\t\t\t\t\t<TimeUntilDayReset classes=\"fs-4\" />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset legend={I18N_ALCHEMY_CALC} classes=\"col-lg-6 col-12 \">\n\t\t\t\t\t<AlchemyCalculator />\n\t\t\t\t</Fieldset>\n\t\t\t</div>\n\t\t\t<div className=\"row\">\n\t\t\t\t<Fieldset classes=\"col-lg-6 col-12\" legend={I18N_WHAT_TO_FARM}>\n\t\t\t\t\t<FarmToday />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset classes=\"col-lg-6 col-12\" legend={I18N_BUILDS}>\n\t\t\t\t\t<BuildsPreviewsWrap />\n\t\t\t\t</Fieldset>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { PageWrap } from './components/page-wrap'\nimport { Footer } from './containers/footer'\nimport { Header } from './containers/header'\nimport { BuildsPage_BuildDetail, BuildsPage_CharSelect } from './pages/builds'\nimport { EquipmentPage } from './pages/equipment'\nimport { FrontPage } from './pages/front-page'\nimport { paths } from './routes/paths'\nimport { route, useRouter } from './routes/router'\n\nimport './App.scss'\nimport './animations.scss'\n\nconst routes = [\n\troute(paths.front, FrontPage),\n\troute(paths.builds, BuildsPage_CharSelect),\n\troute(paths.buildCharacters, BuildsPage_BuildDetail),\n\troute(paths.equipment, EquipmentPage),\n]\n\nexport function App(): JSX.Element {\n\tconst page = useRouter(routes)\n\treturn (\n\t\t<div class=\"d-flex flex-column app-container\">\n\t\t\t<Header />\n\t\t\t<main>\n\t\t\t\t<PageWrap>{page}</PageWrap>\n\t\t\t</main>\n\t\t\t<Footer />\n\t\t</div>\n\t)\n}\n","if (process.env.NODE_ENV === 'development') {\n\trequire('preact/debug')\n}\n\nimport { render } from 'preact'\nimport { renderToString } from 'preact-render-to-string'\n\nimport { App } from './App'\n\nexport const renderPage = BUNDLE_ENV.IS_SSR\n\t? html =>\n\t\t\thtml.replace(\n\t\t\t\t/(<div class=\"app\">)/,\n\t\t\t\t(_, div) => div + renderToString(<App />, null, { pretty: false }),\n\t\t\t)\n\t: render(<App />, document.querySelector('body .app') as Element)\n"],"names":[],"sourceRoot":""}