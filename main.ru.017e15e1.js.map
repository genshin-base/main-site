{"version":3,"file":"main.ru.017e15e1.js","mappings":"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","sources":["webpack://gi_builds/webpack/runtime/load script","webpack://gi_builds/./node_modules/preact/dist/preact.module.js","webpack://gi_builds/./node_modules/preact/hooks/dist/hooks.module.js","webpack://gi_builds/./node_modules/preact/jsx-runtime/dist/jsxRuntime.module.js","webpack://gi_builds/./node_modules/preact/compat/src/portals.js","webpack://gi_builds/./www/src/utils/preact-compat.tsx","webpack://gi_builds/./node_modules/preact/compat/src/memo.js","webpack://gi_builds/./node_modules/preact/compat/src/util.js","webpack://gi_builds/./lib/utils/values.js","webpack://gi_builds/webpack/bootstrap","webpack://gi_builds/webpack/runtime/define property getters","webpack://gi_builds/webpack/runtime/ensure chunk","webpack://gi_builds/webpack/runtime/get javascript chunk filename","webpack://gi_builds/webpack/runtime/get mini-css chunk filename","webpack://gi_builds/webpack/runtime/hasOwnProperty shorthand","webpack://gi_builds/webpack/runtime/make namespace object","webpack://gi_builds/webpack/runtime/publicPath","webpack://gi_builds/webpack/runtime/jsonp chunk loading","webpack://gi_builds/./www/src/errors/rollbar.ts","webpack://gi_builds/./www/src/errors/index.ts","webpack://gi_builds/./www/src/errors/catch.ts","webpack://gi_builds/./lib/utils/collections.js","webpack://gi_builds/./www/src/utils/bootstrap.tsx","webpack://gi_builds/./www/src/utils/hooks.tsx","webpack://gi_builds/./www/src/utils/typography.tsx","webpack://gi_builds/./www/src/components/go-up-btn.tsx","webpack://gi_builds/./www/src/components/page-wrap.tsx","webpack://gi_builds/./www/src/utils/links.tsx","webpack://gi_builds/./www/src/i18n/i18n.tsx","webpack://gi_builds/./www/src/utils/dom.tsx","webpack://gi_builds/./www/src/modals/report-bug.tsx","webpack://gi_builds/./www/src/containers/footer.tsx","webpack://gi_builds/./www/src/api/generated.js","webpack://gi_builds/./www/src/routes/paths.js","webpack://gi_builds/./www/src/routes/router.tsx","webpack://gi_builds/./www/src/utils/calc-pos-for-dd.tsx","webpack://gi_builds/./www/src/components/tooltip.tsx","webpack://gi_builds/./lib/genshin.js","webpack://gi_builds/./lib/utils/date.js","webpack://gi_builds/./www/src/api/utils.ts","webpack://gi_builds/./www/src/components/block-header.tsx","webpack://gi_builds/./www/src/components/mobile-desc-switch.tsx","webpack://gi_builds/./www/src/components/tabs.tsx","webpack://gi_builds/./www/src/containers/item-cards/item-detail-dd-portal.tsx","webpack://gi_builds/./www/src/utils/artifacts.tsx","webpack://gi_builds/./www/src/utils/items.tsx","webpack://gi_builds/./www/src/utils/weapons.tsx","webpack://gi_builds/./www/src/containers/alchemy-calculator.tsx","webpack://gi_builds/./www/src/components/placeholders.tsx","webpack://gi_builds/./www/src/components/select.tsx","webpack://gi_builds/./www/src/containers/item-cards/card-map.tsx","webpack://gi_builds/./www/src/utils/domains.tsx","webpack://gi_builds/./www/src/utils/enemies.tsx","webpack://gi_builds/./www/src/utils/local-storage-keys.tsx","webpack://gi_builds/./www/src/containers/item-cards/common.tsx","webpack://gi_builds/./www/src/containers/item-cards/dd-cards.tsx","webpack://gi_builds/./www/src/modules/builds/common.tsx","webpack://gi_builds/./www/src/utils/characters.tsx","webpack://gi_builds/./www/src/utils/elements.tsx","webpack://gi_builds/./www/src/containers/item-cards/item-avatars.tsx","webpack://gi_builds/./www/src/utils/our-pages-in-social-networks.tsx","webpack://gi_builds/./www/src/components/globe-icon.tsx","webpack://gi_builds/./www/src/components/nav.tsx","webpack://gi_builds/./www/src/api/endpoints.ts","webpack://gi_builds/./www/src/modules/equipment/common.tsx","webpack://gi_builds/./www/src/containers/mega-search.tsx","webpack://gi_builds/./www/src/containers/header.tsx","webpack://gi_builds/./www/src/i18n/about-site.tsx","webpack://gi_builds/./www/src/api/index.ts","webpack://gi_builds/./www/src/utils/color-gradient.tsx","webpack://gi_builds/./www/src/containers/abyss/common.tsx","webpack://gi_builds/./www/src/containers/character-picker/common.tsx","webpack://gi_builds/./www/src/components/weapon-type-filter.tsx","webpack://gi_builds/./www/src/containers/character-picker/mobile-character-picker.tsx","webpack://gi_builds/./www/src/containers/character-picker/character-picker.tsx","webpack://gi_builds/./www/src/containers/character-picker/favorite-characters.tsx","webpack://gi_builds/./www/src/components/characters.tsx","webpack://gi_builds/./www/src/containers/abyss/char-rating.tsx","webpack://gi_builds/./www/src/modules/builds/character-build-detailed.tsx","webpack://gi_builds/./www/src/components/accordion.tsx","webpack://gi_builds/./www/src/containers/item-cards/line-cards/artifact-card.tsx","webpack://gi_builds/./www/src/modules/equipment/artifacts-list.tsx","webpack://gi_builds/./www/src/containers/item-cards/line-cards/weapon-card.tsx","webpack://gi_builds/./www/src/modules/equipment/weapons-list.tsx","webpack://gi_builds/./www/src/modules/equipment/index.tsx","webpack://gi_builds/./www/src/components/greetings/index.tsx","webpack://gi_builds/./www/src/containers/farm-today.tsx","webpack://gi_builds/./www/src/containers/region-switch.tsx","webpack://gi_builds/./www/src/containers/time-until-day-reset.tsx","webpack://gi_builds/./www/src/modules/builds/character-build-preview.tsx","webpack://gi_builds/./www/src/pages/front-page.tsx","webpack://gi_builds/./www/src/App.tsx","webpack://gi_builds/./www/src/pages/builds.tsx","webpack://gi_builds/./www/src/pages/equipment.tsx","webpack://gi_builds/./www/src/pages/about.tsx","webpack://gi_builds/./www/src/pages/everywhere.tsx","webpack://gi_builds/./www/src/index.tsx"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"gi_builds:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\t\tscript.type = \"module\";\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t};\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","var n,l,u,i,t,o,r,f={},e=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function s(n,l){for(var u in l)n[u]=l[u];return n}function a(n){var l=n.parentNode;l&&l.removeChild(n)}function h(l,u,i){var t,o,r,f={};for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];if(arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),\"function\"==typeof l&&null!=l.defaultProps)for(r in l.defaultProps)void 0===f[r]&&(f[r]=l.defaultProps[r]);return v(l,f,t,o,null)}function v(n,i,t,o,r){var f={type:n,props:i,key:t,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++u:r};return null==r&&null!=l.vnode&&l.vnode(f),f}function y(){return{current:null}}function p(n){return n.children}function d(n,l){this.props=n,this.context=l}function _(n,l){if(null==l)return n.__?_(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?_(n):null}function k(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return k(n)}}function b(n){(!n.__d&&(n.__d=!0)&&t.push(n)&&!g.__r++||o!==l.debounceRendering)&&((o=l.debounceRendering)||setTimeout)(g)}function g(){for(var n;g.__r=t.length;)n=t.sort(function(n,l){return n.__v.__b-l.__v.__b}),t=[],n.some(function(n){var l,u,i,t,o,r;n.__d&&(o=(t=(l=n).__v).__e,(r=l.__P)&&(u=[],(i=s({},t)).__v=t.__v+1,j(r,t,i,l.__n,void 0!==r.ownerSVGElement,null!=t.__h?[o]:null,u,null==o?_(t):o,t.__h),z(u,t),t.__e!=o&&k(t)))})}function w(n,l,u,i,t,o,r,c,s,a){var h,y,d,k,b,g,w,x=i&&i.__k||e,C=x.length;for(u.__k=[],h=0;h<l.length;h++)if(null!=(k=u.__k[h]=null==(k=l[h])||\"boolean\"==typeof k?null:\"string\"==typeof k||\"number\"==typeof k||\"bigint\"==typeof k?v(null,k,null,null,k):Array.isArray(k)?v(p,{children:k},null,null,null):k.__b>0?v(k.type,k.props,k.key,k.ref?k.ref:null,k.__v):k)){if(k.__=u,k.__b=u.__b+1,null===(d=x[h])||d&&k.key==d.key&&k.type===d.type)x[h]=void 0;else for(y=0;y<C;y++){if((d=x[y])&&k.key==d.key&&k.type===d.type){x[y]=void 0;break}d=null}j(n,k,d=d||f,t,o,r,c,s,a),b=k.__e,(y=k.ref)&&d.ref!=y&&(w||(w=[]),d.ref&&w.push(d.ref,null,k),w.push(y,k.__c||b,k)),null!=b?(null==g&&(g=b),\"function\"==typeof k.type&&k.__k===d.__k?k.__d=s=m(k,s,n):s=A(n,k,d,x,b,s),\"function\"==typeof u.type&&(u.__d=s)):s&&d.__e==s&&s.parentNode!=n&&(s=_(d))}for(u.__e=g,h=C;h--;)null!=x[h]&&N(x[h],x[h]);if(w)for(h=0;h<w.length;h++)M(w[h],w[++h],w[++h])}function m(n,l,u){for(var i,t=n.__k,o=0;t&&o<t.length;o++)(i=t[o])&&(i.__=n,l=\"function\"==typeof i.type?m(i,l,u):A(u,i,i,t,i.__e,l));return l}function x(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(Array.isArray(n)?n.some(function(n){x(n,l)}):l.push(n)),l}function A(n,l,u,i,t,o){var r,f,e;if(void 0!==l.__d)r=l.__d,l.__d=void 0;else if(null==u||t!=o||null==t.parentNode)n:if(null==o||o.parentNode!==n)n.appendChild(t),r=null;else{for(f=o,e=0;(f=f.nextSibling)&&e<i.length;e+=1)if(f==t)break n;n.insertBefore(t,o),r=o}return void 0!==r?r:t.nextSibling}function C(n,l,u,i,t){var o;for(o in u)\"children\"===o||\"key\"===o||o in l||H(n,o,null,u[o],i);for(o in l)t&&\"function\"!=typeof l[o]||\"children\"===o||\"key\"===o||\"value\"===o||\"checked\"===o||u[o]===l[o]||H(n,o,l[o],u[o],i)}function $(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=null==u?\"\":\"number\"!=typeof u||c.test(l)?u:u+\"px\"}function H(n,l,u,i,t){var o;n:if(\"style\"===l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof i&&(n.style.cssText=i=\"\"),i)for(l in i)u&&l in u||$(n.style,l,\"\");if(u)for(l in u)i&&u[l]===i[l]||$(n.style,l,u[l])}else if(\"o\"===l[0]&&\"n\"===l[1])o=l!==(l=l.replace(/Capture$/,\"\")),l=l.toLowerCase()in n?l.toLowerCase().slice(2):l.slice(2),n.l||(n.l={}),n.l[l+o]=u,u?i||n.addEventListener(l,o?T:I,o):n.removeEventListener(l,o?T:I,o);else if(\"dangerouslySetInnerHTML\"!==l){if(t)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"href\"!==l&&\"list\"!==l&&\"form\"!==l&&\"tabIndex\"!==l&&\"download\"!==l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null==u||!1===u&&-1==l.indexOf(\"-\")?n.removeAttribute(l):n.setAttribute(l,u))}}function I(n){this.l[n.type+!1](l.event?l.event(n):n)}function T(n){this.l[n.type+!0](l.event?l.event(n):n)}function j(n,u,i,t,o,r,f,e,c){var a,h,v,y,_,k,b,g,m,x,A,C,$,H,I,T=u.type;if(void 0!==u.constructor)return null;null!=i.__h&&(c=i.__h,e=u.__e=i.__e,u.__h=null,r=[e]),(a=l.__b)&&a(u);try{n:if(\"function\"==typeof T){if(g=u.props,m=(a=T.contextType)&&t[a.__c],x=a?m?m.props.value:a.__:t,i.__c?b=(h=u.__c=i.__c).__=h.__E:(\"prototype\"in T&&T.prototype.render?u.__c=h=new T(g,x):(u.__c=h=new d(g,x),h.constructor=T,h.render=O),m&&m.sub(h),h.props=g,h.state||(h.state={}),h.context=x,h.__n=t,v=h.__d=!0,h.__h=[],h._sb=[]),null==h.__s&&(h.__s=h.state),null!=T.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=s({},h.__s)),s(h.__s,T.getDerivedStateFromProps(g,h.__s))),y=h.props,_=h.state,v)null==T.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==T.getDerivedStateFromProps&&g!==y&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(g,x),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(g,h.__s,x)||u.__v===i.__v){for(h.props=g,h.state=h.__s,u.__v!==i.__v&&(h.__d=!1),h.__v=u,u.__e=i.__e,u.__k=i.__k,u.__k.forEach(function(n){n&&(n.__=u)}),A=0;A<h._sb.length;A++)h.__h.push(h._sb[A]);h._sb=[],h.__h.length&&f.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(g,h.__s,x),null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(y,_,k)})}if(h.context=x,h.props=g,h.__v=u,h.__P=n,C=l.__r,$=0,\"prototype\"in T&&T.prototype.render){for(h.state=h.__s,h.__d=!1,C&&C(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,C&&C(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++$<25);h.state=h.__s,null!=h.getChildContext&&(t=s(s({},t),h.getChildContext())),v||null==h.getSnapshotBeforeUpdate||(k=h.getSnapshotBeforeUpdate(y,_)),I=null!=a&&a.type===p&&null==a.key?a.props.children:a,w(n,Array.isArray(I)?I:[I],u,i,t,o,r,f,e,c),h.base=u.__e,u.__h=null,h.__h.length&&f.push(h),b&&(h.__E=h.__=null),h.__e=!1}else null==r&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=L(i.__e,u,i,t,o,r,f,c);(a=l.diffed)&&a(u)}catch(n){u.__v=null,(c||null!=r)&&(u.__e=e,u.__h=!!c,r[r.indexOf(e)]=null),l.__e(n,u,i)}}function z(n,u){l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function L(l,u,i,t,o,r,e,c){var s,h,v,y=i.props,p=u.props,d=u.type,k=0;if(\"svg\"===d&&(o=!0),null!=r)for(;k<r.length;k++)if((s=r[k])&&\"setAttribute\"in s==!!d&&(d?s.localName===d:3===s.nodeType)){l=s,r[k]=null;break}if(null==l){if(null===d)return document.createTextNode(p);l=o?document.createElementNS(\"http://www.w3.org/2000/svg\",d):document.createElement(d,p.is&&p),r=null,c=!1}if(null===d)y===p||c&&l.data===p||(l.data=p);else{if(r=r&&n.call(l.childNodes),h=(y=i.props||f).dangerouslySetInnerHTML,v=p.dangerouslySetInnerHTML,!c){if(null!=r)for(y={},k=0;k<l.attributes.length;k++)y[l.attributes[k].name]=l.attributes[k].value;(v||h)&&(v&&(h&&v.__html==h.__html||v.__html===l.innerHTML)||(l.innerHTML=v&&v.__html||\"\"))}if(C(l,p,y,o,c),v)u.__k=[];else if(k=u.props.children,w(l,Array.isArray(k)?k:[k],u,i,t,o&&\"foreignObject\"!==d,r,e,r?r[0]:i.__k&&_(i,0),c),null!=r)for(k=r.length;k--;)null!=r[k]&&a(r[k]);c||(\"value\"in p&&void 0!==(k=p.value)&&(k!==l.value||\"progress\"===d&&!k||\"option\"===d&&k!==y.value)&&H(l,\"value\",k,y.value,!1),\"checked\"in p&&void 0!==(k=p.checked)&&k!==l.checked&&H(l,\"checked\",k,y.checked,!1))}return l}function M(n,u,i){try{\"function\"==typeof n?n(u):n.current=u}catch(n){l.__e(n,i)}}function N(n,u,i){var t,o;if(l.unmount&&l.unmount(n),(t=n.ref)&&(t.current&&t.current!==n.__e||M(t,null,u)),null!=(t=n.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(n){l.__e(n,u)}t.base=t.__P=null,n.__c=void 0}if(t=n.__k)for(o=0;o<t.length;o++)t[o]&&N(t[o],u,i||\"function\"!=typeof n.type);i||null==n.__e||a(n.__e),n.__=n.__e=n.__d=void 0}function O(n,l,u){return this.constructor(n,u)}function P(u,i,t){var o,r,e;l.__&&l.__(u,i),r=(o=\"function\"==typeof t)?null:t&&t.__k||i.__k,e=[],j(i,u=(!o&&t||i).__k=h(p,null,[u]),r||f,f,void 0!==i.ownerSVGElement,!o&&t?[t]:r?null:i.firstChild?n.call(i.childNodes):null,e,!o&&t?t:r?r.__e:i.firstChild,o),z(e,u)}function S(n,l){P(n,l,S)}function q(l,u,i){var t,o,r,f=s({},l.props);for(r in u)\"key\"==r?t=u[r]:\"ref\"==r?o=u[r]:f[r]=u[r];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):i),v(l.type,f,t||l.key,o||l.ref,null)}function B(n,l){var u={__c:l=\"__cC\"+r++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var u,i;return this.getChildContext||(u=[],(i={})[l]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(n){this.props.value!==n.value&&u.some(b)},this.sub=function(n){u.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u.splice(u.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Provider.__=u.Consumer.contextType=u}n=e.slice,l={__e:function(n,l,u,i){for(var t,o,r;l=l.__;)if((t=l.__c)&&!t.__)try{if((o=t.constructor)&&null!=o.getDerivedStateFromError&&(t.setState(o.getDerivedStateFromError(n)),r=t.__d),null!=t.componentDidCatch&&(t.componentDidCatch(n,i||{}),r=t.__d),r)return t.__E=t}catch(l){n=l}throw n}},u=0,i=function(n){return null!=n&&void 0===n.constructor},d.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=s({},this.state),\"function\"==typeof n&&(n=n(s({},u),this.props)),n&&s(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),b(this))},d.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),b(this))},d.prototype.render=p,t=[],g.__r=0,r=0;export{d as Component,p as Fragment,q as cloneElement,B as createContext,h as createElement,y as createRef,h,S as hydrate,i as isValidElement,l as options,P as render,x as toChildArray};\n//# sourceMappingURL=preact.module.js.map\n","import{options as n}from\"preact\";var t,r,u,i,o=0,f=[],c=[],e=n.__b,a=n.__r,v=n.diffed,l=n.__c,m=n.unmount;function d(t,u){n.__h&&n.__h(r,t,o||u),o=0;var i=r.__H||(r.__H={__:[],__h:[]});return t>=i.__.length&&i.__.push({__V:c}),i.__[t]}function p(n){return o=1,y(B,n)}function y(n,u,i){var o=d(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):B(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.u)){r.u=!0;var f=r.shouldComponentUpdate;r.shouldComponentUpdate=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return n.__c});if(u.every(function(n){return!n.__N}))return!f||f.call(this,n,t,r);var i=!1;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),!(!i&&o.__c.props===n)&&(!f||f.call(this,n,t,r))}}return o.__N||o.__}function h(u,i){var o=d(t++,3);!n.__s&&z(o.__H,i)&&(o.__=u,o.i=i,r.__H.__h.push(o))}function s(u,i){var o=d(t++,4);!n.__s&&z(o.__H,i)&&(o.__=u,o.i=i,r.__h.push(o))}function _(n){return o=5,F(function(){return{current:n}},[])}function A(n,t,r){o=6,s(function(){return\"function\"==typeof n?(n(t()),function(){return n(null)}):n?(n.current=t(),function(){return n.current=null}):void 0},null==r?r:r.concat(n))}function F(n,r){var u=d(t++,7);return z(u.__H,r)?(u.__V=n(),u.i=r,u.__h=n,u.__V):u.__}function T(n,t){return o=8,F(function(){return n},t)}function q(n){var u=r.context[n.__c],i=d(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function x(t,r){n.useDebugValue&&n.useDebugValue(r?r(t):t)}function P(n){var u=d(t++,10),i=p();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function V(){var n=d(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__=\"P\"+i[0]+\"-\"+i[1]++}return n.__}function b(){for(var t;t=f.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(k),t.__H.__h.forEach(w),t.__H.__h=[]}catch(r){t.__H.__h=[],n.__e(r,t.__v)}}n.__b=function(n){r=null,e&&e(n)},n.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=c,n.__N=n.i=void 0})):(i.__h.forEach(k),i.__h.forEach(w),i.__h=[])),u=r},n.diffed=function(t){v&&v(t);var o=t.__c;o&&o.__H&&(o.__H.__h.length&&(1!==f.push(o)&&i===n.requestAnimationFrame||((i=n.requestAnimationFrame)||j)(b)),o.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==c&&(n.__=n.__V),n.i=void 0,n.__V=c})),u=r=null},n.__c=function(t,r){r.some(function(t){try{t.__h.forEach(k),t.__h=t.__h.filter(function(n){return!n.__||w(n)})}catch(u){r.some(function(n){n.__h&&(n.__h=[])}),r=[],n.__e(u,t.__v)}}),l&&l(t,r)},n.unmount=function(t){m&&m(t);var r,u=t.__c;u&&u.__H&&(u.__H.__.forEach(function(n){try{k(n)}catch(n){r=n}}),u.__H=void 0,r&&n.__e(r,u.__v))};var g=\"function\"==typeof requestAnimationFrame;function j(n){var t,r=function(){clearTimeout(u),g&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,100);g&&(t=requestAnimationFrame(r))}function k(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function w(n){var t=r;n.__c=n.__(),r=t}function z(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function B(n,t){return\"function\"==typeof t?t(n):t}export{T as useCallback,q as useContext,x as useDebugValue,h as useEffect,P as useErrorBoundary,V as useId,A as useImperativeHandle,s as useLayoutEffect,F as useMemo,y as useReducer,_ as useRef,p as useState};\n//# sourceMappingURL=hooks.module.js.map\n","import{options as r}from\"preact\";export{Fragment}from\"preact\";var _=0;function o(o,e,n,t,f){var l,s,u={};for(s in e)\"ref\"==s?l=e[s]:u[s]=e[s];var a={type:o,props:u,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--_,__source:f,__self:t};if(\"function\"==typeof o&&(l=o.defaultProps))for(s in l)void 0===u[s]&&(u[s]=l[s]);return r.vnode&&r.vnode(a),a}export{o as jsx,o as jsxDEV,o as jsxs};\n//# sourceMappingURL=jsxRuntime.module.js.map\n","import { createElement, render } from 'preact';\n\n/**\n * @param {import('../../src/index').RenderableProps<{ context: any }>} props\n */\nfunction ContextProvider(props) {\n\tthis.getChildContext = () => props.context;\n\treturn props.children;\n}\n\n/**\n * Portal component\n * @this {import('./internal').Component}\n * @param {object | null | undefined} props\n *\n * TODO: use createRoot() instead of fake root\n */\nfunction Portal(props) {\n\tconst _this = this;\n\tlet container = props._container;\n\n\t_this.componentWillUnmount = function() {\n\t\trender(null, _this._temp);\n\t\t_this._temp = null;\n\t\t_this._container = null;\n\t};\n\n\t// When we change container we should clear our old container and\n\t// indicate a new mount.\n\tif (_this._container && _this._container !== container) {\n\t\t_this.componentWillUnmount();\n\t}\n\n\t// When props.vnode is undefined/false/null we are dealing with some kind of\n\t// conditional vnode. This should not trigger a render.\n\tif (props._vnode) {\n\t\tif (!_this._temp) {\n\t\t\t_this._container = container;\n\n\t\t\t// Create a fake DOM parent node that manages a subset of `container`'s children:\n\t\t\t_this._temp = {\n\t\t\t\tnodeType: 1,\n\t\t\t\tparentNode: container,\n\t\t\t\tchildNodes: [],\n\t\t\t\tappendChild(child) {\n\t\t\t\t\tthis.childNodes.push(child);\n\t\t\t\t\t_this._container.appendChild(child);\n\t\t\t\t},\n\t\t\t\tinsertBefore(child, before) {\n\t\t\t\t\tthis.childNodes.push(child);\n\t\t\t\t\t_this._container.appendChild(child);\n\t\t\t\t},\n\t\t\t\tremoveChild(child) {\n\t\t\t\t\tthis.childNodes.splice(this.childNodes.indexOf(child) >>> 1, 1);\n\t\t\t\t\t_this._container.removeChild(child);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// Render our wrapping element into temp.\n\t\trender(\n\t\t\tcreateElement(ContextProvider, { context: _this.context }, props._vnode),\n\t\t\t_this._temp\n\t\t);\n\t}\n\t// When we come from a conditional render, on a mounted\n\t// portal we should clear the DOM.\n\telse if (_this._temp) {\n\t\t_this.componentWillUnmount();\n\t}\n}\n\n/**\n * Create a `Portal` to continue rendering the vnode tree at a different DOM node\n * @param {import('./internal').VNode} vnode The vnode to render\n * @param {import('./internal').PreactElement} container The DOM node to continue rendering in to.\n */\nexport function createPortal(vnode, container) {\n\tconst el = createElement(Portal, { _vnode: vnode, _container: container });\n\tel.containerInfo = container;\n\treturn el;\n}\n","// direct imports to avoid kilobytes of side-effects from 'preact/compat'\n// normal imports (preact/compat/src/memo) do not work with webpack (it strictly follows 'exports' field in package.json)\nimport { memo as memo_ } from '#src/../../node_modules/preact/compat/src/memo'\nimport { createPortal as createPortal_ } from '#src/../../node_modules/preact/compat/src/portals'\n\nimport type { createPortal as createPortalOrig } from 'preact/compat'\nimport type { memo as memoOrig } from 'preact/compat'\n\nexport const createPortal = createPortal_ as typeof createPortalOrig\nexport const memo = memo_ as typeof memoOrig\n","import { createElement } from 'preact';\nimport { shallowDiffers } from './util';\n\n/**\n * Memoize a component, so that it only updates when the props actually have\n * changed. This was previously known as `React.pure`.\n * @param {import('./internal').FunctionComponent} c functional component\n * @param {(prev: object, next: object) => boolean} [comparer] Custom equality function\n * @returns {import('./internal').FunctionComponent}\n */\nexport function memo(c, comparer) {\n\tfunction shouldUpdate(nextProps) {\n\t\tlet ref = this.props.ref;\n\t\tlet updateRef = ref == nextProps.ref;\n\t\tif (!updateRef && ref) {\n\t\t\tref.call ? ref(null) : (ref.current = null);\n\t\t}\n\n\t\tif (!comparer) {\n\t\t\treturn shallowDiffers(this.props, nextProps);\n\t\t}\n\n\t\treturn !comparer(this.props, nextProps) || !updateRef;\n\t}\n\n\tfunction Memoed(props) {\n\t\tthis.shouldComponentUpdate = shouldUpdate;\n\t\treturn createElement(c, props);\n\t}\n\tMemoed.displayName = 'Memo(' + (c.displayName || c.name) + ')';\n\tMemoed.prototype.isReactComponent = true;\n\tMemoed._forwarded = true;\n\treturn Memoed;\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Check if two objects have a different shape\n * @param {object} a\n * @param {object} b\n * @returns {boolean}\n */\nexport function shallowDiffers(a, b) {\n\tfor (let i in a) if (i !== '__source' && !(i in b)) return true;\n\tfor (let i in b) if (i !== '__source' && a[i] !== b[i]) return true;\n\treturn false;\n}\n\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n\n/**\n * Check if two values are the same value\n * @param {*} x\n * @param {*} y\n * @returns {boolean}\n */\nexport function is(x, y) {\n\treturn (x === y && (x !== 0 || 1 / x === 1 / y)) || (x !== x && y !== y);\n}\n","/**\n * @template T\n * @param {T|null} val\n * @returns {T}\n */\nexport function mustBeNotNull(val) {\n\tif (val === null) throw new Error('value is null, this should not happen')\n\treturn val\n}\n\n/**\n * @template T\n * @param {T|undefined} val\n * @returns {T}\n */\nexport function mustBeDefined(val) {\n\tif (val === undefined) throw new Error('value is undefined, this should not happen')\n\treturn val\n}\n\n/**\n * @template T\n * @param {T|undefined} x\n * @returns {x is T}\n */\nexport function isDefined(x) {\n\treturn x !== undefined\n}\n\n/**\n * @param {never[]} values\n * @returns {never}\n */\nexport function mustBeNever(...values) {\n\tthrow new Error('must not be reachable')\n}\n\n/**\n * @param {never[]} values\n * @returns {void}\n */\nexport function staticNever(...values) {\n\t//  ,  \n}\n\n/**\n * @param {unknown} a\n * @param {unknown} b\n * @returns {boolean}\n */\nexport function simpleDeepEqual(a, b) {\n\tif (Array.isArray(a) && Array.isArray(b)) {\n\t\tif (a.length !== b.length) return false\n\t\tfor (let i = 0; i < a.length; i++) {\n\t\t\tif (!simpleDeepEqual(a[i], b[i])) return false\n\t\t}\n\t\treturn true\n\t}\n\tif (typeof a === 'object' && typeof b === 'object' && a !== null && b !== null) {\n\t\tif (Object.keys(a).length !== Object.keys(b).length) return false\n\t\tfor (const attr in a) {\n\t\t\tif (!simpleDeepEqual(a[attr], b[attr])) return false\n\t\t}\n\t\treturn true\n\t}\n\treturn a === b\n}\n\n/**\n * @template TVal\n * @template TKey\n * @param {Iterable<TVal>} items\n * @param {(item:TVal) => TKey} keyFunc\n * @returns {Map<TKey, TVal[]>}\n */\nexport function groupByToMap(items, keyFunc) {\n\tconst map = /**@type {Map<TKey, TVal[]>}*/ (new Map())\n\tfor (const item of items) {\n\t\tconst key = keyFunc(item)\n\t\tconst cur = map.get(key)\n\t\tif (cur) cur.push(item)\n\t\telse map.set(key, [item])\n\t}\n\treturn map\n}\n\n/**\n * @param {number} min\n * @param {number} val\n * @param {number} max\n * @returns {number}\n */\nexport function clamp(min, val, max) {\n\treturn val < min ? min : val > max ? max : val\n}\n\n/** @returns {Promise<never>} */\nexport function promiseNever() {\n\treturn new Promise(() => undefined)\n}\n\n/**\n * @class\n * @template T\n */\nexport function Deferred() {\n\t/** @type {Promise<T>} */\n\tthis.promise = new Promise((res, rej) => {\n\t\tthis.resolve = res\n\t\tthis.reject = rej\n\t})\n}\n\n/**\n * @template T\n * @param {T | Promise<T>} value\n * @returns {value is Promise<T>}\n */\nexport function isPromise(value) {\n\treturn typeof value === 'object' && value !== null && 'then' in value\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + \"async\" + \".ru.\" + \"8b9fad72\" + \".js\";\n};","// This function allow to reference async chunks\n__webpack_require__.miniCssF = (chunkId) => {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t179: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t} else installedChunks[chunkId] = 0;\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkgi_builds\"] = self[\"webpackChunkgi_builds\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","const ROLLBAR_TOKEN = 'f5661155727c4a9e9db4d770357a0bcf'\n\nexport function sendError(class_: string, message: string): Promise<void> {\n\treturn sendNewItem('error', undefined, {\n\t\ttrace: {\n\t\t\tframes: [],\n\t\t\texception: {\n\t\t\t\tclass: class_,\n\t\t\t\tmessage,\n\t\t\t\t// description: '',\n\t\t\t},\n\t\t},\n\t})\n}\n\nexport function sendMessage(msg: string): Promise<void> {\n\treturn sendNewItem('warning', 'msg:' + Date.now(), {\n\t\tmessage: {\n\t\t\tbody: msg,\n\t\t},\n\t})\n}\n\n/**\n * {@link https://explorer.docs.rollbar.com/#operation/create-item}\n */\nfunction sendNewItem(level, fingerprint, rollbarBody) {\n\tconst body = JSON.stringify({\n\t\tdata: {\n\t\t\tenvironment: process.env.NODE_ENV,\n\t\t\tbody: rollbarBody,\n\t\t\tlevel,\n\t\t\tcode_version: BUNDLE_ENV.VERSION.commitHash,\n\t\t\tplatform: 'browser',\n\t\t\tcontext: location.href,\n\t\t\tclient: {\n\t\t\t\tjavascript: {\n\t\t\t\t\tbrowser: navigator.userAgent,\n\t\t\t\t\t// code_version: ''\n\t\t\t\t\t// source_map_enabled: false,\n\t\t\t\t},\n\t\t\t},\n\t\t\tfingerprint,\n\t\t},\n\t})\n\tconst headers = {\n\t\t'X-Rollbar-Access-Token': ROLLBAR_TOKEN,\n\t\t'Content-Type': 'application/json',\n\t}\n\treturn fetch('https://api.rollbar.com/api/1/item/', { method: 'POST', body, headers })\n\t\t.then(r => r.json())\n\t\t.then(resp => {\n\t\t\tif (resp.err !== 0) throw new Error(`rollbar: ` + resp.message)\n\t\t})\n}\n","import { sendError } from './rollbar'\n\nexport function logErrorExt(message: string | null, anyError: unknown, silent: boolean): void {\n\tconst error = anyError ? (anyError instanceof Error ? anyError : new Error(anyError + '')) : null\n\n\tif (!silent) console.error(message, error)\n\n\tconst class_ = error ? error.constructor.name : 'Message'\n\tconst text = (message ? message + '\\n' : '') + (error ? error.stack : '')\n\tsendError(class_, text).catch(console.error)\n}\n\nexport function logError(error: unknown): void {\n\tlogErrorExt(null, error, false)\n}\n","import './rollbar'\n\nimport { logErrorExt } from './'\n\nif (!BUNDLE_ENV.IS_SSR) {\n\twindow.addEventListener('error', e => {\n\t\t//      ,  \n\t\tif (e.message === 'Script error.' && e.filename === '') return\n\t\t// e.message    \"Uncaught Error:\",     \n\t\tconst msg = `${e.message} in ${e.filename}:${e.lineno}:${e.colno}`\n\t\tlogErrorExt(msg, e.error, true)\n\t})\n\n\twindow.addEventListener('unhandledrejection', e => {\n\t\t//  Promise.reject(123)      ,  ;  \"reason\"   \n\t\tconst msg = 'Unhandled Rejection: ' + (e.reason?.message ? e.reason.message : e.reason + '')\n\t\tlogErrorExt(msg, e.reason, true)\n\t})\n}\n","/**\n * @template T\n * @param {T[]} arr\n * @returns {T[]}\n */\nexport function arrSimpleUniq(arr) {\n\treturn arr.filter((value, index, self) => self.indexOf(value) === index)\n}\n\n/**\n * @template T\n * @param {T[]} arr\n * @param {T[]} items\n * @returns {number}\n */\nexport function arrPushIfNew(arr, ...items) {\n\tfor (let i = 0; i < items.length; i++)\n\t\tif (!arr.includes(items[i])) {\n\t\t\tarr.push(items[i])\n\t\t}\n\treturn arr.length\n}\n/**\n * @template T\n * @param {T[]} arr\n * @param {T} item\n * @returns {T[]}\n */\nexport function toggleInArr(arr, item) {\n\tif (arr.includes(item)) arr = arr.filter(i => i !== item)\n\telse arr.push(item)\n\treturn arr\n}\n\n/**\n * @template TKey\n * @template TVal\n * @param {Map<TKey, TVal[]>} map\n * @param {TKey} key\n * @param {TVal} val\n * @returns {TVal[]}\n */\nexport function mappedArrPush(map, key, val) {\n\tlet values = map.get(key)\n\tif (values) {\n\t\tvalues.push(val)\n\t} else {\n\t\tvalues = [val]\n\t\tmap.set(key, values)\n\t}\n\treturn values\n}\n\n/**\n * @template T\n * @param {T[]} arr\n * @param {(item:T) => boolean} func\n * @returns {T[][]}\n */\nexport function arrSplitFn(arr, func) {\n\tconst res = /**@type {T[][]}*/ ([[]])\n\tfor (let i = 0; i < arr.length; i++) {\n\t\tconst item = arr[i]\n\t\tif (func(item)) res.push([])\n\t\telse res[res.length - 1].push(item)\n\t}\n\treturn res\n}\n\n/**\n * @param {unknown[]} a\n * @param {unknown[]} b\n */\nexport function arrShallowEqualAsSets(a, b) {\n\tif (a.length !== b.length) return false\n\tfor (let i = 0; i < a.length; i++) if (!b.includes(a[i])) return false\n\treturn true\n}\n\n/**\n * @param {unknown[]} a\n * @param {unknown[]} b\n */\nexport function arrShallowEqual(a, b) {\n\tif (a.length !== b.length) return false\n\tfor (let i = 0; i < a.length; i++) if (a[i] !== b[i]) return false\n\treturn true\n}\n\n/**\n * @template {string} TKey\n * @template TVal\n * @param {Record<TKey, TVal>} obj\n * @param {(a:[TKey,TVal], b:[TKey,TVal]) => number} sortFunc\n * @returns {Record<TKey, TVal>}\n */\nexport function sortObject(obj, sortFunc) {\n\tconst entries = /**@type {[TKey,TVal][]}*/ (Object.entries(obj)).sort(sortFunc)\n\tfor (const key in obj) delete obj[key]\n\tfor (const [key, val] of entries) obj[key] = val\n\treturn obj\n}\n/**\n * @template T\n * @param {T[]} arr\n * @param {T} item\n * @param {1|-1} [direction]\n * @returns {T}\n */\nexport function arrGetAfter(arr, item, direction = 1) {\n\tconst index = arr.indexOf(item)\n\treturn arr[(index + direction + arr.length) % arr.length]\n}\n\n/**\n * @template TKey\n * @template TVal\n * @param {Map<TKey, TVal>} map\n * @param {TKey} key\n * @param {() => TVal} defaultFunc\n * @returns {TVal}\n */\nexport function mapGetOrSet(map, key, defaultFunc) {\n\tlet value = map.get(key)\n\tif (value === undefined) {\n\t\tvalue = defaultFunc()\n\t\tmap.set(key, value)\n\t}\n\treturn value\n}\n\n/**\n * @template {string} TKey\n * @template TVal\n * @param {Partial<Record<TKey, TVal>>} obj\n * @param {TKey} key\n * @param {() => TVal} defaultFunc\n * @returns {TVal}\n */\nexport function objGetOrSet(obj, key, defaultFunc) {\n\tlet value = obj[key]\n\tif (value === undefined) {\n\t\tobj[key] = value = defaultFunc()\n\t}\n\treturn /**@type {TVal}*/ (value)\n}\n\n/**\n * @param {unknown} obj\n * @param {(item:unknown) => undefined|true|'skip-children'} func return true to abort iteration\n * @returns {boolean}\n */\nexport function objForEach(obj, func) {\n\tconst res = func(obj)\n\tif (res === 'skip-children') return false\n\tif (res) return true\n\n\tif (Array.isArray(obj)) {\n\t\tfor (const item of obj) if (objForEach(item, func)) return true\n\t} else if (typeof obj === 'object' && obj !== null) {\n\t\tfor (const attr in obj) if (objForEach(obj[attr], func)) return true\n\t}\n\treturn false\n}\n\n/**\n * @template T\n * @param {T | T[]} item\n * @returns {T[]}\n */\nexport function arrOrItemToArr(item) {\n\treturn Array.isArray(item) ? item : [item]\n}\n/**\n * @template T\n * @param {T[]} arr\n * @returns {T[] | T}\n */\nexport function arrItemIfSingle(arr) {\n\treturn arr.length === 1 ? arr[0] : arr\n}\n","export type BS_BreakpointCode = 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'xxl'\nexport const BS_BreakpointsCodes: BS_BreakpointCode[] = ['xs', 'sm', 'md', 'lg', 'xl', 'xxl']\n\nexport const BS_BreakpointsMap = { xs: 0, sm: 576, md: 768, lg: 992, xl: 1200, xxl: 1400 }\nexport function BS_getCurrBreakpoint(screenWidth: number): BS_BreakpointCode {\n\treturn (\n\t\t//todo  \n\t\t(Object.keys(BS_BreakpointsMap).find(k => screenWidth < BS_BreakpointsMap[k]) as BS_BreakpointCode) ||\n\t\t('xxl' as BS_BreakpointCode)\n\t)\n}\nexport function BS_isBreakpointLessThen(br: BS_BreakpointCode, targetBr: BS_BreakpointCode): boolean {\n\treturn BS_BreakpointsCodes.indexOf(br) <= BS_BreakpointsCodes.indexOf(targetBr)\n}\n","import { Ref, RefObject } from 'preact'\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'preact/hooks'\n\nimport { arrShallowEqual } from '#lib/utils/collections'\nimport { isPromise } from '#lib/utils/values'\nimport { logError } from '#src/errors'\nimport { BS_BreakpointCode, BS_getCurrBreakpoint } from '#src/utils/bootstrap'\n\ntype Pending = { _type: 'pending' }\n\nexport const PENDING: Pending = {} as never\n\nexport type LoadingState<T> = T | Error | Pending\n\nexport function isLoaded<T>(value: LoadingState<T>): value is T {\n\treturn value !== PENDING && !(value instanceof Error)\n}\n\nexport function useFetch<T>(\n\tloadFunc: (abortSignal: AbortSignal) => T,\n\targs: unknown[],\n): LoadingState<Awaited<T>> {\n\tconst controller = useRef<AbortController | null>(null)\n\tconst prevArgs = useRef<unknown[] | null>(null)\n\tconst data = useRef<LoadingState<Awaited<T>>>(PENDING)\n\tconst foceUpdate = useForceUpdate()\n\n\tif (prevArgs.current === null || !arrShallowEqual(prevArgs.current, args)) {\n\t\tif (controller.current !== null) controller.current.abort()\n\t\tconst ac: AbortController | null = new AbortController()\n\t\tcontroller.current = ac\n\n\t\tconst res = loadFunc(ac.signal)\n\t\tif (isPromise(res)) {\n\t\t\tres.then(res => (data.current = res as Awaited<T>))\n\t\t\t\t.catch(err => (data.current = err))\n\t\t\t\t.finally(foceUpdate)\n\t\t\tdata.current = PENDING\n\t\t} else {\n\t\t\tdata.current = res as Awaited<T>\n\t\t}\n\n\t\tprevArgs.current = args\n\t}\n\n\t//    \n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (controller.current !== null) controller.current.abort()\n\t\t}\n\t}, [])\n\treturn data.current\n}\n\nexport function useFetchWithPrev<T>(\n\tloadFunc: (abortSignal: AbortSignal) => Promise<T> | T,\n\targs: unknown[],\n): [data: LoadingState<T>, isUpdating: boolean] {\n\tconst prevDataRef = useRef<LoadingState<T>>(PENDING)\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst data = useFetch(loadFunc, args)\n\tif (isLoaded(data)) prevDataRef.current = data\n\treturn [isLoaded(data) ? data : prevDataRef.current, data === PENDING]\n}\n\nexport const useToggle = (initial: boolean): [boolean, () => void] => {\n\tconst [flagState, setFlagState] = useState(initial)\n\treturn [flagState, useCallback(() => setFlagState(status => !status), [])]\n}\n\nexport const useClickAway = (\n\trefs: preact.RefObject<HTMLElement> | preact.RefObject<HTMLElement>[],\n\tcallback?: () => void,\n): void => {\n\tconst handleClick = (e: MouseEvent | TouchEvent) => {\n\t\tconst refsLocal = Array.isArray(refs) ? refs : [refs]\n\t\tconst isClickAwayEveryone = refsLocal.every(\n\t\t\tref => ref.current && e.target instanceof HTMLElement && !ref.current.contains(e.target),\n\t\t)\n\t\tif (isClickAwayEveryone) callback && callback()\n\t}\n\tuseEffect(() => {\n\t\tdocument.addEventListener('mousedown', handleClick)\n\t\tdocument.addEventListener('touchstart', handleClick)\n\t\t// document.addEventListener('click', handleClick)\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('mousedown', handleClick)\n\t\t\tdocument.removeEventListener('touchstart', handleClick)\n\t\t\t// document.removeEventListener('click', handleClick)\n\t\t}\n\t})\n}\n\nexport type WindowSize = {\n\twidth: number | undefined\n\theight: number | undefined\n\tbreakpoint: BS_BreakpointCode\n}\nexport function useWindowSize(): WindowSize {\n\tconst [windowSize, setWindowSize] = useState<WindowSize>({\n\t\twidth: window.innerWidth,\n\t\theight: window.innerHeight,\n\t\tbreakpoint: BS_getCurrBreakpoint(window.innerWidth),\n\t})\n\tuseEffect(() => {\n\t\tfunction handleResize() {\n\t\t\tsetWindowSize({\n\t\t\t\twidth: window.innerWidth,\n\t\t\t\theight: window.innerHeight,\n\t\t\t\tbreakpoint: BS_getCurrBreakpoint(window.innerWidth),\n\t\t\t})\n\t\t}\n\t\twindow.addEventListener('resize', handleResize)\n\t\thandleResize()\n\t\treturn () => window.removeEventListener('resize', handleResize)\n\t}, [])\n\treturn windowSize\n}\n\ndeclare global {\n\tinterface WindowEventMap {\n\t\t'x-local-tab-storage': CustomEvent<{ key: string }>\n\t\t'x-local-hashchange': CustomEvent<null>\n\t}\n}\n\nexport function useLocalStorage<T>(key: string, initialValue: T): [T, (val: T) => unknown] {\n\tconst [value, setValueInner] = useState(() => {\n\t\ttry {\n\t\t\tconst curRecord = localStorage.getItem(key) //reading 'localStorage' from window may fail with SecurityError\n\t\t\treturn curRecord ? JSON.parse(curRecord) : initialValue //JSON parsing may fail\n\t\t} catch (ex) {\n\t\t\tlogError(ex)\n\t\t\treturn initialValue\n\t\t}\n\t})\n\n\tconst setValueAndSave = useCallback(\n\t\t(val: T) => {\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem(key, JSON.stringify(val)) //reading 'localStorage' from window may fail with SecurityError\n\t\t\t} catch (ex) {\n\t\t\t\t// \\_()_/\n\t\t\t}\n\t\t\tsetValueInner(val)\n\t\t\tdispatchEvent(new CustomEvent('x-local-tab-storage', { detail: { key } }))\n\t\t},\n\t\t[key],\n\t)\n\n\tuseEffect(() => {\n\t\tfunction onStorage(e: StorageEvent | CustomEvent<{ key: string }>) {\n\t\t\tconst affectedKey = 'detail' in e ? e.detail.key : e.key\n\t\t\tif (affectedKey === key) {\n\t\t\t\ttry {\n\t\t\t\t\tconst curRecord = localStorage.getItem(key) //reading 'localStorage' from window may fail with SecurityError\n\t\t\t\t\tif (curRecord) setValueInner(JSON.parse(curRecord)) //JSON parsing may fail\n\t\t\t\t} catch (ex) {\n\t\t\t\t\tconsole.log(ex)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\taddEventListener('storage', onStorage)\n\t\taddEventListener('x-local-tab-storage', onStorage)\n\t\treturn () => {\n\t\t\tremoveEventListener('storage', onStorage)\n\t\t\tremoveEventListener('x-local-tab-storage', onStorage)\n\t\t}\n\t}, [key])\n\n\treturn [value, setValueAndSave]\n}\n\nexport type Migration<TIn, TOut> = (val: TIn) => TOut\ntype MigrationResult<T> = T extends Migration<infer _A, infer B> ? B : never\ntype Last<T> = T extends readonly [...infer _I, infer L] ? L : never\ntype VersionedValue<T> = { version: number; value: T }\n\nexport function useVersionedStorage<T extends readonly Migration<unknown, unknown>[]>({\n\tkey,\n\tversions,\n}: {\n\tkey: string\n\tversions: T\n}): [MigrationResult<Last<T>>, (val: MigrationResult<Last<T>>) => unknown] {\n\tconst [val, setVal] = useLocalStorage<VersionedValue<unknown> | null>(key, null)\n\n\tlet version = -1\n\tlet value = null as unknown\n\tif (val && typeof val === 'object' && 'version' in val) {\n\t\t;({ version, value } = val)\n\t}\n\tfor (let i = version + 1; i < versions.length; i++) {\n\t\tvalue = versions[i](value)\n\t\tversion = i\n\t}\n\n\tconst setValInner = useCallback(\n\t\t(value: MigrationResult<Last<T>>) => {\n\t\t\tsetVal({ version, value })\n\t\t},\n\t\t[setVal, version],\n\t)\n\treturn [value as MigrationResult<Last<T>>, setValInner]\n}\n\nexport function useHover<T extends Element>(): [RefObject<T>, boolean] {\n\tconst [value, setValue] = useState<boolean>(false)\n\tconst ref = useRef<T | null>(null)\n\tuseEffect(\n\t\t() => {\n\t\t\tconst node = ref.current\n\t\t\tif (!node) return\n\n\t\t\tconst handleMouseOver = () => setValue(true)\n\t\t\tconst handleMouseOut = () => setValue(false)\n\t\t\tnode.addEventListener('mouseover', handleMouseOver)\n\t\t\tnode.addEventListener('mouseout', handleMouseOut)\n\t\t\treturn () => {\n\t\t\t\tsetValue(false)\n\t\t\t\tnode.removeEventListener('mouseover', handleMouseOver)\n\t\t\t\tnode.removeEventListener('mouseout', handleMouseOut)\n\t\t\t}\n\t\t},\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t\t[ref.current],\n\t)\n\treturn [ref, value]\n}\n\nexport const useWindowVisibility = () => {\n\tconst [isVisible, setIsVisible] = useState(\n\t\t// Focus for first render\n\t\tBUNDLE_ENV.IS_SSR ? true : document.visibilityState === 'visible',\n\t)\n\tuseEffect(() => {\n\t\tconst onVisibilityChange = () => setIsVisible(document.visibilityState === 'visible')\n\t\tconst onPageHide = () => setIsVisible(false)\n\t\tconst onPageShow = () => setIsVisible(true)\n\t\tdocument.addEventListener('visibilitychange', onVisibilityChange)\n\t\twindow.addEventListener('pagehide', onPageHide)\n\t\twindow.addEventListener('pageshow', onPageShow)\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('visibilitychange', onVisibilityChange)\n\t\t\twindow.removeEventListener('pagehide', onPageHide)\n\t\t\twindow.removeEventListener('pageshow', onPageShow)\n\t\t}\n\t}, [])\n\treturn isVisible\n}\n/*\n * not used\n *\nexport function useInterval(callback: () => void, delay: number | null) {\n\tconst savedCallback = useRef(callback)\n\t// Remember the latest callback if it changes.\n\tuseLayoutEffect(() => {\n\t\tsavedCallback.current = callback\n\t}, [callback])\n\n\t// Set up the interval.\n\tuseEffect(() => {\n\t\t// Don't schedule if no delay is specified.\n\t\t// Note: 0 is a valid value for delay.\n\t\tif (!delay && delay !== 0) {\n\t\t\treturn\n\t\t}\n\n\t\tconst id = setInterval(() => savedCallback.current(), delay)\n\t\treturn () => clearInterval(id)\n\t}, [delay])\n}\n*/\nexport function useForceUpdate(): () => void {\n\tconst setValue = useState(0)[1]\n\treturn useRef(() => setValue(v => ~v)).current\n}\n\nexport function useOnce(args: unknown[]): boolean {\n\tconst ref = useRef(true)\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tuseMemo(() => (ref.current = true), args)\n\tconst flag = ref.current\n\tref.current = false\n\treturn flag\n}\n\nexport function useUniqKey(): number {\n\tconst key = useMemo(() => {\n\t\treturn Math.random()\n\t}, [])\n\treturn key\n}\n\nexport function useVisibleTicker(callback: () => void, interval: number) {\n\tconst isVisible = useWindowVisibility()\n\n\tuseEffect(() => {\n\t\tif (!isVisible) return\n\t\tlet id\n\t\tfunction callbackInner() {\n\t\t\tcallback()\n\t\t\tid = setTimeout(callbackInner, interval - (Date.now() % interval) + 10)\n\t\t}\n\t\tcallbackInner()\n\t\treturn () => clearTimeout(id)\n\t\t//     \n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [interval, isVisible])\n}\n\nexport function useDocumentTitle(title: string, shouldRestoreOnUnmount = false) {\n\tconst defaultTitle = useRef(document.title).current\n\n\t// useEffect  :      \n\tuseMemo(() => {\n\t\tdocument.title = title\n\t}, [title])\n\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tif (shouldRestoreOnUnmount) {\n\t\t\t\tdocument.title = defaultTitle\n\t\t\t}\n\t\t}\n\t}, [shouldRestoreOnUnmount, defaultTitle])\n}\n\nexport function usePageDescription(func: () => string | null) {\n\tif (BUNDLE_ENV.IS_SSR) {\n\t\tSSR_ENV.outPageDescription = func()\n\t} else if (process.env.NODE_ENV === 'development') {\n\t\tconst description = func()\n\t\t// eslint-disable-next-line react-hooks/rules-of-hooks\n\t\tuseEffect(() => {\n\t\t\tfor (const meta of document.querySelectorAll('meta[name=\"description\"]')) {\n\t\t\t\tmeta.remove()\n\t\t\t}\n\t\t\tif (description !== null) {\n\t\t\t\tconst meta = document.createElement('meta')\n\t\t\t\tmeta.name = 'description'\n\t\t\t\tmeta.content = description\n\t\t\t\tdocument.head.appendChild(meta)\n\t\t\t}\n\t\t}, [description])\n\t}\n}\n\nexport function useHashValue<T extends string | null>(\n\tkey: string,\n\tdefaultValue: T,\n): [string | T, (key: T) => void] {\n\tconst [val, setVal] = useState(getHashValue(key) ?? defaultValue)\n\n\t//       \n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tuseMemo(() => setHashValue(key, val), [key])\n\n\t//     \n\tuseEffect(() => {\n\t\treturn () => setHashValue(key, null)\n\t}, [key])\n\n\tuseEffect(() => {\n\t\tfunction onHashChange() {\n\t\t\tsetVal(getHashValue(key) ?? defaultValue)\n\t\t}\n\t\taddEventListener('hashchange', onHashChange)\n\t\taddEventListener('x-local-hashchange', onHashChange)\n\t\treturn () => {\n\t\t\tremoveEventListener('hashchange', onHashChange)\n\t\t\tremoveEventListener('x-local-hashchange', onHashChange)\n\t\t}\n\t}, [key, defaultValue])\n\n\tconst setValAndHash = useCallback(\n\t\t(val: T) => {\n\t\t\tsetVal(val)\n\t\t\tsetHashValue(key, val)\n\t\t\tdispatchEvent(new CustomEvent('x-local-hashchange'))\n\t\t},\n\t\t[key],\n\t)\n\treturn [val, setValAndHash]\n}\nfunction getHashValue(key: string) {\n\treturn new URLSearchParams(location.hash.slice(1)).get(key)\n}\nfunction setHashValue(key: string, val: string | null) {\n\tconst params = new URLSearchParams(location.hash.slice(1))\n\tif (params.get(key) !== val) {\n\t\tif (val === null) {\n\t\t\tparams.delete(key)\n\t\t} else {\n\t\t\tparams.set(key, val)\n\t\t}\n\t\tlet hash = params.toString()\n\t\tif (hash !== '') hash = '#' + hash\n\t\tconst { origin, pathname, search } = location\n\t\tconsole.log('history', hash, location.hash)\n\t\thistory.replaceState(history.state, '', origin + pathname + search + hash)\n\t}\n}\nexport function useScrollTo<T extends Element>(\n\tshouldScrollToArg: boolean,\n\tscrollParams?: ScrollIntoViewOptions,\n): [Ref<T>, (flag: boolean) => void] {\n\tconst ref = useRef<T>(null)\n\tconst [shouldScrollTo, setShouldScrollTo] = useState(false)\n\tuseEffect(() => {\n\t\tif (ref.current && (shouldScrollTo || shouldScrollToArg)) {\n\t\t\tlet params: ScrollIntoViewOptions = { behavior: 'smooth' }\n\t\t\tif (scrollParams) params = { ...params, ...scrollParams }\n\t\t\tref.current.scrollIntoView(params)\n\t\t\tsetShouldScrollTo(false)\n\t\t}\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [shouldScrollTo, shouldScrollToArg])\n\treturn [ref, setShouldScrollTo]\n}\nexport function useScrollPosition(): number {\n\tconst [scrollPosition, setScrollPosition] = useState<number>(0)\n\n\tuseEffect(() => {\n\t\tconst setScrollPositionLocal = () => {\n\t\t\tsetScrollPosition(window.pageYOffset)\n\t\t}\n\t\twindow.addEventListener('scroll', setScrollPositionLocal)\n\t\tsetScrollPositionLocal()\n\t\treturn () => window.removeEventListener('scroll', setScrollPositionLocal)\n\t}, [])\n\n\treturn scrollPosition\n}\n","export const BULLET = ''\nexport const TIMES = ''\nexport const LEFT_POINTING = ''\nexport const RIGHT_POINTING = ''\nexport const TOP_POINTING = ''\nexport const ELLIPSIS = ''\nexport const STAR = ''\nexport const HEART = ''\nexport const HEART_EMPTY = ''\nexport const VARIATION_SELECTOR = '\\uFE0E'\nexport const NBSP = ''\nexport const DASH = ''\n","import { useCallback } from 'preact/hooks'\n\nimport { useScrollPosition } from '#src/utils/hooks'\nimport { TOP_POINTING } from '#src/utils/typography'\n\nexport function GoUpBtn({ classes = '' }: { classes?: string }): JSX.Element | null {\n\tconst onClick = useCallback(() => {\n\t\twindow.scrollTo(0, 0)\n\t}, [])\n\tconst scrollPos = useScrollPosition()\n\tif (scrollPos < 10) return null\n\treturn (\n\t\t<button\n\t\t\tclassName={`btn rounded-circle lh-1 header-main-bg bottom-0 left-0 p-1 text-center m-1 ${classes} d-none d-md-block`}\n\t\t\tstyle={{ position: 'fixed' }}\n\t\t\tonClick={onClick}\n\t\t>\n\t\t\t<span>{TOP_POINTING}</span>\n\t\t</button>\n\t)\n}\n","export function PageWrap({ children }): JSX.Element {\n\treturn <div className=\"page py-4\">{children}</div>\n}\n","export const LINK_DISCORD_INVITE = 'https://discord.gg/YapnrQ63bD'\r\nexport const LINK_TELEGRAM_RU = 'https://t.me/genshin_base'\r\nexport const LINK_TELEGRAM_UA = 'https://t.me/genshin_base_media_ua'\r\n\r\nexport const LINK_KO_FI = 'https://ko-fi.com/genshinbase'\r\nexport const LINK_DONATELLO = 'https://donatello.to/genshinbase'\r\nexport const LINK_DONATION_ALERTS = 'https://www.donationalerts.com/r/genshinbase'\r\n\r\nexport const LINK_YOUTUBE_RU = 'https://www.youtube.com/@Genshin_Base_Media_RU'\r\nexport const LINK_YOUTUBE_UA = 'https://www.youtube.com/@Genshin_Base_Media_UA'\r\n\r\nexport const LINK_TIKTOK_RU = 'https://www.tiktok.com/@genshin_base_ru' //todo genshin_base_media_ru\r\nexport const LINK_TIKTOK_UA = 'https://www.tiktok.com/@genshin_base_media_ua'\r\n\r\nexport const LINK_GOOGLE_FORM_ORDER_SITE = 'https://forms.gle/WtWCxStRy5kqDwFY8'\r\n\r\nexport const LINK_HELPER_TEAM_TABLE =\r\n\t'https://docs.google.com/spreadsheets/d/1gNxZ2xab1J6o1TuNVWMeLOZ7TPOqrsf3SshP5DLvKzI/pubhtml#'\r\nexport const LINK_HONEY_IMPACT = 'https://genshin.honeyhunterworld.com/'\r\nexport const LINK_GI_MAP = 'https://webstatic-sea.hoyolab.com/ys/app/interactive-map/index.html'\r\nexport const LINK_GI_WIKI = 'https://genshin-impact.fandom.com/wiki/Genshin_Impact_Wiki'\r\nexport const LINK_AKASHADATA = 'https://akashadata.feixiaoqiu.com/'\r\n","import {\n\tGI_ArtifactGroupCode,\n\tGI_ArtifactTypeCode,\n\tGI_KnownStatBonusCode,\n\tGI_WeaponObtainSource,\n\tGI_WeaponTypeCode,\n\tMapCode,\n} from '#lib/genshin'\nimport { GI_TalentCode } from '#lib/parsing/helperteam/types'\nimport { LINK_DISCORD_INVITE } from '#src/utils/links'\nimport { BULLET, DASH, ELLIPSIS, NBSP } from '#src/utils/typography'\n\ntype Lang = 'en' | 'ru'\nexport const LANG = BUNDLE_ENV.LANG as Lang\nexport const I18N_LANG_NAMES: Record<Lang, string> = {\n\ten: 'English',\n\tru: '',\n}\nexport const I18N_LANG_NAME = I18N_LANG_NAMES[LANG]\nexport const I18N_PAGE_TITLE_POSTFIX = { en: ` ${BULLET} Genshin Base`, ru: ` ${BULLET}  ` }[LANG]\nexport const I18N_LOADING = { en: 'Loading', ru: '' }[LANG]\nexport const I18N_COLLAPSE = { en: 'Collapse', ru: '' }[LANG]\nexport const I18N_DASHBOARD = { en: 'Dashboard', ru: ' ' }[LANG]\nexport const I18N_REGION = { en: 'Region', ru: '' }[LANG]\nexport const I18N_UNTIL_DAY_RESET = { en: 'Until Day Reset', ru: '  ' }[LANG]\nexport const I18N_ALCHEMY_CALC = { en: 'Alchemy Calculator', ru: ' ' }[LANG]\nexport const I18N_WHAT_TO_FARM = { en: 'What to Farm', ru: ' ' }[LANG]\nexport const I18N_BUILDS = { en: 'Builds', ru: ' ' }[LANG]\nexport const I18N_ASIA = { en: 'Asia', ru: '' }[LANG]\nexport const I18N_NORH_AMERICA = { en: 'North America', ru: ' ' }[LANG]\nexport const I18N_EUROPE = { en: 'Europe', ru: '' }[LANG]\nexport const I18N_MINUTE = { en: 'minute', ru: '' }[LANG]\nexport const I18N_MINUTES = { en: 'minutes', ru: '' }[LANG]\nexport const I18N_MINUTES_3 = { en: 'minutes', ru: '' }[LANG]\nexport const I18N_TODAY = { en: 'today', ru: '' }[LANG]\nexport const I18N_WEEKDAYS = {\n\ten: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'],\n\tru: ['', '', '', '', '', '', ''],\n}[LANG]\nexport const I18N_TOMORROW = { en: 'tomorrow', ru: '' }[LANG]\nexport const I18N_DUNGEONS = { en: 'Dungeons', ru: '' }[LANG]\nexport const I18N_TALENTS = { en: 'Talents', ru: '' }[LANG]\nexport const I18N_WEAPONS = { en: 'Weapons', ru: '' }[LANG]\nexport const I18N_MAIN_INFO = { en: 'main info', ru: ' ' }[LANG]\nexport const I18N_WEAPON_STACKS_COUNT = {\n\ten: (stacks: number) => stacks + ' ' + pluralizeEN(stacks, 'stack', 'stacks'),\n\tru: (stacks: number) => stacks + ' ' + pluralizeRU(stacks, '', '', ''),\n}[LANG]\nexport const I18N_WEAPON_REFINE = {\n\ten: (refine: string) => 'R' + refine,\n\tru: (refine: string) => '' + refine,\n}[LANG]\nexport const I18N_WHY_ADD_TO_FAVS_TIP = {\n\ten: 'Add characters or items to your favorites to see them marked here.',\n\tru: '     ,    ',\n}[LANG]\nexport const I18N_FAV_CHARACTERS = { en: 'Favorite characters', ru: ' ' }[LANG]\n\nexport const I18N_FAV_TIPS = {\n\ten: (() => {\n\t\tconst add = (s: string) => `Add ${s} to favourites`\n\t\tconst remove = (s: string) => `Remove ${s} from favourites`\n\t\treturn {\n\t\t\tadd: { weapon: add('weapon'), character: add('character'), material: add('material') },\n\t\t\tremove: {\n\t\t\t\tweapon: remove('weapon'),\n\t\t\t\tcharacter: remove('character'),\n\t\t\t\tmaterial: remove('material'),\n\t\t\t},\n\t\t}\n\t})(),\n\tru: (() => {\n\t\tconst add = (s: string) => ` ${s}  `\n\t\tconst remove = (s: string) => ` ${s}  `\n\t\treturn {\n\t\t\tadd: { weapon: add(''), character: add(''), material: add('') },\n\t\t\tremove: {\n\t\t\t\tweapon: remove(''),\n\t\t\t\tcharacter: remove(''),\n\t\t\t\tmaterial: remove(''),\n\t\t\t},\n\t\t}\n\t})(),\n}[LANG]\nexport const I18N_CHOOSE_FROM_FAV = {\n\ten: 'Choose from favorite',\n\tru: '  ',\n}[LANG]\nexport const I18N_ARTIFACTS = { en: 'Artifacts', ru: '' }[LANG]\nexport const I18N_CHARACTERS = { en: 'Characters', ru: '' }[LANG]\nexport const I18N_ART_STATS_PRIORITY = { en: 'Artifact stats priority', ru: ' ' }[LANG]\nexport const I18N_SUBSTATS_PRIORITY = { en: 'Substats priority', ru: ' ' }[LANG]\nexport const I18N_TALENTS_PRIORITY = { en: 'Talents Priority', ru: ' ' }[LANG]\nexport const I18N_ASC_MATERIALS = { en: 'Ascension materials', ru: ' ' }[LANG]\nexport const I18N_FULL_BUILD_INFO = { en: 'Full build info', ru: '   ' }[LANG]\nexport const I18N_CHAR_LORE = { en: 'Character lore', ru: ' ' }[LANG]\nexport const I18N_MORE_ON_BUILDS_PAGE = {\n\ten: 'more on build page',\n\tru: '   ',\n}[LANG]\nexport const I18N_BACK = { en: 'Back', ru: '' }[LANG]\nexport const I18N_NOTES = { en: 'Notes', ru: '' }[LANG]\n\nconst artTypeNamesRU: Record<GI_ArtifactTypeCode, string> = {\n\tflower: '',\n\tplume: '',\n\tsands: '',\n\tgoblet: '',\n\tcirclet: '',\n}\nexport const I18N_ART_TYPE = {\n\ten: (code: GI_ArtifactTypeCode) => code as string,\n\tru: (code: GI_ArtifactTypeCode) => artTypeNamesRU[code],\n}[LANG]\n\nconst statNamesRu: Record<GI_KnownStatBonusCode, string> = {\n\tdef: '',\n\t'def%': '% ',\n\tdmg: '',\n\t'dmg%': '% ',\n\tatk: ' ',\n\t'atk%': '% ',\n\thp: '',\n\t'hp%': '% ',\n\tem: ' ',\n\ter: ' ',\n\t'er%': '%  ',\n\thealing: '',\n\t'healing%': '% ',\n\t'crit-rate': ' . ',\n\t'crit-rate%': '% . ',\n\t'crit-dmg': '. ',\n\t'crit-dmg%': '% . ',\n\t'phys-dmg': '. ',\n\t'cryo-dmg': ' ',\n\t'geo-dmg': ' ',\n\t'anemo-dmg': ' ',\n\t'hydro-dmg': ' ',\n\t'electro-dmg': ' ',\n\t'pyro-dmg': ' ',\n\t'dendro-dmg': ' ',\n\t'phys-dmg%': '% . ',\n\t'cryo-dmg%': '%  ',\n\t'geo-dmg%': '%  ',\n\t'anemo-dmg%': '%  ',\n\t'hydro-dmg%': '%  ',\n\t'electro-dmg%': '%  ',\n\t'pyro-dmg%': '%  ',\n\t'dendro-dmg%': '%  ',\n}\nexport const I18N_STAT_NAME = {\n\ten: (code: string) => code.replace(/-/g, ' '),\n\tru: (code: string) => statNamesRu[code] ?? code,\n}[LANG]\n\ntype TalentTypeNames = Record<GI_TalentCode, string>\nconst talentTypesNamesRU: TalentTypeNames = {\n\tattack: ' ',\n\tskill: ' ',\n\tburst: ' ',\n}\nexport const I18N_TALENT_NAME = {\n\ten: (code: GI_TalentCode) => code,\n\tru: (code: GI_TalentCode) => talentTypesNamesRU[code],\n}[LANG]\n\ntype ConjuctionType = 'or' | 'and'\nexport const I18N_CONJUCTIONS: Record<ConjuctionType, string> = {\n\ten: { or: 'or', and: 'and' },\n\tru: { or: '', and: '' },\n}[LANG]\n\nexport const I18N_RECOMMENDED_FOR = { en: 'Recommended for', ru: ' ' }[LANG]\nexport const I18N_FOR_NOBODY = { en: 'Nobody', ru: '' }[LANG]\nexport const I18N_SOURCE = { en: 'Source', ru: '' }[LANG]\nexport const I18N_SCROLL_TO_ZOOM = { en: 'Scroll to zoom', ru: ' ' }[LANG]\nexport const I18N_PINCH_TO_ZOOM = { en: 'Pinch to zoom', ru: ' ' }[LANG]\nexport const I18N_CANCEL = { en: 'cancel', ru: '' }[LANG]\nexport const I18N_SUBMIT = { en: 'submit', ru: '' }[LANG]\nexport const I18N_SUBMIT_BUG_SUCCESS = { en: 'Message sent. Thank you', ru: ' . ' }[\n\tLANG\n]\nexport const I18N_SUBMIT_BUG_ERROR = {\n\ten: 'Error happened while sending message. Please disable adblock or try again later, or contact us on Discord',\n\tru: '   .      ,      ',\n}[LANG]\nexport const I18N_YOUR_MESSAGE_HERE = { en: 'Your message here', ru: ' ' }[LANG]\nexport const I18N_REPORT_BUG_GUIDE = {\n\ten: () => (\n\t\t<>\n\t\t\t<p>\n\t\t\t\tPlease describe your problem here. You can upload images on{' '}\n\t\t\t\t<a href=\"https://imgur.com/upload\" target=\"_blank\">\n\t\t\t\t\timgur.com\n\t\t\t\t</a>{' '}\n\t\t\t\tand use generated links to them in your message.\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\tOr message us on{' '}\n\t\t\t\t<a href={LINK_DISCORD_INVITE} target=\"_blank\">\n\t\t\t\t\tour Discord server\n\t\t\t\t</a>\n\t\t\t\t!\n\t\t\t</p>\n\t\t</>\n\t),\n\tru: () => (\n\t\t<>\n\t\t\t<p>\n\t\t\t\t,     .  ,     \n\t\t\t\t{' '}\n\t\t\t\t<a href=\"https://imgur.com/upload\" target=\"_blank\">\n\t\t\t\t\timgur.com\n\t\t\t\t</a>{' '}\n\t\t\t\t       .\n\t\t\t</p>\n\t\t\t<p>\n\t\t\t\t   {' '}\n\t\t\t\t<a href={LINK_DISCORD_INVITE} target=\"_blank\">\n\t\t\t\t\ta   \n\t\t\t\t</a>\n\t\t\t\t!\n\t\t\t</p>\n\t\t</>\n\t),\n}[LANG]()\nexport const I18N_ERROR = { en: 'Error, reload page', ru: ',  ' }[LANG]\nexport const I18N_PIECE_BONUS = {\n\ten: (n: number) => `${n} piece bonus`,\n\tru: (n: number) => ` ${n} `,\n}[LANG]\nexport const I18N_PIECES_BONUS = {\n\ten: (n: number) => `${n} pieces bonus`,\n\tru: (n: number) => ` ${n} `,\n}[LANG]\nexport const I18N_BASE_ATTACK = { en: 'Base attack', ru: ' ' }[LANG]\nexport const I18N_ITEM_STORY = { en: 'Item Story', ru: ' ' }[LANG]\nexport const I18N_ON_MAP = { en: 'On map', ru: ' ' }[LANG]\nexport const I18N_SECONDARY_STAT = { en: 'Secondary Stat', ru: ' ' }[LANG]\ntype MapCodeName = Record<MapCode, string>\nexport const I18N_MAP_CODES_NAME: MapCodeName = {\n\ten: { teyvat: 'Teyvat', enkanomiya: 'Enkanomiya', chasm: 'The Chasm' },\n\tru: { teyvat: '', enkanomiya: '', chasm: '' },\n}[LANG]\nexport const I18N_CHAR_BUILD_RECS = {\n\ten: 'Character builds recommendations',\n\tru: '  ',\n}[LANG]\nexport const I18N_BEST_CHAR_BUILDS = {\n\ten: 'Best builds for Genshin characters',\n\tru: '    ',\n}[LANG]\nexport const I18N_FOR_EXAMPLE = {\n\ten: 'For example' + ELLIPSIS,\n\tru: '' + ELLIPSIS,\n}[LANG]\nexport const I18N_SELECT_CHAR_BELOW = { en: 'Select character below', ru: ' ' }[LANG]\nexport const I18N_BUILD_RECS_FOR = { en: 'build recommendations', ru: '' }[LANG]\nexport const I18N_RECOMMENDED_RU_ONLY = { en: '', ru: '' }[LANG]\nexport const I18N_ABOUT_SITE = { en: 'Site History', ru: ' ' }[LANG]\nexport const I18N_OUR_SOCIAL_NETWORKS = { en: 'Social', ru: '  ' }[LANG]\nexport const I18N_PAGE_WITH_ALL_LINKS = { en: 'Page with all links', ru: '   ' }[LANG]\nexport const I18N_WE_ARE_EVERYWHERE = { en: 'We are everywhere', ru: ' ' }[LANG]\nexport const I18N_CHATS = { en: 'Chats', ru: '' }[LANG]\nexport const I18N_VIDEOS = { en: 'Videos', ru: '' }[LANG]\n// export const I18N_PICTURES = { en: 'Images', ru: '' }[LANG]\nexport const I18N_DONATE_US = { en: 'Donate', ru: ' ' }[LANG]\nexport const I18N_EQUIPMENT = { en: 'Equipment', ru: '' }[LANG]\nexport const I18N_OUR_DISCORD = { en: 'Discord', ru: '' }[LANG]\nconst yt = { en: 'YouTube', ru: '' }[LANG]\nexport const I18N_YOUTUBE_RU = { en: yt + ' RU', ru: yt + '  ' }[LANG]\nexport const I18N_YOUTUBE_UA = { en: yt + ' UA', ru: yt + '  ' }[LANG]\nconst tiktok = { en: 'TikTok', ru: '' }[LANG]\nexport const I18N_TIKTOK_RU = { en: tiktok + ' RU', ru: tiktok + '  ' }[LANG]\nexport const I18N_TIKTOK_UA = { en: tiktok + ' UA', ru: tiktok + '  ' }[LANG]\nconst tg = { en: 'Telegram', ru: '' }[LANG]\nexport const I18N_OUR_TELEGRAM_RU = { en: tg + ' RU', ru: tg + '  ' }[LANG]\nexport const I18N_OUR_TELEGRAM_UA = { en: tg + ' UA', ru: tg + '  ' }[LANG]\nexport const I18N_CHAR_EQUIPMENT = { en: 'Character Equipment', ru: ' ' }[LANG]\nexport const I18N_CREATED_BY_US = {\n\ten: `Designed and coded by${NBSP}Yurtaikin${NBSP}Studio`,\n\tru: `   ${NBSP}${NBSP}${NBSP}`,\n}[LANG]\nexport const I18N_REPORT_BUG = {\n\ten: 'Report a bug',\n\tru: '  ',\n}[LANG]\nexport const I18N_SUPPORT_US = {\n\ten: 'Support Us',\n\tru: ' ',\n}[LANG]\nexport const I18N_SUPPORT_VIA_DONATELLO = {\n\ten: 'Donatello',\n\tru: '',\n}[LANG]\nexport const I18N_SUPPORT_VIA_KO_FI = {\n\ten: 'Ko-fi',\n\tru: '-',\n}[LANG]\nexport const I18N_SUPPORT_VIA_DON_ALERTS = {\n\ten: 'DonationAlerts',\n\tru: ' ',\n}[LANG]\nexport const I18N_ORDER_SITE_FROM_US = {\n\ten: 'Request a site from us',\n\tru: '   ',\n}[LANG]\nexport const I18N_NOT_AFFILIATED_WITH_MIHOYO = {\n\ten: 'We are not affiliated with HoYoverse',\n\tru: '    ',\n}[LANG]\nexport const I18N_C_MIHOYO = {\n\ten: 'Genshin Impact, items and characters illustrations are trademarks and copyrights of HoYoverse.',\n\tru: ' ,      ',\n}[LANG]\nexport const I18N_HELPER_TEAM_TABLE = {\n\ten: 'Helper Team',\n\tru: ' ',\n}[LANG]\nexport const I18N_HONEY_IMPACT = {\n\ten: 'Honey Impact',\n\tru: ' ',\n}[LANG]\nexport const I18N_GI_MAP = {\n\ten: 'Genshin Map',\n\tru: ' ',\n}[LANG]\nexport const I18N_GI_WIKI = {\n\ten: 'Genshin Wiki',\n\tru: ' ',\n}[LANG]\nexport const I18N_AKASHADATA = {\n\ten: 'Akashadata',\n\tru: '',\n}[LANG]\nexport const I18N_WE_USE_DATA_FROM = {\n\ten: 'We use data from',\n\tru: ' ',\n}[LANG]\nexport const I18N_COPYRIGHTS = {\n\ten: 'Copyrights',\n\tru: ' ',\n}[LANG]\nexport const I18N_SEE_NOTES = {\n\ten: 'see notes',\n\tru: '. ',\n}[LANG]\nexport const I18N_UNSUPPORTED_LOCATION_WARNING = {\n\ten: \"Looks like you've opened a cached/saved page. It won't work correctly that way :(\",\n\tru: ',    .         :(',\n}[LANG]\nexport const I18N_NOTHING_TO_SHOW = {\n\ten: 'nothing to show',\n\tru: ' ',\n}[LANG]\nexport const I18N_MEGA_SEARCH_PLACEHOLDER = {\n\ten: 'Search for characters, weapons, artifacts',\n\tru: ' , , ',\n}[LANG]\nexport const I18N_ABYSS_LETTERS_EXPLANATION = {\n\ten: 'F-SSS character ratings are based on approximate character usage statistics in the current abyss.',\n\tru: '  F-SSS         .',\n}[LANG]\n\nexport const I18N_FRONT_PAGE_DESCRIPTION = {\n\ten: 'Up-to-date character builds recommendations, list of all weapons and artifacts in the game, dungeons schedule and other useful information about Genshin Impact',\n\tru: '  ,     ,    ,         ',\n}[LANG]\nexport const I18N_BUILDS_PAGE_DESCRIPTION = {\n\ten: 'Genshin Impact builds recommendations for every character',\n\tru: '     ',\n}[LANG]\nexport const I18N_EQUIPMENT_PAGE_DESCRIPTION = {\n\ten: (code: 'weapons' | 'artifacts') => {\n\t\treturn `List of Genshin Impact ${code} with full information and recommended characters`\n\t},\n\tru: (code: 'weapons' | 'artifacts') => {\n\t\tconst name = { artifacts: '', weapons: '' }[code] ?? code\n\t\treturn ` ${name}        `\n\t},\n}[LANG]\nexport function I18N_CHARACTER_PAGE_DESCRIPTION(\n\tcharacterName: string,\n\troleName: string,\n\tweaponR5Name: string | null | undefined,\n\tweaponR4Name: string | null | undefined,\n\tartifactName: string | null | undefined,\n\ttipsText: string,\n\tnotesText: string,\n) {\n\tconst weaponLabel = { en: 'Recommended weapon', ru: ' ' }[LANG]\n\tconst artifactLabel = { en: 'Recommended artifact', ru: ' ' }[LANG]\n\n\t//     \n\tif (tipsText && !tipsText.trim().endsWith('.')) tipsText += '.'\n\tlet extraText = tipsText + ' ' + notesText\n\t//     \n\tif (extraText.length > 250) {\n\t\tconst cutIndex = Math.min(...[' ', '.'].map(x => extraText.lastIndexOf(x, 230)))\n\t\textraText = extraText.slice(0, cutIndex) + ELLIPSIS\n\t}\n\n\treturn (\n\t\t`${characterName} ${DASH} ${roleName}.` +\n\t\t` ${weaponLabel}: ${[weaponR5Name, weaponR4Name].filter(x => x).join(', ')}.` +\n\t\t` ${artifactLabel}: ${artifactName ?? ''}.` +\n\t\t' ' +\n\t\textraText\n\t)\n}\n\ntype WeaponTypeNames = Record<GI_WeaponTypeCode, string>\nconst weaponTypeNamesRU: WeaponTypeNames = {\n\tclaymore: ' ',\n\tsword: '',\n\tcatalyst: '',\n\tpolearm: '',\n\tbow: '',\n}\nexport const I18N_WEAPON_TYPE_NAME = {\n\ten: (code: GI_WeaponTypeCode) => code,\n\tru: (code: GI_WeaponTypeCode) => weaponTypeNamesRU[code],\n}[LANG]\n\ntype WeaponObtainSourceNames = Record<GI_WeaponObtainSource | 'other', string>\nconst weaponObtainSourceNamesRU: WeaponObtainSourceNames = {\n\twishes: '',\n\t'event-wishes': ' ',\n\tevents: '',\n\t'battle-pass': ' ',\n\t'in-game-shop': ' ',\n\tforging: '',\n\tfishing: '',\n\t'npc-shop': ' ',\n\tchests: '',\n\tquests: '',\n\tpuzzles: '',\n\tinvestigation: ' ',\n\t'adventure-rank-10': '10  ',\n\tplaystation: '',\n\tother: '',\n}\nexport const I18N_WEAPON_OBTAIN_SOURCE_NAME = {\n\ten: (code: GI_WeaponObtainSource | 'other') => code.replace(/-/g, ' ').replace(/\\bnpc\\b/, 'NPC'),\n\tru: (code: GI_WeaponObtainSource | 'other') => weaponObtainSourceNamesRU[code],\n}[LANG]\nexport const I18N_OBTAINED_DURING_STORYLINE = {\n\ten: 'Obtained during storyline quests',\n\tru: '     ',\n}[LANG]\nexport const I18N_ART_GROUP_NAME: Record<GI_ArtifactGroupCode, string> = {\n\t'18%-atk': { en: 'ATK +18%', ru: '  +18%' }[LANG],\n\t'25%-ph-atk': { en: 'Physical DMG +25%', ru: '.  +25%' }[LANG],\n\t'15%-anemo': { en: 'Anemo DMG +15%', ru: '  +15%' }[LANG],\n\t'20%-er': { en: 'Energy Recharge +20%', ru: '  +20%' }[LANG],\n\t'80-em': { en: 'Elemental Mastery +80', ru: '  +80' }[LANG],\n\t'15%-heal': { en: 'Healing Bonus +15%', ru: '  +15%' }[LANG],\n}\nexport const I18N_ITEM_DETAIL = {\n\ten: 'item detail',\n\tru: ' ',\n}[LANG]\nexport const I18N_ARROWS_TO_SELECT = {\n\ten: 'you can use Arrow keys and Enter to select option',\n\tru: '     -  ',\n}[LANG]\nexport const I18N_RECOMMENDED_BUILDS = {\n\ten: 'recomended builds',\n\tru: ' ',\n}[LANG]\nexport const I18N_OBTAIN_SOURCES = {\n\ten: 'Obtain sources',\n\tru: ' ',\n}[LANG]\nexport const I18N_SORT_BY = {\n\ten: 'Sort by',\n\tru: ' ',\n}[LANG]\nexport const I18N_USAGE = {\n\ten: 'Usage',\n\tru: '',\n}[LANG]\nexport const I18N_USED_IN_ABYSS = {\n\ten: (n: number) => `Used in Abyss by ${n.toFixed(2)}${NBSP}% owners`,\n\tru: (n: number) => `${n.toFixed(2)}${NBSP}%     `,\n}[LANG]\nexport const I18N_FILTER = {\n\ten: 'Filter',\n\tru: '',\n}[LANG]\nexport const I18N_WEAPON_TYPE = {\n\ten: 'Weapon type',\n\tru: ' ',\n}[LANG]\nexport const I18N_NAME = {\n\ten: 'Name',\n\tru: '',\n}[LANG]\nexport const I18N_SUBSTAT = {\n\ten: 'Substat',\n\tru: '',\n}[LANG]\nexport const I18N_RARITY = {\n\ten: 'Rarity',\n\tru: '',\n}[LANG]\nexport const I18N_WEAPON_TYPE_FILTER_TIP: Record<GI_WeaponTypeCode | 'everything', string> = {\n\ten: {\n\t\teverything: 'every type of weapon selected',\n\t\tsword: 'showing only swords',\n\t\tcatalyst: 'showing only catalists',\n\t\tclaymore: 'showing only claymores',\n\t\tpolearm: 'showing only polearms',\n\t\tbow: 'showing only bows',\n\t},\n\tru: {\n\t\teverything: '   ',\n\t\tsword: '  ',\n\t\tcatalyst: '  ',\n\t\tclaymore: '   ',\n\t\tpolearm: '  ',\n\t\tbow: '  ',\n\t},\n}[LANG]\n\nconst pluralizeHours = {\n\ten: (hours: number) => pluralizeEN(hours, 'hour', 'hours'),\n\tru: (hours: number) => pluralizeRU(hours, '', '', ''),\n}[LANG]\nconst pluralizeMinutes = {\n\ten: (minutes: number) => pluralizeEN(minutes, 'minute', 'minutes'),\n\tru: (minutes: number) => pluralizeRU(minutes, '', '', ''),\n}[LANG]\nexport function I18N_MS_TO_HM_WORDS(duration: number): string {\n\tconst minutes = Math.floor((duration / (1000 * 60)) % 60)\n\tconst hours = Math.floor((duration / (1000 * 60 * 60)) % 24)\n\treturn `${hours} ${pluralizeHours(hours)} ${minutes} ${pluralizeMinutes(minutes)}`\n}\n\nfunction pluralizeEN(n: number, w0: string, w1: string): string {\n\tif (n < 0) n = -n\n\tconst d0 = n % 10\n\tconst d10 = n % 100\n\n\tif (d10 === 11 || d10 === 12 || d0 === 0 || (d0 >= 2 && d0 <= 9)) return w1\n\treturn w0\n}\nfunction pluralizeRU(n: number, w0: string, w1: string, w3: string): string {\n\tif (n < 0) n = -n\n\tif (n % 10 === 1 && n % 100 !== 11) {\n\t\treturn w0\n\t} else if (n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20)) {\n\t\treturn w1\n\t} else {\n\t\treturn w3\n\t}\n}\n","let modalsEl: Element | undefined\nexport function GET_MODALS_EL(): Element {\n\treturn (modalsEl ??= document.querySelector('.modals') as Element)\n}\n\nexport const stopPropagation = e => e.stopPropagation()\n","import { useCallback, useRef, useState } from 'preact/hooks'\r\n\r\nimport { sendMessage } from '#src/errors/rollbar'\r\nimport {\r\n\tI18N_CANCEL,\r\n\tI18N_REPORT_BUG,\r\n\tI18N_REPORT_BUG_GUIDE,\r\n\tI18N_SUBMIT,\r\n\tI18N_SUBMIT_BUG_ERROR,\r\n\tI18N_SUBMIT_BUG_SUCCESS,\r\n\tI18N_YOUR_MESSAGE_HERE,\r\n} from '#src/i18n/i18n'\r\nimport { GET_MODALS_EL } from '#src/utils/dom'\r\nimport { useClickAway } from '#src/utils/hooks'\r\nimport { createPortal } from '#src/utils/preact-compat'\r\n\r\nexport const ReportBugModal = ({ onClickAway }: { onClickAway(): void }): JSX.Element => {\r\n\tconst [message, setMessage] = useState<string>('')\r\n\tconst [isInvalid, setIsInvalid] = useState<boolean>(false)\r\n\tconst onMessageChange = useCallback(\r\n\t\te => {\r\n\t\t\tsetMessage(e.target.value)\r\n\t\t\tisInvalid && setIsInvalid(false)\r\n\t\t},\r\n\t\t[setMessage, isInvalid, setIsInvalid],\r\n\t)\r\n\tconst modalRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\r\n\tuseClickAway(modalRef, onClickAway)\r\n\tconst tryToSendMessage = useCallback(() => {\r\n\t\tif (!message.length) return setIsInvalid(true)\r\n\t\tsendMessage('message from bug report modal: ' + message)\r\n\t\t\t.then(() => alert(I18N_SUBMIT_BUG_SUCCESS))\r\n\t\t\t.catch(() => alert(I18N_SUBMIT_BUG_ERROR))\r\n\t\t\t.finally(() => {\r\n\t\t\t\tonClickAway()\r\n\t\t\t})\r\n\t}, [message, onClickAway, setIsInvalid])\r\n\treturn createPortal(\r\n\t\t<>\r\n\t\t\t<div className=\"modal-backdrop show d-block\"></div>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"modal d-block\"\r\n\t\t\t\tid=\"exampleModal\"\r\n\t\t\t\ttab-index=\"-1\"\r\n\t\t\t\taria-labelledby=\"exampleModalLabel\"\r\n\t\t\t\taria-hidden=\"true\"\r\n\t\t\t>\r\n\t\t\t\t<div className=\"modal-dialog modal-dialog-scrollable\" ref={modalRef}>\r\n\t\t\t\t\t<div className=\"modal-content\">\r\n\t\t\t\t\t\t<div className=\"modal-header\">\r\n\t\t\t\t\t\t\t<h5 className=\"modal-title\" id=\"exampleModalLabel\">\r\n\t\t\t\t\t\t\t\t{I18N_REPORT_BUG}\r\n\t\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tclassName=\"btn-close btn-sm\"\r\n\t\t\t\t\t\t\t\taria-label=\"Close\"\r\n\t\t\t\t\t\t\t\tonClick={onClickAway}\r\n\t\t\t\t\t\t\t></button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"modal-body\">\r\n\t\t\t\t\t\t\t<div className=\"text-muted\">{I18N_REPORT_BUG_GUIDE}</div>\r\n\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\tvalue={message}\r\n\t\t\t\t\t\t\t\tplaceholder={I18N_YOUR_MESSAGE_HERE}\r\n\t\t\t\t\t\t\t\trows={5}\r\n\t\t\t\t\t\t\t\tclassName={`w-100 bg-light border ${\r\n\t\t\t\t\t\t\t\t\tisInvalid ? 'border-2 border-danger' : 'border-light'\r\n\t\t\t\t\t\t\t\t} rounded`}\r\n\t\t\t\t\t\t\t\tonInput={onMessageChange}\r\n\t\t\t\t\t\t\t></textarea>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"modal-footer\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tclassName=\"btn btn-link text-decoration-none text-capitalize\"\r\n\t\t\t\t\t\t\t\tonClick={onClickAway}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{I18N_CANCEL}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tclassName=\"btn btn-primary text-capitalize\"\r\n\t\t\t\t\t\t\t\tonClick={tryToSendMessage}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{I18N_SUBMIT}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</>,\r\n\t\tGET_MODALS_EL(),\r\n\t)\r\n}\r\n","import { useCallback, useState } from 'preact/hooks'\n\nimport {\n\tI18N_AKASHADATA,\n\tI18N_C_MIHOYO,\n\tI18N_COPYRIGHTS,\n\tI18N_CREATED_BY_US,\n\tI18N_GI_MAP,\n\tI18N_GI_WIKI,\n\tI18N_HELPER_TEAM_TABLE,\n\tI18N_HONEY_IMPACT,\n\tI18N_NOT_AFFILIATED_WITH_MIHOYO,\n\tI18N_ORDER_SITE_FROM_US,\n\tI18N_REPORT_BUG,\n\tI18N_WE_USE_DATA_FROM,\n} from '#src/i18n/i18n'\nimport { ReportBugModal } from '#src/modals/report-bug'\nimport {\n\tLINK_AKASHADATA,\n\tLINK_GI_MAP,\n\tLINK_GI_WIKI,\n\tLINK_GOOGLE_FORM_ORDER_SITE,\n\tLINK_HELPER_TEAM_TABLE,\n\tLINK_HONEY_IMPACT,\n} from '#src/utils/links'\n\nexport function Footer() {\n\tconst [isReportBugModalVisible, setIsReportBugModalVisible] = useState<boolean>(false)\n\tconst onRepBugBtnClick = useCallback(() => {\n\t\tsetIsReportBugModalVisible(true)\n\t}, [setIsReportBugModalVisible])\n\tconst closeRepBugModal = useCallback(() => {\n\t\tsetIsReportBugModalVisible(false)\n\t}, [setIsReportBugModalVisible])\n\treturn (\n\t\t<footer className=\"mt-auto bg-dark\">\n\t\t\t<div className=\"container my-3\">\n\t\t\t\t<div className=\"row pt-3 gy-3\">\n\t\t\t\t\t<div className=\"col-12 col-md-3\">\n\t\t\t\t\t\t<h5 className=\"opacity-75\">Genshin Base</h5>\n\t\t\t\t\t\t<div class=\"small muted opacity-75 mb-2 mt-n2\">\n\t\t\t\t\t\t\t{BUNDLE_ENV.VERSION.lastTag}{' '}\n\t\t\t\t\t\t\t<span class=\"opacity-75\">{BUNDLE_ENV.VERSION.commitDate}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p className=\"small\">\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"link text-decoration-underline-dotted\"\n\t\t\t\t\t\t\t\tonClick={onRepBugBtnClick}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{I18N_REPORT_BUG}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t{isReportBugModalVisible && <ReportBugModal onClickAway={closeRepBugModal} />}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"small  opacity-75\">{I18N_CREATED_BY_US}</p>\n\t\t\t\t\t\t<p className=\"small\">\n\t\t\t\t\t\t\t<a href={LINK_GOOGLE_FORM_ORDER_SITE} target=\"_blank\">\n\t\t\t\t\t\t\t\t{I18N_ORDER_SITE_FROM_US}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-12 col-md-4\">\n\t\t\t\t\t\t<div className=\"ps-md-3\">\n\t\t\t\t\t\t\t<h5 className=\"opacity-75\">{I18N_WE_USE_DATA_FROM}</h5>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_HELPER_TEAM_TABLE} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_HELPER_TEAM_TABLE}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_HONEY_IMPACT} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_HONEY_IMPACT}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_GI_MAP} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_GI_MAP}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_GI_WIKI} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_GI_WIKI}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t<a target=\"_blank\" href={LINK_AKASHADATA} className=\"text-muted small\">\n\t\t\t\t\t\t\t\t\t{I18N_AKASHADATA}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-12 col-md-4\">\n\t\t\t\t\t\t<div className=\"ps-md-3 \">\n\t\t\t\t\t\t\t<h5 className=\"opacity-75\">{I18N_COPYRIGHTS}</h5>\n\t\t\t\t\t\t\t<p className=\"small opacity-75\">{I18N_C_MIHOYO}</p>\n\t\t\t\t\t\t\t<p className=\"small opacity-75\">{I18N_NOT_AFFILIATED_WITH_MIHOYO}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</footer>\n\t)\n}\n","\nexport const GENERATED_DATA_HASH = \"afe4a404\"\n\n/** @type {import('#lib/parsing/combine').CharacterShortInfo[]} */\nexport const charactersShortList = [\n\t{\n\t\t\"code\": \"amber\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"barbara\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"beidou\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"bennett\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"chongyun\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"diluc\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"fischl\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"jean\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kaeya\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"keqing\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"klee\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"lisa\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"mona\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ningguang\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"noelle\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"qiqi\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"razor\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"sucrose\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"traveler-anemo\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"traveler-dendro\",\n\t\t\"elementCode\": \"dendro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"traveler-electro\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"traveler-geo\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"venti\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xiangling\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"xingqiu\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"diona\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"tartaglia\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xinyan\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"zhongli\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"albedo\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ganyu\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"hu-tao\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"xiao\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"rosaria\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"eula\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"yanfei\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"kazuha\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ayaka\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"sayu\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"yoimiya\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"aloy\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kokomi\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kujou-sara\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"raiden-shogun\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"thoma\",\n\t\t\"elementCode\": \"pyro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"gorou\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"itto\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"shenhe\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"yun-jin\",\n\t\t\"elementCode\": \"geo\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"yae-miko\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"ayato\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"kuki-shinobu\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"yelan\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"heizou\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"collei\",\n\t\t\"elementCode\": \"dendro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"dori\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"claymore\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"tighnari\",\n\t\t\"elementCode\": \"dendro\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"candace\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"cyno\",\n\t\t\"elementCode\": \"electro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"nilou\",\n\t\t\"elementCode\": \"hydro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"layla\",\n\t\t\"elementCode\": \"cryo\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"nahida\",\n\t\t\"elementCode\": \"dendro\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"faruzan\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"bow\",\n\t\t\"rarity\": 4\n\t},\n\t{\n\t\t\"code\": \"wanderer\",\n\t\t\"elementCode\": \"anemo\",\n\t\t\"weaponTypeCode\": \"catalyst\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"alhaitham\",\n\t\t\"elementCode\": \"dendro\",\n\t\t\"weaponTypeCode\": \"sword\",\n\t\t\"rarity\": 5\n\t},\n\t{\n\t\t\"code\": \"yaoyao\",\n\t\t\"elementCode\": \"dendro\",\n\t\t\"weaponTypeCode\": \"polearm\",\n\t\t\"rarity\": 4\n\t}\n]\n\n/** @type {import('#lib/parsing').ArtifcatSetGroupsCodes} */\nexport const ART_GROUP_CODES = {\n\t\"18%-atk\": [\n\t\t\"echoes-of-an-offering\",\n\t\t\"gladiators-finale\",\n\t\t\"shimenawas-reminiscence\",\n\t\t\"vermillion-hereafter\",\n\t\t\"brave-heart\",\n\t\t\"resolution-of-sojourner\"\n\t],\n\t\"25%-ph-atk\": [\n\t\t\"bloodstained-chivalry\",\n\t\t\"pale-flame\"\n\t],\n\t\"15%-anemo\": [\n\t\t\"desert-pavilion-chronicle\",\n\t\t\"viridescent-venerer\"\n\t],\n\t\"20%-er\": [\n\t\t\"emblem-of-severed-fate\",\n\t\t\"scholar\",\n\t\t\"the-exile\"\n\t],\n\t\"80-em\": [\n\t\t\"flower-of-paradise-lost\",\n\t\t\"gilded-dreams\",\n\t\t\"wanderers-troupe\",\n\t\t\"instructor\"\n\t],\n\t\"15%-heal\": [\n\t\t\"maiden-beloved\",\n\t\t\"ocean-hued-clam\"\n\t]\n}\n","import { charactersShortList } from '../api/generated.js'\n\nexport const paths = /** @type {const} */ ({\n\tfront: [''],\n\tbuilds: ['/builds'],\n\tbuildCharacters: ['/builds/', ['code', charactersShortList.map(x => x.code)]],\n\tweapons: ['/weapons'],\n\tartifacts: ['/artifacts'],\n\tabout: ['/about'],\n\teverywhere: ['/everywhere'],\n})\n\n/**\n * @param {import('./router').RoutePath} path\n * @param {string} url\n * @returns {Record<string, string> | null}\n */\nexport function matchPath(path, url) {\n\tif (path.length === 0) return null\n\tlet rem = url\n\tconst props = /**@type {Record<string, string>}*/ ({})\n\tfor (const part of path) {\n\t\tlet matched = true //true    variants\n\t\tif (typeof part === 'string') {\n\t\t\t;[rem, matched] = withoutPrefix(rem, part)\n\t\t} else {\n\t\t\tconst [name, variants] = part\n\t\t\tfor (const variant of variants) {\n\t\t\t\t;[rem, matched] = withoutPrefix(rem, variant)\n\t\t\t\tif (matched) {\n\t\t\t\t\tprops[name] = variant\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (!matched) return null\n\t}\n\treturn !rem || rem === '/' ? props : null\n}\n\n/**\n * @param {string} prefix\n * @param {import('./router').RoutePath} path\n * @param {number} [fromIndex]\n * @returns {string[]}\n */\nexport function pathToStrings(prefix, path, fromIndex = 0) {\n\tif (path.length === 0) return []\n\tif (fromIndex >= path.length) return [prefix]\n\n\tconst part = path[fromIndex]\n\tif (typeof part === 'string') {\n\t\treturn pathToStrings(prefix + part, path, fromIndex + 1)\n\t} else {\n\t\tconst [, variants] = part\n\t\treturn variants.flatMap(x => pathToStrings(prefix + x, path, fromIndex + 1))\n\t}\n}\n\n/**\n * @param {string} url\n * @param {string} prefix\n * @returns {[string, boolean]}\n */\nfunction withoutPrefix(url, prefix) {\n\treturn url.startsWith(prefix) ? [url.slice(prefix.length), true] : [url, false]\n}\n","import { ComponentType, h, Ref } from 'preact'\nimport { useEffect, useState } from 'preact/hooks'\n\nimport { matchPath } from './paths'\n\nexport type RoutePath = readonly (string | readonly [name: string, variants: readonly string[]])[]\n\ntype Routes = [RoutePath, ComponentType][]\n\ntype SubRoute<T> = readonly [string, readonly T[]]\ntype EmptySubRoute = readonly [string, readonly []]\ntype PathProps<T extends RoutePath> = {\n\t[K in keyof T as T[K] extends EmptySubRoute\n\t\t? never\n\t\t: T[K] extends SubRoute<unknown>\n\t\t? T[K][0]\n\t\t: never]: T[K] extends SubRoute<infer A> ? A : never\n} & {\n\t[K in keyof T as T[K] extends EmptySubRoute ? T[K][0] : never]?: undefined\n}\n\ndeclare global {\n\tinterface WindowEventMap {\n\t\t'x-route-to': CustomEvent<{ path: string }>\n\t}\n}\n\nconst URL_LANG_PREFIX = makeUrlLangPrefix(BUNDLE_ENV.LANG)\n\nfunction findRoutedComponent(routes: Routes, url: string): [ComponentType, Record<string, string>] | null {\n\tfor (const [route, comp] of routes) {\n\t\tconst props = matchPath(route, url)\n\t\tif (props) return [comp, props]\n\t}\n\treturn null\n}\n\nfunction pathSearchHash(url: { pathname: string; search: string; hash: string }) {\n\treturn url.pathname + url.search + url.hash\n}\n\nfunction tryRouteToPage(routes: Routes, url: URL) {\n\tif (url.origin === location.origin) {\n\t\tif (findRoutedComponent(routes, url.pathname)) {\n\t\t\tif (pathSearchHash(location) !== pathSearchHash(url)) {\n\t\t\t\tconst hashChanged = url.hash !== location.hash\n\t\t\t\thistory.pushState(null, '', pathSearchHash(url))\n\t\t\t\tif (hashChanged) dispatchEvent(new CustomEvent('x-local-hashchange'))\n\t\t\t}\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nfunction handleAnchorClick(e: MouseEvent, routes: Routes) {\n\tif (e.ctrlKey || e.altKey || e.shiftKey || e.metaKey || e.button !== 0) return\n\n\tconst a = e.target instanceof Element && e.target.closest('a')\n\tif (a && a.href && (!a.target || a.target === '_self')) {\n\t\tif (tryRouteToPage(routes, new URL(a.href))) {\n\t\t\te.preventDefault()\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nexport function useRouter(routes: Routes) {\n\tconst [, forceUpdate] = useState(0)\n\n\tuseEffect(() => {\n\t\tfunction onClick(e: MouseEvent) {\n\t\t\tconst handled = handleAnchorClick(e, routes)\n\t\t\tif (handled) forceUpdate(x => x + 1)\n\t\t}\n\t\tfunction onRouteTo(e: WindowEventMap['x-route-to']) {\n\t\t\tconst url = new URL(e.detail.path, location.href)\n\t\t\tif (tryRouteToPage(routes, url)) {\n\t\t\t\tforceUpdate(x => x + 1)\n\t\t\t} else {\n\t\t\t\tlocation.href = url.toString()\n\t\t\t}\n\t\t}\n\t\tfunction onPopState(e: PopStateEvent) {\n\t\t\tforceUpdate(x => x + 1)\n\t\t}\n\t\t//      , ..  window   ,\n\t\t//      <a>  `location.href = a.href`,  \n\t\t//   --.\n\t\t//  onCapture  :    onlick - \n\t\t//     (..      ),\n\t\t//   (   preact/debug').\n\t\t//        ,  `defaultPrevented`,\n\t\t//   -     location.\n\t\tdocument.body.addEventListener('click', onClick)\n\t\taddEventListener('x-route-to', onRouteTo)\n\t\taddEventListener('popstate', onPopState)\n\t\treturn () => {\n\t\t\tdocument.body.removeEventListener('click', onClick)\n\t\t\tremoveEventListener('x-route-to', onRouteTo)\n\t\t\tremoveEventListener('popstate', onPopState)\n\t\t}\n\t}, [routes])\n\n\tconst res = findRoutedComponent(routes, location.pathname)\n\tif (!res) return '404'\n\tconst [Comp, props] = res\n\treturn <Comp {...props} />\n}\n\n/**\n *  ,    ,      .\n * :\n *   dispatchRouteTo('/path/to/page')\n *     -\n *   const goToPage = useRouterGoTo()\n *   goToPage('/path/to/page')\n *      <App>    ,    ...\n *     -  .\n */\nexport function dispatchRouteTo(path: string) {\n\tdispatchEvent(new CustomEvent('x-route-to', { detail: { path: URL_LANG_PREFIX + path } }))\n}\n\nexport const route = <TPath extends RoutePath>(\n\tpath: TPath,\n\tcomp: ComponentType<PathProps<TPath>>,\n): [RoutePath, ComponentType] => [[URL_LANG_PREFIX, ...path], comp as ComponentType]\n\nfunction makeUrlLangPrefix(lang: string): string {\n\treturn lang === 'en' ? '' : '/ru'\n}\n\nexport function isOnRoute(path: RoutePath): boolean {\n\treturn matchPath([URL_LANG_PREFIX, ...path], location.pathname) !== null\n}\n\nexport function makeLocationHrefForLang(lang: string): string {\n\tconst url = location.pathname + location.search + location.hash\n\tconst curPrefix = URL_LANG_PREFIX\n\tconst newPrefix = makeUrlLangPrefix(lang)\n\tlet newUrl = newPrefix + (url.startsWith(curPrefix) ? url.slice(curPrefix.length) : url)\n\tif (newUrl === '') newUrl = '/'\n\treturn newUrl\n}\n\nexport function A(\n\tprops: JSX.HTMLAttributes<HTMLAnchorElement> & {\n\t\tref?: Ref<typeof A>\n\t\tinnerRef?: Ref<HTMLAnchorElement>\n\t\tisExternal?: boolean\n\t},\n): JSX.Element {\n\tprops = Object.assign({}, props)\n\t// @ts-ignore\n\tprops.ref = props.innerRef\n\tdelete props.innerRef\n\tif (props.href && !props.isExternal) props.href = URL_LANG_PREFIX + props.href\n\tif (props.isExternal) props.target = '_blank'\n\t//  JSX- - :\n\t//   <a {...props}/>   Object.assign({}, props)\n\treturn h('a', props as Parameters<typeof h>[1])\n}\n","// bootstrap edition\nexport function calcPosForDd(\n\tparentRect: DOMRect,\n\tddRect: DOMRect,\n\t{ isAbsolute = false, isCentered = false, shouldFitInScreen = false } = {},\n): { top: number; left: number; layoutPosition: { x: 'end' | 'start'; y: 'top' | 'bottom' } } {\n\tconst tWidth = window.innerWidth\n\tconst tHeight = window.innerHeight\n\tconst scrollTopFix = isAbsolute ? window.scrollY : 0\n\tconst centredFix = isCentered ? (parentRect.width - ddRect.width) / 2 : 0\n\tlet top = 0\n\tlet left = 0\n\tlet layoutPositionX: 'end' | 'start' = 'end'\n\tlet layoutPositionY: 'top' | 'bottom' = 'bottom'\n\tif (parentRect.top + parentRect.height + ddRect.height < tHeight) {\n\t\t// to bottom\n\t\ttop = parentRect.top + parentRect.height + scrollTopFix\n\t\tlayoutPositionY = 'bottom'\n\t} else {\n\t\t// to top\n\t\ttop = parentRect.top - ddRect.height + scrollTopFix\n\t\tlayoutPositionY = 'top'\n\t}\n\tif (parentRect.left + ddRect.width + centredFix < tWidth) {\n\t\t// to right\n\t\tleft = parentRect.left + centredFix\n\t\tlayoutPositionX = 'end'\n\t} else {\n\t\t// to left\n\t\tleft = parentRect.left + parentRect.width - ddRect.width - centredFix\n\t\tlayoutPositionX = 'start'\n\t}\n\tif (shouldFitInScreen) {\n\t\tleft = Math.min(Math.max(0, left), tWidth - ddRect.width)\n\t\ttop = Math.max(top, 0)\n\t}\n\treturn { top, left, layoutPosition: { y: layoutPositionY, x: layoutPositionX } }\n}\n","import { useCallback, useLayoutEffect, useRef, useState } from 'preact/hooks'\n\nimport { calcPosForDd } from '#src/utils/calc-pos-for-dd'\nimport { GET_MODALS_EL } from '#src/utils/dom'\nimport { useWindowSize } from '#src/utils/hooks'\nimport { createPortal } from '#src/utils/preact-compat'\n\nexport function Tooltip({\n\tchildren,\n\tclasses = '',\n\ttargetEl,\n}: {\n\tchildren: JSX.Node\n\tclasses?: string\n\ttargetEl: HTMLElement | null | undefined\n}): JSX.Element {\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `tooltip fade show ${classes}`\n\tconst [arrowStyle, setArrowStyle] = useState<string>('')\n\tconst onResize = useCallback(() => {\n\t\tif (!wrapRef.current) return\n\t\tif (!targetEl) return\n\t\tconst wrapEl = wrapRef.current\n\t\tconst pos = calcPosForDd(targetEl.getBoundingClientRect(), wrapEl.getBoundingClientRect(), {\n\t\t\tisAbsolute: true,\n\t\t\tisCentered: true,\n\t\t})\n\t\t;('bs-tooltip-top bs-tooltip-bottom')\n\t\twrapEl.className = `${defClassName} bs-tooltip-${pos.layoutPosition.y}`\n\t\twrapEl.style.left = `${Math.max(0, pos.left)}px`\n\t\twrapEl.style.top = `${Math.max(0, pos.top)}px`\n\t\tsetArrowStyle(\n\t\t\t`position: absolute; transform: translate3d(${wrapEl.offsetWidth / 2 - 8}px, 0, 0); left: 0`,\n\t\t)\n\t}, [wrapRef, targetEl, defClassName, setArrowStyle])\n\tuseLayoutEffect(onResize)\n\tuseWindowSize()\n\t//todo  ,   \n\treturn createPortal(\n\t\t<div className={defClassName} ref={wrapRef}>\n\t\t\t<div className=\"tooltip-arrow\" style={arrowStyle}></div>\n\t\t\t<div className=\"tooltip-inner\">{children}</div>\n\t\t</div>,\n\t\tGET_MODALS_EL(),\n\t)\n}\n","import { setDayStartUTC, weekdayAsMonSun } from './utils/date.js'\n\n/** @typedef {'pyro' | 'electro' | 'hydro' | 'dendro' | 'cryo' | 'anemo' | 'geo'} GI_ElementCode */\n/** @typedef {'claymore' | 'sword' | 'catalyst' | 'polearm' | 'bow'} GI_WeaponTypeCode */\n/** @typedef {'flower' | 'plume' | 'sands' | 'goblet' | 'circlet'} GI_ArtifactTypeCode */\n/** @typedef {1 | 2 | 3 | 4 | 5} GI_RarityCode */\n/**\n * @typedef {'wishes'|'event-wishes'|'events'|'battle-pass'|'in-game-shop'|\n *   'forging'|'fishing'|'npc-shop'|'chests'|'quests'|'puzzles'|'investigation'|\n *   'adventure-rank-10'|'playstation'} GI_WeaponObtainSource\n */\n/** @typedef {'limited'|'unlimited'} GI_DomainTypeCode */\n\n/** @typedef {{mapCode:MapCode, x:number, y:number}} MapLocation */\n\n/** @typedef {'teyvat'|'enkanomiya'|'chasm'} MapCode */\n/** @type {MapCode[]} */\nexport const GI_MAP_CODES = ['teyvat', 'enkanomiya', 'chasm']\n\n/** @typedef {'mondstadt'|'liyue'|'inazuma'|'sumeru'} GI_RegionCode */\n/** @type {GI_RegionCode[]} */\nexport const GI_REGION_CODES = ['mondstadt', 'liyue', 'inazuma', 'sumeru']\n\n/** @typedef {'europe'|'asia'|'north-america'} GI_ServerRegionCode */\n/** @type {GI_ServerRegionCode[]} */\nexport const GI_SERVER_REGIONS = ['europe', 'asia', 'north-america']\n\n/** @typedef {'mon'|'tue'|'wed'|'thu'|'fri'|'sat'|'sun'} WeekdayCode */\n/** @type {WeekdayCode[]} */\nexport const GI_ROTATION_WEEKDAY_CODES = ['mon', 'tue', 'wed', 'thu', 'fri', 'sat', 'sun']\n\n/** @type {GI_ElementCode[]} */\nexport const GI_ELEMENT_CODES = ['pyro', 'electro', 'hydro', 'dendro', 'cryo', 'anemo', 'geo']\n\n/** @type {GI_WeaponTypeCode[]} */\nexport const GI_WEAPON_TYPE_CODES = ['claymore', 'sword', 'catalyst', 'polearm', 'bow']\n\n/** @type {GI_ArtifactTypeCode[]} */\nexport const GI_ARTIFACT_TYPE_CODES = ['flower', 'plume', 'sands', 'goblet', 'circlet']\n\nexport const ART_GROUP_18_ATK_CODE = '18%-atk'\nexport const ART_GROUP_25_PH_ATK_CODE = '25%-ph-atk'\nexport const ART_GROUP_15_ANEMO_CODE = '15%-anemo'\nexport const ART_GROUP_20_ER_CODE = '20%-er'\nexport const ART_GROUP_80_EM_CODE = '80-em'\nexport const ART_GROUP_15_HEAL_CODE = '15%-heal'\n/** @typedef {'18%-atk'|'25%-ph-atk'|'15%-anemo'|'20%-er'|'80-em'|'15%-heal'} GI_ArtifactGroupCode */\n/** @type {GI_ArtifactGroupCode[]} */\nexport const GI_ARTIFACT_GROUP_CODES = [\n\tART_GROUP_18_ATK_CODE,\n\tART_GROUP_25_PH_ATK_CODE,\n\tART_GROUP_15_ANEMO_CODE,\n\tART_GROUP_20_ER_CODE,\n\tART_GROUP_80_EM_CODE,\n\tART_GROUP_15_HEAL_CODE,\n]\n\n/** @type {GI_RarityCode[]} */\nexport const GI_RARITY_CODES = [1, 2, 3, 4, 5]\n\n/**  ,    */\nconst _GI_STAT_REGULAR = /**@type {const}*/ (['em'])\n/**     ,    : <stat>  <stat>% */\nconst _GI_STAT_PERCENT = /**@type {const}*/ (['def', 'dmg', 'atk', 'hp', 'er', 'healing'])\n/**    'crit-' */\nconst _GI_STAT_CRIT_SUFFIXES = /**@type {const}*/ (['rate', 'dmg', 'rate%', 'dmg%'])\n/**    '-dmg'  '-dmg%' */\nconst _GI_STAT_DMG_PEFIXES = /**@type {const}*/ (['phys', 'cryo', 'geo', 'anemo', 'hydro', 'electro', 'pyro', 'dendro']) //prettier-ignore\n\n/**\n * @typedef {typeof _GI_STAT_REGULAR[number]\n *   | typeof _GI_STAT_PERCENT[number]\n *   | `${typeof _GI_STAT_PERCENT[number]}%`\n *   | `crit-${typeof _GI_STAT_CRIT_SUFFIXES[number]}`\n *   | `${typeof _GI_STAT_DMG_PEFIXES[number]}-dmg`\n *   | `${typeof _GI_STAT_DMG_PEFIXES[number]}-dmg%`} GI_KnownStatBonusCode\n */\n\nexport const GI_KNOWN_STAT_BONUS_CODES = /**@type {GI_KnownStatBonusCode[]}*/ (\n\t/**@type {readonly string[]}*/ (_GI_STAT_REGULAR)\n\t\t.concat(_GI_STAT_PERCENT)\n\t\t.concat(_GI_STAT_PERCENT.map(x => x + '%'))\n\t\t.concat(_GI_STAT_CRIT_SUFFIXES.map(x => 'crit-' + x))\n\t\t.concat(_GI_STAT_DMG_PEFIXES.map(x => x + '-dmg'))\n\t\t.concat(_GI_STAT_DMG_PEFIXES.map(x => x + '-dmg%'))\n)\n\n/**\n *     UTC ( )\n * @type {Record<GI_ServerRegionCode, number>}\n */\nexport const GI_REGION_TIMEZONE_OFFSET = {\n\teurope: 1,\n\tasia: 8,\n\t'north-america': -5,\n}\n/**    ( )       */\nexport const GI_SERVER_RESET_TIME = 4\n/**\n * @param {GI_ServerRegionCode} regionCode\n * @returns {{weekdayCode:WeekdayCode, weekdayMonSun:number, resetIn:number, resetAt:Date}}\n */\nexport function getRegionTime(regionCode) {\n\tconst now = new Date()\n\t//         UTC\n\tconst offsetHours = GI_SERVER_RESET_TIME - GI_REGION_TIMEZONE_OFFSET[regionCode]\n\n\tconst lastResetDate = new Date(now)\n\tlastResetDate.setHours(lastResetDate.getHours() - offsetHours)\n\tconst weekdayMonSun = weekdayAsMonSun(lastResetDate.getUTCDay())\n\tsetDayStartUTC(lastResetDate)\n\tlastResetDate.setUTCHours(offsetHours)\n\n\tconst nextResetDate = new Date(lastResetDate)\n\tnextResetDate.setDate(nextResetDate.getDate() + 1)\n\n\treturn {\n\t\tweekdayMonSun: weekdayMonSun,\n\t\tweekdayCode: GI_ROTATION_WEEKDAY_CODES[weekdayMonSun],\n\t\tresetIn: +nextResetDate - +now,\n\t\tresetAt: nextResetDate,\n\t}\n}\n/**\n * {@link https://www.timeanddate.com/time/map/}\n * @returns {GI_ServerRegionCode}\n */\nexport function guessCurrentRegion() {\n\tif (navigator.language.startsWith('ru')) return 'europe'\n\tconst curOffset = -new Date().getTimezoneOffset() / 60\n\tif (curOffset <= -2) return 'north-america'\n\tif (curOffset >= 5) return 'asia'\n\treturn 'europe'\n}\n\n/** @param {string} name */\nexport function getCharacterCodeFromName(name) {\n\tconst code = name.trim().toLocaleLowerCase().replace(/\\s/g, '-')\n\tif (code === 'childe') return 'tartaglia'\n\tif (code === 'kamisato-ayaka') return 'ayaka'\n\tif (code === 'kamisato-ayato') return 'ayato'\n\tif (code === 'sangonomiya-kokomi') return 'kokomi'\n\tif (code === 'kaedehara-kazuha') return 'kazuha'\n\tif (code === 'arataki-itto') return 'itto'\n\tif (code === 'shikanoin-heizou') return 'heizou'\n\treturn code\n}\n\n/** @param {string} name */\nexport function getArtifactCodeFromName(name) {\n\treturn name.trim().toLocaleLowerCase().replace(/\\s/g, '-').replace(/[']/g, '')\n}\n\n/** @param {string} name */\nexport function getWeaponCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/\\s+/g, '-')\n\t\t.replace(/['\"]/g, '')\n}\n\n/** @param {string} name */\nexport function getDomainCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/[\\s:]+/g, '-')\n\t\t.replace(/'/g, '')\n}\n\n/** @param {string} name */\nexport function getItemCodeFromName(name) {\n\treturn name.trim().toLocaleLowerCase().replace(/\\s+/g, '-').replace(/'/g, '')\n}\n\n/** @param {string} name */\nexport function getEnemyCodeFromName(name) {\n\treturn name\n\t\t.trim()\n\t\t.toLocaleLowerCase()\n\t\t.replace(/[\\s:\\-,]+/g, '-')\n\t\t.replace(/'/g, '')\n}\n\n/**\n * @template {{rarity:GI_RarityCode}} T\n * @param {T[]} items\n * @returns {T}\n */\nexport function getWithMaxRarity(items) {\n\tlet maxItem = items[0]\n\tfor (let i = 0; i < items.length; i++) if (maxItem.rarity < items[i].rarity) maxItem = items[i]\n\treturn maxItem\n}\n\n/** @type {Record<MapCode, string>} */\nconst locEnc_map2code = {\n\tteyvat: 'T',\n\tenkanomiya: 'E',\n\tchasm: 'C',\n}\n/** @type {Record<string, MapCode>} */\nconst locEnc_code2map = {\n\tT: 'teyvat',\n\tE: 'enkanomiya',\n\tC: 'chasm',\n}\n/**\n * @param {MapLocation[]} locations\n * @param {number} [downsample]\n * @returns {string}\n */\nexport function encodeLocations(locations, downsample = 1) {\n\tif (downsample < 1 || downsample > 35 || downsample % 1 !== 0)\n\t\tthrow new Error(`wrong downsample: ${downsample}`)\n\n\tconst sortedLocs = locations.slice().sort((a, b) => a.x - b.x || a.y - b.y)\n\n\tlet res = downsample.toString(36)\n\tfor (const [groupMapCode, groupLetter] of Object.entries(locEnc_map2code)) {\n\t\tlet xx = ''\n\t\tlet yy = ''\n\t\tfor (const { mapCode, x, y } of sortedLocs) {\n\t\t\tif (mapCode === groupMapCode) {\n\t\t\t\txx += encodeLocNum(x, downsample)\n\t\t\t\tyy += encodeLocNum(y, downsample)\n\t\t\t}\n\t\t}\n\t\tif (xx || yy) res += xx + yy + groupLetter\n\t}\n\treturn res\n}\n/**\n * @param {MapLocation[]} locations\n * @param {number} [downsample]\n * @returns {string}\n */\nexport function encodeLocationsChecked(locations, downsample = 1) {\n\tconst res = encodeLocations(locations, downsample)\n\n\tconst codes = Object.keys(locEnc_map2code)\n\tconst sortedLocs = locations\n\t\t.slice()\n\t\t.sort((a, b) => codes.indexOf(a.mapCode) - codes.indexOf(b.mapCode) || a.x - b.x || a.y - b.y)\n\t\t.map(l => ({\n\t\t\t...l,\n\t\t\tx: Math.round(l.x / downsample) * downsample,\n\t\t\ty: Math.round(l.y / downsample) * downsample,\n\t\t}))\n\tconst decodedLocs = decodeLocations(res)\n\tconst inJson = JSON.stringify(sortedLocs)\n\tconst outJson = JSON.stringify(decodedLocs)\n\tif (inJson !== outJson)\n\t\tthrow new Error('wrong decoded locations:\\n> ' + inJson + '\\n> ' + outJson + '\\n> ' + res)\n\n\treturn res\n}\n/**\n * @param {string} encodedLocations\n * @returns {MapLocation[]}\n */\nexport function decodeLocations(encodedLocations) {\n\tconst downsample = parseInt(encodedLocations[0], 36)\n\tencodedLocations = encodedLocations.slice(1)\n\n\tconst locs = /**@type {MapLocation[]}*/ ([])\n\twhile (encodedLocations) {\n\t\tlet i = 0\n\t\tfor (; i < encodedLocations.length; i++) {\n\t\t\tconst mapCode = locEnc_code2map[encodedLocations[i]]\n\t\t\tif (mapCode) {\n\t\t\t\tconst len3 = (i / 2) | 0\n\t\t\t\tfor (let j = 0; j < len3; j += 3) {\n\t\t\t\t\tconst x = decodeLocNum(encodedLocations, j, downsample)\n\t\t\t\t\tconst y = decodeLocNum(encodedLocations, j + len3, downsample)\n\t\t\t\t\tlocs.push({ mapCode, x, y })\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t\tencodedLocations = encodedLocations.slice(i + 1)\n\t}\n\treturn locs\n}\nconst LOC_NUM_ENC_OFFSET = 18 * 36 * 36\n/**\n * @param {number} num\n * @param {number} downsample\n */\nfunction encodeLocNum(num, downsample) {\n\tconst numD = Math.round(num / downsample)\n\tif (numD < -LOC_NUM_ENC_OFFSET || numD >= LOC_NUM_ENC_OFFSET)\n\t\tthrow new Error(`location value out of range: ${num} (${numD})`)\n\tconst str = (LOC_NUM_ENC_OFFSET + numD).toString(36)\n\treturn '0'.repeat(3 - str.length) + str\n}\n/**\n * @param {string} str\n * @param {number} i\n * @param {number} downsample\n */\nfunction decodeLocNum(str, i, downsample) {\n\treturn (parseInt(str.slice(i, i + 3), 36) - LOC_NUM_ENC_OFFSET) * downsample\n}\n\n/**\n * @template {{locations: 'external' | MapLocation[], _locsEnc?: string|null}} T\n * @param {T} obj\n * @param {number} [downsample]\n * @returns {void}\n */\nexport function encodeObjLocations(obj, downsample = 1) {\n\tif (obj.locations !== 'external') {\n\t\tobj._locsEnc = encodeLocationsChecked(obj.locations, downsample)\n\t\tobj.locations = []\n\t}\n}\n/**\n * @template {{locations: 'external' | MapLocation[], _locsEnc?: string|null}} T\n * @param {T} obj\n * @returns {void}\n */\nexport function decodeObjLocations(obj) {\n\tif (obj._locsEnc) {\n\t\tobj.locations = decodeLocations(obj._locsEnc)\n\t\tobj._locsEnc = null\n\t}\n}\n","/**\n *      --  --\n * @param {number} weekday\n * @returns {number}\n */\nexport function weekdayAsMonSun(weekday) {\n\treturn weekday === 0 ? 6 : weekday - 1\n}\n\n/**\n * @param {Date} date\n * @returns {number}\n */\nexport function setDayStartUTC(date) {\n\treturn date.setUTCHours(0, 0, 0, 0)\n}\n","import { decodeObjLocations } from '#lib/genshin'\nimport { DomainShortInfo, EnemyShortInfo, ItemShortInfo } from '#lib/parsing/combine'\n\nexport function apiGetJSONFile<T>(path: string, signal?: AbortSignal | null): Promise<T> | T {\n\tif (BUNDLE_ENV.IS_SSR) {\n\t\treturn JSON.parse(SSR_ENV.readPublic(path))\n\t} else {\n\t\treturn fetch(BUNDLE_ENV.ASSET_PATH + path, { method: 'GET', signal }).then(x => x.json())\n\t}\n}\n\ntype MapByCodeInner<T> = T extends (infer A)[] ? (A extends { code: string } ? Map<string, A> : never) : never\n\nexport type MapAllByCode<T> = T & {\n\tmaps: {\n\t\t[K in keyof T as T[K] extends (infer A)[]\n\t\t\t? A extends { code: string }\n\t\t\t\t? K\n\t\t\t\t: never\n\t\t\t: never]: MapByCodeInner<T[K]>\n\t}\n}\n\nexport function mapAllByCode<T>(obj: T): MapAllByCode<T> {\n\t// @ts-ignore\n\tconst maps: MapAllByCode<T>['maps'] = {}\n\tfor (const attr in obj) {\n\t\tconst val = obj[attr]\n\t\tif (Array.isArray(val) && (val.length === 0 || 'code' in val[0])) {\n\t\t\t// @ts-ignore\n\t\t\tmaps[attr] = new Map(val.map(x => [x.code, x]))\n\t\t}\n\t}\n\treturn Object.assign({}, obj, { maps })\n}\n\nexport function decodeRelatedLocations<T extends { items?: ItemShortInfo[]; enemies?: EnemyShortInfo[] }>(\n\trel: T,\n): T {\n\tif (rel.items) for (const item of rel.items) decodeObjLocations(item)\n\tif (rel.enemies) for (const enemy of rel.enemies) decodeObjLocations(enemy)\n\treturn rel\n}\n\nexport type RelItemsShort = { items: Map<string, ItemShortInfo> }\nexport type RelDomainsShort = { domains: Map<string, DomainShortInfo> }\nexport type RelEnemiesShort = { enemies: Map<string, EnemyShortInfo> }\n\nexport function getAllRelated<T>(map: Map<string, T>, codes: string[]): T[] {\n\tconst res: T[] = []\n\tfor (const code of codes) {\n\t\tconst item = map.get(code)\n\t\tif (item !== undefined) res.push(item)\n\t}\n\treturn res\n}\n\n/*\ntype MergeNestedInner<TBase, T> = T & {\n\t[K in keyof T as K extends 'materialCodes'\n\t\t? 'materials'\n\t\t: K extends 'domainCodes'\n\t\t? 'domains'\n\t\t: K extends 'enemyCodes'\n\t\t? 'enemies'\n\t\t: K]: K extends 'materialCodes'\n\t\t? TBase extends { items: (infer TItem)[] }\n\t\t\t? TItem[]\n\t\t\t: never\n\t\t: K extends 'domainCodes'\n\t\t? TBase extends { domains: (infer TDomain)[] }\n\t\t\t? TDomain[]\n\t\t\t: never\n\t\t: K extends 'enemyCodes'\n\t\t? TBase extends { enemies: (infer TEnemy)[] }\n\t\t\t? TEnemy[]\n\t\t\t: never\n\t\t: MergeNestedInner<TBase, T[K]>\n}\n\ntype WithNested_<T, TArt, TItem, TDomain, TEnemy> = T & {\n\t[K in keyof T as K extends 'materialCodes'\n\t\t? 'materials'\n\t\t: K extends 'domainCodes'\n\t\t? 'domains'\n\t\t: K extends 'enemyCodes'\n\t\t? 'enemies'\n\t\t: K]: K extends 'materialCodes'\n\t\t? TItem\n\t\t: K extends 'domainCodes'\n\t\t? TDomain\n\t\t: K extends 'enemyCodes'\n\t\t? TEnemy\n\t\t: WithNested_<T[K], TItem, TDomain, TEnemy>\n}\n\ntype WithNestedAuto<T> = WithNested_<\n\tT,\n\tT extends { items: (infer TItem)[] } ? TItem[] : never,\n\tT extends { artifacts: (infer TArt)[] } ? TArt[] : never,\n\tT extends { domains: (infer TDomain)[] } ? TDomain[] : never,\n\tT extends { enemies: (infer TEnemy)[] } ? TEnemy[] : never\n>\n\nexport type WithNested<T> = MergeNestedInner<T, T>\n\nexport function addNested<T>(obj: T): WithNested<T> {\n\tconst mapsCache = {}\n\tfunction getAllByCode(codes, attr) {\n\t\tif (!(attr in obj)) throw new Error(`no attr '${attr}' in obj`)\n\t\tconst map = (mapsCache[attr] = mapsCache[attr] ?? new Map(obj[attr].map(x => [x.code, x])))\n\t\tconst res: unknown[] = []\n\t\tfor (const code of codes) {\n\t\t\tconst item = map.get(code)\n\t\t\tif (item) res.push(item)\n\t\t}\n\t\treturn res\n\t}\n\n\tconst relatedAttrMap = {\n\t\tmaterialCodes: ['materials', 'items'],\n\t\tdomainCodes: ['domains', 'domains'],\n\t\tenemyCodes: ['enemies', 'enemies'],\n\t}\n\tfunction mergeInner(cur) {\n\t\tif (cur === null || typeof cur !== 'object') return cur\n\n\t\tfor (const attr in cur) {\n\t\t\tmergeInner(cur[attr])\n\t\t\tconst rel = relatedAttrMap[attr]\n\t\t\tif (rel) cur[rel[0]] = getAllByCode(cur[attr], rel[1])\n\t\t}\n\t}\n\n\tmergeInner(obj)\n\treturn obj as WithNested<T>\n}\n*/\n\n/*\ntype ItemsWithCodeAttrs<T> = {\n\t[K in keyof T]: T[K] extends (infer A)[] ? (A extends { code: string } ? K : never) : never\n}[keyof T]\n\nexport function mapByCode<T, K extends ItemsWithCodeAttrs<T>>(obj: T, attrs: K[]): MapByCode<T, K> {\n\t// @ts-ignore\n\tconst maps: MapByCode<T, K>['maps'] = {}\n\tfor (const attr of attrs) {\n\t\t// @ts-ignore\n\t\tmaps[attr] = new Map(obj[attr].map(x => [x.code, x]))\n\t}\n\treturn Object.assign({}, obj, { maps })\n}\n*/\n","export function BlockHeader({ children, classes = '' }) {\n\treturn <h6 className={`text-uppercase letter-spacing-1 ${classes}`}>{children}</h6>\n}\n","import { BS_isBreakpointLessThen } from '#src/utils/bootstrap'\nimport { useWindowSize } from '#src/utils/hooks'\n\n//     \nexport function MobileDesktopSwitch({\n\tchildrenDesktop,\n\tchildrenMobile,\n}: {\n\tchildrenDesktop: JSX.Element | null\n\tchildrenMobile: JSX.Element | null\n}): JSX.Element | null {\n\tconst windowSize = useWindowSize()\n\treturn BS_isBreakpointLessThen(windowSize.breakpoint, 'xl') ? childrenMobile : childrenDesktop\n}\n","import { useCallback, useMemo, useState } from 'preact/hooks'\n\nimport { arrShallowEqual } from '#lib/utils/collections'\nimport { A } from '#src/routes/router'\n\nexport type Tab = { code: string; title?: string | JSX.Element; href?: string }\n\nexport function tabTitleFromName(obj: { name: string }): string {\n\treturn obj.name\n}\n\nexport function Tabs<T extends Tab>({\n\ttabs,\n\ttitleFunc,\n\tselectedTab,\n\tonTabSelect,\n\tclasses = '',\n}: {\n\ttabs: T[]\n\ttitleFunc?: (tab: T) => string | JSX.Element\n\tselectedTab: T\n\tonTabSelect?: (tab: T) => unknown\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ul className={`nav nav-tabs ${classes}`}>\n\t\t\t{tabs.map(t => (\n\t\t\t\t<li className=\"nav-item\" key={t.code}>\n\t\t\t\t\t<A\n\t\t\t\t\t\tclassName={`nav-link c-pointer ${t.code === selectedTab.code ? 'active' : ''}`}\n\t\t\t\t\t\thref={t.href}\n\t\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\t\tif (t.href) return\n\t\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\t\tonTabSelect && onTabSelect(t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className={`${t.code === selectedTab.code ? 'opacity-75' : ''}`}>\n\t\t\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</A>\n\t\t\t\t</li>\n\t\t\t))}\n\t\t</ul>\n\t)\n}\n\nexport function BtnTabGroup<T extends Tab>({\n\ttabs,\n\ttitleFunc,\n\tselectedTab,\n\tonTabSelect,\n\tclasses = '',\n\tvisibleTabsLength,\n}: {\n\ttabs: T[]\n\ttitleFunc?: (tab: T) => string | JSX.Element\n\tselectedTab: T\n\tonTabSelect: (tab: T) => void\n\tclasses?: string\n\tvisibleTabsLength?: number\n}): JSX.Element {\n\tconst tabsGrouped: T[][] = []\n\tif (visibleTabsLength) {\n\t\ttabsGrouped[0] = tabs.slice(0, visibleTabsLength)\n\t\ttabsGrouped[1] = tabs.slice(visibleTabsLength, tabs.length - 1)\n\t} else {\n\t\ttabsGrouped[0] = tabs\n\t}\n\t// todo    \n\treturn (\n\t\t<div>\n\t\t\t<div class={`btn-group ${classes}`}>\n\t\t\t\t{tabsGrouped[0].map(t => (\n\t\t\t\t\t<button\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tdisabled={tabs.length === 1}\n\t\t\t\t\t\tclassName={`btn lh-sm ${\n\t\t\t\t\t\t\tt.code === selectedTab.code ? 'btn-primary' : 'btn-outline-primary'\n\t\t\t\t\t\t} `}\n\t\t\t\t\t\tkey={t.code}\n\t\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\t\tonTabSelect(t)\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t\t</button>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t\t{visibleTabsLength && tabsGrouped[1].length ? (\n\t\t\t\t<div class={`btn-group ${classes}`}>\n\t\t\t\t\t{tabsGrouped[1].map(t => (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tdisabled={tabs.length === 1}\n\t\t\t\t\t\t\tclassName={`btn lh-sm ${\n\t\t\t\t\t\t\t\tt.code === selectedTab.code ? 'btn-primary' : 'btn-outline-primary'\n\t\t\t\t\t\t\t} `}\n\t\t\t\t\t\t\tkey={t.code}\n\t\t\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\t\t\tonTabSelect(t)\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t) : null}\n\t\t</div>\n\t)\n}\nexport function LightBtnTabGroup<T extends Tab>({\n\ttabs,\n\ttitleFunc,\n\tselectedTab,\n\tonTabSelect,\n\tclasses = '',\n}: {\n\ttabs: T[]\n\ttitleFunc?: (tab: T) => string | JSX.Element\n\tselectedTab: T\n\tonTabSelect?: (tab: T) => void\n\tclasses?: string\n}): JSX.Element {\n\tconst btnClass = 'flex-sm-fill small lh-sm text-sm-center nav-link c-pointer'\n\tconst btnClassActive = btnClass + ' active'\n\tconst btnClassDisabled = btnClass + ' disabled'\n\treturn (\n\t\t<nav className={`nav nav-pills flex-column flex-sm-row ${classes}`}>\n\t\t\t{tabs.map(t => (\n\t\t\t\t<A\n\t\t\t\t\tclassName={\n\t\t\t\t\t\ttabs.length === 1\n\t\t\t\t\t\t\t? btnClassDisabled\n\t\t\t\t\t\t\t: t.code === selectedTab.code\n\t\t\t\t\t\t\t? btnClassActive\n\t\t\t\t\t\t\t: btnClass\n\t\t\t\t\t}\n\t\t\t\t\tkey={t.code}\n\t\t\t\t\thref={t.href}\n\t\t\t\t\tonClick={e => {\n\t\t\t\t\t\tif (t.href) return\n\t\t\t\t\t\te.preventDefault()\n\t\t\t\t\t\tonTabSelect && onTabSelect(t)\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{titleFunc ? titleFunc(t) : 'title' in t ? t.title : t.code}\n\t\t\t\t</A>\n\t\t\t))}\n\t\t</nav>\n\t)\n}\n\n/**\n * )      (  ,    \n *       ,   ).\n * )    args,        args\n *    (,       ,\n *      ,    -  ).\n */\nexport function useSelectable<T extends Tab>(tabs: T[], args?: unknown[]): [T, (tab: T) => unknown] {\n\tconst [tabCodes, setTabCodes] = useState<{ code: string; args: unknown[] }[]>([])\n\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\tconst argsInner = useMemo(() => args ?? [], args)\n\n\tconst item = useMemo(() => tabCodes.find(x => arrShallowEqual(argsInner, x.args)), [argsInner, tabCodes])\n\n\tconst tab = useMemo(() => (item && tabs.find(x => x.code === item.code)) ?? tabs[0], [tabs, item])\n\n\tconst setTab = useCallback(\n\t\t(tab: T) => {\n\t\t\tif (item) {\n\t\t\t\tif (item.code !== tab.code) {\n\t\t\t\t\tsetTabCodes(tabCodes.filter(x => x !== item).concat({ ...item, code: tab.code }))\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetTabCodes(tabCodes.concat({ code: tab.code, args: argsInner }))\n\t\t\t}\n\t\t},\n\t\t[argsInner, item, tabCodes],\n\t)\n\treturn [tab, setTab]\n}\n","import { useCallback, useEffect, useLayoutEffect, useRef, useState } from 'preact/hooks'\n\nimport { calcPosForDd } from '#src/utils/calc-pos-for-dd'\nimport { GET_MODALS_EL } from '#src/utils/dom'\nimport { useClickAway, useWindowSize } from '#src/utils/hooks'\nimport { createPortal } from '#src/utils/preact-compat'\n\nexport const ItemDetailDdPortal = ({\n\tonClickAway,\n\tchildren,\n\tclasses = '',\n\ttargetEl,\n\tcontentKey = null,\n\tshouldScrollToTop,\n}: {\n\tonClickAway?(): void\n\tchildren: JSX.Nodes\n\tclasses?: string\n\ttargetEl: HTMLElement | null | undefined\n\tcontentKey?: string | null | undefined\n\tshouldScrollToTop?: boolean\n}): JSX.Element => {\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `popover item-detail-popover ${classes}`\n\tconst [arrowStyle, setArrowStyle] = useState('')\n\tconst onResize = useCallback(() => {\n\t\tif (!wrapRef.current) return\n\t\tif (!targetEl) return\n\t\tconst wrapEl = wrapRef.current\n\t\tconst pos = calcPosForDd(targetEl.getBoundingClientRect(), wrapEl.getBoundingClientRect(), {\n\t\t\tisAbsolute: true,\n\t\t\tisCentered: true,\n\t\t\tshouldFitInScreen: true,\n\t\t})\n\t\t;('bs-popover-top bs-popover-bottom')\n\t\twrapEl.className = `${defClassName} bs-popover-${pos.layoutPosition.y}`\n\t\twrapEl.style.left = `${pos.left}px`\n\t\twrapEl.style.top = `${pos.top}px`\n\t\tsetArrowStyle(\n\t\t\t`position: absolute; transform: translate3d(${wrapEl.offsetWidth / 2 - 8}px, 0, 0); left: 0`,\n\t\t)\n\t}, [wrapRef, targetEl, defClassName, setArrowStyle])\n\tuseLayoutEffect(onResize)\n\tuseEffect(() => {\n\t\tif (!shouldScrollToTop) return\n\t\tconst wrapEl = wrapRef.current\n\t\tif (!wrapEl) return\n\t\tconst elTop = wrapEl.getBoundingClientRect().top\n\t\tif (elTop < 0) scrollTo(0, scrollY + elTop)\n\t})\n\tuseWindowSize()\n\tuseClickAway(wrapRef, onClickAway)\n\t//todo  ,   \n\treturn createPortal(\n\t\t<div class={defClassName} ref={wrapRef}>\n\t\t\t{children}\n\t\t\t<div class=\"popover-arrow\" style={arrowStyle}></div>\n\t\t</div>,\n\t\tGET_MODALS_EL(),\n\t)\n}\nexport const ItemDetailDdMobilePortal = ({\n\tonClickAway,\n\tchildren,\n\tclasses = '',\n\tcontentKey = null,\n}: {\n\tonClickAway?(): void\n\tchildren: JSX.Nodes\n\tclasses?: string\n\tcontentKey?: string | null | undefined\n}): JSX.Element => {\n\tconst wrapRef: preact.RefObject<HTMLDivElement> | null = useRef(null)\n\tconst defClassName = `fixed-bottom ${classes}`\n\n\tuseClickAway(wrapRef, onClickAway)\n\n\treturn createPortal(\n\t\t<div class={defClassName} ref={wrapRef}>\n\t\t\t{children}\n\t\t</div>,\n\t\tGET_MODALS_EL(),\n\t)\n}\n","import { GI_ARTIFACT_GROUP_CODES, GI_ArtifactTypeCode } from '#lib/genshin'\nimport { ART_GROUP_CODES } from '#src/api/generated'\nimport icon_circlet from '#src/media/circlet.png'\nimport icon_flower from '#src/media/flower.png'\nimport icon_goblet from '#src/media/goblet.png'\nimport icon_plume from '#src/media/plume.png'\nimport icon_sands from '#src/media/sands.png'\n\nexport type GI_ArtifactType = { readonly code: GI_ArtifactTypeCode; imgSrc: string }\nexport const artifactTypes: GI_ArtifactType[] = [\n\t{ code: 'flower' as const, imgSrc: icon_flower },\n\t{ code: 'plume' as const, imgSrc: icon_plume },\n\t{ code: 'sands' as const, imgSrc: icon_sands },\n\t{ code: 'goblet' as const, imgSrc: icon_goblet },\n\t{ code: 'circlet' as const, imgSrc: icon_circlet },\n]\n\nexport function getArtifactTypeIconSrc(artifactTypeCode: string): string {\n\treturn (artifactTypes.find(at => at.code === artifactTypeCode) || artifactTypes[0]).imgSrc\n}\n\nfunction isGroup(code: string) {\n\treturn (GI_ARTIFACT_GROUP_CODES as string[]).includes(code)\n}\n\nexport function getArtifactIconSrc(artifactCode: string): string {\n\treturn isGroup(artifactCode) ? icon_flower : BUNDLE_ENV.ASSET_PATH + `media/artifacts/${artifactCode}.png`\n}\n\nexport function getArtifactIconLargeSrc(artifactCode: string): string {\n\treturn isGroup(artifactCode)\n\t\t? icon_flower\n\t\t: BUNDLE_ENV.ASSET_PATH + `media/artifacts/${artifactCode}.large.png`\n}\n\nfunction getAllOrNone<T>(codes: string[], map: Map<string, T>) {\n\tconst res: T[] = []\n\tfor (const code of codes) {\n\t\tconst item = map.get(code)\n\t\tif (!item) return []\n\t\tres.push(item)\n\t}\n\treturn res\n}\nexport function getAllArtifacts<T>(code: string, artsMap: Map<string, T>): T[] {\n\tif (code in ART_GROUP_CODES) return getAllOrNone(ART_GROUP_CODES[code], artsMap)\n\treturn getAllOrNone([code], artsMap)\n}\n","export function getItemIconSrc(itemCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/items/${itemCode}.png`\n}\n\nexport function getItemIconLargeSrc(itemCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/items/${itemCode}.large.png`\n}\n","import icon_Bow from '#src/media/Icon_Bow.png'\nimport icon_Catalyst from '#src/media/Icon_Catalyst.png'\nimport icon_Claymore from '#src/media/Icon_Claymore.png'\nimport icon_Polearm from '#src/media/Icon_Polearm.png'\nimport icon_Sword from '#src/media/Icon_Sword.png'\n\nimport type { GI_WeaponTypeCode } from '#lib/genshin'\n\nexport type GI_WeaponType = { readonly code: GI_WeaponTypeCode; imgSrc: string }\nexport const weaponTypes: GI_WeaponType[] = [\n\t{ code: 'sword' as const, imgSrc: icon_Sword },\n\t{ code: 'bow' as const, imgSrc: icon_Bow },\n\t{ code: 'catalyst' as const, imgSrc: icon_Catalyst },\n\t{ code: 'claymore' as const, imgSrc: icon_Claymore },\n\t{ code: 'polearm' as const, imgSrc: icon_Polearm },\n]\n\nexport function getWeaponIconSrc(weaponCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/weapons/${weaponCode}.png`\n}\n\nexport function getWeaponIconLageSrc(weaponCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/weapons/${weaponCode}.large.png`\n}\n","import { useCallback, useEffect, useState } from 'preact/hooks'\nimport { ItemAvatar } from './item-cards/item-avatars'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { GI_RarityCode } from '#src/../../lib/genshin'\n\nconst DEF_ANCESTRY_CODES = [\n\t'agnidus-agate-sliver',\n\t'agnidus-agate-fragment',\n\t'agnidus-agate-chunk',\n\t'agnidus-agate-gemstone',\n]\nexport function AlchemyCalculator({\n\tclasses = '',\n\tancestryCodes = DEF_ANCESTRY_CODES,\n}: {\n\tclasses?: string\n\tancestryCodes?: string[]\n}): JSX.Element {\n\tconst [values, setValues] = useState<number[]>([])\n\tconst onValueChange = useCallback(\n\t\te => {\n\t\t\tconst value = +e.target.value\n\t\t\tconst index = +e.target.dataset.index\n\t\t\tsetValues(values.map((v, i) => (v = Math.floor(3 ** (index - i) * value))))\n\t\t},\n\t\t[setValues, values],\n\t)\n\tuseEffect(() => {\n\t\tsetValues(ancestryCodes.map((c, i) => 3 ** (ancestryCodes.length - 1 - i)))\n\t}, [ancestryCodes])\n\tconst startNotRoundClass = 'not-rounded-start'\n\tconst endNotRoundClass = 'not-rounded-end'\n\tconst endRoundClass = 'rounded-end'\n\treturn (\n\t\t<div className={`alchemy-calculator overflow-hidden ${classes}`}>\n\t\t\t<div className=\"input-group\">\n\t\t\t\t{ancestryCodes.map((c, i) => {\n\t\t\t\t\tconst isFirst = i === 0\n\t\t\t\t\tconst isLast = i === ancestryCodes.length - 1\n\t\t\t\t\tconst rarity = 5 - (ancestryCodes.length - 1 - i)\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{i !== 0 ? (\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclassName={`input-group-text text-dark border-light border-top border-bottom bg-${\n\t\t\t\t\t\t\t\t\t\trarity - 1\n\t\t\t\t\t\t\t\t\t} ps-1`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{'='}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t\tclassName={`form-control bg-dark text-light text-end border-secondary pe-1 ${\n\t\t\t\t\t\t\t\t\t!isFirst ? startNotRoundClass : ''\n\t\t\t\t\t\t\t\t} ${endNotRoundClass}`}\n\t\t\t\t\t\t\t\tonInput={onValueChange}\n\t\t\t\t\t\t\t\tvalue={values[i]}\n\t\t\t\t\t\t\t\tdata-index={i}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tsrc={getItemIconSrc(c)}\n\t\t\t\t\t\t\t\trarity={rarity as GI_RarityCode}\n\t\t\t\t\t\t\t\tclasses={`small-avatar with-padding input-group-avatar ${startNotRoundClass} ${\n\t\t\t\t\t\t\t\t\t!isLast ? endNotRoundClass : endRoundClass + ' border-end'\n\t\t\t\t\t\t\t\t} border-top border-bottom border-light`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","export function Spinner(): JSX.Element {\n\treturn (\n\t\t<div class=\"d-flex justify-content-center\">\n\t\t\t<div class=\"spinner-border\" role=\"status\">\n\t\t\t\t<span class=\"visually-hidden\">Loading...</span>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\nexport function CentredSpinner(): JSX.Element {\n\treturn (\n\t\t<div className=\"position-absolute top-0 bottom-0 start-0 end-0 d-flex justify-content-center align-items-center\">\n\t\t\t<Spinner />\n\t\t</div>\n\t)\n}\nexport function CentredLabel({ label }: { label: string }): JSX.Element {\n\treturn (\n\t\t<div className=\"position-absolute top-0 bottom-0 start-0 end-0 d-flex justify-content-center align-items-center placeholder-backdrop\">\n\t\t\t<div class=\"d-flex justify-content-center\">\n\t\t\t\t<div>{label}</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { useCallback } from 'preact/hooks'\n\nexport type Option = { title: string | JSX.Element; code: string }\n\nexport function SimpleSelect({\n\toptions,\n\tselectedOption,\n\tonOptionSelect,\n\tclasses = '',\n\tsize = 1,\n}: {\n\toptions: Option[]\n\tselectedOption: Option | null\n\tonOptionSelect(Option): unknown\n\tclasses?: string\n\tsize?: number\n}): JSX.Element {\n\tconst handleChange = useCallback(\n\t\te => {\n\t\t\tonOptionSelect(options.find(o => o.code === e.target.value))\n\t\t},\n\t\t[options, onOptionSelect],\n\t)\n\treturn (\n\t\t<select\n\t\t\tclassName={`form-select border-secondary bg-dark text-light c-pointer ${classes}`}\n\t\t\tonChange={handleChange}\n\t\t\tsize={size}\n\t\t>\n\t\t\t<option value=\"\" disabled selected hidden>\n\t\t\t\tSelect\n\t\t\t</option>\n\t\t\t{options.map(o => (\n\t\t\t\t<option\n\t\t\t\t\tclassName=\"c-pointer\"\n\t\t\t\t\tkey={o.code}\n\t\t\t\t\tvalue={o.code}\n\t\t\t\t\tselected={!!(selectedOption && o.code === selectedOption.code)}\n\t\t\t\t>\n\t\t\t\t\t{o.title}\n\t\t\t\t</option>\n\t\t\t))}\n\t\t</select>\n\t)\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { GI_DomainTypeCode, MapCode, MapLocation } from '#lib/genshin'\nimport { ArtifactRegularInfo, ItemShortInfo, WeaponRegularInfo } from '#lib/parsing/combine'\nimport { arrGetAfter } from '#lib/utils/collections'\nimport { CentredLabel, Spinner } from '#src/components/placeholders'\nimport { SimpleSelect } from '#src/components/select'\nimport { BtnTabGroup, useSelectable } from '#src/components/tabs'\nimport { MapMarkerRaw } from '#src/components/teyvat-map'\nimport {\n\tI18N_ERROR,\n\tI18N_MAP_CODES_NAME,\n\tI18N_NOTHING_TO_SHOW,\n\tI18N_PINCH_TO_ZOOM,\n\tI18N_SCROLL_TO_ZOOM,\n\tI18N_SOURCE,\n} from '#src/i18n/i18n'\nimport { ToggleWeaponPrimaryMaterialFav } from '#src/modules/builds/common'\nimport { getDomainIconSrc } from '#src/utils/domains'\nimport { getEnemyIconSrc } from '#src/utils/enemies'\nimport { isLoaded, useFetch } from '#src/utils/hooks'\nimport { ELLIPSIS, LEFT_POINTING, RIGHT_POINTING } from '#src/utils/typography'\nimport { LabeledItemAvatar } from './item-avatars'\n\nconst LazyTeyvatMap = import('#src/components/teyvat-map')\n\nexport type CardMapMarkerGroup = {\n\tcode: string\n\ttitle: string\n\tmarkers: 'external' | MapMarkerRaw[]\n}\n\nconst dummyMarkerGroups: CardMapMarkerGroup[] = [\n\t{\n\t\tcode: '',\n\t\ttitle: ELLIPSIS,\n\t\tmarkers: [{ mapCode: 'teyvat', x: 0, y: 0, icon: '' }],\n\t},\n]\nexport function addMarkerGroupsByDomains(\n\tmarkerGroups: CardMapMarkerGroup[],\n\tdomains: { code: string; name: string; type: GI_DomainTypeCode; location: MapLocation }[],\n) {\n\tfor (const domain of domains) {\n\t\tconst loc = domain.location\n\t\tconst icon = getDomainIconSrc(domain.type)\n\t\tmarkerGroups.push({ code: domain.code, title: domain.name, markers: [{ ...loc, icon }] })\n\t}\n}\nexport function addMarkerGroupsByEnemies(\n\tmarkerGroups: CardMapMarkerGroup[],\n\tenemies: { code: string; name: string; locations: 'external' | MapLocation[] }[],\n) {\n\tfor (const enemy of enemies) {\n\t\tconst markers =\n\t\t\tenemy.locations === 'external'\n\t\t\t\t? 'external'\n\t\t\t\t: enemy.locations.map((loc): MapMarkerRaw => {\n\t\t\t\t\t\tconst icon = getEnemyIconSrc(enemy.code)\n\t\t\t\t\t\treturn { ...loc, icon, style: 'circle' }\n\t\t\t\t  })\n\t\tmarkerGroups.push({ code: enemy.code, title: enemy.name, markers })\n\t}\n}\nexport function CardMap({\n\titemData,\n\tmarkerGroups,\n\tisItemFavable,\n\tisFatHead,\n\tclasses = '',\n}: {\n\titemData?: {\n\t\timgSrc: string\n\t\titem: ItemShortInfo | ArtifactRegularInfo | WeaponRegularInfo\n\t}\n\tmarkerGroups: CardMapMarkerGroup[]\n\tisItemFavable?: boolean\n\tisFatHead?: boolean\n\tclasses?: string\n}): JSX.Element {\n\tconst TeyvatMap = useFetch(() => LazyTeyvatMap.then(x => x.TeyvatMap), [])\n\tconst markerGroupsLocal = useMemo(\n\t\t() => (markerGroups.length > 0 ? markerGroups : dummyMarkerGroups),\n\t\t[markerGroups],\n\t)\n\tconst isMapEmpty: boolean = useMemo(() => markerGroupsLocal === dummyMarkerGroups, [markerGroupsLocal])\n\tconst [selectedSource, setSelectedSource] = useSelectable(markerGroupsLocal)\n\n\tconst visibleMapCodeTabs = useMemo(() => {\n\t\tif (selectedSource.markers === 'external') return [{ code: 'teyvat' as MapCode }]\n\t\tconst mapCodes = new Set<MapCode>()\n\t\tfor (const marker of selectedSource.markers) mapCodes.add(marker.mapCode)\n\t\treturn Array.from(mapCodes, code => ({ code }))\n\t}, [selectedSource])\n\n\tconst [selectedMapCodeTab, setMapCodeTab] = useSelectable(visibleMapCodeTabs)\n\tconst selectedMapCode = selectedMapCodeTab.code\n\n\tconst setSourceAndFixMapCode = (selectedSource: CardMapMarkerGroup) => {\n\t\tif (\n\t\t\tselectedSource.markers !== 'external' &&\n\t\t\t!selectedSource.markers.find(m => m.mapCode === selectedMapCode)\n\t\t)\n\t\t\tsetMapCodeTab({ code: selectedSource.markers[0].mapCode })\n\t\tsetSelectedSource(selectedSource)\n\t}\n\tconst goToPrevGroup = () => {\n\t\tsetSourceAndFixMapCode(arrGetAfter(markerGroupsLocal, selectedSource, -1))\n\t}\n\tconst goToNextGroup = () => {\n\t\tsetSourceAndFixMapCode(arrGetAfter(markerGroupsLocal, selectedSource))\n\t}\n\n\tlet sourceSelectEl\n\tif (!markerGroupsLocal.length) {\n\t\tsourceSelectEl = null\n\t} else if (markerGroupsLocal.length === 1) {\n\t\tsourceSelectEl = <span className=\"align-self-center lh-1 small\">{markerGroupsLocal[0].title}</span>\n\t} else if (markerGroupsLocal.length < 3) {\n\t\tsourceSelectEl = (\n\t\t\t<BtnTabGroup\n\t\t\t\ttabs={markerGroupsLocal}\n\t\t\t\tselectedTab={selectedSource}\n\t\t\t\tonTabSelect={setSourceAndFixMapCode}\n\t\t\t\tclasses=\"w-100 btn-group-sm\"\n\t\t\t/>\n\t\t)\n\t} else {\n\t\tsourceSelectEl = (\n\t\t\t<div className=\"btn-group w-100\">\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"btn btn-secondary border-dark border-end-0 text-muted fs-4 lh-1\"\n\t\t\t\t\tonClick={goToPrevGroup}\n\t\t\t\t>\n\t\t\t\t\t{LEFT_POINTING}\n\t\t\t\t</button>\n\t\t\t\t<SimpleSelect\n\t\t\t\t\toptions={markerGroupsLocal}\n\t\t\t\t\tselectedOption={selectedSource}\n\t\t\t\t\tonOptionSelect={setSourceAndFixMapCode}\n\t\t\t\t\tclasses=\"w-100 rounded-0\"\n\t\t\t\t/>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"btn btn-secondary border-dark border-start-0 text-muted fs-4 lh-1\"\n\t\t\t\t\tonClick={goToNextGroup}\n\t\t\t\t>\n\t\t\t\t\t{RIGHT_POINTING}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t)\n\t}\n\n\tconst isItemWeaponPrimaryMaterial = useMemo(\n\t\t() =>\n\t\t\titemData?.item &&\n\t\t\t'types' in itemData.item &&\n\t\t\t~itemData?.item.types?.indexOf('weapon-material-primary'),\n\t\t[itemData?.item],\n\t)\n\n\treturn (\n\t\t<div className={`map-wrap position-relative mb-3 ${classes}`}>\n\t\t\t{selectedSource.markers !== 'external' && isLoaded(TeyvatMap) ? (\n\t\t\t\t<TeyvatMap\n\t\t\t\t\tclasses=\"h-inherit\"\n\t\t\t\t\tpos=\"auto\"\n\t\t\t\t\tmapCode={selectedMapCode}\n\t\t\t\t\tmarkers={selectedSource.markers}\n\t\t\t\t/>\n\t\t\t) : TeyvatMap instanceof Error ? (\n\t\t\t\t<div className=\"text-muted position-absolute top-0 bottom-0 start-0 end-0 d-flex justify-content-center align-items-center\">\n\t\t\t\t\t{I18N_ERROR}\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t\t<div className=\"map-header position-absolute top-0 px-3 py-1 w-100\">\n\t\t\t\t<div className=\"map-header-bg position-absolute top-0 start-0 w-100 h-100 bg-dark opacity-75\"></div>\n\t\t\t\t<div\n\t\t\t\t\tclassName={`d-flex ${isFatHead ? 'flex-column' : 'flex-row'} justify-content-between`}\n\t\t\t\t\tstyle={{ opacity: '0.9999' }}\n\t\t\t\t>\n\t\t\t\t\t{itemData && (\n\t\t\t\t\t\t<div className={`me-2 flex-shrink-1 d-flex ${isFatHead ? '' : 'align-self-center'}`}>\n\t\t\t\t\t\t\t{isItemWeaponPrimaryMaterial && isItemFavable ? (\n\t\t\t\t\t\t\t\t<ToggleWeaponPrimaryMaterialFav\n\t\t\t\t\t\t\t\t\titemCode={itemData.item.code}\n\t\t\t\t\t\t\t\t\tclasses=\"align-self-center p-1 flex-fill fs-5\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t<LabeledItemAvatar\n\t\t\t\t\t\t\t\tisNoBg={true}\n\t\t\t\t\t\t\t\tclasses=\"small-avatar small\"\n\t\t\t\t\t\t\t\tavatarClasses=\"with-padding \"\n\t\t\t\t\t\t\t\timgSrc={itemData.imgSrc}\n\t\t\t\t\t\t\t\ttitle={itemData.item.name}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t{!isMapEmpty ? (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={`d-flex flex-fill ${\n\t\t\t\t\t\t\t\tisFatHead ? 'mt-1' : 'justify-content-end align-self-center'\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<label className=\"me-1 text-muted align-self-center small\">{I18N_SOURCE}:</label>\n\t\t\t\t\t\t\t{sourceSelectEl}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : null}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"map-tip position-absolute px-3 pt-1 lh-1 top-100 start-0 small text-muted opacity-75 user-select-none\">\n\t\t\t\t{!isMapEmpty &&\n\t\t\t\t\tvisibleMapCodeTabs.map(({ code }) => (\n\t\t\t\t\t\t<div className=\"d-inline me-2\" key={code} onClick={() => setMapCodeTab({ code })}>\n\t\t\t\t\t\t\t{visibleMapCodeTabs.length > 1 ? (\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclassName=\"lh-1 align-middle c-pointer me-1\"\n\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\tid={code}\n\t\t\t\t\t\t\t\t\tchecked={code === selectedMapCode}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\tclassName={`lh-1 align-middle text-capitalize ${\n\t\t\t\t\t\t\t\t\tvisibleMapCodeTabs.length > 1 ? 'c-pointer' : ''\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\tfor={code}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{I18N_MAP_CODES_NAME[code]}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclassName={`map-tip position-absolute \\\n\t\t\t\t px-3 pt-1 lh-1 \\\n\t\t\t\t bottom-0 end-0 small text-muted \\\n\t\t\t\t opacity-75 pe-none bg-dark opacity-75 \\\n\t\t\t\t rounded-start not-rounded-bottom \\\n\t\t\t\t ${isMapEmpty ? 'd-none' : ''}`}\n\t\t\t>\n\t\t\t\t<div class=\"d-none d-xl-block\">{I18N_SCROLL_TO_ZOOM}</div>\n\t\t\t\t<div class=\"d-xl-none\">{I18N_PINCH_TO_ZOOM}</div>\n\t\t\t</div>\n\t\t\t{isMapEmpty ? <CentredLabel label={I18N_NOTHING_TO_SHOW} /> : null}\n\t\t</div>\n\t)\n}\n","import { GI_DomainTypeCode } from '#lib/genshin'\n\nexport function getDomainIconSrc(domainType: GI_DomainTypeCode): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/domains/${domainType}.png`\n}\n","export function getEnemyIconSrc(enemyCode: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/enemies/${enemyCode}.png`\n}\n","import { guessCurrentRegion } from '#lib/genshin'\n\n//sv - storage versioned\nexport const SV_SELECTED_REGION_CODE = {\n\tkey: 'selected-region-code',\n\tversions: [() => guessCurrentRegion()] as const,\n}\nexport const SV_ARE_GREETINGS_VISIBLE = {\n\tkey: 'are-greetings-visible',\n\tversions: [() => true] as const,\n}\n\nexport type SV_FavCodes = string[]\nconst favCodes = (key: string) => ({\n\tkey,\n\tversions: [() => [] as SV_FavCodes] as const,\n})\nexport const SV_FAV_CHAR_CODES = favCodes('favoriteCharacterCodes')\nexport const SV_FAV_TALENT_MATERIAL_CODES = favCodes('favoriteTalentMaterialCodes')\nexport const SV_FAV_WEAPON_PRIMARY_MATERIAL_CODES = favCodes('favoriteWeaponPrimaryMaterialCodes')\n\nexport type STORAGE_WEAPON_DATA = [weaponCode: string, weaponMaterialCode: string]\nexport const SV_FAV_WEAPON_DATAS = {\n\tkey: 'favoriteWeaponDatas',\n\tversions: [() => [] as STORAGE_WEAPON_DATA[]] as const,\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { ItemShortInfo } from '#lib/parsing/combine'\nimport { mappedArrPush } from '#lib/utils/collections'\nimport { I18N_ASC_MATERIALS, I18N_FOR_NOBODY, I18N_RECOMMENDED_FOR } from '#src/i18n/i18n'\nimport { useVersionedStorage } from '#src/utils/hooks'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { SV_FAV_CHAR_CODES } from '#src/utils/local-storage-keys'\nimport { HEART } from '#src/utils/typography'\nimport { CharacterAvatar, ItemAvatar } from './item-avatars'\n\nexport function RecommendedTo({\n\tcharCodes,\n\tisInline = false,\n\tisAvatarWithBorder = false,\n\tnavigateToCharacter = false,\n}: {\n\tcharCodes: (string | { count: number; code: string })[]\n\tisInline?: boolean\n\tnavigateToCharacter?: boolean\n\tisAvatarWithBorder?: boolean\n}): JSX.Element {\n\tconst [favCharCodes] = useVersionedStorage(SV_FAV_CHAR_CODES)\n\n\tconst charLists = useMemo(() => {\n\t\tconst groupsMap = new Map<number, string[]>()\n\t\tfor (const item of charCodes) {\n\t\t\tif (typeof item === 'string') {\n\t\t\t\tmappedArrPush(groupsMap, 0, item)\n\t\t\t} else {\n\t\t\t\tmappedArrPush(groupsMap, item.count, item.code)\n\t\t\t}\n\t\t}\n\t\tconst groups = Array.from(groupsMap.entries())\n\t\tgroups.sort(([countA], [countB]) => countB - countA)\n\t\tgroups.forEach(([, codes]) => codes.reverse()) //   (    )\n\n\t\tif (groups.every(([, codes]) => codes.length === 0))\n\t\t\treturn <span class={`align-middle ${isInline ? 'py-1' : ''}`}>{I18N_FOR_NOBODY}</span>\n\n\t\treturn groups.map(([count, codes]) => (\n\t\t\t<div>\n\t\t\t\t{count !== 0 && 'x' + count + ': '}\n\t\t\t\t{codes.map(c => (\n\t\t\t\t\t<CharacterAvatar\n\t\t\t\t\t\tkey={c}\n\t\t\t\t\t\tcode={c}\n\t\t\t\t\t\trarity={isAvatarWithBorder ? 4 : undefined}\n\t\t\t\t\t\tisNoBg={!navigateToCharacter}\n\t\t\t\t\t\tclasses={`small-avatar mb-2 me-2`}\n\t\t\t\t\t\thref={navigateToCharacter ? '/builds/' + c : undefined}\n\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t~favCharCodes.indexOf(c) ? (\n\t\t\t\t\t\t\t\t<span className=\"text-danger opacity-75\">{HEART}</span>\n\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t))\n\t}, [charCodes, isInline, navigateToCharacter, isAvatarWithBorder, favCharCodes])\n\treturn (\n\t\t<div class={`d-flex ${isInline ? 'flex-row' : 'flex-column'}`}>\n\t\t\t<label class=\"opacity-75 pe-2 align-middle py-1\">\n\t\t\t\t{I18N_RECOMMENDED_FOR}\n\t\t\t\t{isInline ? ':' : ''}\n\t\t\t</label>\n\t\t\t{charLists}\n\t\t</div>\n\t)\n}\n\nexport function AscMaterials({\n\tmaterials,\n\tselectedMat,\n\tonMatSelect,\n}: {\n\tmaterials: ItemShortInfo[]\n\tselectedMat?: ItemShortInfo\n\tonMatSelect: (ItemShortInfo) => unknown\n}): JSX.Element {\n\tconst matList = useMemo(\n\t\t() =>\n\t\t\tmaterials.length\n\t\t\t\t? materials.map(m => (\n\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\tkey={m.code}\n\t\t\t\t\t\t\trarity={2}\n\t\t\t\t\t\t\tclasses={`mb-2 mx-1 small-avatar with-padding ${\n\t\t\t\t\t\t\t\tselectedMat?.code !== m.code && 'opacity-50'\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\t\tonClick={() => onMatSelect(m)}\n\t\t\t\t\t\t/>\n\t\t\t\t  ))\n\t\t\t\t: null,\n\t\t[materials, selectedMat, onMatSelect],\n\t)\n\treturn (\n\t\t<>\n\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_ASC_MATERIALS}:</label>\n\t\t\t{matList}\n\t\t</>\n\t)\n}\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { ArtifactRegularInfo, ItemShortInfo, WeaponRegularInfo } from '#lib/parsing/combine'\nimport { getAllRelated, RelDomainsShort, RelEnemiesShort, RelItemsShort } from '#src/api/utils'\nimport { BlockHeader } from '#src/components/block-header'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { BtnTabGroup, tabTitleFromName, useSelectable } from '#src/components/tabs'\nimport {\n\tItemDetailDdMobilePortal,\n\tItemDetailDdPortal,\n} from '#src/containers/item-cards/item-detail-dd-portal'\nimport {\n\tI18N_ALCHEMY_CALC,\n\tI18N_BASE_ATTACK,\n\tI18N_OBTAINED_DURING_STORYLINE,\n\tI18N_PIECE_BONUS,\n\tI18N_PIECES_BONUS,\n\tI18N_SECONDARY_STAT,\n\tI18N_STAT_NAME,\n\tI18N_WEAPON_OBTAIN_SOURCE_NAME,\n\tI18N_WEAPON_TYPE_NAME,\n} from '#src/i18n/i18n'\nimport {\n\tnotesToJSX,\n\tToggleTalentMaterialFav,\n\tToggleWeaponPrimaryMaterialFav,\n} from '#src/modules/builds/common'\nimport { getArtifactIconLargeSrc, getArtifactIconSrc } from '#src/utils/artifacts'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { BULLET } from '#src/utils/typography'\nimport { getWeaponIconLageSrc } from '#src/utils/weapons'\nimport { AlchemyCalculator } from '../alchemy-calculator'\nimport { addMarkerGroupsByDomains, addMarkerGroupsByEnemies, CardMap, CardMapMarkerGroup } from './card-map'\nimport { RecommendedTo } from './common'\nimport { DdContext, ItemAvatar } from './item-avatars'\n\nimport type { MapMarkerRaw } from '#src/components/teyvat-map'\n//     \nexport function CardDescMobileWrap({\n\tchildren,\n\ttargetEl,\n\tonClickAway,\n}: {\n\tonClickAway: () => void\n\ttargetEl: HTMLElement | null | undefined\n\tchildren: JSX.Element\n}): JSX.Element {\n\treturn (\n\t\t<MobileDesktopSwitch\n\t\t\tchildrenDesktop={\n\t\t\t\t<ItemDetailDdPortal onClickAway={onClickAway} targetEl={targetEl} shouldScrollToTop={true}>\n\t\t\t\t\t{children}\n\t\t\t\t</ItemDetailDdPortal>\n\t\t\t}\n\t\t\tchildrenMobile={\n\t\t\t\t<ItemDetailDdMobilePortal onClickAway={onClickAway}>{children}</ItemDetailDdMobilePortal>\n\t\t\t}\n\t\t/>\n\t)\n}\n//   \nfunction Card({\n\tclasses = '',\n\ttitleEl,\n\tselectorEl,\n\tbodyEl,\n\tmapEl,\n}: {\n\tclasses?: string\n\ttitleEl: JSX.Nodes | string\n\tselectorEl?: JSX.Nodes\n\tbodyEl?: JSX.Nodes\n\tmapEl?: JSX.Nodes\n}): JSX.Element {\n\treturn (\n\t\t<div className={`item-detail-popover-card card ${classes}`}>\n\t\t\t<h3 className=\"card-header fs-4 d-flex position-relative\">\n\t\t\t\t<span className=\"flex-fill\">{titleEl}</span>{' '}\n\t\t\t\t<DdContext.Consumer>\n\t\t\t\t\t{ddContext =>\n\t\t\t\t\t\tddContext.onClickAway && (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclass=\"btn-close btn-sm position-absolute end-0 top-50 translate-middle\"\n\t\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\t\tonClick={ddContext.onClickAway}\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t</DdContext.Consumer>\n\t\t\t</h3>\n\t\t\t{selectorEl && <div class=\"p-3\">{selectorEl}</div>}\n\t\t\t<div\n\t\t\t\tclassName={`card-body overflow-auto flex-shrink-1 hide-if-empty mb-3 pb-0 ${\n\t\t\t\t\tselectorEl ? 'pt-0' : ''\n\t\t\t\t}`}\n\t\t\t>\n\t\t\t\t{bodyEl}\n\t\t\t</div>\n\t\t\t{mapEl}\n\t\t</div>\n\t)\n}\n\nexport function ArtifactCard({\n\tclasses,\n\tartifacts,\n\trelated,\n\ttitle,\n}: {\n\tclasses?: string\n\tartifacts: ArtifactRegularInfo[]\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n\ttitle: string\n}): JSX.Element {\n\tconst [selectedArt, setSelectedArt] = useSelectable(artifacts)\n\n\tconst dataForMap = useMemo(() => {\n\t\tconst srcs = selectedArt.obtainSources\n\t\tconst markerGroups = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: selectedArt,\n\t\t\t\timgSrc: getArtifactIconSrc(selectedArt.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [selectedArt, related])\n\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={title}\n\t\t\tclasses={classes}\n\t\t\tselectorEl={\n\t\t\t\tartifacts.length > 1 ? (\n\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\ttabs={artifacts}\n\t\t\t\t\t\ttitleFunc={tabTitleFromName}\n\t\t\t\t\t\tselectedTab={selectedArt}\n\t\t\t\t\t\tonTabSelect={setSelectedArt}\n\t\t\t\t\t\tclasses=\"w-100 btn-group-sm\"\n\t\t\t\t\t\tvisibleTabsLength={3}\n\t\t\t\t\t/>\n\t\t\t\t) : null\n\t\t\t}\n\t\t\tbodyEl={\n\t\t\t\t<div className=\"\">\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\trarity={selectedArt.rarity}\n\t\t\t\t\t\tclasses=\"float-end me-2 large-avatar\"\n\t\t\t\t\t\tsrc={getArtifactIconLargeSrc(selectedArt.code)}\n\t\t\t\t\t/>\n\t\t\t\t\t{selectedArt.sets[1] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECE_BONUS(1)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[1])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{selectedArt.sets[2] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(2)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[2])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{selectedArt.sets[4] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(4)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3\">{notesToJSX(selectedArt.sets[4])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{<RecommendedTo charCodes={selectedArt.recommendedTo} />}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <CardMap {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n\nexport function WeaponCard({\n\tclasses,\n\tweapon,\n\trelated,\n}: {\n\tonCloseClick?: () => void\n\tclasses?: string\n\tweapon: WeaponRegularInfo\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n}): JSX.Element {\n\tconst materials = getAllRelated(related.items, weapon.materialCodes)\n\tconst [materialOnMap, setMaterialOnMap] = useState(materials[0])\n\tconst dataForMap = useMemo(() => {\n\t\tconst srcs = materialOnMap.obtainSources\n\t\tconst markerGroups = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: materialOnMap,\n\t\t\t\timgSrc: getItemIconSrc(materialOnMap.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [materialOnMap, related])\n\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={\n\t\t\t\tweapon.name\n\t\t\t\t// <>\n\t\t\t\t// \t{weapon.name}{' '}\n\t\t\t\t// \t{ascMaterial && (\n\t\t\t\t// \t\t<ToggleWeaponFav\n\t\t\t\t// \t\t\tweaponCode={weapon.code}\n\t\t\t\t// \t\t\tweapMatCode={ascMaterial.code}\n\t\t\t\t// \t\t\tclasses=\"d-inline align-middle p-1\"\n\t\t\t\t// \t\t/>\n\t\t\t\t// \t)}\n\t\t\t\t// </>\n\t\t\t}\n\t\t\tclasses={classes}\n\t\t\tbodyEl={\n\t\t\t\t<div className=\"\">\n\t\t\t\t\t<div className=\"float-end\">\n\t\t\t\t\t\t<div className=\"d-flex w-100 justify-content-around\">\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\t\tclasses=\"mb-2 large-avatar\"\n\t\t\t\t\t\t\t\tsrc={getWeaponIconLageSrc(weapon.code)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"d-flex justify-content-between w-100\">\n\t\t\t\t\t\t\t{materials.map(m => (\n\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\tkey={m.code}\n\t\t\t\t\t\t\t\t\trarity={2}\n\t\t\t\t\t\t\t\t\tclasses={`mb-2 mx-1 small-avatar with-padding ${\n\t\t\t\t\t\t\t\t\t\tmaterialOnMap.code !== m.code && 'opacity-50'\n\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\t\t\t\tonClick={() => setMaterialOnMap(m)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"overflow-hidden\">\n\t\t\t\t\t\t<BlockHeader classes=\"d-inline-block me-1\">\n\t\t\t\t\t\t\t{I18N_WEAPON_TYPE_NAME(weapon.typeCode)}\n\t\t\t\t\t\t</BlockHeader>\n\t\t\t\t\t\t<span className=\"mb-2 text-muted\">\n\t\t\t\t\t\t\t{BULLET} {weapon.obtainSources.map(I18N_WEAPON_OBTAIN_SOURCE_NAME).join(', ')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t\t<div className=\"me-2\">\n\t\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_BASE_ATTACK}</div>\n\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t{weapon.atk.base} / {weapon.atk.max}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{weapon.subStat && (\n\t\t\t\t\t\t\t<div className=\"ms-1\">\n\t\t\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_STAT_NAME(weapon.subStat.code)}</div>\n\t\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t\t{weapon.subStat.base} / {weapon.subStat.max}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t<span className=\"opacity-75\">{I18N_SECONDARY_STAT}</span>\n\t\t\t\t\t\t<div className=\"\">{notesToJSX(weapon.passiveStat)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<RecommendedTo charCodes={weapon.recommendedTo} />\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <CardMap isItemFavable={true} {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n\nexport function OtherItemCard({\n\tclasses,\n\titem,\n\trelated,\n}: {\n\tonCloseClick?: () => void\n\tclasses?: string\n\titem: ItemShortInfo\n\trelated: RelItemsShort & RelDomainsShort & RelEnemiesShort\n}): JSX.Element {\n\tconst materials = getAllRelated(related.items, [item.code])\n\tconst materialOnMap = materials[0]\n\tconst dataForMap = useMemo(() => {\n\t\tconst markerGroups: CardMapMarkerGroup[] = []\n\t\tconst srcs = materialOnMap.obtainSources\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(related.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(related.enemies, srcs.enemyCodes))\n\t\tif (materialOnMap.locations.length > 0) {\n\t\t\tconst icon = getItemIconSrc(materialOnMap.code)\n\t\t\tconst markers =\n\t\t\t\tmaterialOnMap.locations === 'external'\n\t\t\t\t\t? 'external'\n\t\t\t\t\t: materialOnMap.locations.map((loc): MapMarkerRaw => ({ ...loc, icon, style: 'outline' }))\n\t\t\tmarkerGroups.push({ code: materialOnMap.code, title: materialOnMap.name, markers })\n\t\t}\n\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: materialOnMap,\n\t\t\t\timgSrc: getItemIconSrc(materialOnMap.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [materialOnMap, related])\n\n\tconst isItemCharTalentMaterial = useMemo(() => ~item.types.indexOf('character-material-talent'), [item])\n\tconst isItemWeaponPrimaryMaterial = useMemo(() => ~item.types.indexOf('weapon-material-primary'), [item])\n\tconst codesForCalc = useMemo(() => {\n\t\treturn [...item.ancestryCodes.reverse(), item.code]\n\t}, [item])\n\treturn (\n\t\t<Card\n\t\t\ttitleEl={\n\t\t\t\t<>\n\t\t\t\t\t{item.name}{' '}\n\t\t\t\t\t{isItemCharTalentMaterial ? (\n\t\t\t\t\t\t<ToggleTalentMaterialFav itemCode={item.code} classes=\"d-inline align-middle p-1\" />\n\t\t\t\t\t) : null}\n\t\t\t\t\t{isItemWeaponPrimaryMaterial ? (\n\t\t\t\t\t\t<ToggleWeaponPrimaryMaterialFav\n\t\t\t\t\t\t\titemCode={item.code}\n\t\t\t\t\t\t\tclasses=\"d-inline align-middle p-1\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t) : null}\n\t\t\t\t</>\n\t\t\t}\n\t\t\tclasses={classes}\n\t\t\tbodyEl={\n\t\t\t\titem.code === 'brilliant-diamond-gemstone' ? (\n\t\t\t\t\tI18N_OBTAINED_DURING_STORYLINE\n\t\t\t\t) : item.ancestryCodes.length > 0 ? (\n\t\t\t\t\t<div className=\"\">\n\t\t\t\t\t\t{/* <ItemAvatar rarity={3} classes=\"large-avatar float-end\" src={getItemIconSrc(item.code)} /> */}\n\t\t\t\t\t\t{/* <BlockHeader></BlockHeader>\n\t\t\t\t<div className=\"mb-3\">{notesToJSX()}</div> */}\n\t\t\t\t\t\t<BlockHeader>{I18N_ALCHEMY_CALC}</BlockHeader>\n\t\t\t\t\t\t<AlchemyCalculator ancestryCodes={codesForCalc} />\n\t\t\t\t\t</div>\n\t\t\t\t) : null\n\t\t\t}\n\t\t\tmapEl={dataForMap.markerGroups.length ? <CardMap {...dataForMap} /> : null}\n\t\t></Card>\n\t)\n}\n","import { useCallback, useMemo } from 'preact/hooks'\n\nimport { CharacterFullInfoWithRelated } from '#lib/parsing/combine'\nimport { CompactTextParagraphs, TextNode } from '#lib/parsing/helperteam/text'\nimport { ArtifactRef, ArtifactRefNode, CharacterBuildInfoRole } from '#lib/parsing/helperteam/types'\nimport { mustBeDefined, staticNever } from '#lib/utils/values'\nimport { ART_GROUP_CODES } from '#src/api/generated'\nimport { MapAllByCode } from '#src/api/utils'\nimport { Tooltip } from '#src/components/tooltip'\nimport { ArtifactCard } from '#src/containers/item-cards/dd-cards'\nimport { ItemLabelWithDd, LabeledItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { logError } from '#src/errors'\nimport { I18N_ART_GROUP_NAME, I18N_CONJUCTIONS, I18N_FAV_TIPS, I18N_STAT_NAME } from '#src/i18n/i18n'\nimport { getAllArtifacts, getArtifactIconSrc } from '#src/utils/artifacts'\nimport { Migration, useHover, useVersionedStorage } from '#src/utils/hooks'\nimport {\n\tSV_FAV_CHAR_CODES,\n\tSV_FAV_TALENT_MATERIAL_CODES,\n\tSV_FAV_WEAPON_DATAS,\n\tSV_FAV_WEAPON_PRIMARY_MATERIAL_CODES,\n\tSV_FavCodes,\n} from '#src/utils/local-storage-keys'\nimport { HEART, HEART_EMPTY, STAR } from '#src/utils/typography'\n\nexport const DUMMY_ROLE: { code: string; name: string } & Partial<CharacterBuildInfoRole<'monolang'>> = {\n\tname: '',\n\tcode: '',\n}\nexport const DUMMY_ROLES = [DUMMY_ROLE]\n\nexport type BuildRoleOrDummy = CharacterBuildInfoRole<'monolang'> | typeof DUMMY_ROLE\n\nexport function makeRoleTitle(r: BuildRoleOrDummy) {\n\treturn (\n\t\t<span key={r.code}>\n\t\t\t{r.isRecommended && (\n\t\t\t\t<span className=\"fs-4 lh-1 opacity-75 text-rarity-5 align-bottom\">{STAR}</span>\n\t\t\t)}\n\t\t\t{r.name}\n\t\t</span>\n\t)\n}\nexport const CIRCLET_GOBLET_SANDS = ['sands', 'goblet', 'circlet'] as const\nexport function getRoleData(build: CharacterFullInfoWithRelated, selectedCode: string) {\n\treturn mustBeDefined(build.character.roles.find(x => x.code === selectedCode))\n}\nexport function genArtMainStatDetail(\n\trole: CharacterBuildInfoRole<'monolang'>,\n\titemCode: 'circlet' | 'goblet' | 'sands',\n\tisShort?: boolean,\n) {\n\treturn (\n\t\t<span className=\"\">\n\t\t\t{genSimpleList(role.mainStats[itemCode].codes.map(I18N_STAT_NAME))}{' '}\n\t\t\t{!isShort && genNotes(role.mainStats[itemCode])}\n\t\t\t{!isShort && genSeeCharNotes(role.mainStats[itemCode])}\n\t\t</span>\n\t)\n}\nexport function genSimpleList(arr: string[]) {\n\treturn arr.join(', ')\n}\nexport function notesWrap(str) {\n\treturn <span className=\"text-muted small\">{str}</span>\n}\nexport function genNotes(item: { notes: CompactTextParagraphs | null }) {\n\treturn item.notes === null ? '' : notesWrap(notesToJSX(item.notes))\n}\nexport function genSeeCharNotes(item: { seeCharNotes: boolean }) {\n\treturn '' //TODO\n\treturn item.seeCharNotes ? notesWrap(' (see notes)') : ''\n}\nexport function notesToJSX(tips: CompactTextParagraphs | null): JSX.Nodes {\n\tfunction processString(str: string) {\n\t\treturn str\n\t\t\t.split('\\n')\n\t\t\t.map((sub, i, arr) => [sub, i < arr.length - 1 ? <br /> : ''])\n\t\t\t.flat()\n\t\t\t.filter(a => a)\n\t}\n\tfunction processObj(tip: TextNode) {\n\t\tif (typeof tip === 'string') return processString(tip)\n\t\tif ('p' in tip) return <p>{notesToJSX(tip.p)}</p>\n\t\tif ('b' in tip) return <b class=\"text-normal\">{notesToJSX(tip.b)}</b>\n\t\tif ('i' in tip) return <i>{notesToJSX(tip.i)}</i>\n\t\tif ('s' in tip) return <s>{notesToJSX(tip.s)}</s>\n\t\tif ('a' in tip)\n\t\t\treturn (\n\t\t\t\t<a href={tip.href} target=\"_blank\">\n\t\t\t\t\t{notesToJSX(tip.a)}\n\t\t\t\t</a>\n\t\t\t)\n\t\tif ('weapon' in tip)\n\t\t\treturn (\n\t\t\t\t<ItemLabelWithDd type=\"weapon\" code={tip.code}>\n\t\t\t\t\t{notesToJSX(tip.weapon)}\n\t\t\t\t</ItemLabelWithDd>\n\t\t\t)\n\t\tif ('artifact' in tip)\n\t\t\treturn (\n\t\t\t\t<ItemLabelWithDd type=\"artifact\" code={tip.code}>\n\t\t\t\t\t{notesToJSX(tip.artifact)}\n\t\t\t\t</ItemLabelWithDd>\n\t\t\t)\n\t\tif ('item' in tip) return <>{notesToJSX(tip.item)}</>\n\t\tstaticNever(tip)\n\t\tlogError('unknown text node: ' + JSON.stringify(tip))\n\t\treturn <span>{JSON.stringify(tip)}</span>\n\t}\n\tif (!tips) return null\n\tif (Array.isArray(tips)) return tips.map(processObj).flat()\n\treturn processObj(tips)\n}\n\nexport function getCoverArtifactForSet(code, artsForDd) {\n\tlet coverArt\n\tif (code in ART_GROUP_CODES) {\n\t\tcoverArt = {\n\t\t\tname: I18N_ART_GROUP_NAME[code],\n\t\t\tcode: code,\n\t\t\trarity: 5,\n\t\t}\n\t} else {\n\t\tcoverArt = artsForDd[0]\n\t}\n\treturn coverArt\n}\nexport function genArtifactAdvice(\n\tset: ArtifactRef | ArtifactRefNode,\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>,\n\tisLast = true,\n) {\n\t// todo notes\n\tif ('code' in set) {\n\t\t//ArtifactRef\n\t\tconst artifactsForDd = getAllArtifacts(set.code, build.maps.artifacts)\n\t\tif (!artifactsForDd.length) return null\n\t\tconst coverArt = getCoverArtifactForSet(set.code, artifactsForDd)\n\t\treturn (\n\t\t\t<LabeledItemAvatar\n\t\t\t\timgSrc={getArtifactIconSrc(set.code)}\n\t\t\t\trarity={coverArt.rarity}\n\t\t\t\ttitle={coverArt.name}\n\t\t\t\tkey={set.code}\n\t\t\t\tavatarTopEndBadge={'x' + set.count}\n\t\t\t\tavatarClasses=\"with-padding\"\n\t\t\t\tclasses={`small ${isLast ? 'mb-1' : ''}`}\n\t\t\t\tddComponent={\n\t\t\t\t\t<ArtifactCard artifacts={artifactsForDd} related={build.maps} title={coverArt.name} />\n\t\t\t\t}\n\t\t\t/>\n\t\t)\n\t} else {\n\t\t//ArtifactRefNode\n\t\treturn (\n\t\t\t<ItemsListGroupWrap>\n\t\t\t\t{set.arts.map((art, i) => {\n\t\t\t\t\tconst isLastInList = i >= set.arts.length - 1\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t{genArtifactAdvice(art, build, isLastInList)}\n\t\t\t\t\t\t\t{!isLastInList && <ItemsJoinerWrap>{I18N_CONJUCTIONS[set.op]}</ItemsJoinerWrap>}\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</ItemsListGroupWrap>\n\t\t)\n\t}\n}\nexport function ItemsJoinerWrap({ children }): JSX.Element {\n\treturn <div className=\"text-start text-muted small px-5 my-n1\">{children}</div>\n}\nexport function ItemsListGroupWrap({\n\tchildren,\n}: {\n\tchildren: JSX.Node | (JSX.Element | null)[]\n}): JSX.Element {\n\treturn <div className=\"border-2 rounded border-secondary border-start ps-2\">{children}</div>\n}\nexport const MAX_SMTHS_TO_STORE = 5\nexport function removeOldSmthsFromList<T>(codes: T[]): T[] {\n\treturn codes.slice(0, MAX_SMTHS_TO_STORE)\n}\n\nfunction ToggleSmthFav<\n\tTStorageKey extends {\n\t\tkey: string\n\t\tversions: readonly [...Migration<unknown, unknown>[], Migration<unknown, SV_FavCodes>]\n\t},\n>({\n\tsmthCode,\n\tclasses,\n\tstorageKey,\n\ttipFav,\n\ttipNotFav,\n}: {\n\tsmthCode: string\n\tclasses?: string\n\tstorageKey: TStorageKey\n\ttipFav: string\n\ttipNotFav: string\n}): JSX.Element {\n\tconst [favSmthCodes, setFavSmthCodes] = useVersionedStorage(storageKey)\n\tconst [elRef, isHovered] = useHover<HTMLDivElement>()\n\tconst isFav = ~favSmthCodes.indexOf(smthCode)\n\tconst toggleFav = useCallback(() => {\n\t\tsetFavSmthCodes(\n\t\t\tremoveOldSmthsFromList(\n\t\t\t\tisFav ? favSmthCodes.filter(c => c !== smthCode) : [smthCode, ...favSmthCodes],\n\t\t\t),\n\t\t)\n\t}, [smthCode, setFavSmthCodes, favSmthCodes, isFav])\n\treturn (\n\t\t<div\n\t\t\trole=\"button\"\n\t\t\tclassName={`user-select-none lh-1 ${isFav ? 'text-danger' : 'text-danger opacity-50'} ${classes}`}\n\t\t\tonClick={toggleFav}\n\t\t\tref={elRef}\n\t\t>\n\t\t\t{isFav ? HEART : HEART_EMPTY}\n\t\t\t{elRef.current && isHovered ? (\n\t\t\t\t<Tooltip targetEl={elRef.current}>{isFav ? tipFav : tipNotFav}</Tooltip>\n\t\t\t) : null}\n\t\t</div>\n\t)\n}\n\nexport function ToggleCharFav({\n\tcharacterCode,\n\tclasses,\n}: {\n\tcharacterCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={characterCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SV_FAV_CHAR_CODES}\n\t\t\ttipFav={I18N_FAV_TIPS.remove.character}\n\t\t\ttipNotFav={I18N_FAV_TIPS.add.character}\n\t\t/>\n\t)\n}\nexport function ToggleWeaponPrimaryMaterialFav({\n\titemCode,\n\tclasses,\n}: {\n\titemCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={itemCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SV_FAV_WEAPON_PRIMARY_MATERIAL_CODES}\n\t\t\ttipFav={I18N_FAV_TIPS.remove.material}\n\t\t\ttipNotFav={I18N_FAV_TIPS.add.material}\n\t\t/>\n\t)\n}\nexport function ToggleTalentMaterialFav({\n\titemCode,\n\tclasses,\n}: {\n\titemCode: string\n\tclasses?: string\n}): JSX.Element {\n\treturn (\n\t\t<ToggleSmthFav\n\t\t\tsmthCode={itemCode}\n\t\t\tclasses={classes}\n\t\t\tstorageKey={SV_FAV_TALENT_MATERIAL_CODES}\n\t\t\ttipFav={I18N_FAV_TIPS.remove.material}\n\t\t\ttipNotFav={I18N_FAV_TIPS.add.material}\n\t\t/>\n\t)\n}\n\n//not used\nexport function ToggleWeaponFav({\n\tweaponCode,\n\tweapMatCode,\n\tclasses,\n}: {\n\tweaponCode: string\n\tweapMatCode: string\n\tclasses?: string\n}): JSX.Element {\n\tconst [favWeaponDatas, setWeaponDatas] = useVersionedStorage(SV_FAV_WEAPON_DATAS)\n\tconst favWeaponCodes = useMemo(() => favWeaponDatas.map(wd => wd[0]), [favWeaponDatas])\n\tconst [elRef, isHovered] = useHover<HTMLDivElement>()\n\tconst isFav = ~favWeaponCodes.indexOf(weaponCode)\n\tconst toggleFav = useCallback(() => {\n\t\tsetWeaponDatas(\n\t\t\tremoveOldSmthsFromList(\n\t\t\t\tisFav\n\t\t\t\t\t? favWeaponDatas.filter(d => d[0] !== weaponCode)\n\t\t\t\t\t: [[weaponCode, weapMatCode], ...favWeaponDatas],\n\t\t\t),\n\t\t)\n\t}, [weaponCode, weapMatCode, setWeaponDatas, favWeaponDatas, isFav])\n\treturn (\n\t\t<div\n\t\t\trole=\"button\"\n\t\t\tclassName={`user-select-none lh-1 ${isFav ? 'text-danger' : 'text-danger opacity-50'} ${classes}`}\n\t\t\tonClick={toggleFav}\n\t\t\tref={elRef}\n\t\t>\n\t\t\t{isFav ? HEART : HEART_EMPTY}\n\t\t\t{elRef.current && isHovered ? (\n\t\t\t\t<Tooltip targetEl={elRef.current}>\n\t\t\t\t\t{isFav ? I18N_FAV_TIPS.remove.weapon : I18N_FAV_TIPS.add.weapon}\n\t\t\t\t</Tooltip>\n\t\t\t) : null}\n\t\t</div>\n\t)\n}\n","// export type Character = {\n// \tcode: string,\n// \telement:\n// }\n\n// export function getCharactersWithElement = (characters, elementCode) = {\n// \treturn characters.filter(c=> c.element = elementCode)\n// }\n\nfunction unprefixTraveler(code: string) {\n\treturn code.startsWith('traveler-') ? 'traveler' : code\n}\n\nexport function getCharacterAvatarSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/avatars/${unprefixTraveler(code)}.png`\n}\n\nexport function getCharacterAvatarLargeSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/avatars/${unprefixTraveler(code)}.large.png`\n}\n\nexport function getCharacterPortraitSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/portraits/${unprefixTraveler(code)}.png`\n}\n\nexport function getCharacterSilhouetteSrc(code: string): string {\n\treturn BUNDLE_ENV.ASSET_PATH + `media/characters/silhouettes/${unprefixTraveler(code)}.svg`\n}\n","import element_Anemo from '#src/media/Element_Anemo.png'\nimport element_Cryo from '#src/media/Element_Cryo.png'\nimport element_Dendro from '#src/media/Element_Dendro.png'\nimport element_Electro from '#src/media/Element_Electro.png'\nimport element_Geo from '#src/media/Element_Geo.png'\nimport element_Hydro from '#src/media/Element_Hydro.png'\nimport element_Pyro from '#src/media/Element_Pyro.png'\n\nimport type { GI_ElementCode } from '#lib/genshin'\n\nexport type GI_Element = { readonly code: GI_ElementCode; imgSrc: string }\nexport const elements: GI_Element[] = [\n\t{ code: 'pyro' as const, imgSrc: element_Pyro },\n\t{ code: 'hydro' as const, imgSrc: element_Hydro },\n\t{ code: 'anemo' as const, imgSrc: element_Anemo },\n\t{ code: 'electro' as const, imgSrc: element_Electro },\n\t{ code: 'dendro' as const, imgSrc: element_Dendro },\n\t{ code: 'cryo' as const, imgSrc: element_Cryo },\n\t{ code: 'geo' as const, imgSrc: element_Geo },\n]\n","import { createContext } from 'preact'\nimport { useCallback, useContext, useRef, useState } from 'preact/hooks'\n\nimport { GI_RarityCode } from '#lib/genshin'\nimport {\n\tArtifactRegularInfo,\n\tDomainShortInfo,\n\tEnemyShortInfo,\n\tItemShortInfo,\n\tWeaponRegularInfo,\n} from '#lib/parsing/combine'\nimport { mustBeNever } from '#src/../../lib/utils/values'\nimport { getCoverArtifactForSet } from '#src/modules/builds/common'\nimport { A } from '#src/routes/router'\nimport { getAllArtifacts } from '#src/utils/artifacts'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { elements } from '#src/utils/elements'\nimport { ArtifactCard, CardDescMobileWrap, WeaponCard } from './dd-cards'\n\nimport './item-cards.scss'\n\nexport function getRarityBorder(r: GI_RarityCode): string {\n\treturn r === 5 ? 'border-warning' : 'border-light'\n}\n\ninterface ItemAvatarCommonProps {\n\trarity?: GI_RarityCode\n\tisNoBg?: boolean\n\tborderColor?: string\n\tclasses?: string\n\thref?: string\n\tonClick?(): unknown\n\tbadgeTopStart?: string | null | JSX.Node\n\tbadgeTopEnd?: string | null | JSX.Node\n\tddComponent?: JSX.Element\n}\ninterface ItemAvatarProps extends ItemAvatarCommonProps {\n\tsrc: string\n}\ninterface CharacterAvatarProps extends ItemAvatarCommonProps {\n\tcode: string //todo charcode\n}\nexport function ItemAvatar({\n\tsrc,\n\trarity,\n\tclasses = '',\n\thref,\n\tisNoBg,\n\tonClick,\n\tbadgeTopStart,\n\tbadgeTopEnd,\n\tddComponent,\n\tborderColor,\n}: ItemAvatarProps): JSX.Element {\n\t;['bg-2', 'bg-3', 'bg-4', 'bg-5']\n\tconst rarityClass = isNoBg ? '' : rarity ? 'bg-' + rarity : 'bg-dark'\n\n\tconst elRef = useRef<HTMLAnchorElement>(null)\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst closeDd = useCallback(() => isExpanded && setIsExpanded(false), [setIsExpanded, isExpanded])\n\tconst openDd = useCallback(() => !isExpanded && setIsExpanded(true), [setIsExpanded, isExpanded])\n\tconst pointerClass = ddComponent || onClick ? 'c-pointer' : ''\n\tconst onClickLocal = useCallback(() => {\n\t\topenDd && openDd()\n\t\tonClick && onClick()\n\t}, [openDd, onClick])\n\tconst borderStyle = borderColor ? { border: `1px solid ${borderColor}` } : {}\n\treturn (\n\t\t<DdContext.Provider value={{ onClickAway: closeDd }}>\n\t\t\t<A\n\t\t\t\thref={href}\n\t\t\t\tclassName={`item-avatar position-relative rounded-circle d-inline-block ${pointerClass} ${rarityClass} ${classes}`}\n\t\t\t\tinnerRef={elRef}\n\t\t\t\tonClick={onClickLocal}\n\t\t\t\tstyle={{ ...borderStyle }}\n\t\t\t>\n\t\t\t\t<img className=\"image\" src={src} />\n\t\t\t\t{badgeTopStart && (\n\t\t\t\t\t<span className=\"position-absolute top-0 start-0 translate-middle badge rounded-pill small\">\n\t\t\t\t\t\t{badgeTopStart}\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\t\t\t\t{badgeTopEnd && (\n\t\t\t\t\t<span className=\"position-absolute top-0 start-100 translate-middle badge rounded-pill opacity-75 small\">\n\t\t\t\t\t\t{badgeTopEnd}\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\t\t\t\t{/* <span className=\"position-absolute top-0 start-0 translate-middle badge rounded-pill bg-primary border border-light\">\n\t\t\t\t4\n\t\t\t</span> */}\n\t\t\t\t{isExpanded && elRef.current && ddComponent && (\n\t\t\t\t\t<CardDescMobileWrap onClickAway={closeDd} targetEl={elRef.current}>\n\t\t\t\t\t\t{ddComponent}\n\t\t\t\t\t</CardDescMobileWrap>\n\t\t\t\t)}\n\t\t\t</A>\n\t\t</DdContext.Provider>\n\t)\n}\nconst codeToBadge = (code: string) => {\n\tconst e = elements.find(e => code === `traveler-${e.code}`)\n\treturn e ? <img className=\"badge-element-icon d-block ms-n1 mb-n1\" src={e.imgSrc} /> : null\n}\nexport function CharacterAvatar(props: CharacterAvatarProps) {\n\tconst classesLocal = props.rarity\n\t\t? `${props.classes} border ${getRarityBorder(props.rarity)}`\n\t\t: props.classes\n\treturn (\n\t\t<ItemAvatar\n\t\t\t{...props}\n\t\t\trarity={undefined} //     ,   \n\t\t\tclasses={classesLocal}\n\t\t\tsrc={getCharacterAvatarSrc(props.code)}\n\t\t\tbadgeTopEnd={codeToBadge(props.code)}\n\t\t/>\n\t)\n}\nfunction ItemLabel({\n\trarity,\n\tclasses = '',\n\tchildren,\n}: {\n\trarity?: GI_RarityCode | null\n\tclasses?: string\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst rarityClass =\n\t\trarity === 5 //\n\t\t\t? 'text-rarity-5'\n\t\t\t: rarity === 4\n\t\t\t? 'text-rarity-4'\n\t\t\t: 'text-rarity-3'\n\t//todo c-pointer text-decoration-underline-dotted  \n\treturn <label class={`${classes} ${rarityClass}`}>{children}</label>\n}\n\nfunction ItemDd({\n\tclasses = '',\n\tchildren,\n\tddComponent,\n}: {\n\tclasses?: string\n\tddComponent?: JSX.Element | null\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst elRef = useRef<HTMLButtonElement>(null)\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\n\tconst closeDd = useCallback(() => setIsExpanded(false), [])\n\tconst openDd = useCallback(() => setIsExpanded(true), [])\n\n\tconst pointerClass = ddComponent ? 'c-pointer' : ''\n\treturn (\n\t\t<DdContext.Provider value={{ onClickAway: closeDd }}>\n\t\t\t<button\n\t\t\t\tclassName={`btn-reset user-select-text ${pointerClass} ${classes}`}\n\t\t\t\tref={elRef}\n\t\t\t\tonClick={openDd}\n\t\t\t\tdisabled={!ddComponent}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t\t{isExpanded && elRef.current && ddComponent && (\n\t\t\t\t\t<CardDescMobileWrap onClickAway={closeDd} targetEl={elRef.current}>\n\t\t\t\t\t\t{ddComponent}\n\t\t\t\t\t</CardDescMobileWrap>\n\t\t\t\t)}\n\t\t\t</button>\n\t\t</DdContext.Provider>\n\t)\n}\n\nexport const ItemsDataContext = createContext({\n\tweapons: new Map<string, WeaponRegularInfo>(),\n\tartifacts: new Map<string, ArtifactRegularInfo>(),\n\tdomains: new Map<string, DomainShortInfo>(),\n\tenemies: new Map<string, EnemyShortInfo>(),\n\titems: new Map<string, ItemShortInfo>(),\n})\n\nexport function ItemLabelWithDd({\n\tclasses = '',\n\ttype,\n\tcode,\n\tchildren,\n}: {\n\tclasses?: string\n\ttype: 'weapon' | 'artifact'\n\tcode: string\n\tchildren: JSX.Nodes\n}): JSX.Element {\n\tconst maps = useContext(ItemsDataContext)\n\n\tlet ddComp: JSX.Element | undefined = undefined\n\tlet rarity: GI_RarityCode | undefined = undefined\n\tif (type === 'weapon') {\n\t\tconst weapon = maps.weapons.get(code)\n\t\tif (weapon) {\n\t\t\tddComp = <WeaponCard weapon={weapon} related={maps} />\n\t\t\trarity = weapon.rarity\n\t\t}\n\t} else if (type === 'artifact') {\n\t\tconst artifacts = getAllArtifacts(code, maps.artifacts)\n\t\tif (artifacts.length > 0) {\n\t\t\tconst coverArtifact = getCoverArtifactForSet(code, artifacts)\n\t\t\tddComp = <ArtifactCard title={coverArtifact.name} artifacts={artifacts} related={maps} />\n\t\t\trarity = artifacts[0].rarity\n\t\t}\n\t} else mustBeNever(type)\n\n\tconst interactiveLabelClass = ddComp ? 'text-decoration-underline-dotted' : ''\n\treturn (\n\t\t<ItemDd ddComponent={ddComp} classes={`d-inline ${classes}`}>\n\t\t\t<ItemLabel classes={`${interactiveLabelClass} c-inherit`} rarity={rarity}>\n\t\t\t\t{children}\n\t\t\t</ItemLabel>\n\t\t</ItemDd>\n\t)\n}\n\nexport const DdContext = createContext({\n\tonClickAway: () => {\n\t\treturn\n\t},\n})\n\nexport function LabeledItemAvatar({\n\timgSrc,\n\trarity,\n\tclasses = '',\n\tavatarClasses = '',\n\ttitle,\n\tavatarTopStartBadge,\n\tavatarTopEndBadge,\n\tddComponent,\n\tisNoBg = false,\n}: {\n\tisNoBg?: boolean\n\timgSrc: string\n\trarity?: GI_RarityCode\n\ttitle: string\n\tclasses?: string\n\tavatarClasses?: string\n\tavatarTopStartBadge?: string\n\tavatarTopEndBadge?: string\n\tddComponent?: JSX.Element\n}): JSX.Element {\n\tconst interactiveLabelClass = ddComponent ? 'text-decoration-underline-dotted' : ''\n\treturn (\n\t\t<ItemDd ddComponent={ddComponent} classes={`w-100 text-nowrap ${classes}`}>\n\t\t\t<ItemAvatar\n\t\t\t\tclasses={`small-avatar align-middle ${avatarClasses}`}\n\t\t\t\tsrc={imgSrc}\n\t\t\t\tbadgeTopStart={avatarTopStartBadge}\n\t\t\t\tbadgeTopEnd={avatarTopEndBadge}\n\t\t\t\tisNoBg={isNoBg}\n\t\t\t/>\n\t\t\t<ItemLabel\n\t\t\t\tclasses={'text-wrap align-middle lh-1 ps-1 mw-75 c-inherit ' + interactiveLabelClass}\n\t\t\t\trarity={rarity}\n\t\t\t>\n\t\t\t\t{title}\n\t\t\t</ItemLabel>\n\t\t</ItemDd>\n\t)\n}\n","import {\n\tI18N_CHATS,\n\tI18N_DONATE_US,\n\tI18N_OUR_DISCORD,\n\tI18N_SUPPORT_VIA_DON_ALERTS,\n\tI18N_SUPPORT_VIA_DONATELLO,\n\tI18N_SUPPORT_VIA_KO_FI,\n\tI18N_TIKTOK_RU,\n\tI18N_TIKTOK_UA,\n\tI18N_VIDEOS,\n\tI18N_YOUTUBE_RU,\n\tI18N_YOUTUBE_UA,\n} from '#src/i18n/i18n'\nimport {\n\tLINK_DISCORD_INVITE,\n\tLINK_DONATELLO,\n\tLINK_DONATION_ALERTS,\n\tLINK_KO_FI,\n\tLINK_TIKTOK_RU,\n\tLINK_TIKTOK_UA,\n\tLINK_YOUTUBE_RU,\n\tLINK_YOUTUBE_UA,\n} from './links'\n\ntype SocialNetworkGroupCode = 'chats' | 'videos' | 'donations'\nexport const ourPagesInSocialNetworks: {\n\ttitle: string\n\tcode: SocialNetworkGroupCode\n\tlinks: { href: string; title: string; favicon: string }[]\n}[] = [\n\t{\n\t\ttitle: I18N_CHATS,\n\t\tcode: 'chats',\n\t\tlinks: [\n\t\t\t{\n\t\t\t\thref: LINK_DISCORD_INVITE,\n\t\t\t\ttitle: I18N_OUR_DISCORD,\n\t\t\t\tfavicon: 'https://i.imgur.com/Yr1itn9.png',\n\t\t\t},\n\t\t\t// {\n\t\t\t// \thref: LINK_TELEGRAM_RU,\n\t\t\t// \ttitle: I18N_OUR_TELEGRAM_RU,\n\t\t\t// \tfavicon: 'https://telegram.org/img/favicon.ico',\n\t\t\t// },\n\t\t\t// {\n\t\t\t// \thref: LINK_TELEGRAM_UA,\n\t\t\t// \ttitle: I18N_OUR_TELEGRAM_UA,\n\t\t\t// \tfavicon: 'https://telegram.org/img/favicon.ico',\n\t\t\t// },\n\t\t],\n\t},\n\t{\n\t\ttitle: I18N_VIDEOS,\n\t\tcode: 'videos',\n\t\tlinks: [\n\t\t\t{ href: LINK_YOUTUBE_UA, title: I18N_YOUTUBE_UA, favicon: 'https://i.imgur.com/jruSfn5.png' },\n\t\t\t{ href: LINK_YOUTUBE_RU, title: I18N_YOUTUBE_RU, favicon: 'https://i.imgur.com/jruSfn5.png' },\n\t\t\t{ href: LINK_TIKTOK_UA, title: I18N_TIKTOK_UA, favicon: 'https://i.imgur.com/eq8XizF.png' },\n\t\t\t{ href: LINK_TIKTOK_RU, title: I18N_TIKTOK_RU, favicon: 'https://i.imgur.com/eq8XizF.png' },\n\t\t],\n\t},\n\t{\n\t\ttitle: I18N_DONATE_US,\n\t\tcode: 'donations',\n\t\tlinks: [\n\t\t\t{\n\t\t\t\thref: LINK_DONATELLO,\n\t\t\t\ttitle: I18N_SUPPORT_VIA_DONATELLO,\n\t\t\t\tfavicon: 'https://donatello.to/favicon.ico',\n\t\t\t},\n\t\t\t{\n\t\t\t\thref: LINK_DONATION_ALERTS,\n\t\t\t\ttitle: I18N_SUPPORT_VIA_DON_ALERTS,\n\t\t\t\tfavicon: 'https://www.donationalerts.com/favicon-96x96.png',\n\t\t\t},\n\t\t\t{\n\t\t\t\thref: LINK_KO_FI,\n\t\t\t\ttitle: I18N_SUPPORT_VIA_KO_FI,\n\t\t\t\tfavicon: 'https://ko-fi.com/favicon.ico',\n\t\t\t},\n\t\t],\n\t},\n]\n","export function GlobeIcon({ classes = '' }) {\n\treturn (\n\t\t<svg\n\t\t\tclass={classes}\n\t\t\twidth=\"24\"\n\t\t\theight=\"24\"\n\t\t\tviewBox=\"0 0 24 24\"\n\t\t\tfill=\"none\"\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t>\n\t\t\t<path\n\t\t\t\tfill-rule=\"evenodd\"\n\t\t\t\tclip-rule=\"evenodd\"\n\t\t\t\td=\"M12 21a9 9 0 1 0 0-18 9 9 0 0 0 0 18Zm2.8-2.6a7 7 0 0 0 4.2-5.9c-.8.5-1.9.8-3 1.1-.2 1.9-.6 3.5-1.2 4.8ZM9.2 5.6a7 7 0 0 0-4 4.6l1.2.8 1.6.5c0-2.3.5-4.4 1.2-6Zm.9 8.3c.2 1.5.5 2.7.9 3.7l.8 1.2.2.2.2-.2.8-1.2c.4-1 .7-2.2.9-3.7a20 20 0 0 1-3.8 0Zm-2-.3c.1 1.9.5 3.5 1 4.8a7 7 0 0 1-4-5.9c.7.5 1.8.8 3 1.1Zm5.9-1.7a17.8 17.8 0 0 1-4 0c0-2.2.4-4.2 1-5.5l.8-1.2.2-.2.2.2.8 1.2c.6 1.3 1 3.3 1 5.5Zm2-.4c0-2.3-.5-4.4-1.2-6a7 7 0 0 1 4 4.7l-1.2.8-1.6.5Z\"\n\t\t\t\tfill=\"currentColor\"\n\t\t\t/>\n\t\t</svg>\n\t)\n}\n","import { useCallback, useRef, useState } from 'preact/hooks'\n\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport {\n\tI18N_ABOUT_SITE,\n\tI18N_ARTIFACTS,\n\tI18N_BUILDS,\n\tI18N_EQUIPMENT,\n\tI18N_LANG_NAME,\n\tI18N_LANG_NAMES,\n\tI18N_OUR_SOCIAL_NETWORKS,\n\tI18N_PAGE_WITH_ALL_LINKS,\n\tI18N_SUPPORT_US,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { paths } from '#src/routes/paths'\nimport { A, isOnRoute, makeLocationHrefForLang } from '#src/routes/router'\nimport { useClickAway } from '#src/utils/hooks'\nimport { ourPagesInSocialNetworks } from '#src/utils/our-pages-in-social-networks'\nimport { VARIATION_SELECTOR } from '#src/utils/typography'\nimport { GlobeIcon } from './globe-icon'\n\ntype Props = { isNavExpanded: boolean }\nconst isPageActive = routs => routs.some(r => isOnRoute(r))\nexport function Nav({ isNavExpanded }: Props): JSX.Element {\n\treturn (\n\t\t<div className={`collapse navbar-collapse ${isNavExpanded ? 'show' : ''}`}>\n\t\t\t<ul className=\"navbar-nav me-auto mb-2 mb-md-0\">\n\t\t\t\t<li className=\"nav-item\">\n\t\t\t\t\t<A\n\t\t\t\t\t\tclassName={`nav-link ${\n\t\t\t\t\t\t\tisPageActive([paths.builds, paths.buildCharacters]) ? ' active' : ''\n\t\t\t\t\t\t}`}\n\t\t\t\t\t\thref={paths.builds[0]}\n\t\t\t\t\t>\n\t\t\t\t\t\t{I18N_BUILDS}\n\t\t\t\t\t</A>\n\t\t\t\t</li>\n\t\t\t\t<EquipmentDd />\n\t\t\t</ul>\n\t\t\t<ul className=\"navbar-nav mb-2 mb-md-0 float-md-end\">\n\t\t\t\t<LinksDd />\n\t\t\t\t<li className=\"nav-item\">\n\t\t\t\t\t<A\n\t\t\t\t\t\tclassName={`nav-link ${isPageActive([paths.about]) ? ' active' : ''}`}\n\t\t\t\t\t\thref={paths.about[0]}\n\t\t\t\t\t>\n\t\t\t\t\t\t{I18N_ABOUT_SITE}\n\t\t\t\t\t</A>\n\t\t\t\t</li>\n\t\t\t\t<DonationDd />\n\t\t\t\t<LangSelect />\n\t\t\t</ul>\n\t\t</div>\n\t)\n}\nconst linkDataToDdLink = ({ href, title, favicon }) => {\n\treturn {\n\t\ttitle,\n\t\thref,\n\t\tfavicon,\n\t\tisExternal: true,\n\t}\n}\ntype DdLink = {\n\ttitle: string | JSX.Element\n\thref: string\n\tisExternal?: boolean\n\tisActive?: boolean\n\tcode?: string\n\tfavicon?: string\n}\nconst LINKS_DD_LINKS: DdLink[] = ourPagesInSocialNetworks\n\t.filter(g => g.code !== 'donations')\n\t.map(g => g.links)\n\t.flat()\n\t.map(linkDataToDdLink)\n\t.concat([\n\t\t{\n\t\t\ttitle: I18N_PAGE_WITH_ALL_LINKS,\n\t\t\thref: '/everywhere',\n\t\t\tisExternal: false,\n\t\t\tfavicon: '',\n\t\t},\n\t])\nfunction LinksDd(): JSX.Element {\n\treturn <HeadDd title={I18N_OUR_SOCIAL_NETWORKS} ddLinks={LINKS_DD_LINKS} />\n}\nconst SUPPORT_DD_LINKS: DdLink[] = ourPagesInSocialNetworks\n\t.filter(g => g.code === 'donations')\n\t.map(g => g.links)\n\t.flat()\n\t.map(linkDataToDdLink)\n\nfunction DonationDd(): JSX.Element {\n\treturn <HeadDd title={I18N_SUPPORT_US} ddLinks={SUPPORT_DD_LINKS} />\n}\nconst EQUIPMENT_DD_LINKS: DdLink[] = [\n\t{\n\t\ttitle: I18N_WEAPONS,\n\t\thref: '/weapons',\n\t\tcode: 'weapons',\n\t},\n\t{\n\t\ttitle: I18N_ARTIFACTS,\n\t\thref: '/artifacts',\n\t\tcode: 'artifacts',\n\t},\n]\nfunction EquipmentDd(): JSX.Element {\n\tconst ddLinksLocal = EQUIPMENT_DD_LINKS.map(l => {\n\t\treturn {\n\t\t\t...l,\n\t\t\tisActive: isPageActive([paths[l.code]]),\n\t\t}\n\t})\n\treturn <HeadDd title={I18N_EQUIPMENT} ddLinks={ddLinksLocal} />\n}\n\nfunction HeadDd({ title, ddLinks }: { title: string | JSX.Element; ddLinks: DdLink[] }): JSX.Element {\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst ddRef = useRef(null)\n\tconst targetRef = useRef(null)\n\tconst closeDd = useCallback(() => isExpanded && setIsExpanded(false), [setIsExpanded, isExpanded])\n\tconst toggleDd = useCallback(() => setIsExpanded(!isExpanded), [setIsExpanded, isExpanded])\n\n\tuseClickAway([ddRef, targetRef], closeDd)\n\tconst isActive = ddLinks.some(l => l.isActive)\n\treturn (\n\t\t<li className=\"nav-item dropdown\">\n\t\t\t<a\n\t\t\t\tref={targetRef}\n\t\t\t\tclassName={`nav-link dropdown-toggle ${isActive ? 'active' : ''} ${isExpanded ? 'show' : ''}`}\n\t\t\t\tid=\"navbarDropdown\"\n\t\t\t\trole=\"button\"\n\t\t\t\tonClick={toggleDd}\n\t\t\t>\n\t\t\t\t{title}\n\t\t\t</a>\n\t\t\t<ul className={`dropdown-menu ${isExpanded ? 'show' : ''}`} style={'right: 0'} ref={ddRef}>\n\t\t\t\t{isExpanded\n\t\t\t\t\t? ddLinks.map(l => (\n\t\t\t\t\t\t\t<li key={l.href} onClick={closeDd}>\n\t\t\t\t\t\t\t\t<A\n\t\t\t\t\t\t\t\t\tclassName={`dropdown-item ${l.isActive ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\thref={l.href}\n\t\t\t\t\t\t\t\t\tisExternal={l.isExternal}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{l.favicon && (\n\t\t\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\t\t\tsrc={l.favicon}\n\t\t\t\t\t\t\t\t\t\t\tclasses=\"emoji-avatar me-1 align-middle\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{l.title}\n\t\t\t\t\t\t\t\t</A>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t  ))\n\t\t\t\t\t: null}\n\t\t\t</ul>\n\t\t</li>\n\t)\n}\n// const LANG_DD_LINKS: DdLink[] = BUNDLE_ENV.LANGS.map(lang => {\n// \treturn {\n// \t\ttitle: I18N_LANG_NAMES[lang],\n// \t\thref: makeLocationHrefForLang(lang),\n// \t\tisActive: I18N_LANG_NAMES[lang] === I18N_LANG_NAME,\n// \t}\n// })\nfunction LangSelect(): JSX.Element {\n\tconst [isExpanded, setIsExpanded] = useState(false)\n\tconst ddRef = useRef(null)\n\tconst targetRef = useRef(null)\n\tconst closeDd = useCallback(() => isExpanded && setIsExpanded(false), [setIsExpanded, isExpanded])\n\tconst toggleDd = useCallback(() => setIsExpanded(!isExpanded), [setIsExpanded, isExpanded])\n\n\tuseClickAway([ddRef, targetRef], closeDd)\n\n\treturn (\n\t\t<li className=\"nav-item dropdown\">\n\t\t\t<a\n\t\t\t\tref={targetRef}\n\t\t\t\tclassName={`nav-link dropdown-toggle ${isExpanded ? 'show' : ''}`}\n\t\t\t\tid=\"navbarDropdown\"\n\t\t\t\trole=\"button\"\n\t\t\t\tonClick={toggleDd}\n\t\t\t>\n\t\t\t\t<GlobeIcon />\n\t\t\t\t{VARIATION_SELECTOR} {I18N_LANG_NAME}\n\t\t\t</a>\n\t\t\t{/* todo -    dropdown-menu-end */}\n\t\t\t<ul className={`dropdown-menu ${isExpanded ? 'show' : ''}`} style={'right: 0'} ref={ddRef}>\n\t\t\t\t{/*     ,   ,\n\t\t\t\t\t\t      (    useMemo).\n\t\t\t\t\t\t        . */}\n\t\t\t\t{isExpanded &&\n\t\t\t\t\tBUNDLE_ENV.LANGS.map(lang => {\n\t\t\t\t\t\tconst langName = I18N_LANG_NAMES[lang]\n\t\t\t\t\t\tconst isActiveLang = langName === I18N_LANG_NAME\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li key={lang}>\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tclassName={`dropdown-item ${isActiveLang ? 'active' : ''}`}\n\t\t\t\t\t\t\t\t\thref={makeLocationHrefForLang(lang)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{I18N_LANG_NAMES[lang]}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t</ul>\n\t\t</li>\n\t)\n}\n","import { isPromise } from '#lib/utils/values'\nimport { GENERATED_DATA_HASH } from './generated'\nimport { apiGetJSONFile, decodeRelatedLocations, mapAllByCode, MapAllByCode } from './utils'\n\nimport type {\n\tAbyssStatsInfo,\n\tArtifactFullInfoWithRelated,\n\tArtifactRegularInfo,\n\tCharacterFullInfoWithRelated,\n\tExtractedLocationsInfo,\n\tMaterialsTimetableWithRelated,\n\tSearchItem,\n\tWeaponFullInfoWithRelated,\n\tWeaponRegularInfo,\n} from '#lib/parsing/combine'\n\nconst get = <T>(prefix: string, signal: AbortSignal) =>\n\tapiGetJSONFile<T>(`generated/${prefix}.json?v=${GENERATED_DATA_HASH}`, signal)\n\nconst getLang = <T>(prefix: string, signal: AbortSignal) => get<T>(prefix + '-' + BUNDLE_ENV.LANG, signal)\n\ntype PromiseOrSync<T> = Promise<T> | T\n\nconst _map = <T, R>(val: PromiseOrSync<T>, func: (v: T) => R): PromiseOrSync<R> =>\n\tisPromise(val) ? val.then(func) : func(val)\n\nexport function apiGetCharacter(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<CharacterFullInfoWithRelated>> {\n\treturn _map(getLang<CharacterFullInfoWithRelated>(`characters/${code}`, signal), mapAllByCode)\n}\n\nexport function apiGetCharacterRelatedLocs(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<ExtractedLocationsInfo> {\n\treturn getLang(`characters/${code}-locs`, signal)\n}\n\nexport function apiGetArtifacts(signal: AbortSignal): PromiseOrSync<ArtifactRegularInfo[]> {\n\treturn getLang<ArtifactRegularInfo[]>(`artifacts`, signal)\n}\n\nexport function apiGetArtifact(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<ArtifactFullInfoWithRelated>> {\n\treturn _map(getLang<ArtifactFullInfoWithRelated>(`artifacts/${code}`, signal), arts =>\n\t\tmapAllByCode(decodeRelatedLocations(arts)),\n\t)\n}\n\nexport function apiGetWeapons(signal: AbortSignal): PromiseOrSync<WeaponRegularInfo[]> {\n\treturn getLang<WeaponRegularInfo[]>(`weapons`, signal)\n}\nexport function apiGetWeapon(\n\tcode: string,\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<WeaponFullInfoWithRelated>> {\n\treturn _map(getLang<WeaponFullInfoWithRelated>(`weapons/${code}`, signal), arts =>\n\t\tmapAllByCode(decodeRelatedLocations(arts)),\n\t)\n}\n\nexport function apiMaterialsTimetable(\n\tsignal: AbortSignal,\n): PromiseOrSync<MapAllByCode<MaterialsTimetableWithRelated>> {\n\treturn _map(getLang<MaterialsTimetableWithRelated>(`timetables/materials`, signal), mapAllByCode)\n}\n\nexport function apiGetSearchData(signal: AbortSignal) {\n\treturn getLang<SearchItem[]>(`search`, signal)\n}\n\nexport function apiGetAbyssStats(signal: AbortSignal) {\n\treturn get<AbyssStatsInfo>(`abyss_stats`, signal)\n}\n","export const WEAPON_ROW_CARD_HASH_KEY = 'w'\nexport const ARTIFACT_ROW_CARD_HASH_KEY = 'a'\nconst keyMap = {\n\tweapon: WEAPON_ROW_CARD_HASH_KEY,\n\tartifact: ARTIFACT_ROW_CARD_HASH_KEY,\n}\nexport const genEquipmentHash = (type: 'weapon' | 'artifact', code: string): string => {\n\treturn `#${keyMap[type]}=${code}`\n}\n","import { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'preact/hooks'\n\nimport { SearchItem, SearchItemType } from '#lib/parsing/combine'\nimport { apiGetSearchData } from '#src/api/endpoints'\nimport { BlockHeader } from '#src/components/block-header'\nimport { CentredLabel, CentredSpinner } from '#src/components/placeholders'\nimport {\n\tI18N_ARROWS_TO_SELECT,\n\tI18N_ARTIFACTS,\n\tI18N_CHARACTERS,\n\tI18N_ITEM_DETAIL,\n\tI18N_MEGA_SEARCH_PLACEHOLDER,\n\tI18N_NOTHING_TO_SHOW,\n\tI18N_RECOMMENDED_BUILDS,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { genEquipmentHash } from '#src/modules/equipment/common'\nimport { A, dispatchRouteTo } from '#src/routes/router'\nimport { getArtifactIconSrc } from '#src/utils/artifacts'\nimport { calcPosForDd } from '#src/utils/calc-pos-for-dd'\nimport { getCharacterAvatarSrc } from '#src/utils/characters'\nimport { GET_MODALS_EL } from '#src/utils/dom'\nimport {\n\tisLoaded,\n\tuseClickAway,\n\tuseFetch,\n\tuseForceUpdate,\n\tuseScrollTo,\n\tuseWindowSize,\n} from '#src/utils/hooks'\nimport { createPortal } from '#src/utils/preact-compat'\nimport { getWeaponIconSrc } from '#src/utils/weapons'\nimport { ItemAvatar } from './item-cards/item-avatars'\n\nimport './mega-search.scss'\n\ntype MegaSearch_SearchItem = SearchItem & {\n\tnameLC: string\n\tnameEnLC?: string\n}\ntype SearchResults = Record<SearchItemType, MegaSearch_SearchItem[]>\n\nfunction getIconForItem({ code, type }: { code: string; type: SearchItemType }): string {\n\treturn {\n\t\tcharacter: getCharacterAvatarSrc,\n\t\tweapon: getWeaponIconSrc,\n\t\tartifact: getArtifactIconSrc,\n\t}[type](code)\n}\nfunction searchInItem(item: MegaSearch_SearchItem, searchStr: string): boolean {\n\treturn item.nameLC.includes(searchStr) || (item.nameEnLC ? item.nameEnLC.includes(searchStr) : false)\n}\nfunction strIndexOrInf(str: string | undefined, searchStr: string) {\n\tif (!str) return Infinity\n\tconst index = str.indexOf(searchStr)\n\treturn index === -1 ? Infinity : index\n}\nfunction sortInItem(item: MegaSearch_SearchItem, searchStr: string): number {\n\treturn Math.min(strIndexOrInf(item.nameLC, searchStr), strIndexOrInf(item.nameEnLC, searchStr))\n}\nconst itemTypes: SearchItemType[] = ['character', 'weapon', 'artifact']\n\nexport function MegaSearch({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [searchStr, setSearchStr] = useState<string>('')\n\tconst searchData = useFetch(apiGetSearchData, [])\n\n\tconst searchDataGrouped = useMemo(() => {\n\t\tconst searchDataLocal: SearchResults = { weapon: [], character: [], artifact: [] }\n\t\tif (isLoaded(searchData)) {\n\t\t\tsearchData.forEach(si => {\n\t\t\t\tsearchDataLocal[si.type].push({\n\t\t\t\t\t...si,\n\t\t\t\t\tnameLC: si.name.toLocaleLowerCase(),\n\t\t\t\t\tnameEnLC: si.nameEn?.toLocaleLowerCase(),\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\t\treturn searchDataLocal\n\t}, [searchData])\n\n\tconst ddRef = useRef<HTMLDivElement>(null)\n\tconst targetRef = useRef<HTMLInputElement>(null)\n\n\tconst clearSearch = useCallback(\n\t\t(shouldBlur?: boolean) => {\n\t\t\tif (shouldBlur && targetRef.current) targetRef.current.blur()\n\t\t\tsetSearchStr('')\n\t\t},\n\t\t[targetRef],\n\t)\n\n\tuseClickAway([targetRef, ddRef], clearSearch)\n\n\tconst onResize = useCallback(() => {\n\t\tif (!ddRef.current) return\n\t\tif (!targetRef.current) return\n\t\tconst ddEl = ddRef.current\n\t\tconst targetEl = targetRef.current\n\t\tconst pos = calcPosForDd(targetEl.getBoundingClientRect(), ddEl.getBoundingClientRect(), {\n\t\t\tisAbsolute: true,\n\t\t\tisCentered: true,\n\t\t})\n\t\tddEl.style.left = `${Math.max(0, pos.left)}px`\n\t\tddEl.style.top = `${Math.max(0, pos.top)}px`\n\t}, [ddRef, targetRef])\n\n\tconst searchResults = useMemo<SearchResults | null>(() => {\n\t\tif (!isLoaded(searchData) || !searchStr) return null\n\t\tconst searchResultsLocal: SearchResults = { character: [], weapon: [], artifact: [] }\n\t\titemTypes.forEach(t => {\n\t\t\tsearchResultsLocal[t] = searchDataGrouped[t]\n\t\t\t\t.filter(it => searchInItem(it, searchStr))\n\t\t\t\t.sort((a, b) => sortInItem(a, searchStr) - sortInItem(b, searchStr))\n\t\t})\n\t\treturn searchResultsLocal\n\t}, [searchStr, searchDataGrouped, searchData])\n\n\tuseEffect(() => {\n\t\tconst clearSearchAndBlurLocal = () => clearSearch(true)\n\n\t\tfunction onKeyPress(e: KeyboardEvent) {\n\t\t\tif (e.key === 'Escape') clearSearch(true)\n\t\t}\n\t\taddEventListener('popstate', clearSearchAndBlurLocal)\n\t\taddEventListener('keydown', onKeyPress)\n\t\treturn () => {\n\t\t\tremoveEventListener('popstate', clearSearchAndBlurLocal)\n\t\t\tremoveEventListener('keydown', onKeyPress)\n\t\t}\n\t}, [clearSearch])\n\n\tuseEffect(() => onResize(), [searchResults, onResize])\n\tconst onSearchValueChange = useCallback((e: JSX.TargetedEvent<HTMLInputElement, Event>) => {\n\t\tsetSearchStr(e.currentTarget.value.toLocaleLowerCase())\n\t}, [])\n\tuseLayoutEffect(onResize)\n\tuseWindowSize()\n\n\treturn (\n\t\t<div className={`mega-search position-relative d-inline-block w-100 ${classes}`}>\n\t\t\t<input\n\t\t\t\tclassName=\"rounded border bg-dark text-light border-secondary w-100 text-center\"\n\t\t\t\ttype=\"search\"\n\t\t\t\tvalue={searchStr}\n\t\t\t\tonInput={onSearchValueChange}\n\t\t\t\tdisabled={!isLoaded(searchData)}\n\t\t\t\tref={targetRef}\n\t\t\t\tplaceholder={I18N_MEGA_SEARCH_PLACEHOLDER}\n\t\t\t/>\n\t\t\t{!isLoaded(searchData) ? <CentredSpinner /> : null}\n\t\t\t{searchStr &&\n\t\t\t\tsearchResults &&\n\t\t\t\tcreatePortal(\n\t\t\t\t\t<div className=\"card search-results-dd position-absolute mx-2 my-1\" ref={ddRef}>\n\t\t\t\t\t\t<div className=\"card-body p-2 pb-4 position-relative\">\n\t\t\t\t\t\t\t{searchResults && (\n\t\t\t\t\t\t\t\t<SearchResultsWrap\n\t\t\t\t\t\t\t\t\tsearchResults={searchResults}\n\t\t\t\t\t\t\t\t\tsearchStr={searchStr}\n\t\t\t\t\t\t\t\t\tclearSearch={clearSearch}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={`position-absolute w-100\\\n\t\t\t\t \t\t\t\t\t\t\t\t\t\tpx-2 py-2 lh-1 text-center\\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbottom-0 start-0 small text-muted \\\n\t\t\t\t\t\t\t\t\t\t\t\t\t\topacity-75 pe-none`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"d-none d-md-block\">{I18N_ARROWS_TO_SELECT}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>,\n\t\t\t\t\tGET_MODALS_EL(),\n\t\t\t\t)}\n\t\t</div>\n\t)\n}\n\nconst searckTypeTitleMap: Record<SearchItemType, string> = {\n\tcharacter: I18N_CHARACTERS,\n\tartifact: I18N_ARTIFACTS,\n\tweapon: I18N_WEAPONS,\n}\n/**\n *           \n */\nfunction switchSearchType(\n\tsearchResults: SearchResults,\n\tselected: { type: SearchItemType; index: number },\n\toffset: -1 | 0 | 1,\n\tdirection: -1 | 1,\n) {\n\tconst fromIndex = itemTypes.indexOf(selected.type)\n\tconst itemsLen = itemTypes.length\n\tfor (let i = 0; i < itemsLen; i++) {\n\t\tconst index = (i * direction + fromIndex + offset + itemsLen * 2) % itemsLen\n\t\tconst type = itemTypes[index]\n\t\tif (searchResults[type].length > 0) {\n\t\t\tselected.type = type\n\t\t\tselected.index = Math.min(searchResults[type].length - 1, selected.index)\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nfunction SearchResultsWrap({\n\tsearchResults,\n\tsearchStr,\n\tclearSearch,\n}: {\n\tsearchResults: SearchResults\n\tsearchStr: string\n\tclearSearch: (shouldBlur?: boolean) => unknown\n}): JSX.Element {\n\tconst forceUpdate = useForceUpdate()\n\tconst selected = useRef({ type: 'character' as SearchItemType, index: -1 }).current\n\n\tuseMemo(() => {\n\t\t//        \n\t\t//      \n\t\tselected.index = -1\n\t\tswitchSearchType(searchResults, selected, 0, 1)\n\t}, [searchResults, selected])\n\n\tuseEffect(() => {\n\t\tfunction onKeyPress(e: KeyboardEvent) {\n\t\t\tif (e.ctrlKey || e.altKey || e.shiftKey || e.metaKey) return\n\t\t\tconst results = searchResults[selected.type]\n\n\t\t\tif (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {\n\t\t\t\tconst len = results.length\n\t\t\t\tif (len > 0) {\n\t\t\t\t\tif (e.key === 'ArrowDown') selected.index = (selected.index + 1) % len\n\t\t\t\t\tif (e.key === 'ArrowUp') selected.index = (selected.index - 1 + len) % len\n\t\t\t\t}\n\t\t\t\tif (e.key === 'ArrowLeft') switchSearchType(searchResults, selected, -1, -1)\n\t\t\t\tif (e.key === 'ArrowRight') switchSearchType(searchResults, selected, 1, 1)\n\t\t\t\tforceUpdate()\n\t\t\t\te.preventDefault()\n\t\t\t}\n\n\t\t\tif (['Enter', ' '].includes(e.key)) {\n\t\t\t\tconst gotSingleResult = itemTypes.every(\n\t\t\t\t\tx => searchResults[x].length === (x === selected.type ? 1 : 0),\n\t\t\t\t)\n\t\t\t\t//      ,      ,\n\t\t\t\t//    ,       (  selected)\n\t\t\t\tconst item = results[gotSingleResult ? 0 : selected.index]\n\t\t\t\tif (item) {\n\t\t\t\t\tconst path = mainItemHrefMap[item.type](item.code)\n\t\t\t\t\tclearSearch(true)\n\t\t\t\t\tdispatchRouteTo(path)\n\t\t\t\t\te.preventDefault()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\taddEventListener('keydown', onKeyPress)\n\t\treturn () => removeEventListener('keydown', onKeyPress)\n\t}, [forceUpdate, clearSearch, searchResults, selected])\n\n\treturn (\n\t\t<div className=\"search-results-wrap d-flex align-items-stretch\">\n\t\t\t{itemTypes.map(type => (\n\t\t\t\t<div className=\"w-33 h-100 px-1 d-flex flex-column\" key={type}>\n\t\t\t\t\t<BlockHeader>{searckTypeTitleMap[type]}</BlockHeader>\n\t\t\t\t\t<div className=\"overflow-auto flex-fill position-relative pe-1\">\n\t\t\t\t\t\t{searchResults[type].length ? (\n\t\t\t\t\t\t\tsearchResults[type].map((item, i) => (\n\t\t\t\t\t\t\t\t<SearchItemCard\n\t\t\t\t\t\t\t\t\tkey={item.code}\n\t\t\t\t\t\t\t\t\titem={item}\n\t\t\t\t\t\t\t\t\tsearchStr={searchStr}\n\t\t\t\t\t\t\t\t\tisSelected={type === selected.type && i === selected.index}\n\t\t\t\t\t\t\t\t\tclearSearch={clearSearch}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<CentredLabel label={I18N_NOTHING_TO_SHOW} />\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\nfunction highlightPartOfText(regexp: RegExp, text: string | undefined) {\n\tif (!text) return undefined\n\tconst parts = text.split(regexp)\n\treturn parts.filter(String).map((part, i) => {\n\t\treturn regexp.test(part) ? (\n\t\t\t<mark className=\"p-0\" key={i}>\n\t\t\t\t{part}\n\t\t\t</mark>\n\t\t) : (\n\t\t\t<span key={i}>{part}</span>\n\t\t)\n\t})\n}\nconst mainItemHrefMap: Record<SearchItemType, (code: string) => string> = {\n\tweapon: c => `/weapons${genEquipmentHash('weapon', c)}`,\n\tartifact: c => `/artifacts${genEquipmentHash('artifact', c)}`,\n\tcharacter: c => `/builds/${c}`,\n}\nconst SearchItemCard = ({\n\titem,\n\tsearchStr,\n\tisSelected,\n\tclearSearch,\n}: {\n\titem: SearchItem\n\tsearchStr: string\n\tisSelected: boolean\n\tclearSearch: (shouldBlur?: boolean) => unknown\n}): JSX.Element => {\n\tconst [wrapRef] = useScrollTo<HTMLDivElement>(isSelected, { block: 'nearest' })\n\tconst clearSearchAndBlurLocal = useCallback(() => clearSearch(true), [clearSearch])\n\tconst regexp = new RegExp(`(${searchStr})`, 'gi')\n\tconst nameWithHighlight = searchStr ? highlightPartOfText(regexp, item.name) : item.name\n\tconst nameEnWithHighlight = searchStr ? highlightPartOfText(regexp, item.nameEn) : item.nameEn\n\tconst mainItemHref = mainItemHrefMap[item.type](item.code)\n\treturn (\n\t\t<div\n\t\t\tclassName={`lh-sm d-flex mt-1 mb-2 py-1 search-item-card rounded ${\n\t\t\t\tisSelected ? 'ps-1 highlighted bg-secondary' : ''\n\t\t\t}`}\n\t\t\tref={wrapRef}\n\t\t>\n\t\t\t<div className=\"me-1 d-none d-md-block \">\n\t\t\t\t<ItemAvatar\n\t\t\t\t\tsrc={getIconForItem(item)}\n\t\t\t\t\thref={mainItemHref}\n\t\t\t\t\tclasses=\"bg-dark-on-dark\"\n\t\t\t\t\tonClick={clearSearchAndBlurLocal}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<h6 className=\"mb-0 text-break\">\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tsrc={getIconForItem(item)}\n\t\t\t\t\t\tclasses=\"emoji-avatar me-1 d-md-none align-middle\"\n\t\t\t\t\t/>\n\t\t\t\t\t<span className=\"align-middle\">{nameWithHighlight}</span>\n\t\t\t\t</h6>\n\t\t\t\t<div className=\"text-muted small text-break\">{nameEnWithHighlight}</div>\n\t\t\t\t<div className=\"small\">\n\t\t\t\t\t{item.type === 'weapon' && (\n\t\t\t\t\t\t<A href={mainItemHref} onClick={clearSearchAndBlurLocal}>\n\t\t\t\t\t\t\t{I18N_ITEM_DETAIL}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t)}\n\t\t\t\t\t{item.type === 'artifact' && (\n\t\t\t\t\t\t<A href={mainItemHref} onClick={clearSearchAndBlurLocal}>\n\t\t\t\t\t\t\t{I18N_ITEM_DETAIL}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t)}\n\t\t\t\t\t{item.type === 'character' && (\n\t\t\t\t\t\t<A href={mainItemHref} onClick={clearSearchAndBlurLocal}>\n\t\t\t\t\t\t\t{I18N_RECOMMENDED_BUILDS}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { useState } from 'preact/hooks'\n\nimport { A } from '#src/routes/router'\nimport { Nav } from '../components/nav'\nimport { MegaSearch } from './mega-search'\n\nexport function Header() {\n\tconst [isNavExpanded, setIsNavExpanded] = useState(false)\n\t// TODO   \n\t// -  ,   \n\treturn (\n\t\t<header style={{ zIndex: 1 }}>\n\t\t\t<div className=\"navbar navbar-expand-lg navbar-dark header-main-bg\">\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<A className=\"navbar-brand\" href=\"/\">\n\t\t\t\t\t\tGenshin Base\n\t\t\t\t\t</A>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"navbar-toggler\"\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\tonClick={() => setIsNavExpanded(!isNavExpanded)}\n\t\t\t\t\t>\n\t\t\t\t\t\t<span className=\"navbar-toggler-icon\"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<Nav isNavExpanded={isNavExpanded} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"navbar py-2 header-sub-bg\">\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<MegaSearch />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</header>\n\t)\n}\n","import { LINK_DISCORD_INVITE } from '#src/utils/links'\r\nimport { LANG } from './i18n'\r\n\r\nexport const I18N_ABOUT_SITE_EPIGRAPH = {\r\n\ten: { quote: 'A site to be hold!', footer: 'The head shrine maiden in charge of', cite: 'Grand Shrine' },\r\n\tru: { quote: ',  !', footer: ' ', cite: ' ' },\r\n}[LANG]\r\nexport const I18N_ABOUT_SITE_CONTENT = {\r\n\ten: () => (\r\n\t\t<>\r\n\t\t\t<p>\r\n\t\t\t\tThe Genshin Base is a site that contains only the necessary information about Genshin Impact.\r\n\t\t\t\tThe site is equally convenient to use both from a computer and from a phone.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tWe welcome any support. If you want to become a part of our team, arrange a collaboration or\r\n\t\t\t\tjust chat, we are waiting for you in our{' '}\r\n\t\t\t\t<a className=\"link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\r\n\t\t\t\t\tDiscord\r\n\t\t\t\t</a>\r\n\t\t\t\t.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tSurfing once again on the Internet in search of actual information about character builds, I\r\n\t\t\t\tfelt indignant. I spent a lot of time collecting information bit by bit from different places.\r\n\t\t\t\tBadly designed pictures with recommendations for leveling characters, the date of which was\r\n\t\t\t\talmost equal to the release date of the game, or complicated Google tables, funny articles\r\n\t\t\t\ttranslated by an electronic translator from copywriters for two pennies who have never seen\r\n\t\t\t\tthe game. Unable to endure it any longer, I called my few comrades together and announced: we\r\n\t\t\t\tare making a site on Genshin. We start today.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tA week passed and we started. First of all, we decided to make a page with builds. Based on\r\n\t\t\t\tone of the few usable tables, I came up with a universal character page design. It turned out\r\n\t\t\t\tthat for such a design, information from the table alone was not enough  we had to take\r\n\t\t\t\tinformation from four more sites.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tThe result is a section that contains the detailed information needed to level up and unlock\r\n\t\t\t\tthe potential of a character. For each character defined the team roles. For each role there\r\n\t\t\t\tare lists of recommended artifacts, weapons, talents, as well as tips for playing this role.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tFor each artifact, weapon, or material needed to upgrade a character or weapon, there are\r\n\t\t\t\tcards with a detailed description and information about where this item is obtained. Also, for\r\n\t\t\t\tartifacts and weapons there are always character recommendations.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tBut this seemed to us not enough. The site, consisting of a single section, looks somehow dry.\r\n\t\t\t\tWe started thinking about what else to add. After analyzing our needs as players, we came to\r\n\t\t\t\tthe conclusion that it would be good to show on the main page information for game planning.\r\n\t\t\t\tFirstly, we add a block with information about what is farmed today and tomorrow in dungeons,\r\n\t\t\t\tso users can plan where to spend the resin, and the time until the end of the day on different\r\n\t\t\t\tservers. Secondly, we designed a block with a summary of the character build. At the same\r\n\t\t\t\ttime, a system of favorites appeared: now any character and any material can be added to\r\n\t\t\t\tfavorites. Selected materials are highlighted on the main page. Information about selected\r\n\t\t\t\tcharacters is also displayed there.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tThe last thing I added was the Alchemy Calculator. A third of our team of three people laugh\r\n\t\t\t\tat him, but I find it extremely useful. It is designed to simplify the calculation of the\r\n\t\t\t\tnecessary resources for leveling up talent books, as well as materials for characters and\r\n\t\t\t\tweapons.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\tWe have many plans for the future. Our goal is to make the most complete and useful site about\r\n\t\t\t\tGenshin. And we need your help. Message to us on{' '}\r\n\t\t\t\t<a className=\"link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\r\n\t\t\t\t\tDiscord\r\n\t\t\t\t</a>{' '}\r\n\t\t\t\tif you want to participate in the development.\r\n\t\t\t</p>\r\n\t\t</>\r\n\t),\r\n\tru: () => (\r\n\t\t<>\r\n\t\t\t<p>\r\n\t\t\t\t   ,         . \r\n\t\t\t\t     ,    .\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t    .       , \r\n\t\t\t\t         {' '}\r\n\t\t\t\t<a className=\"link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\r\n\t\t\t\t\t\r\n\t\t\t\t</a>\r\n\t\t\t\t.\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t          ,  \r\n\t\t\t\t.      ,      \r\n\t\t\t\t .         , \r\n\t\t\t\t        ,     ,\r\n\t\t\t\t ,        , \r\n\t\t\t\t   .      ,    \r\n\t\t\t\t  :     .  .\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t   ,   .         .\r\n\t\t\t\t       ,     \r\n\t\t\t\t. , ,         \r\n\t\t\t\t        .\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t  ,    ,    \r\n\t\t\t\t  .     ,   \r\n\t\t\t\t  .   ,   ,   \r\n\t\t\t\t, , ,           .\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t  ,   ,      ,\r\n\t\t\t\t         ,  \r\n\t\t\t\t .         .\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t    . -   ,   -\r\n\t\t\t\t.   ,    .    \r\n\t\t\t\t,    ,          \r\n\t\t\t\t.     ,       ,   \r\n\t\t\t\t,   ,        .    \r\n\t\t\t\t   .      : \r\n\t\t\t\t          . \r\n\t\t\t\t   .         \r\n\t\t\t\t,        .\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t    .        \r\n\t\t\t\t,      .       \r\n\t\t\t\t  ,        .\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t     .           . \r\n\t\t\t\t   .   {' '}\r\n\t\t\t\t<a className=\"link\" target=\"_blank\" href={LINK_DISCORD_INVITE}>\r\n\t\t\t\t\t\r\n\t\t\t\t</a>\r\n\t\t\t\t,     .\r\n\t\t\t</p>\r\n\t\t</>\r\n\t),\r\n}[LANG]()\r\n","import { useMemo } from 'preact/hooks'\n\nimport { decodeLocations } from '#lib/genshin'\nimport {\n\tCharacterFullInfoWithRelated,\n\tEnemyShortInfo,\n\tExtractedLocationsInfo,\n\tItemShortInfo,\n} from '#lib/parsing/combine'\nimport { promiseNever } from '#lib/utils/values'\nimport { isLoaded, LoadingState, useFetch, useFetchWithPrev } from '#src/utils/hooks'\nimport { apiGetCharacter, apiGetCharacterRelatedLocs } from './endpoints'\nimport { MapAllByCode, mapAllByCode } from './utils'\n\nexport function useBuildWithDelayedLocs(\n\tcharacterCode: string,\n): [build: LoadingState<MapAllByCode<CharacterFullInfoWithRelated>>, isUpdating: boolean] {\n\tconst [build, isUpdating] = useFetchWithPrev(sig => apiGetCharacter(characterCode, sig), [characterCode])\n\tconst buildIsLoaded = isLoaded(build)\n\n\tconst locs = useFetch(\n\t\tsig =>\n\t\t\tbuildIsLoaded\n\t\t\t\t? apiGetCharacterRelatedLocs(characterCode, sig) //\n\t\t\t\t: promiseNever(), //  ,      \n\t\t[characterCode, buildIsLoaded],\n\t)\n\n\tconst buildWithLocs = useMemo(\n\t\t() => (buildIsLoaded && isLoaded(locs) ? applyFullInfoLocationsImmut(build, locs) : build),\n\t\t[build, buildIsLoaded, locs],\n\t)\n\treturn [buildWithLocs, isUpdating]\n}\n\nfunction applyFullInfoLocationsImmut(\n\tfullInfo: MapAllByCode<CharacterFullInfoWithRelated>,\n\tlocsInfo: ExtractedLocationsInfo,\n): MapAllByCode<CharacterFullInfoWithRelated> {\n\tconst items = applyItemsLocationsImmut(fullInfo.items, locsInfo.items)\n\tconst enemies = applyItemsLocationsImmut(fullInfo.enemies, locsInfo.enemies)\n\treturn mapAllByCode({ ...fullInfo, items, enemies })\n}\n\nfunction applyItemsLocationsImmut<T extends ItemShortInfo | EnemyShortInfo>(\n\titems: T[],\n\tlocItems: Record<string, string>,\n): T[] {\n\tlet resItems = items\n\tfor (let i = 0; i < items.length; i++) {\n\t\tconst locs = locItems[items[i].code]\n\t\tif (locs) {\n\t\t\tif (resItems === items) resItems = items.slice()\n\t\t\tresItems[i] = { ...items[i], locations: decodeLocations(locs) }\n\t\t}\n\t}\n\treturn resItems\n}\n","function hex(c: number) {\n\tconst s = '0123456789abcdef'\n\tlet i = parseInt('' + c)\n\tif (i === 0 || isNaN(+c)) return '00'\n\ti = Math.round(Math.min(Math.max(0, i), 255))\n\treturn s.charAt((i - (i % 16)) / 16) + s.charAt(i % 16)\n}\n\n/* Convert an RGB triplet to a hex string */\nfunction convertToHex(rgb: number[]) {\n\treturn '#' + hex(rgb[0]) + hex(rgb[1]) + hex(rgb[2])\n}\n\n/* Remove '#' in color hex string */\nfunction trim(s: string) {\n\treturn s.charAt(0) === '#' ? s.substring(1, 7) : s\n}\n\n/* Convert a hex string to an RGB triplet */\nfunction convertToRGB(hex: string) {\n\tconst color: number[] = []\n\tcolor[0] = parseInt(trim(hex).substring(0, 2), 16)\n\tcolor[1] = parseInt(trim(hex).substring(2, 4), 16)\n\tcolor[2] = parseInt(trim(hex).substring(4, 6), 16)\n\treturn color\n}\n\nexport function generateColor(colorStart: string, colorEnd: string, colorCount: number) {\n\tconst end = convertToRGB(colorStart)\n\n\tconst start = convertToRGB(colorEnd)\n\n\tconst len = colorCount\n\n\t//Alpha blending amount\n\tlet alpha = 0.0\n\n\tconst saida: string[] = []\n\n\tfor (let i = 0; i < len; i++) {\n\t\tconst c: number[] = []\n\t\talpha += 1.0 / len\n\n\t\tc[0] = start[0] * alpha + (1 - alpha) * end[0]\n\t\tc[1] = start[1] * alpha + (1 - alpha) * end[1]\n\t\tc[2] = start[2] * alpha + (1 - alpha) * end[2]\n\n\t\tsaida.push(convertToHex(c))\n\t}\n\n\treturn saida\n}\n","import { generateColor } from '#src/utils/color-gradient'\n\nexport const percentsSpectrum = generateColor('#5c568d', '#d81243', 101)\nexport const possiblePercentLetters = ['SSS', 'SS', 'S', 'A', 'B', 'C', 'D', 'F']\nexport const getPercentLetters = (percent: number) => {\n\tif (percent > 90) return 'SSS'\n\tif (percent > 80) return 'SS'\n\tif (percent > 60) return 'S'\n\tif (percent > 40) return 'A'\n\tif (percent > 20) return 'B'\n\tif (percent > 10) return 'C'\n\tif (percent > 1) return 'D'\n\treturn 'F'\n}\n","import { isLoaded } from '#src/utils/hooks'\nimport { getPercentLetters, percentsSpectrum } from '../abyss/common'\n\nexport const getAbyssDataForCharIcon = (code, abyssStats) => {\n\tif (!isLoaded(abyssStats)) return { color: 'transparent' }\n\tconst percents = (abyssStats.mostUsedCharacters.find(c => c.code === code)?.use || 0) * 100\n\tconst letters = getPercentLetters(percents)\n\tconst color = percentsSpectrum[Math.round(percents)]\n\treturn {\n\t\tcolor,\n\t\tbadge: (\n\t\t\t<span\n\t\t\t\tclassName=\"fst-italic fw-bold fs-6 position-relative\"\n\t\t\t\tstyle={{ color, top: '0px', right: '-2px' }}\n\t\t\t>\n\t\t\t\t{letters}\n\t\t\t</span>\n\t\t),\n\t}\n}\n","import { GI_WeaponTypeCode } from '#src/../../lib/genshin'\r\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\r\nimport { weaponTypes } from '#src/utils/weapons'\r\n\r\nexport function WeaponTypeFilter({\r\n\tselectedWeaponTypeCode,\r\n\tonTypeCodeSelect,\r\n\tclasses = '',\r\n}: {\r\n\tselectedWeaponTypeCode: GI_WeaponTypeCode | null\r\n\tonTypeCodeSelect: (typeCode: GI_WeaponTypeCode) => unknown\r\n\tclasses?: string\r\n}): JSX.Element {\r\n\treturn (\r\n\t\t<div className={classes}>\r\n\t\t\t{weaponTypes.map(wt => (\r\n\t\t\t\t<ItemAvatar\r\n\t\t\t\t\tclasses={`small-avatar bg-secondary p-1 m-1 ${\r\n\t\t\t\t\t\tselectedWeaponTypeCode && selectedWeaponTypeCode !== wt.code ? 'opacity-25' : ''\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\tkey={wt.code}\r\n\t\t\t\t\tsrc={wt.imgSrc}\r\n\t\t\t\t\tonClick={() => onTypeCodeSelect(wt.code)}\r\n\t\t\t\t/>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { GI_ElementCode, GI_WeaponTypeCode } from '#lib/genshin'\nimport { apiGetAbyssStats } from '#src/api/endpoints'\nimport { charactersShortList } from '#src/api/generated'\nimport { WeaponTypeFilter } from '#src/components/weapon-type-filter'\nimport { CharacterAvatar, ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { I18N_FILTER } from '#src/i18n/i18n'\nimport { elements } from '#src/utils/elements'\nimport { useFetch } from '#src/utils/hooks'\nimport { getAbyssDataForCharIcon } from './common'\n\nexport function CharacterPickerMobile() {\n\tconst [selectedElementCode, setSelectedElementCode] = useState<null | GI_ElementCode>(null)\n\tconst selectElement = el => setSelectedElementCode(selectedElementCode === el.code ? null : el.code)\n\tconst [selectedWeaponTypeCode, setSelectedWeaponTypeCode] = useState<null | GI_WeaponTypeCode>(null)\n\tconst abyssStats = useFetch(apiGetAbyssStats, [])\n\n\tconst selectWeaponTypeCode = code =>\n\t\tsetSelectedWeaponTypeCode(selectedWeaponTypeCode === code ? null : code)\n\n\tconst elementGroups = useMemo(() => {\n\t\tconst filteredElements = selectedElementCode\n\t\t\t? elements.filter(x => x.code === selectedElementCode)\n\t\t\t: elements\n\t\treturn filteredElements\n\t\t\t.map(element => ({\n\t\t\t\telement,\n\t\t\t\tcharacters: charactersShortList.filter(\n\t\t\t\t\tx =>\n\t\t\t\t\t\tx.elementCode === element.code &&\n\t\t\t\t\t\t(selectedWeaponTypeCode === null || x.weaponTypeCode === selectedWeaponTypeCode),\n\t\t\t\t),\n\t\t\t}))\n\t\t\t.filter(x => x.characters.length > 0)\n\t}, [selectedElementCode, selectedWeaponTypeCode])\n\n\tconst rows = elementGroups.map(({ element, characters }) => (\n\t\t<div className=\"row py-2\" key={element.code}>\n\t\t\t<div className=\"col-2 py-1\">\n\t\t\t\t<ItemAvatar isNoBg={true} classes=\"d-block mx-auto muted-icon\" src={element.imgSrc} />\n\t\t\t</div>\n\t\t\t<div className=\"col py-31\">\n\t\t\t\t{characters.map(x => {\n\t\t\t\t\tconst abyssData = getAbyssDataForCharIcon(x.code, abyssStats)\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<CharacterAvatar\n\t\t\t\t\t\t\tcode={x.code}\n\t\t\t\t\t\t\thref={'/builds/' + x.code}\n\t\t\t\t\t\t\tclasses={`m-1`}\n\t\t\t\t\t\t\tborderColor={abyssData?.color}\n\t\t\t\t\t\t\tbadgeTopStart={abyssData?.badge}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</div>\n\t\t</div>\n\t))\n\n\treturn (\n\t\t<div className=\"character-picker-mobile\">\n\t\t\t<div className=\"m-auto text-center my-3\">\n\t\t\t\t<div className=\"m-auto\">{I18N_FILTER} </div>\n\t\t\t\t<div className=\"d-inline\">\n\t\t\t\t\t<div className=\"d-inline\">\n\t\t\t\t\t\t{elements.map(el => (\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tclasses={`small-avatar bg-secondary p-1 m-1 ${\n\t\t\t\t\t\t\t\t\tselectedElementCode && selectedElementCode !== el.code ? 'opacity-25' : ''\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\tkey={el.code}\n\t\t\t\t\t\t\t\tsrc={el.imgSrc}\n\t\t\t\t\t\t\t\tonClick={() => selectElement(el)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<br />\n\t\t\t\t\t<WeaponTypeFilter\n\t\t\t\t\t\tselectedWeaponTypeCode={selectedWeaponTypeCode}\n\t\t\t\t\t\tonTypeCodeSelect={selectWeaponTypeCode}\n\t\t\t\t\t\tclasses={'d-inline'}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{rows.length === 0 ? 'not yet' : rows}\n\t\t</div>\n\t)\n}\n","import { apiGetAbyssStats } from '#src/api/endpoints'\nimport { charactersShortList } from '#src/api/generated'\nimport { CharacterAvatar, ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport { I18N_ABYSS_LETTERS_EXPLANATION } from '#src/i18n/i18n'\nimport { elements } from '#src/utils/elements'\nimport { useFetch } from '#src/utils/hooks'\nimport { GI_WeaponType, weaponTypes } from '#src/utils/weapons'\nimport { getAbyssDataForCharIcon } from './common'\nimport { CharacterPickerMobile } from './mobile-character-picker'\n\nimport './character-picker.scss'\n\nfunction CharacterPickerDesktop({ weaponTypes }: { weaponTypes: GI_WeaponType[] }) {\n\tconst abyssStats = useFetch(apiGetAbyssStats, [])\n\treturn (\n\t\t<>\n\t\t\t{elements.map((el, i, arr) => {\n\t\t\t\tconst isLastRowClass = i + 1 === arr.length ? 'rounded-bottom' : ''\n\t\t\t\treturn (\n\t\t\t\t\t<div className=\"row\" key={el.code}>\n\t\t\t\t\t\t<div className=\"col col-2 pt-3 pb-2 opacity-50 rounded-start\">\n\t\t\t\t\t\t\t<ItemAvatar classes=\"d-block mx-auto\" isNoBg={true} src={el.imgSrc} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{weaponTypes.map(wType => (\n\t\t\t\t\t\t\t<div className={`col col-2 pt-3 pb-2 px-2 ${isLastRowClass}`} key={wType.code}>\n\t\t\t\t\t\t\t\t{charactersShortList\n\t\t\t\t\t\t\t\t\t.filter(x => x.elementCode === el.code && x.weaponTypeCode === wType.code)\n\t\t\t\t\t\t\t\t\t.map(x => {\n\t\t\t\t\t\t\t\t\t\tconst abyssData = getAbyssDataForCharIcon(x.code, abyssStats)\n\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t<CharacterAvatar\n\t\t\t\t\t\t\t\t\t\t\t\tkey={x.code}\n\t\t\t\t\t\t\t\t\t\t\t\tcode={x.code}\n\t\t\t\t\t\t\t\t\t\t\t\thref={'/builds/' + x.code}\n\t\t\t\t\t\t\t\t\t\t\t\tclasses={`mb-1 me-1 mb-xxl-2 me-xxl-2`}\n\t\t\t\t\t\t\t\t\t\t\t\tborderColor={abyssData?.color}\n\t\t\t\t\t\t\t\t\t\t\t\tbadgeTopStart={abyssData?.badge}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t})}\n\t\t</>\n\t)\n}\n\nexport function CharacterPicker() {\n\treturn (\n\t\t<div className=\"character-picker\">\n\t\t\t<div class=\"d-none d-xl-block container overflow-hidden big-table\">\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-2 pb-3 pt-2\"></div>\n\t\t\t\t\t{weaponTypes.map((wt, i) => (\n\t\t\t\t\t\t<div className=\"col col-2 pb-3 pt-2 rounded-top \" key={wt.code}>\n\t\t\t\t\t\t\t<ItemAvatar classes=\"d-block mx-auto\" isNoBg={true} src={wt.imgSrc} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t\t<CharacterPickerDesktop weaponTypes={weaponTypes} />\n\t\t\t</div>\n\t\t\t<div class=\"d-xl-none\">\n\t\t\t\t<CharacterPickerMobile />\n\t\t\t</div>\n\t\t\t<div className=\"text-center mt-3 text-muted small\">{I18N_ABYSS_LETTERS_EXPLANATION}</div>\n\t\t</div>\n\t)\n}\n","import { useEffect, useMemo } from 'preact/hooks'\n\nimport { charactersShortList } from '#src/api/generated'\nimport { I18N_FAV_CHARACTERS } from '#src/i18n/i18n'\nimport { MAX_SMTHS_TO_STORE } from '#src/modules/builds/common'\nimport { useVersionedStorage } from '#src/utils/hooks'\nimport { SV_FAV_CHAR_CODES } from '#src/utils/local-storage-keys'\nimport { CharacterAvatar } from '../item-cards/item-avatars'\n\nexport function FavoriteCharacters({\n\tclasses = '',\n\tonCharacterSelect,\n\tshoudSelectFirst,\n\tnavigateToCharacter,\n\tselectedCharacterCode,\n\tblockLabel = I18N_FAV_CHARACTERS,\n}: {\n\tclasses?: string\n\tonCharacterSelect?(characterCode: string): void\n\tshoudSelectFirst?: boolean\n\tnavigateToCharacter: boolean\n\tselectedCharacterCode?: string\n\tblockLabel?: string\n}): JSX.Element {\n\tconst [favCharCodes] = useVersionedStorage(SV_FAV_CHAR_CODES)\n\t//todo sort characters by release date\n\tconst charactersShortListCodes = useMemo(\n\t\t() =>\n\t\t\tcharactersShortList\n\t\t\t\t.map(c => c.code)\n\t\t\t\t.reverse()\n\t\t\t\t.filter(c => !favCharCodes.includes(c)),\n\t\t[favCharCodes],\n\t)\n\tconst characterCodes =\n\t\tfavCharCodes.length < MAX_SMTHS_TO_STORE\n\t\t\t? favCharCodes.concat(charactersShortListCodes.slice(0, MAX_SMTHS_TO_STORE - favCharCodes.length))\n\t\t\t: favCharCodes.slice(0, MAX_SMTHS_TO_STORE)\n\t// const optsForSelect = useMemo(\n\t// \t//todo     \n\t// \t() =>\n\t// \t\t(characterCodes.length > 4 ? characterCodes.slice(4, characterCodes.length) : []).map(c => {\n\t// \t\t\treturn { title: c, code: c }\n\t// \t\t}),\n\t// \t[characterCodes],\n\t// )\n\t// const onSelectViaSelect = useCallback(\n\t// \topt => {\n\t// \t\tonCharacterSelect && onCharacterSelect(opt.code)\n\t// \t},\n\t// \t[onCharacterSelect],\n\t// )\n\n\tuseEffect(() => {\n\t\tshoudSelectFirst && onCharacterSelect && onCharacterSelect(characterCodes[0])\n\t}, [onCharacterSelect, characterCodes, shoudSelectFirst])\n\n\tconst charactersElems = useMemo(\n\t\t() =>\n\t\t\tcharacterCodes.map(code => (\n\t\t\t\t<CharacterAvatar\n\t\t\t\t\tcode={code}\n\t\t\t\t\t// rarity={charactersShortList.find(x => x.code === code)?.rarity ?? 5}\n\t\t\t\t\tclasses={`me-1 small-avatar ${\n\t\t\t\t\t\tselectedCharacterCode && selectedCharacterCode !== code && 'opacity-50'\n\t\t\t\t\t}`}\n\t\t\t\t\tkey={code}\n\t\t\t\t\thref={navigateToCharacter ? '/builds/' + code : undefined}\n\t\t\t\t\tonClick={() => onCharacterSelect && onCharacterSelect(code)}\n\t\t\t\t/>\n\t\t\t)),\n\t\t[characterCodes, onCharacterSelect, navigateToCharacter, selectedCharacterCode],\n\t)\n\treturn (\n\t\t<div className={`favorite-characters ${classes}`}>\n\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{blockLabel}:</label>\n\t\t\t<br className=\"d-xl-none\" />\n\t\t\t{charactersElems}\n\t\t\t{/* {optsForSelect.length ? (\n\t\t\t\t<SimpleSelect\n\t\t\t\t\tclasses=\"d-inline w-auto align-top\"\n\t\t\t\t\toptions={optsForSelect}\n\t\t\t\t\tonOptionSelect={onSelectViaSelect}\n\t\t\t\t\tselectedOption={null}\n\t\t\t\t/>\n\t\t\t) : null} */}\n\t\t</div>\n\t)\n}\n","import './characters.scss'\n\nexport function CharacterPortrait({ src, classes = '' }: { src: string; classes?: string }): JSX.Element {\n\treturn <img className={`character-portrait ${classes}`} src={src} />\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { apiGetAbyssStats } from '#src/api/endpoints'\nimport { CentredSpinner } from '#src/components/placeholders'\nimport { Tooltip } from '#src/components/tooltip'\nimport { I18N_USED_IN_ABYSS } from '#src/i18n/i18n'\nimport { isLoaded, useFetch, useHover } from '#src/utils/hooks'\nimport { getPercentLetters, percentsSpectrum } from './common'\n\nexport function CharacterRating({ characterCode }: { characterCode: string }): JSX.Element {\n\tconst abyssStats = useFetch(apiGetAbyssStats, [])\n\tconst [elRef, isHovered] = useHover<HTMLDivElement>()\n\tconst stats = useMemo(() => {\n\t\tif (!isLoaded(abyssStats)) return {}\n\t\tconst charCodeLocal = characterCode.includes('traveler') ? 'traveler' : characterCode\n\t\tconst charData = abyssStats.mostUsedCharacters.find(d => d.code === charCodeLocal)\n\t\tconst percent = (charData ? charData.use : 0) * 100\n\t\treturn {\n\t\t\tletters: getPercentLetters(Math.max(percent, 1)),\n\t\t\tpercent,\n\t\t\twidth: percent + '%',\n\t\t\tcolor: percentsSpectrum[Math.round(Math.max(percent, 1))],\n\t\t}\n\t}, [abyssStats, characterCode])\n\treturn (\n\t\t<div class=\"character-rating position-relative mt-n4\">\n\t\t\t{!isLoaded(abyssStats) ? <CentredSpinner /> : null}\n\t\t\t<div className=\"d-flex flex-row-reverse\" style={{ color: stats.color || '' }}>\n\t\t\t\t<div class=\"d-flex align-items-center c-help\" ref={elRef}>\n\t\t\t\t\t<span class=\"badge rounded-pill bg-secondary me-1 opacity-75\">?</span>\n\t\t\t\t\t<span class=\"fs-3 fst-italic\" ref={elRef}>\n\t\t\t\t\t\t{stats.letters}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{elRef.current && isHovered ? (\n\t\t\t\t<Tooltip targetEl={elRef.current}>{I18N_USED_IN_ABYSS(stats.percent || 0)}</Tooltip>\n\t\t\t) : null}\n\t\t\t<div class=\"progress\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"progress-bar\"\n\t\t\t\t\trole=\"progressbar\"\n\t\t\t\t\tstyle={{ width: stats.width, backgroundColor: stats.color }}\n\t\t\t\t\taria-valuenow={stats.percent}\n\t\t\t\t\taria-valuemin=\"0\"\n\t\t\t\t\taria-valuemax=\"100\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { useCallback, useMemo } from 'preact/hooks'\n\nimport { arrOrItemToArr } from '#lib/utils/collections'\nimport { CharacterFullInfoWithRelated } from '#src/../../lib/parsing/combine'\nimport { getAllRelated, MapAllByCode } from '#src/api/utils'\nimport { BlockHeader } from '#src/components/block-header'\nimport { CharacterPortrait } from '#src/components/characters'\nimport { CentredSpinner } from '#src/components/placeholders'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport { CharacterRating } from '#src/containers/abyss/char-rating'\nimport { OtherItemCard, WeaponCard } from '#src/containers/item-cards/dd-cards'\nimport { ItemAvatar, ItemsDataContext, LabeledItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport {\n\tI18N_ART_STATS_PRIORITY,\n\tI18N_ART_TYPE,\n\tI18N_ARTIFACTS,\n\tI18N_ASC_MATERIALS,\n\tI18N_BACK,\n\tI18N_CONJUCTIONS,\n\tI18N_NOTES,\n\tI18N_STAT_NAME,\n\tI18N_SUBSTATS_PRIORITY,\n\tI18N_TALENT_NAME,\n\tI18N_TALENTS_PRIORITY,\n\tI18N_USAGE,\n\tI18N_WEAPON_REFINE,\n\tI18N_WEAPON_STACKS_COUNT,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { A } from '#src/routes/router'\nimport { getArtifactTypeIconSrc } from '#src/utils/artifacts'\nimport {\n\tgetCharacterAvatarLargeSrc,\n\tgetCharacterPortraitSrc,\n\tgetCharacterSilhouetteSrc,\n} from '#src/utils/characters'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { getWeaponIconSrc } from '#src/utils/weapons'\nimport {\n\tBuildRoleOrDummy,\n\tCIRCLET_GOBLET_SANDS,\n\tgenArtifactAdvice,\n\tgenArtMainStatDetail,\n\tgenNotes,\n\tgenSeeCharNotes,\n\tgenSimpleList,\n\tgetRoleData,\n\tItemsJoinerWrap,\n\tItemsListGroupWrap,\n\tmakeRoleTitle,\n\tnotesToJSX,\n\tToggleCharFav,\n} from './common'\n\nimport './character-build-detailed.scss'\n\nexport function CharacterBuildDetailed({\n\tbuild,\n\tisUpdating,\n}: {\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>\n\tisUpdating: boolean\n}): JSX.Element {\n\tconst roleTabs: BuildRoleOrDummy[] = build.character.roles\n\tconst characterCode = build.character.code\n\tconst [selectedRoleTab, setSelectedRoleTab] = useSelectable(roleTabs, [characterCode])\n\tconst goBack = useCallback(() => {\n\t\thistory.back()\n\t}, [])\n\tconst weaponListBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\t\treturn role.weapons.advices.map((advice, i) => {\n\t\t\tconst isInList = advice.similar.length > 1\n\t\t\tconst map = advice.similar.map((item, i) => {\n\t\t\t\tconst weapon = build.weapons.find(x => x.code === item.code)\n\t\t\t\tif (!weapon) return null\n\t\t\t\tconst isLastInList = i >= advice.similar.length - 1\n\t\t\t\treturn (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<LabeledItemAvatar\n\t\t\t\t\t\t\timgSrc={getWeaponIconSrc(weapon.code)}\n\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\tweapon.name +\n\t\t\t\t\t\t\t\t(item.refine === null ? '' : ` [${I18N_WEAPON_REFINE(item.refine)}]`) +\n\t\t\t\t\t\t\t\t(item.stacks === null ? '' : ` (${I18N_WEAPON_STACKS_COUNT(item.stacks)})`)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\tavatarClasses=\"with-padding\"\n\t\t\t\t\t\t\tclasses={`small ${!isInList || isLastInList ? 'mb-1' : ''}`}\n\t\t\t\t\t\t\tddComponent={<WeaponCard weapon={weapon} related={build.maps} />}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{genNotes(item)}\n\t\t\t\t\t\t{genSeeCharNotes(item)}\n\t\t\t\t\t\t{isInList && !isLastInList && (\n\t\t\t\t\t\t\t<ItemsJoinerWrap>{I18N_CONJUCTIONS.or}</ItemsJoinerWrap>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</>\n\t\t\t\t)\n\t\t\t})\n\t\t\treturn (\n\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t{isInList ? <ItemsListGroupWrap>{map}</ItemsListGroupWrap> : map}\n\t\t\t\t</li>\n\t\t\t)\n\t\t})\n\t}, [build, selectedRoleTab])\n\n\tconst artifactsListBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\n\t\treturn role.artifacts.sets.map((set, i) => {\n\t\t\treturn (\n\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t{genArtifactAdvice(set.arts, build)}\n\t\t\t\t\t{genNotes(set)}\n\t\t\t\t\t{genSeeCharNotes(set)}\n\t\t\t\t</li>\n\t\t\t)\n\t\t})\n\t}, [build, selectedRoleTab])\n\tconst artifactStatsAndSkillsBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<BlockHeader>{I18N_ART_STATS_PRIORITY}</BlockHeader>\n\t\t\t\t<ul className=\"mb-1 list-unstyled ms-1 small\">\n\t\t\t\t\t{CIRCLET_GOBLET_SANDS.map(ac => (\n\t\t\t\t\t\t<li className=\"my-1 ms-1\">\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tsrc={getArtifactTypeIconSrc(ac)}\n\t\t\t\t\t\t\t\tisNoBg={true}\n\t\t\t\t\t\t\t\tclasses=\"small-avatar small with-padding align-middle\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<b className=\"text-muted\">{I18N_ART_TYPE(ac)}  </b>\n\t\t\t\t\t\t\t{genArtMainStatDetail(role, ac)}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t))}\n\t\t\t\t</ul>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.mainStats.notes)} {genSeeCharNotes(role.mainStats)}\n\t\t\t\t</div>\n\t\t\t\t<BlockHeader classes=\"mt-3\">{I18N_SUBSTATS_PRIORITY}</BlockHeader>\n\t\t\t\t<ol className=\"mb-1 small\">\n\t\t\t\t\t{role.subStats.advices.map(advice => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div className=\"opacity-75\">\n\t\t\t\t\t\t\t\t\t{genSimpleList(advice.codes.map(I18N_STAT_NAME))} {genNotes(advice)}\n\t\t\t\t\t\t\t\t\t{genSeeCharNotes(advice)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.subStats.notes)} {genSeeCharNotes(role.subStats)}\n\t\t\t\t</div>\n\t\t\t\t<BlockHeader classes=\"mt-3\">{I18N_TALENTS_PRIORITY}</BlockHeader>\n\t\t\t\t<ol className=\"small\">\n\t\t\t\t\t{role.talents.advices.map(advice => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div className=\"opacity-75\">\n\t\t\t\t\t\t\t\t\t{arrOrItemToArr(advice).map(I18N_TALENT_NAME).join(', ')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t\t<div className=\"opacity-75 small\">\n\t\t\t\t\t{notesToJSX(role.talents.notes)} {genSeeCharNotes(role.subStats)}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst notesBlock = useMemo(() => {\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className=\"mb-2\">{notesToJSX(role.tips)}</div>\n\t\t\t\t<div className=\"mb-2\">{notesToJSX(role.notes)}</div>\n\t\t\t\t<div>{notesToJSX(build.character.credits)}</div>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst materialsBlock = useMemo(() => {\n\t\tconst materials = getAllRelated(build.maps.items, build.character.materialCodes)\n\t\treturn (\n\t\t\t<div className=\"w-100 d-flex flex-wrap justify-content-between\">\n\t\t\t\t{materials.map((m, i) => (\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses={`${\n\t\t\t\t\t\t\ti === materials.length - 1 ? 'ms-1' : i === 0 ? 'me-1' : 'mx-1'\n\t\t\t\t\t\t} small-avatar with-padding`}\n\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\tddComponent={<OtherItemCard item={m} related={build.maps} />}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t)\n\t}, [build])\n\tconst CharacterDetailDesktop = (\n\t\t<div className=\"d-none d-xl-block\">\n\t\t\t<div className=\"container\">\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-3 p-0\">\n\t\t\t\t\t\t<button className=\"btn btn-secondary align-self-center\" onClick={goBack}>\n\t\t\t\t\t\t\t<span className=\"fs-4 lh-1 opacity-75\"> </span> {I18N_BACK}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col col-9\">\n\t\t\t\t\t\t<Tabs\n\t\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"row\">\n\t\t\t\t\t<div className=\"col col-3 pt-3\">\n\t\t\t\t\t\t<div className=\"position-relative\">\n\t\t\t\t\t\t\t<CharacterPortrait src={getCharacterPortraitSrc(characterCode)} classes=\"w-100\" />\n\t\t\t\t\t\t\t<div className=\"mt-3\">{materialsBlock}</div>\n\t\t\t\t\t\t\t<ToggleCharFav\n\t\t\t\t\t\t\t\tclasses=\"fs-3 position-absolute top-0 end-0\"\n\t\t\t\t\t\t\t\tcharacterCode={characterCode}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"mt-3 mb-4\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_USAGE}</BlockHeader>\n\t\t\t\t\t\t\t\t<CharacterRating characterCode={characterCode} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/* <div className=\"my-2\">\n\t\t\t\t\t\t\t\t<BlockHeader>{''}</BlockHeader>\n\t\t\t\t\t\t\t\t<RecommendedTeams characterCode={characterCode} />\n\t\t\t\t\t\t\t</div> */}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col col-9\">\n\t\t\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_WEAPONS}</BlockHeader>\n\t\t\t\t\t\t\t\t<ol className=\"items-list\">{weaponListBlock}</ol>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_ARTIFACTS}</BlockHeader>\n\t\t\t\t\t\t\t\t<ol className=\"items-list\">{artifactsListBlock}</ol>\n\t\t\t\t\t\t\t\t<div></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex-fill w-33 p-3\">{artifactStatsAndSkillsBlock}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"w-100\">\n\t\t\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t\t\t<BlockHeader>{I18N_NOTES}</BlockHeader>\n\t\t\t\t\t\t\t\t<div className=\"text-muted\">{notesBlock}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n\tconst CharacterDetailMobile = (\n\t\t<div className=\"d-xl-none\">\n\t\t\t<CharacterPortrait\n\t\t\t\tsrc={getCharacterSilhouetteSrc(characterCode)}\n\t\t\t\tclasses=\"w-75 character-portrait-mobile\"\n\t\t\t/>\n\t\t\t<div className=\"mt-3\">\n\t\t\t\t<BlockHeader>{I18N_USAGE}</BlockHeader>\n\t\t\t\t<CharacterRating characterCode={characterCode} />\n\t\t\t</div>\n\t\t\t<div className=\"my-4\">\n\t\t\t\t<BlockHeader>{I18N_ASC_MATERIALS}</BlockHeader>\n\t\t\t\t{materialsBlock}\n\t\t\t</div>\n\t\t\t<BtnTabGroup\n\t\t\t\ttabs={roleTabs}\n\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\tclasses=\"w-100 btn-group-sm mb-n1\"\n\t\t\t/>\n\t\t\t<div className=\"\">\n\t\t\t\t<div className=\"my-4\">\n\t\t\t\t\t<BlockHeader>{I18N_ARTIFACTS}</BlockHeader>\n\t\t\t\t\t<ol className=\"items-list\">{artifactsListBlock}</ol>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"my-4\">{artifactStatsAndSkillsBlock}</div>\n\t\t\t\t<div className=\"my-4\">\n\t\t\t\t\t<BlockHeader>{I18N_WEAPONS}</BlockHeader>\n\t\t\t\t\t<ol className=\"items-list\">{weaponListBlock}</ol>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<BlockHeader>{I18N_NOTES}</BlockHeader>\n\t\t\t\t<div className=\"text-muted\">{notesBlock}</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n\treturn (\n\t\t<ItemsDataContext.Provider value={build.maps}>\n\t\t\t<div className=\"character-build-detailed mt-2 mb-3 position-relative\">\n\t\t\t\t<div className=\"d-flex d-xl-none mt-3\">\n\t\t\t\t\t<A className=\"btn btn-secondary align-self-center\" type=\"submit\" href=\"/builds\">\n\t\t\t\t\t\t<span className=\"fs-4 lh-1 opacity-75\"> </span> {I18N_BACK}\n\t\t\t\t\t</A>\n\t\t\t\t\t<h5 className=\"ps-3 pe-1 m-0 align-self-center w-50 d-inline-block overflow-hidden text-truncate text-wrap\">\n\t\t\t\t\t\t{build.character.name}\n\t\t\t\t\t</h5>\n\t\t\t\t\t<div className=\"align-self-end ms-auto d-flex\">\n\t\t\t\t\t\t<ToggleCharFav classes=\"fs-3\" characterCode={characterCode} />\n\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\tsrc={getCharacterAvatarLargeSrc(characterCode)}\n\t\t\t\t\t\t\tclasses=\"large-avatar mt-n5 align-self-end\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{isUpdating ? <CentredSpinner /> : null}\n\t\t\t\t<div className={isUpdating ? 'opacity-50 pe-none' : ''}>\n\t\t\t\t\t{CharacterDetailDesktop}\n\t\t\t\t\t{CharacterDetailMobile}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</ItemsDataContext.Provider>\n\t)\n}\n","import { useState } from 'preact/hooks'\r\n\r\ninterface AccordionItem {\r\n\tcode: string\r\n\ttitle: string\r\n\tcontent: JSX.Element\r\n}\r\nexport function Accordion({\r\n\tclasses = '',\r\n\texpandedItemCode,\r\n\titems,\r\n}: {\r\n\tclasses?: string\r\n\texpandedItemCode?: string\r\n\titems: AccordionItem[]\r\n}): JSX.Element {\r\n\tconst [expandedItemCodeLocal, setexpandedItemCode] = useState<string | undefined>(expandedItemCode)\r\n\treturn (\r\n\t\t<div className={`accordion ${classes}`}>\r\n\t\t\t{items.map(ai => {\r\n\t\t\t\tconst isThisExpanded = expandedItemCodeLocal === ai.code\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"accordion-item\">\r\n\t\t\t\t\t\t<h2 className=\"accordion-header\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName={`accordion-button ${isThisExpanded ? '' : 'collapsed'}`}\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tonClick={() => setexpandedItemCode(isThisExpanded ? undefined : ai.code)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ai.title}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t{isThisExpanded ? (\r\n\t\t\t\t\t\t\t<div className={`accordion-collapse collapse show`}>\r\n\t\t\t\t\t\t\t\t<div className=\"accordion-body\">{ai.content}</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) : null}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)\r\n\t\t\t})}\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { useCallback, useEffect, useMemo, useState } from 'preact/hooks'\n\nimport { ArtifactRegularInfo } from '#lib/parsing/combine'\nimport { GI_ARTIFACT_TYPE_CODES, GI_ArtifactTypeCode } from '#src/../../lib/genshin'\nimport { apiGetArtifact } from '#src/api/endpoints'\nimport { getAllRelated } from '#src/api/utils'\nimport { Accordion } from '#src/components/accordion'\nimport { BlockHeader } from '#src/components/block-header'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { CentredSpinner, Spinner } from '#src/components/placeholders'\nimport { BtnTabGroup } from '#src/components/tabs'\nimport {\n\tI18N_ART_TYPE,\n\tI18N_COLLAPSE,\n\tI18N_ITEM_STORY,\n\tI18N_MAIN_INFO,\n\tI18N_ON_MAP,\n\tI18N_PIECE_BONUS,\n\tI18N_PIECES_BONUS,\n} from '#src/i18n/i18n'\nimport { notesToJSX } from '#src/modules/builds/common'\nimport { ARTIFACT_ROW_CARD_HASH_KEY, genEquipmentHash } from '#src/modules/equipment/common'\nimport { getArtifactIconLargeSrc, getArtifactIconSrc } from '#src/utils/artifacts'\nimport { isLoaded, useFetch, useHashValue, useScrollTo } from '#src/utils/hooks'\nimport { BULLET, DASH, ELLIPSIS } from '#src/utils/typography'\nimport { addMarkerGroupsByDomains, addMarkerGroupsByEnemies, CardMap, CardMapMarkerGroup } from '../card-map'\nimport { RecommendedTo } from '../common'\nimport { ItemAvatar } from '../item-avatars'\n\nimport './line-cards.scss'\n\nconst dummyMarkerGroups: CardMapMarkerGroup[] = [\n\t{\n\t\tcode: '',\n\t\ttitle: ELLIPSIS,\n\t\tmarkers: [{ mapCode: 'teyvat', x: 0, y: 0, icon: '' }],\n\t},\n]\n\ntype ArtifactRowProps = {\n\tartifact: ArtifactRegularInfo\n\tgroup: number\n\tisExpanded: boolean\n}\ntype ArtTypeTab = { code: GI_ArtifactTypeCode; title: string }\nconst artTypeTabs: ArtTypeTab[] = GI_ARTIFACT_TYPE_CODES.map(at => {\n\treturn { code: at, title: I18N_ART_TYPE(at) }\n})\n\nfunction ArtifactCardLine({\n\tartifact,\n\tonClose,\n}: {\n\tartifact: ArtifactRegularInfo\n\tonClose: () => unknown\n}): JSX.Element {\n\tconst [selectedArtTypeTab, setSelectedArtTypeTab] = useState<ArtTypeTab>(artTypeTabs[0])\n\n\tconst artifactFull = useFetch(sig => apiGetArtifact(artifact.code, sig), [artifact])\n\tconst artTypeTabsFiltered = useMemo(() => {\n\t\treturn isLoaded(artifactFull)\n\t\t\t? artTypeTabs.filter(att => artifactFull.artifact.pieces[att.code])\n\t\t\t: artTypeTabs\n\t}, [artifactFull])\n\n\tuseEffect(() => {\n\t\tsetSelectedArtTypeTab(artTypeTabsFiltered[0])\n\t}, [artTypeTabsFiltered])\n\n\tconst dataForMap = useMemo(() => {\n\t\tif (!isLoaded(artifactFull)) return { markerGroups: dummyMarkerGroups }\n\t\tconst srcs = artifact.obtainSources\n\t\tconst markerGroups: CardMapMarkerGroup[] = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(artifactFull.maps.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(artifactFull.maps.enemies, srcs.enemyCodes))\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: artifact,\n\t\t\t\timgSrc: getArtifactIconSrc(artifact.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [artifactFull, artifact])\n\tconst mainInfoColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div>\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 me-2 large-avatar float-start\"\n\t\t\t\t\t\trarity={artifact.rarity}\n\t\t\t\t\t\tsrc={getArtifactIconLargeSrc(artifact.code)}\n\t\t\t\t\t/>\n\t\t\t\t\t<h4 className=\"mb-0\">{artifact.name}</h4>\n\t\t\t\t\t<div className=\"overflow-hidden\">\n\t\t\t\t\t\t<span className=\"mb-2 text-muted\">\n\t\t\t\t\t\t\t{/* {BULLET} {artifact.obtainSources.map(I18N_WEAPON_OBTAIN_SOURCE_NAME).join(', ')} */}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mt-1 mb-2\">\n\t\t\t\t\t<RecommendedTo\n\t\t\t\t\t\tnavigateToCharacter={true}\n\t\t\t\t\t\tisAvatarWithBorder={true}\n\t\t\t\t\t\tcharCodes={artifact.recommendedTo}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-fill overflow-auto small lh-sm mt-1\">\n\t\t\t\t\t{artifact.sets[1] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECE_BONUS(1)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3 opacity-75\">{notesToJSX(artifact.sets[1])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{artifact.sets[2] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(2)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3 opacity-75\">{notesToJSX(artifact.sets[2])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t{artifact.sets[4] && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<BlockHeader>{I18N_PIECES_BONUS(4)}</BlockHeader>\n\t\t\t\t\t\t\t<div className=\"mb-3 opacity-75\">{notesToJSX(artifact.sets[4])}</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</>\n\t\t)\n\t}, [artifact])\n\tconst loreInfoColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className=\"opacity-75\">{I18N_ITEM_STORY}</div>\n\t\t\t\t{isLoaded(artifactFull) ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\t\ttabs={artTypeTabsFiltered}\n\t\t\t\t\t\t\tonTabSelect={setSelectedArtTypeTab}\n\t\t\t\t\t\t\tselectedTab={selectedArtTypeTab}\n\t\t\t\t\t\t\tclasses=\"w-100 my-1 btn-group-sm\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div className=\"fst-italic my-1 small lh-sm text-muted\">\n\t\t\t\t\t\t\t{notesToJSX(\n\t\t\t\t\t\t\t\tartifactFull.artifact.pieces[selectedArtTypeTab.code]?.description || null,\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex-fill my-1 overflow-auto small lh-sm opacity-75\">\n\t\t\t\t\t\t\t{notesToJSX(artifactFull.artifact.pieces[selectedArtTypeTab.code]?.story || null)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\t<Spinner />\n\t\t\t\t)}\n\t\t\t</>\n\t\t)\n\t}, [artifactFull, selectedArtTypeTab, setSelectedArtTypeTab, artTypeTabsFiltered])\n\tconst locationColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<div className=\"d-flex flex-fill flex-column location-col-inner position-relative\">\n\t\t\t\t{dataForMap.markerGroups === dummyMarkerGroups ? (\n\t\t\t\t\t<CentredSpinner />\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className=\"flex-fill mt-2\">\n\t\t\t\t\t\t\t<CardMap isFatHead={true} {...dataForMap} classes=\"h-100\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t)\n\t}, [dataForMap])\n\n\tconst cellClass = 'w-33 d-flex px-2 pb-3 pt-2 flex-column'\n\tconst forAccordion = useMemo(() => {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttitle: `${artifact.name} ${BULLET} ${I18N_MAIN_INFO}`,\n\t\t\t\tcode: 'mainInfoColInner',\n\t\t\t\tcontent: mainInfoColInner,\n\t\t\t},\n\t\t\t{ title: I18N_ITEM_STORY, code: 'loreInfoColInner', content: loreInfoColInner },\n\t\t\t{ title: I18N_ON_MAP, code: 'locationColInner', content: locationColInner },\n\t\t]\n\t}, [mainInfoColInner, loreInfoColInner, locationColInner, artifact])\n\treturn (\n\t\t<MobileDesktopSwitch\n\t\t\tchildrenDesktop={\n\t\t\t\t<div className=\"bg-dark-darker rounded-start border border-secondary d-flex w-100 line-card-desktop\">\n\t\t\t\t\t<div className={cellClass}>{mainInfoColInner}</div>\n\t\t\t\t\t<div className={cellClass}>\n\t\t\t\t\t\t<div className=\"invisible pe-none\">\n\t\t\t\t\t\t\t{/* to make the same padding-top as on the next cell */}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"btn-close btn-sm ms-auto \"\n\t\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{loreInfoColInner}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={cellClass}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn-close btn-sm ms-auto\"\n\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t></button>\n\t\t\t\t\t\t{locationColInner}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tchildrenMobile={\n\t\t\t\t<>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"ms-auto d-flex justify-content-end align-items-center mb-2 me-3\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t>\n\t\t\t\t\t\t<label className=\"small text-muted c-pointer\">{I18N_COLLAPSE}</label>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn-close btn-sm d-inline-block ms-1\"\n\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"bg-dark rounded border overflow-hidden border-secondary d-flex w-100 line-card-mobile\">\n\t\t\t\t\t\t<Accordion\n\t\t\t\t\t\t\tclasses=\"accordion-flush w-100\"\n\t\t\t\t\t\t\titems={forAccordion}\n\t\t\t\t\t\t\texpandedItemCode={forAccordion[0].code}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t}\n\t\t/>\n\t)\n}\n\nexport function ArtifactCardTableRow({ artifact, isExpanded, group }: ArtifactRowProps): JSX.Element {\n\tconst [, setSelectedArtifactCode] = useHashValue<string | null>(ARTIFACT_ROW_CARD_HASH_KEY, null)\n\n\tconst toggleExpand = useCallback(() => {\n\t\tisExpanded ? setSelectedArtifactCode(null) : setSelectedArtifactCode(artifact.code)\n\t}, [isExpanded, setSelectedArtifactCode, artifact.code])\n\tconst bgClass = group === 1 ? 'bg-dark' : 'bg-dark-darker'\n\n\tconst [cardRef] = useScrollTo<HTMLTableCellElement>(isExpanded)\n\n\tconst expandedRow = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colSpan={5} className=\"p-2\" ref={cardRef}>\n\t\t\t\t\t\t<ArtifactCardLine artifact={artifact} onClose={toggleExpand} />\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</>\n\t\t)\n\t}, [artifact, toggleExpand, cardRef])\n\tconst collapsededRow = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<tr className={'small lh-sm ' + bgClass}>\n\t\t\t\t\t<td colSpan={1}>\n\t\t\t\t\t\t<div className=\"d-flex c-pointer\" onClick={toggleExpand}>\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tclasses=\"me-2 small-avatar align-self-center flex-shrink-0\"\n\t\t\t\t\t\t\t\trarity={artifact.rarity}\n\t\t\t\t\t\t\t\tsrc={getArtifactIconLargeSrc(artifact.code)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref={genEquipmentHash('artifact', artifact.code)}\n\t\t\t\t\t\t\t\tclassName=\"align-self-center text-decoration-underline-dotted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{artifact.name}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td className=\"opacity-75\">{artifact.sets[4] ? notesToJSX(artifact.sets[4]) : DASH}</td>\n\t\t\t\t\t<MobileDesktopSwitch\n\t\t\t\t\t\tchildrenDesktop={\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<td className=\"opacity-75\">\n\t\t\t\t\t\t\t\t\t{artifact.sets[2] ? notesToJSX(artifact.sets[2]) : DASH}\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td className=\"opacity-75\">\n\t\t\t\t\t\t\t\t\t{artifact.sets[1] ? notesToJSX(artifact.sets[1]) : DASH}\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchildrenMobile={null}\n\t\t\t\t\t/>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div className=\"c-pointer\" onClick={toggleExpand}>\n\t\t\t\t\t\t\t<button className=\"btn\">\n\t\t\t\t\t\t\t\t<span className=\"btn-expand-inner\"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</>\n\t\t)\n\t}, [artifact, toggleExpand, bgClass])\n\treturn isExpanded ? expandedRow : collapsededRow\n}\n","import { apiGetArtifacts } from '#src/api/endpoints'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { Spinner } from '#src/components/placeholders'\nimport { ArtifactCardTableRow } from '#src/containers/item-cards/line-cards/artifact-card'\nimport { I18N_NAME, I18N_PIECES_BONUS, I18N_PIECE_BONUS } from '#src/i18n/i18n'\nimport { isLoaded, useFetch, useHashValue } from '#src/utils/hooks'\nimport { useMemo } from 'preact/hooks'\nimport { ARTIFACT_ROW_CARD_HASH_KEY } from './common'\n\nexport function ArtifactsList(): JSX.Element {\n\tconst artifacts = useFetch(apiGetArtifacts, [])\n\tconst [selectedArtifactCode] = useHashValue(ARTIFACT_ROW_CARD_HASH_KEY, null)\n\n\tconst artifactsSorted = useMemo(() => {\n\t\tif (!isLoaded(artifacts)) return []\n\t\tconst artifactsLocal = [...artifacts]\n\t\tartifactsLocal.sort((a, b) => b.rarity - a.rarity)\n\t\treturn artifactsLocal\n\t}, [artifacts])\n\tif (!isLoaded(artifacts)) return <Spinner />\n\treturn (\n\t\t<>\n\t\t\t<table className=\"table table-sm\">\n\t\t\t\t<thead className=\"bg-dark\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_NAME}</th>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_PIECES_BONUS(4)}</th>\n\t\t\t\t\t\t<MobileDesktopSwitch\n\t\t\t\t\t\t\tchildrenDesktop={\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<th scope=\"col\">{I18N_PIECES_BONUS(2)}</th>\n\t\t\t\t\t\t\t\t\t<th scope=\"col\">{I18N_PIECE_BONUS(1)}</th>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchildrenMobile={null}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<th scope=\"col\"></th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{isLoaded(artifacts)\n\t\t\t\t\t\t? artifactsSorted.map((a, i) => (\n\t\t\t\t\t\t\t\t<ArtifactCardTableRow\n\t\t\t\t\t\t\t\t\tartifact={a}\n\t\t\t\t\t\t\t\t\tkey={a.code}\n\t\t\t\t\t\t\t\t\tgroup={i % 2}\n\t\t\t\t\t\t\t\t\tisExpanded={a.code === selectedArtifactCode}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t  ))\n\t\t\t\t\t\t: null}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</>\n\t)\n}\n","import { useCallback, useEffect, useMemo, useState } from 'preact/hooks'\n\nimport { ItemShortInfo, WeaponRegularInfo } from '#lib/parsing/combine'\nimport { apiGetWeapon } from '#src/api/endpoints'\nimport { getAllRelated } from '#src/api/utils'\nimport { Accordion } from '#src/components/accordion'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { CentredSpinner, Spinner } from '#src/components/placeholders'\nimport {\n\tI18N_ASC_MATERIALS,\n\tI18N_BASE_ATTACK,\n\tI18N_COLLAPSE,\n\tI18N_ITEM_STORY,\n\tI18N_MAIN_INFO,\n\tI18N_STAT_NAME,\n\tI18N_WEAPON_OBTAIN_SOURCE_NAME,\n} from '#src/i18n/i18n'\nimport { notesToJSX } from '#src/modules/builds/common'\nimport { genEquipmentHash, WEAPON_ROW_CARD_HASH_KEY } from '#src/modules/equipment/common'\nimport { isLoaded, useFetch, useHashValue, useScrollTo } from '#src/utils/hooks'\nimport { getItemIconSrc } from '#src/utils/items'\nimport { BULLET, DASH, ELLIPSIS } from '#src/utils/typography'\nimport { getWeaponIconLageSrc } from '#src/utils/weapons'\nimport { addMarkerGroupsByDomains, addMarkerGroupsByEnemies, CardMap, CardMapMarkerGroup } from '../card-map'\nimport { AscMaterials, RecommendedTo } from '../common'\nimport { ItemAvatar } from '../item-avatars'\n\nimport './line-cards.scss'\n\ntype WeaponRowProps = {\n\tweapon: WeaponRegularInfo\n\tgroup: number\n\tisExpanded: boolean\n}\n\nconst dummyMarkerGroups: CardMapMarkerGroup[] = [\n\t{\n\t\tcode: '',\n\t\ttitle: ELLIPSIS,\n\t\tmarkers: [{ mapCode: 'teyvat', x: 0, y: 0, icon: '' }],\n\t},\n]\n\nfunction WeaponCardLine({\n\tweapon,\n\tonClose,\n}: {\n\tweapon: WeaponRegularInfo\n\tonClose: () => unknown\n}): JSX.Element {\n\tconst weaponFull = useFetch(sig => apiGetWeapon(weapon.code, sig), [weapon])\n\tconst [materialOnMap, setMaterialOnMap] = useState<ItemShortInfo | undefined>()\n\tconst dataForMap = useMemo(() => {\n\t\tif (!isLoaded(weaponFull) || !materialOnMap) return { markerGroups: dummyMarkerGroups }\n\t\tconst srcs = materialOnMap.obtainSources\n\t\tconst markerGroups: CardMapMarkerGroup[] = []\n\t\taddMarkerGroupsByDomains(markerGroups, getAllRelated(weaponFull.maps.domains, srcs.domainCodes))\n\t\taddMarkerGroupsByEnemies(markerGroups, getAllRelated(weaponFull.maps.enemies, srcs.enemyCodes))\n\t\treturn {\n\t\t\titemData: {\n\t\t\t\titem: materialOnMap,\n\t\t\t\timgSrc: getItemIconSrc(materialOnMap.code),\n\t\t\t},\n\t\t\tmarkerGroups,\n\t\t}\n\t}, [weaponFull, materialOnMap])\n\n\tconst materials = useMemo(() => {\n\t\tif (!isLoaded(weaponFull)) return []\n\t\treturn getAllRelated(weaponFull.maps.items, weaponFull.weapon.materialCodes)\n\t}, [weaponFull])\n\n\tuseEffect(() => {\n\t\tsetMaterialOnMap(materials[0])\n\t}, [materials])\n\n\tconst mainInfoColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div>\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 me-2 large-avatar float-start\"\n\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\tsrc={getWeaponIconLageSrc(weapon.code)}\n\t\t\t\t\t/>\n\t\t\t\t\t<h4 className=\"mb-0\">{weapon.name}</h4>\n\t\t\t\t\t<div className=\"overflow-hidden\">\n\t\t\t\t\t\t<span className=\"mb-2 text-muted\">\n\t\t\t\t\t\t\t{BULLET} {weapon.obtainSources.map(I18N_WEAPON_OBTAIN_SOURCE_NAME).join(', ')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"d-flex\">\n\t\t\t\t\t<div className=\"me-2\">\n\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_BASE_ATTACK}</div>\n\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t{weapon.atk.base} / {weapon.atk.max}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t{weapon.subStat && (\n\t\t\t\t\t\t<div className=\"ms-1\">\n\t\t\t\t\t\t\t<div className=\"opacity-75\">{I18N_STAT_NAME(weapon.subStat.code)}</div>\n\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t{weapon.subStat.base} / {weapon.subStat.max}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"mt-1\">\n\t\t\t\t\t<RecommendedTo\n\t\t\t\t\t\tisInline={true}\n\t\t\t\t\t\tnavigateToCharacter={true}\n\t\t\t\t\t\tisAvatarWithBorder={true}\n\t\t\t\t\t\tcharCodes={weapon.recommendedTo}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex-fill overflow-auto small lh-sm\">{weapon.passiveStat}</div>\n\t\t\t</>\n\t\t)\n\t}, [weapon])\n\tconst loreInfoColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div className=\"opacity-75\">{I18N_ITEM_STORY}</div>\n\t\t\t\t{isLoaded(weaponFull) ? (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div className=\"fst-italic my-1 small lh-sm text-muted\">\n\t\t\t\t\t\t\t{weaponFull.weapon.description}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex-fill my-1 overflow-auto small lh-sm opacity-75\">\n\t\t\t\t\t\t\t{notesToJSX(weaponFull.weapon.story)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t) : (\n\t\t\t\t\t<Spinner />\n\t\t\t\t)}\n\t\t\t</>\n\t\t)\n\t}, [weaponFull])\n\tconst locationColInner = useMemo(() => {\n\t\treturn (\n\t\t\t<div className=\"d-flex flex-fill flex-column location-col-inner position-relative\">\n\t\t\t\t{dataForMap.markerGroups === dummyMarkerGroups ? (\n\t\t\t\t\t<CentredSpinner />\n\t\t\t\t) : (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<AscMaterials\n\t\t\t\t\t\t\t\tmaterials={materials}\n\t\t\t\t\t\t\t\tselectedMat={materialOnMap}\n\t\t\t\t\t\t\t\tonMatSelect={setMaterialOnMap}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex-fill\">\n\t\t\t\t\t\t\t<CardMap isFatHead={true} isItemFavable={true} {...dataForMap} classes=\"h-100\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t)\n\t}, [dataForMap, materials, materialOnMap])\n\n\tconst cellClass = 'w-33 d-flex px-2 pb-3 pt-2 flex-column'\n\tconst forAccordion = useMemo(() => {\n\t\treturn [\n\t\t\t{\n\t\t\t\ttitle: `${weapon.name} ${BULLET} ${I18N_MAIN_INFO}`,\n\t\t\t\tcode: 'mainInfoColInner',\n\t\t\t\tcontent: mainInfoColInner,\n\t\t\t},\n\t\t\t{ title: I18N_ITEM_STORY, code: 'loreInfoColInner', content: loreInfoColInner },\n\t\t\t{ title: I18N_ASC_MATERIALS, code: 'locationColInner', content: locationColInner },\n\t\t]\n\t}, [mainInfoColInner, loreInfoColInner, locationColInner, weapon])\n\treturn (\n\t\t<MobileDesktopSwitch\n\t\t\tchildrenDesktop={\n\t\t\t\t<div className=\"bg-dark-darker rounded-start border border-secondary d-flex w-100 line-card-desktop\">\n\t\t\t\t\t<div className={cellClass}>{mainInfoColInner}</div>\n\t\t\t\t\t<div className={cellClass}>\n\t\t\t\t\t\t<div className=\"invisible pe-none\">\n\t\t\t\t\t\t\t{/* to make the same padding-top as on the next cell */}\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tclassName=\"btn-close btn-sm ms-auto \"\n\t\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{loreInfoColInner}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={cellClass}>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn-close btn-sm ms-auto\"\n\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t></button>\n\t\t\t\t\t\t{locationColInner}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tchildrenMobile={\n\t\t\t\t<>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"ms-auto d-flex justify-content-end align-items-center mb-2 me-3\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t>\n\t\t\t\t\t\t<label className=\"small text-muted c-pointer\">{I18N_COLLAPSE}</label>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn-close btn-sm d-inline-block ms-1\"\n\t\t\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\t\t></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"bg-dark rounded border overflow-hidden border-secondary d-flex w-100 line-card-mobile\">\n\t\t\t\t\t\t<Accordion\n\t\t\t\t\t\t\tclasses=\"accordion-flush w-100\"\n\t\t\t\t\t\t\titems={forAccordion}\n\t\t\t\t\t\t\texpandedItemCode={forAccordion[0].code}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t}\n\t\t/>\n\t)\n}\nexport function WeaponCardTableRow({ weapon, isExpanded, group }: WeaponRowProps): JSX.Element {\n\tconst [, setSelectedWeaponCode] = useHashValue<string | null>(WEAPON_ROW_CARD_HASH_KEY, null)\n\n\tconst toggleExpand = useCallback(() => {\n\t\tisExpanded ? setSelectedWeaponCode(null) : setSelectedWeaponCode(weapon.code)\n\t}, [isExpanded, setSelectedWeaponCode, weapon.code])\n\n\tconst [cardRef] = useScrollTo<HTMLTableCellElement>(isExpanded)\n\tconst bgClass = group === 1 ? 'bg-dark' : 'bg-dark-darker'\n\n\tconst expandedRow = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<tr>\n\t\t\t\t\t<td colSpan={6} className=\"p-2\" ref={cardRef}>\n\t\t\t\t\t\t<WeaponCardLine weapon={weapon} onClose={toggleExpand} />\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</>\n\t\t)\n\t}, [weapon, toggleExpand, cardRef])\n\tconst collapsededRow = useMemo(() => {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<tr className={'small lh-sm ' + bgClass}>\n\t\t\t\t\t<td colSpan={1}>\n\t\t\t\t\t\t<div className=\"d-flex c-pointer\" onClick={toggleExpand}>\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tclasses=\"me-2 small-avatar align-self-center flex-shrink-0\"\n\t\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\t\tsrc={getWeaponIconLageSrc(weapon.code)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref={genEquipmentHash('weapon', weapon.code)}\n\t\t\t\t\t\t\t\tclassName=\"align-self-center text-decoration-underline-dotted\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{weapon.name}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{weapon.atk.base} / {weapon.atk.max}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t{weapon.subStat ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{I18N_STAT_NAME(weapon.subStat.code)} <br />\n\t\t\t\t\t\t\t\t{`${weapon.subStat.base} / ${weapon.subStat.max}`}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\tDASH\n\t\t\t\t\t\t)}\n\t\t\t\t\t</td>\n\t\t\t\t\t<MobileDesktopSwitch\n\t\t\t\t\t\tchildrenDesktop={\n\t\t\t\t\t\t\t<td className=\"opacity-75\">{weapon.passiveStat ? weapon.passiveStat : DASH}</td>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchildrenMobile={null}\n\t\t\t\t\t/>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<div className=\"c-pointer\" onClick={toggleExpand}>\n\t\t\t\t\t\t\t<button className=\"btn\">\n\t\t\t\t\t\t\t\t<span className=\"btn-expand-inner\"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</>\n\t\t)\n\t}, [weapon, toggleExpand, bgClass])\n\treturn isExpanded ? expandedRow : collapsededRow\n}\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { GI_WeaponObtainSource, GI_WeaponTypeCode } from '#src/../../lib/genshin'\nimport { WeaponRegularInfo } from '#src/../../lib/parsing/combine'\nimport { arrSimpleUniq, toggleInArr } from '#src/../../lib/utils/collections'\nimport { apiGetWeapons } from '#src/api/endpoints'\nimport { MobileDesktopSwitch } from '#src/components/mobile-desc-switch'\nimport { Spinner } from '#src/components/placeholders'\nimport { WeaponTypeFilter } from '#src/components/weapon-type-filter'\nimport { WeaponCardTableRow } from '#src/containers/item-cards/line-cards/weapon-card'\nimport {\n\tI18N_NAME,\n\tI18N_NOTHING_TO_SHOW,\n\tI18N_OBTAIN_SOURCES,\n\tI18N_RARITY,\n\tI18N_SECONDARY_STAT,\n\tI18N_SORT_BY,\n\tI18N_STAT_NAME,\n\tI18N_SUBSTAT,\n\tI18N_WEAPON_OBTAIN_SOURCE_NAME,\n\tI18N_WEAPON_TYPE,\n\tI18N_WEAPON_TYPE_FILTER_TIP,\n} from '#src/i18n/i18n'\nimport { isLoaded, useFetch, useHashValue, useUniqKey } from '#src/utils/hooks'\nimport { WEAPON_ROW_CARD_HASH_KEY } from './common'\n\nconst WEAPON_SORT_CODES = ['rarity', 'atk', 'subStat']\nconst WEAPON_SORT_NAMES = { rarity: I18N_RARITY, atk: I18N_STAT_NAME('atk'), subStat: I18N_SUBSTAT }\nconst WEAPON_SORT_FUNCS = {\n\trarity: (a: WeaponRegularInfo, b: WeaponRegularInfo) => {\n\t\treturn b.rarity - a.rarity\n\t},\n\tatk: (a: WeaponRegularInfo, b: WeaponRegularInfo) => {\n\t\treturn b.atk.max - a.atk.max\n\t},\n\tsubStat: (a: WeaponRegularInfo, b: WeaponRegularInfo) => {\n\t\treturn (b.subStat ? b.subStat.max : 0) - (a.subStat ? a.subStat.max : 0)\n\t},\n}\nfunction WeaponSort({\n\tselectedSortCode,\n\tonSortCodeSelect,\n\tclasses = '',\n}: {\n\tselectedSortCode: string\n\tonSortCodeSelect: (typeCode: string) => unknown\n\tclasses?: string\n}): JSX.Element {\n\tconst key = useUniqKey()\n\treturn (\n\t\t<div className={classes}>\n\t\t\t{WEAPON_SORT_CODES.map(c => (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"form-check form-check-inline c-pointer  pe-1\"\n\t\t\t\t\tkey={c}\n\t\t\t\t\tonClick={() => onSortCodeSelect(c)}\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"form-check-input c-pointer\"\n\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\tname={`inlineRadioOptions-${key}`}\n\t\t\t\t\t\tid={`radio-${c}-${key}`}\n\t\t\t\t\t\tchecked={selectedSortCode === c}\n\t\t\t\t\t/>\n\t\t\t\t\t<label className=\"form-check-label c-pointer text-lowercase\" for={`radio-${c}-${key}`}>\n\t\t\t\t\t\t{WEAPON_SORT_NAMES[c]}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\ntype ObtainSourceForFilter = GI_WeaponObtainSource | 'other'\nconst WEAPON_FILTER_OBTAIN_SOURCE: ObtainSourceForFilter[] = [\n\t'wishes',\n\t'event-wishes',\n\t'events',\n\t'battle-pass',\n\t'in-game-shop',\n\t'forging',\n\t'other',\n]\ntype FilterOption<T> = { code: T; title: string }\n\nfunction WeaponFilter<T>({\n\tselectedSortCodes,\n\tonFilterCodeSelect,\n\tfilterVariants,\n\tclasses = '',\n}: {\n\tselectedSortCodes: T[]\n\tonFilterCodeSelect: (newSelectedCodes: T[]) => unknown\n\tfilterVariants: FilterOption<T>[]\n\tclasses?: string\n}): JSX.Element {\n\tconst key = useUniqKey()\n\treturn (\n\t\t<div className={classes}>\n\t\t\t{filterVariants.map(v => (\n\t\t\t\t<div className=\"form-check form-switch form-check-inline pe-1\" key={v.code}>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclassName=\"form-check-input c-pointer\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\trole=\"switch\"\n\t\t\t\t\t\tid={`flexSwitch-${v.code}-${key}`}\n\t\t\t\t\t\tchecked={selectedSortCodes.includes(v.code)}\n\t\t\t\t\t\tonChange={() => onFilterCodeSelect(toggleInArr([...selectedSortCodes], v.code))}\n\t\t\t\t\t/>\n\t\t\t\t\t<label className=\"form-check-label c-pointer\" for={`flexSwitch-${v.code}-${key}`}>\n\t\t\t\t\t\t{v.title}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\nexport function WeaponsList() {\n\tconst [selectedWeaponTypeCode, setSelectedWeaponTypeCode] = useState<null | GI_WeaponTypeCode>(null)\n\tconst selectWeaponTypeCode = code =>\n\t\tsetSelectedWeaponTypeCode(selectedWeaponTypeCode === code ? null : code)\n\n\tconst [selectedSortCode, setSelectedSortCode] = useState<string>(WEAPON_SORT_CODES[0])\n\tconst [selectedWeaponCode] = useHashValue(WEAPON_ROW_CARD_HASH_KEY, null)\n\tconst [selectedObtainSourceCodes, setSelectedObtainSourceCodes] =\n\t\tuseState<ObtainSourceForFilter[]>(WEAPON_FILTER_OBTAIN_SOURCE)\n\n\tconst weapons = useFetch(apiGetWeapons, [])\n\tconst otherObtainSourceCodes = useMemo(() => {\n\t\tif (!isLoaded(weapons)) return []\n\t\tconst scs = weapons\n\t\t\t.reduce((p, c) => {\n\t\t\t\tp.push(c.obtainSources)\n\t\t\t\treturn p\n\t\t\t}, [] as GI_WeaponObtainSource[][])\n\t\t\t.flat()\n\t\treturn arrSimpleUniq(scs).filter(sc => !WEAPON_FILTER_OBTAIN_SOURCE.includes(sc))\n\t}, [weapons])\n\tconst weaponsFilteredSorted = useMemo(() => {\n\t\tif (!isLoaded(weapons)) return []\n\t\tconst weaponsLocal = weapons.filter(w => {\n\t\t\treturn (\n\t\t\t\t(selectedWeaponTypeCode ? w.typeCode === selectedWeaponTypeCode : true) && // \n\t\t\t\t(w.obtainSources.find(s => selectedObtainSourceCodes.includes(s)) || //  \n\t\t\t\t\t(selectedObtainSourceCodes.includes('other')\n\t\t\t\t\t\t? w.obtainSources.find(s => otherObtainSourceCodes.includes(s))\n\t\t\t\t\t\t: false)) //   \n\t\t\t)\n\t\t})\n\t\tweaponsLocal.sort(WEAPON_SORT_FUNCS[selectedSortCode])\n\t\treturn weaponsLocal\n\t}, [weapons, selectedWeaponTypeCode, selectedSortCode, selectedObtainSourceCodes, otherObtainSourceCodes])\n\tif (!isLoaded(weapons)) return <Spinner />\n\treturn (\n\t\t<>\n\t\t\t<div className=\"mb-2\">\n\t\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_OBTAIN_SOURCES}:</label>\n\t\t\t\t<WeaponFilter\n\t\t\t\t\tclasses=\"ms-1\"\n\t\t\t\t\tselectedSortCodes={selectedObtainSourceCodes}\n\t\t\t\t\tonFilterCodeSelect={setSelectedObtainSourceCodes}\n\t\t\t\t\tfilterVariants={WEAPON_FILTER_OBTAIN_SOURCE.map(s => {\n\t\t\t\t\t\treturn { code: s, title: I18N_WEAPON_OBTAIN_SOURCE_NAME(s) }\n\t\t\t\t\t})}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"mb-2\">\n\t\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_SORT_BY}:</label>\n\t\t\t\t<WeaponSort\n\t\t\t\t\tclasses=\"ms-1\"\n\t\t\t\t\tselectedSortCode={selectedSortCode}\n\t\t\t\t\tonSortCodeSelect={setSelectedSortCode}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className=\"mb-2\">\n\t\t\t\t<label className=\"opacity-75 pe-2 align-middle py-1\">{I18N_WEAPON_TYPE}:</label>\n\t\t\t\t<div className=\"d-flex align-items-center\">\n\t\t\t\t\t<WeaponTypeFilter\n\t\t\t\t\t\tselectedWeaponTypeCode={selectedWeaponTypeCode}\n\t\t\t\t\t\tonTypeCodeSelect={selectWeaponTypeCode}\n\t\t\t\t\t/>\n\t\t\t\t\t<label className=\"text-muted\">{`${\n\t\t\t\t\t\tselectedWeaponTypeCode\n\t\t\t\t\t\t\t? I18N_WEAPON_TYPE_FILTER_TIP[selectedWeaponTypeCode]\n\t\t\t\t\t\t\t: I18N_WEAPON_TYPE_FILTER_TIP.everything\n\t\t\t\t\t} (${weaponsFilteredSorted.length})`}</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<table className=\"table table-sm\">\n\t\t\t\t<thead className=\"bg-dark\">\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_NAME}</th>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_STAT_NAME('atk')}</th>\n\t\t\t\t\t\t<th scope=\"col\">{I18N_SUBSTAT}</th>\n\t\t\t\t\t\t<MobileDesktopSwitch\n\t\t\t\t\t\t\tchildrenDesktop={<th scope=\"col\">{I18N_SECONDARY_STAT}</th>}\n\t\t\t\t\t\t\tchildrenMobile={null}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<th scope=\"col\"></th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{isLoaded(weapons)\n\t\t\t\t\t\t? weaponsFilteredSorted.map((w, i) => (\n\t\t\t\t\t\t\t\t<WeaponCardTableRow\n\t\t\t\t\t\t\t\t\tweapon={w}\n\t\t\t\t\t\t\t\t\tkey={w.code}\n\t\t\t\t\t\t\t\t\tgroup={i % 2}\n\t\t\t\t\t\t\t\t\tisExpanded={w.code === selectedWeaponCode}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t  ))\n\t\t\t\t\t\t: null}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t\t{isLoaded(weapons) && !weaponsFilteredSorted.length && (\n\t\t\t\t<div className=\"text-center text-muted fst-italic small\">{I18N_NOTHING_TO_SHOW}</div>\n\t\t\t)}\n\t\t</>\n\t)\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { LightBtnTabGroup, Tabs } from '#src/components/tabs'\nimport {\n\tI18N_ARTIFACTS,\n\tI18N_CHAR_EQUIPMENT,\n\tI18N_EQUIPMENT_PAGE_DESCRIPTION,\n\tI18N_PAGE_TITLE_POSTFIX,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport { useDocumentTitle, usePageDescription } from '#src/utils/hooks'\nimport { ArtifactsList } from './artifacts-list'\nimport { WeaponsList } from './weapons-list'\n\nconst cats = [\n\t{ title: I18N_WEAPONS, code: 'weapons', href: '/weapons' },\n\t{ title: I18N_ARTIFACTS, code: 'artifacts', href: '/artifacts' },\n]\n\nexport function Equipment({ code }: { code: 'weapons' | 'artifacts' }) {\n\tconst selectedCat = useMemo(() => cats.find(c => c.code === code) || cats[0], [code])\n\n\tuseDocumentTitle(selectedCat.title + I18N_PAGE_TITLE_POSTFIX)\n\n\tusePageDescription(() => I18N_EQUIPMENT_PAGE_DESCRIPTION(code))\n\n\treturn (\n\t\t<div className=\"equipment container\">\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">{I18N_CHAR_EQUIPMENT}</h1>\n\t\t\t<div className=\"d-none d-xl-flex\">\n\t\t\t\t<Tabs classes=\"w-100 mt-3\" tabs={cats} selectedTab={selectedCat} />\n\t\t\t</div>\n\t\t\t<div className=\"d-block d-xl-none\">\n\t\t\t\t<LightBtnTabGroup\n\t\t\t\t\ttabs={cats}\n\t\t\t\t\tselectedTab={selectedCat}\n\t\t\t\t\tclasses=\"w-100 mt-3 mb-2 btn-group-sm\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t{code === 'weapons' ? <WeaponsList /> : <ArtifactsList />}\n\t\t</div>\n\t)\n}\n","import { useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState } from 'preact/hooks'\n\nimport { useBuildWithDelayedLocs } from '#src/api'\nimport { BlockHeader } from '#src/components/block-header'\nimport { WeaponCard } from '#src/containers/item-cards/dd-cards'\nimport { LabeledItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport {\n\tI18N_ARTIFACTS,\n\tI18N_BEST_CHAR_BUILDS,\n\tI18N_CONJUCTIONS,\n\tI18N_FOR_EXAMPLE,\n\tI18N_MORE_ON_BUILDS_PAGE,\n\tI18N_WEAPON_REFINE,\n\tI18N_WEAPON_STACKS_COUNT,\n\tI18N_WEAPONS,\n} from '#src/i18n/i18n'\nimport {\n\tgenArtifactAdvice,\n\tgenNotes,\n\tgenSeeCharNotes,\n\tItemsJoinerWrap,\n\tItemsListGroupWrap,\n} from '#src/modules/builds/common'\nimport { A } from '#src/routes/router'\nimport { isLoaded, useVersionedStorage, useWindowSize, WindowSize } from '#src/utils/hooks'\nimport { SV_ARE_GREETINGS_VISIBLE } from '#src/utils/local-storage-keys'\nimport { getWeaponIconSrc } from '#src/utils/weapons'\n\nimport dmg0 from './img/dmg_0.webp'\nimport dmg1 from './img/dmg_1.webp'\nimport dmg2 from './img/dmg_2.webp'\nimport dmg3 from './img/dmg_3.webp'\nimport './greetings.scss'\n\nconst yaeCode = 'yae-miko'\nconst damages: string[] = [dmg0, dmg1, dmg2, dmg3]\n\nfunction updateEl(\n\tcoords: { x: number; y: number },\n\twindowSize: WindowSize,\n\tel: HTMLDivElement | HTMLImageElement,\n\tsensX: number,\n\tsensY?: number,\n) {\n\tif (!el) return\n\tconst gSens = 0.1\n\tel.style.transform = `translate(${(coords.x - (windowSize.width || 0) / 2) * sensX * gSens}px, ${\n\t\t(coords.y - (windowSize.height || 0) / 2) * (sensY === undefined ? sensX : sensY) * gSens\n\t}px)`\n}\n\nexport function Greetings({\n\tclasses = '',\n\tisClosable,\n\tisHiddenOnMobile,\n}: {\n\tclasses?: string\n\tisClosable: boolean\n\tisHiddenOnMobile?: boolean\n}): JSX.Element | null {\n\tconst [areGreetingsVisible, setAreGreetingsVisible] = useVersionedStorage(SV_ARE_GREETINGS_VISIBLE)\n\tconst areCurrentlyVisible = areGreetingsVisible || !isClosable\n\tconst hiddenOnMobileClass = isHiddenOnMobile ? 'd-none d-lg-block' : ''\n\n\tconst wrapRef = useRef<HTMLDivElement>(null)\n\tconst bgRef = useRef<HTMLDivElement>(null)\n\tconst mikoRef = useRef<HTMLDivElement>(null)\n\tconst damagesRef = useRef<HTMLImageElement[]>([])\n\tconst windowSize = useWindowSize()\n\tconst [mikoName, setMikoName] = useState<string | null>(null)\n\n\tconst closeGreetings = useCallback(() => {\n\t\tsetAreGreetingsVisible(false)\n\t}, [setAreGreetingsVisible])\n\n\tconst openGreetings = useCallback(() => {\n\t\tsetAreGreetingsVisible(true)\n\t}, [setAreGreetingsVisible])\n\n\tuseEffect(() => {\n\t\tif (!areCurrentlyVisible) return\n\t\tfunction moveElems(e: MouseEvent) {\n\t\t\tif (!windowSize.width) return\n\t\t\tconst coords = { x: e.clientX, y: e.clientY }\n\t\t\tif (bgRef.current) updateEl(coords, windowSize, bgRef.current, 0.1)\n\t\t\tif (mikoRef.current) updateEl(coords, windowSize, mikoRef.current, 0.3, 0)\n\t\t\tif (damagesRef.current)\n\t\t\t\tdamagesRef.current.forEach((dr, i) => updateEl(coords, windowSize, dr, 0.3 + i * 0.3))\n\t\t}\n\t\taddEventListener('mousemove', moveElems, { passive: true })\n\t\treturn () => {\n\t\t\tremoveEventListener('mousemove', moveElems)\n\t\t}\n\t}, [windowSize, areCurrentlyVisible])\n\n\tuseLayoutEffect(() => {\n\t\tif (wrapRef.current) wrapRef.current.style.height = wrapRef.current.offsetWidth / 2 + 'px'\n\t}, [wrapRef, windowSize, areCurrentlyVisible])\n\n\t/*\n\t    ,\n\t,    ,  -  -   , \n\t    \n\t*/\n\n\tif (!areCurrentlyVisible)\n\t\treturn (\n\t\t\t<div className={`greetings-omamori position-relative ${hiddenOnMobileClass}`} key=\"omamori\">\n\t\t\t\t<div className=\"omamori-wrap position-absolute end-0 c-pointer\" onClick={openGreetings}>\n\t\t\t\t\t<img src=\"https://i.imgur.com/VlUoqjo.png\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\treturn (\n\t\t<div\n\t\t\tclassName={`greetings w-100 position-relative rounded-1 ${classes} ${hiddenOnMobileClass}`}\n\t\t\tref={wrapRef}\n\t\t\tkey=\"greetings\"\n\t\t>\n\t\t\t<div className=\"bg\" ref={bgRef}></div>\n\t\t\t<div className=\"damages-wrap\">\n\t\t\t\t{damages.map((d, i) => (\n\t\t\t\t\t<img\n\t\t\t\t\t\tclassName=\"damage-text\"\n\t\t\t\t\t\tsrc={d}\n\t\t\t\t\t\tkey={d}\n\t\t\t\t\t\tref={el => (damagesRef.current[i] = el as HTMLImageElement)}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t\t<div className=\"miko\" ref={mikoRef}></div>\n\t\t\t<BuildInfo updateName={setMikoName} />\n\t\t\t<h2 className=\"position-relative fw-bolder fst-italic my-2 text-center\">\n\t\t\t\t{I18N_BEST_CHAR_BUILDS}\n\t\t\t</h2>\n\t\t\t<h4 className=\"position-relative text-center\">{I18N_FOR_EXAMPLE}</h4>\n\t\t\t<div className=\"build-owner position-absolute bottom-0 start-0 py-2 px-3 rounded-top not-rounded-start\">\n\t\t\t\t<span className=\"fs-2\">{mikoName}</span>\n\t\t\t\t<br />\n\t\t\t\t<A className=\"link-danger\" href={`/builds/` + yaeCode}>\n\t\t\t\t\t{I18N_MORE_ON_BUILDS_PAGE}\n\t\t\t\t</A>\n\t\t\t</div>\n\t\t\t{isClosable && (\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tclass=\"btn-close btn-sm position-absolute end-0 top-0 m-3\"\n\t\t\t\t\taria-label=\"Close\"\n\t\t\t\t\tonClick={closeGreetings}\n\t\t\t\t></button>\n\t\t\t)}\n\t\t</div>\n\t)\n}\n\nfunction BuildInfo({ updateName }: { updateName: (name: string) => void }): JSX.Element {\n\tconst [build] = useBuildWithDelayedLocs(yaeCode)\n\n\tconst weaponListBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return []\n\t\tconst role = build.character.roles[0]\n\t\tif (!role) return []\n\t\treturn (\n\t\t\t<ol className=\"mb-0 pb-2\">\n\t\t\t\t{role.weapons.advices.map((advice, i) => {\n\t\t\t\t\tconst isInList = advice.similar.length > 1\n\t\t\t\t\tconst map = advice.similar.map((item, i) => {\n\t\t\t\t\t\tconst weapon = build.weapons.find(x => x.code === item.code)\n\t\t\t\t\t\tif (!weapon) return null\n\t\t\t\t\t\tconst isLastInList = i >= advice.similar.length - 1\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<LabeledItemAvatar\n\t\t\t\t\t\t\t\t\timgSrc={getWeaponIconSrc(weapon.code)}\n\t\t\t\t\t\t\t\t\ttitle={\n\t\t\t\t\t\t\t\t\t\tweapon.name +\n\t\t\t\t\t\t\t\t\t\t(item.refine === null\n\t\t\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t\t\t: ` [${I18N_WEAPON_REFINE(item.refine)}]`) +\n\t\t\t\t\t\t\t\t\t\t(item.stacks === null\n\t\t\t\t\t\t\t\t\t\t\t? ''\n\t\t\t\t\t\t\t\t\t\t\t: ` (${I18N_WEAPON_STACKS_COUNT(item.stacks)})`)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trarity={weapon.rarity}\n\t\t\t\t\t\t\t\t\tavatarClasses=\"with-padding\"\n\t\t\t\t\t\t\t\t\tclasses={`small ${!isInList || isLastInList ? 'mb-1' : ''}`}\n\t\t\t\t\t\t\t\t\tddComponent={<WeaponCard weapon={weapon} related={build.maps} />}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{genNotes(item)}\n\t\t\t\t\t\t\t\t{genSeeCharNotes(item)}\n\t\t\t\t\t\t\t\t{isInList && !isLastInList && (\n\t\t\t\t\t\t\t\t\t<ItemsJoinerWrap>{I18N_CONJUCTIONS.or}</ItemsJoinerWrap>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)\n\t\t\t\t\t})\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t\t\t{isInList ? <ItemsListGroupWrap>{map}</ItemsListGroupWrap> : map}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t</ol>\n\t\t)\n\t}, [build])\n\tuseEffect(() => {\n\t\tisLoaded(build) && updateName(build.character.name)\n\t}, [build, updateName])\n\tconst artifactsListBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return []\n\t\tconst role = build.character.roles[0]\n\t\tif (!role) return []\n\t\tconst listTimit = 10\n\t\treturn (\n\t\t\t<ol className=\"mb-0 rounded-top not-rounded-end pb-2\">\n\t\t\t\t{role.artifacts.sets.map((set, i) => {\n\t\t\t\t\tif (i > listTimit) return\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={i} className=\"pt-2\">\n\t\t\t\t\t\t\t{genArtifactAdvice(set.arts, build, false)}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t\t{role.artifacts.sets.length > listTimit ? (\n\t\t\t\t\t<li className=\"pt-2\">\n\t\t\t\t\t\t<A className=\"link-secondary text-muted small\" href={`/builds/` + yaeCode}>\n\t\t\t\t\t\t\t{I18N_MORE_ON_BUILDS_PAGE}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</li>\n\t\t\t\t) : null}\n\t\t\t</ol>\n\t\t)\n\t}, [build])\n\n\treturn (\n\t\t<div className=\"build-info d-flex align-items-end\">\n\t\t\t<div className=\"recs-wrap position-relative\">\n\t\t\t\t<label className=\"arrow position-absolute start-50\">\n\t\t\t\t\t<span></span>\n\t\t\t\t</label>\n\t\t\t\t<BlockHeader classes=\"mt-3 mx-2 mb-1\">{I18N_ARTIFACTS}</BlockHeader>\n\t\t\t\t{artifactsListBlock}\n\t\t\t</div>\n\t\t\t<div className=\"recs-wrap position-relative\">\n\t\t\t\t<label className=\"arrow position-absolute start-50\">\n\t\t\t\t\t<span></span>\n\t\t\t\t</label>\n\t\t\t\t<BlockHeader classes=\"mt-3 mx-2 mb-1\">{I18N_WEAPONS}</BlockHeader>\n\t\t\t\t{weaponListBlock}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { useMemo } from 'preact/hooks'\n\nimport { getRegionTime, GI_ROTATION_WEEKDAY_CODES } from '#lib/genshin'\nimport { arrGetAfter } from '#lib/utils/collections'\nimport { mustBeDefined } from '#src/../../lib/utils/values'\nimport { apiMaterialsTimetable } from '#src/api/endpoints'\nimport { Spinner } from '#src/components/placeholders'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport {\n\tI18N_DUNGEONS,\n\tI18N_TALENTS,\n\tI18N_TODAY,\n\tI18N_TOMORROW,\n\tI18N_WEAPONS,\n\tI18N_WEEKDAYS,\n\tI18N_WHY_ADD_TO_FAVS_TIP,\n} from '#src/i18n/i18n'\nimport { isLoaded, useFetch, useForceUpdate, useVersionedStorage, useVisibleTicker } from '#src/utils/hooks'\nimport { getItemIconLargeSrc, getItemIconSrc } from '#src/utils/items'\nimport {\n\tSV_FAV_CHAR_CODES,\n\tSV_FAV_TALENT_MATERIAL_CODES,\n\tSV_FAV_WEAPON_PRIMARY_MATERIAL_CODES,\n\tSV_SELECTED_REGION_CODE,\n} from '#src/utils/local-storage-keys'\nimport { BULLET, HEART } from '#src/utils/typography'\nimport { OtherItemCard } from './item-cards/dd-cards'\nimport { CharacterAvatar, ItemAvatar } from './item-cards/item-avatars'\n\nimport './farm-today.scss'\n\nexport function FarmToday({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst ttData = useFetch(apiMaterialsTimetable, [])\n\tconst [selectedRegionCode] = useVersionedStorage(SV_SELECTED_REGION_CODE)\n\tconst { weekdayMonSun, weekdayCode } = getRegionTime(selectedRegionCode)\n\tconst tomorrowCode = arrGetAfter(GI_ROTATION_WEEKDAY_CODES, weekdayCode)\n\tconst [favCharCodes] = useVersionedStorage(SV_FAV_CHAR_CODES)\n\tconst [favTalMaterialCodes] = useVersionedStorage(SV_FAV_TALENT_MATERIAL_CODES)\n\t// const [favWeaponDatas] = useLocalStorage<STORAGE_WEAPON_DATA[]>(SK_FAV_WEAPON_DATAS, [])\n\t// const favWeapMatCodes = useMemo(() => [...favWeaponDatas.map(wd => wd[1])], [favWeaponDatas])\n\tconst [favWeapPrimMatCodes] = useVersionedStorage(SV_FAV_WEAPON_PRIMARY_MATERIAL_CODES)\n\tconst forceUpdate = useForceUpdate()\n\tuseVisibleTicker(() => {\n\t\tforceUpdate()\n\t}, 60 * 1000)\n\tconst tabs = useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\tcode: weekdayCode,\n\t\t\t\ttitle: `${I18N_WEEKDAYS[weekdayMonSun]}, ${I18N_TODAY}`,\n\t\t\t},\n\t\t\t{ code: tomorrowCode, title: I18N_TOMORROW },\n\t\t],\n\t\t[weekdayCode, tomorrowCode, weekdayMonSun],\n\t)\n\tconst [selectedTab, setSelectedTab] = useSelectable(tabs, [selectedRegionCode])\n\n\treturn (\n\t\t<div className={`farm-today ${classes}`}>\n\t\t\t{!BUNDLE_ENV.IS_SSR && (\n\t\t\t\t<>\n\t\t\t\t\t<div className=\"d-none d-xl-flex\">\n\t\t\t\t\t\t<h5 className=\"py-2 m-0 me-2 d-block \">{I18N_DUNGEONS}</h5>\n\t\t\t\t\t\t<Tabs\n\t\t\t\t\t\t\ttabs={tabs}\n\t\t\t\t\t\t\tselectedTab={selectedTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedTab}\n\t\t\t\t\t\t\tclasses=\"mb-2 flex-grow-1\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"d-block d-xl-none\">\n\t\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\t\ttabs={tabs}\n\t\t\t\t\t\t\tselectedTab={selectedTab}\n\t\t\t\t\t\t\tonTabSelect={setSelectedTab}\n\t\t\t\t\t\t\tclasses=\"w-100 mb-2 btn-group-sm\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t)}\n\t\t\t{isLoaded(ttData) && !BUNDLE_ENV.IS_SSR ? (\n\t\t\t\t<>\n\t\t\t\t\t<h6 className=\"opacity-75 text-capitalize\">{I18N_TALENTS}</h6>\n\t\t\t\t\t<div className=\"talents-wrap pt-1\">\n\t\t\t\t\t\t{ttData.timetable[selectedTab.code].characterAscensions.map(asc => (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<div className=\"mb-3 ps-2 ms-1 d-flex align-items-center\" key={asc.itemCode}>\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\t\t\t\tsrc={getItemIconLargeSrc(asc.itemCode)}\n\t\t\t\t\t\t\t\t\t\t\tclasses=\"me-2 vertical-align-middle\"\n\t\t\t\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t\t\t\t~favTalMaterialCodes.indexOf(asc.itemCode) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger opacity-75\">{HEART}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tddComponent={\n\t\t\t\t\t\t\t\t\t\t\t\t<OtherItemCard\n\t\t\t\t\t\t\t\t\t\t\t\t\titem={mustBeDefined(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tttData.items.find(i => i.code === asc.itemCode),\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\trelated={ttData.maps}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t// for PurgeCSS: color-sumeru color-inazuma color-liyue color-mondstadt\n\t\t\t\t\t\t\t\t\t\tclassName={`color-${asc.itemRegion} me-1 fs-1 position-relative`}\n\t\t\t\t\t\t\t\t\t\tstyle={{ lineHeight: 0, top: '-4px' }}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{BULLET}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"d-flex flex-wrap align-self-center pt-2\">\n\t\t\t\t\t\t\t\t\t\t{asc.characterCodes.map(c => (\n\t\t\t\t\t\t\t\t\t\t\t<CharacterAvatar\n\t\t\t\t\t\t\t\t\t\t\t\tkey={c}\n\t\t\t\t\t\t\t\t\t\t\t\tcode={c}\n\t\t\t\t\t\t\t\t\t\t\t\thref={'/builds/' + c}\n\t\t\t\t\t\t\t\t\t\t\t\tclasses={`small-avatar mb-2 me-2 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t~favCharCodes.indexOf(c) ? 'order-1' : 'order-2'\n\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t\t\t\t\t~favCharCodes.indexOf(c) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger opacity-75\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{HEART}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<h6 class=\"opacity-75 text-capitalize\">{I18N_WEAPONS}</h6>\n\t\t\t\t\t<div className=\"ps-2 ms-1\">\n\t\t\t\t\t\t{ttData.timetable[selectedTab.code].weaponMaterialCodes.map(code => (\n\t\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\t\tkey={code}\n\t\t\t\t\t\t\t\tsrc={getItemIconSrc(code)}\n\t\t\t\t\t\t\t\tclasses=\"small-avatar me-3 with-padding\"\n\t\t\t\t\t\t\t\tbadgeTopStart={\n\t\t\t\t\t\t\t\t\t~favWeapPrimMatCodes.indexOf(code) ? (\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-danger opacity-75\">{HEART}</span>\n\t\t\t\t\t\t\t\t\t) : null\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tddComponent={\n\t\t\t\t\t\t\t\t\t<OtherItemCard\n\t\t\t\t\t\t\t\t\t\titem={mustBeDefined(ttData.items.find(i => i.code === code))}\n\t\t\t\t\t\t\t\t\t\trelated={ttData.maps}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t\t<div className=\"text-muted small text-center px-2 mx-1 py-3\">{I18N_WHY_ADD_TO_FAVS_TIP}</div>\n\t\t</div>\n\t)\n}\n","import { useCallback, useMemo } from 'preact/hooks'\n\nimport { GI_ServerRegionCode } from '#src/../../lib/genshin'\nimport { SimpleSelect } from '#src/components/select'\nimport { I18N_ASIA, I18N_EUROPE, I18N_NORH_AMERICA } from '#src/i18n/i18n'\nimport { useVersionedStorage } from '#src/utils/hooks'\nimport { SV_SELECTED_REGION_CODE } from '#src/utils/local-storage-keys'\n\ntype Opt = { title: string; code: GI_ServerRegionCode }\nconst europeOpt: Opt = { title: I18N_EUROPE, code: 'europe' }\nconst options: Opt[] = [\n\teuropeOpt,\n\t{ title: I18N_ASIA, code: 'asia' },\n\t{ title: I18N_NORH_AMERICA, code: 'north-america' },\n]\n\nexport function RegionSwitch({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedRegionCode, setSelectedRegionCode] = useVersionedStorage(SV_SELECTED_REGION_CODE)\n\tconst selectedOption = useMemo(\n\t\t() => options.find(o => o.code === selectedRegionCode) || europeOpt,\n\t\t[selectedRegionCode],\n\t)\n\tconst onOptSelectLocal = useCallback(o => setSelectedRegionCode(o.code), [setSelectedRegionCode])\n\treturn (\n\t\t<SimpleSelect options={options} selectedOption={selectedOption} onOptionSelect={onOptSelectLocal} />\n\t)\n}\n","import { getRegionTime } from '#lib/genshin'\nimport { I18N_MS_TO_HM_WORDS } from '#src/i18n/i18n'\nimport { useForceUpdate, useVersionedStorage, useVisibleTicker } from '#src/utils/hooks'\nimport { SV_SELECTED_REGION_CODE } from '#src/utils/local-storage-keys'\nimport { BULLET, ELLIPSIS } from '#src/utils/typography'\n\nexport function TimeUntilDayReset({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedRegionCode] = useVersionedStorage(SV_SELECTED_REGION_CODE)\n\tconst { resetIn } = getRegionTime(selectedRegionCode)\n\tconst forceUpdate = useForceUpdate()\n\tuseVisibleTicker(() => {\n\t\tforceUpdate()\n\t}, 60 * 1000)\n\treturn (\n\t\t<div className={`time-until-day-reset ${classes}`}>\n\t\t\t{BUNDLE_ENV.IS_SSR ? ELLIPSIS : I18N_MS_TO_HM_WORDS(resetIn)}\n\t\t\t<span className=\"animation-time-glow ps-1\">{BULLET}</span>\n\t\t</div>\n\t)\n}\n","import { useMemo, useState } from 'preact/hooks'\n\nimport { arrOrItemToArr } from '#src/../../lib/utils/collections'\nimport { useBuildWithDelayedLocs } from '#src/api'\nimport { getAllRelated } from '#src/api/utils'\nimport { CentredSpinner, Spinner } from '#src/components/placeholders'\nimport { BtnTabGroup, Tabs, useSelectable } from '#src/components/tabs'\nimport { FavoriteCharacters } from '#src/containers/character-picker/favorite-characters'\nimport { OtherItemCard } from '#src/containers/item-cards/dd-cards'\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\nimport {\n\tI18N_ART_STATS_PRIORITY,\n\tI18N_ARTIFACTS,\n\tI18N_ASC_MATERIALS,\n\tI18N_CHOOSE_FROM_FAV,\n\tI18N_FULL_BUILD_INFO,\n\tI18N_MORE_ON_BUILDS_PAGE,\n\tI18N_STAT_NAME,\n\tI18N_SUBSTATS_PRIORITY,\n\tI18N_TALENT_NAME,\n\tI18N_TALENTS_PRIORITY,\n} from '#src/i18n/i18n'\nimport { A } from '#src/routes/router'\nimport { getArtifactTypeIconSrc } from '#src/utils/artifacts'\nimport { isLoaded } from '#src/utils/hooks'\nimport { getItemIconSrc } from '#src/utils/items'\nimport {\n\tBuildRoleOrDummy,\n\tCIRCLET_GOBLET_SANDS,\n\tDUMMY_ROLES,\n\tgenArtifactAdvice,\n\tgenArtMainStatDetail,\n\tgenSimpleList,\n\tgetRoleData,\n\tmakeRoleTitle,\n} from './common'\n\nimport './character-build-preview.scss'\n\nfunction CharacterBuildPreview({ characterCode }: { characterCode: string }): JSX.Element {\n\tconst [build, isUpdating] = useBuildWithDelayedLocs(characterCode)\n\tconst displayingCharacterCode = isLoaded(build) ? build.character.code : characterCode\n\tconst roleTabs: BuildRoleOrDummy[] = isLoaded(build) ? build.character.roles : DUMMY_ROLES\n\tconst [selectedRoleTab, setSelectedRoleTab] = useSelectable(roleTabs, [displayingCharacterCode])\n\n\tconst artifactsListBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return []\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\tif (!role) return []\n\t\tconst listTimit = 1\n\t\treturn (\n\t\t\t<ol>\n\t\t\t\t{role.artifacts.sets.map((set, i) => {\n\t\t\t\t\tif (i > listTimit) return\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<li key={i} className=\"pt-1\">\n\t\t\t\t\t\t\t{genArtifactAdvice(set.arts, build, false)}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t)\n\t\t\t\t})}\n\t\t\t\t{role.artifacts.sets.length > listTimit ? (\n\t\t\t\t\t<li className=\"pt-1\">\n\t\t\t\t\t\t<A className=\"link-secondary text-muted small\" href={`/builds/` + characterCode}>\n\t\t\t\t\t\t\t{I18N_MORE_ON_BUILDS_PAGE}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</li>\n\t\t\t\t) : null}\n\t\t\t</ol>\n\t\t)\n\t}, [characterCode, build, selectedRoleTab])\n\n\tconst artifactMainStatsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<ul className=\"mb-1 list-unstyled ms-1 pt-1 ps-1 small\">\n\t\t\t\t{CIRCLET_GOBLET_SANDS.map(ac => (\n\t\t\t\t\t<li className=\"my-1 ms-1\">\n\t\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\t\tsrc={getArtifactTypeIconSrc(ac)}\n\t\t\t\t\t\t\tisNoBg={true}\n\t\t\t\t\t\t\tclasses=\"small-avatar with-padding align-middle\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{genArtMainStatDetail(role, ac, true)}\n\t\t\t\t\t</li>\n\t\t\t\t))}\n\t\t\t</ul>\n\t\t)\n\t}, [build, selectedRoleTab])\n\tconst artifactSubStatsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<ol className=\"mb-1 pt-2 small\">\n\t\t\t\t{role.subStats.advices.map(advice => {\n\t\t\t\t\treturn <li>{genSimpleList(advice.codes.map(I18N_STAT_NAME))}</li>\n\t\t\t\t})}\n\t\t\t</ol>\n\t\t)\n\t}, [build, selectedRoleTab])\n\n\tconst talentsBlock = useMemo(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = getRoleData(build, selectedRoleTab.code)\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<ol className=\"small\">\n\t\t\t\t\t{role.talents.advices.map(advice => {\n\t\t\t\t\t\treturn <li>{arrOrItemToArr(advice).map(I18N_TALENT_NAME)}</li>\n\t\t\t\t\t})}\n\t\t\t\t</ol>\n\t\t\t</>\n\t\t)\n\t}, [build, selectedRoleTab])\n\n\tconst materialsBlock = useMemo(() => {\n\t\t//todo  \n\t\tif (!isLoaded(build)) return null\n\t\tconst materials = getAllRelated(build.maps.items, build.character.materialCodes)\n\t\treturn (\n\t\t\t<div className=\"d-flex justify-content-between flex-wrap px-2\">\n\t\t\t\t{materials.map(m => (\n\t\t\t\t\t<ItemAvatar\n\t\t\t\t\t\tclasses=\"mb-2 mx-1 small-avatar with-padding flex-shrink-0\"\n\t\t\t\t\t\tsrc={getItemIconSrc(m.code)}\n\t\t\t\t\t\tddComponent={<OtherItemCard item={m} related={build.maps} />}\n\t\t\t\t\t/>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t)\n\t}, [build])\n\tif (!isLoaded(build)) return <Spinner />\n\treturn (\n\t\t<div className=\"character-build-preview position-relative\">\n\t\t\t{/* <div className=\"d-none d-xl-block\">\n\t\t\t\t<CharacterPortrait src={getCharacterPortraitSrc(characterCode)} classes=\"w-100\" />\n\t\t\t</div>\n\t\t\t<div className=\"d-xl-none\">\n\t\t\t\t<CharacterPortrait\n\t\t\t\t\tsrc={getCharacterSilhouetteSrc(characterCode)}\n\t\t\t\t\tclasses=\"w-75 character-portrait-mobile\"\n\t\t\t\t/>\n\t\t\t</div> */}\n\t\t\t{isUpdating ? <CentredSpinner /> : null}\n\t\t\t<div className={isUpdating ? 'opacity-50 pe-none' : ''}>\n\t\t\t\t<div className=\"d-none d-xl-flex \">\n\t\t\t\t\t<h5 className=\"py-2 m-0 me-2 d-block \">{build.character.name}</h5>\n\t\t\t\t\t<Tabs\n\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\tclasses=\"mb-2 flex-grow-1\"\n\t\t\t\t\t\tkey={displayingCharacterCode}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"d-flex d-xl-none align-items-center\">\n\t\t\t\t\t<h5 className=\"mb-0 pt-2 me-2\">{build.character.name}</h5>\n\t\t\t\t\t<BtnTabGroup\n\t\t\t\t\t\ttabs={roleTabs}\n\t\t\t\t\t\ttitleFunc={makeRoleTitle}\n\t\t\t\t\t\tselectedTab={selectedRoleTab}\n\t\t\t\t\t\tonTabSelect={setSelectedRoleTab}\n\t\t\t\t\t\tclasses=\"w-100 mt-3 mb-2 btn-group-sm\"\n\t\t\t\t\t\tkey={displayingCharacterCode}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"row small gy-2\">\n\t\t\t\t\t<div className=\"col-lg-4 col-12\">\n\t\t\t\t\t\t<h6>{I18N_ARTIFACTS}</h6>\n\t\t\t\t\t\t<div>{artifactsListBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6>{I18N_ART_STATS_PRIORITY}</h6>\n\t\t\t\t\t\t<div className=\"opacity-75\">{artifactMainStatsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6>{I18N_SUBSTATS_PRIORITY}</h6>\n\t\t\t\t\t\t<div className=\"opacity-75\">{artifactSubStatsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-4 col-6\">\n\t\t\t\t\t\t<h6>{I18N_TALENTS_PRIORITY}</h6>\n\t\t\t\t\t\t<div className=\"opacity-75\">{talentsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-lg-8 col-6\">\n\t\t\t\t\t\t<h6>{I18N_ASC_MATERIALS}</h6>\n\t\t\t\t\t\t<div>{materialsBlock}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"col-12\">\n\t\t\t\t\t\t<A\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName=\"btn btn-link btn-sm w-100\"\n\t\t\t\t\t\t\thref={`/builds/` + characterCode}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{I18N_FULL_BUILD_INFO}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</div>\n\t\t\t\t\t{/* TODO */}\n\t\t\t\t\t{/* <div className=\"col-6\">\n\t\t\t\t\t\t<A type=\"button\" className=\"btn btn-link btn-sm w-100\">\n\t\t\t\t\t\t\t{I18N_CHAR_LORE}\n\t\t\t\t\t\t</A>\n\t\t\t\t\t</div> */}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\nexport function BuildsPreviewsWrap({ classes = '' }: { classes?: string }): JSX.Element {\n\tconst [selectedCharacterCode, setSelectedCharacterCode] = useState<string | undefined>(undefined)\n\treturn (\n\t\t<div className={`character-build-preview ${classes}`}>\n\t\t\t<FavoriteCharacters\n\t\t\t\tonCharacterSelect={setSelectedCharacterCode}\n\t\t\t\tshoudSelectFirst={!selectedCharacterCode}\n\t\t\t\tselectedCharacterCode={selectedCharacterCode}\n\t\t\t\tnavigateToCharacter={false}\n\t\t\t\tblockLabel={I18N_CHOOSE_FROM_FAV}\n\t\t\t\tclasses=\"mb-2\"\n\t\t\t/>\n\t\t\t{selectedCharacterCode ? (\n\t\t\t\t<CharacterBuildPreview characterCode={selectedCharacterCode} />\n\t\t\t) : (\n\t\t\t\t<Spinner />\n\t\t\t)}\n\t\t</div>\n\t)\n}\n","import { Greetings } from '#src/components/greetings'\nimport { AlchemyCalculator } from '#src/containers/alchemy-calculator'\nimport { FarmToday } from '#src/containers/farm-today'\nimport { RegionSwitch } from '#src/containers/region-switch'\nimport { TimeUntilDayReset } from '#src/containers/time-until-day-reset'\nimport {\n\tI18N_ALCHEMY_CALC,\n\tI18N_BUILDS,\n\tI18N_DASHBOARD,\n\tI18N_FRONT_PAGE_DESCRIPTION,\n\tI18N_PAGE_TITLE_POSTFIX,\n\tI18N_REGION,\n\tI18N_UNTIL_DAY_RESET,\n\tI18N_WHAT_TO_FARM,\n} from '#src/i18n/i18n'\nimport { BuildsPreviewsWrap } from '#src/modules/builds/character-build-preview'\nimport { useDocumentTitle, usePageDescription } from '#src/utils/hooks'\n\nfunction Fieldset({ children, legend, classes = '' }) {\n\treturn (\n\t\t<fieldset className={`my-2 ${classes}`}>\n\t\t\t<legend className=\"mb-2\">{legend}</legend>\n\t\t\t{children}\n\t\t</fieldset>\n\t)\n}\nexport function FrontPage(): JSX.Element {\n\tuseDocumentTitle(I18N_DASHBOARD + I18N_PAGE_TITLE_POSTFIX)\n\n\tusePageDescription(() => I18N_FRONT_PAGE_DESCRIPTION)\n\n\treturn (\n\t\t<div className=\"dashboard container \">\n\t\t\t<Greetings classes=\"mb-4 mt-2\" isHiddenOnMobile={true} isClosable={true} />\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">{I18N_DASHBOARD}</h1>\n\t\t\t<div className=\"row\">\n\t\t\t\t<Fieldset legend={I18N_REGION} classes=\"col-lg-3 col-12\">\n\t\t\t\t\t<RegionSwitch />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset legend={I18N_UNTIL_DAY_RESET} classes=\"col-lg-3 col-12\">\n\t\t\t\t\t<TimeUntilDayReset classes=\"fs-4 opacity-75\" />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset legend={I18N_ALCHEMY_CALC} classes=\"col-lg-6 col-12 \">\n\t\t\t\t\t<AlchemyCalculator />\n\t\t\t\t</Fieldset>\n\t\t\t</div>\n\t\t\t<div className=\"row\">\n\t\t\t\t<Fieldset classes=\"col-lg-6 col-12\" legend={I18N_WHAT_TO_FARM}>\n\t\t\t\t\t<FarmToday />\n\t\t\t\t</Fieldset>\n\t\t\t\t<Fieldset classes=\"col-lg-6 col-12\" legend={I18N_BUILDS}>\n\t\t\t\t\t<BuildsPreviewsWrap />\n\t\t\t\t</Fieldset>\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n","import { GoUpBtn } from './components/go-up-btn'\nimport { PageWrap } from './components/page-wrap'\nimport { Footer } from './containers/footer'\nimport { Header } from './containers/header'\nimport { AboutPage } from './pages/about'\nimport { BuildsPage_BuildDetail, BuildsPage_CharSelect } from './pages/builds'\nimport { ArtifactsPage, WeaponsPage } from './pages/equipment'\nimport { EverywherePage } from './pages/everywhere'\nimport { FrontPage } from './pages/front-page'\nimport { paths } from './routes/paths'\nimport { route, useRouter } from './routes/router'\n\nimport './App.scss'\nimport './animations.scss'\n\nconst routes = [\n\troute(paths.front, FrontPage),\n\troute(paths.builds, BuildsPage_CharSelect),\n\troute(paths.buildCharacters, BuildsPage_BuildDetail),\n\troute(paths.weapons, WeaponsPage),\n\troute(paths.artifacts, ArtifactsPage),\n\troute(paths.about, AboutPage),\n\troute(paths.everywhere, EverywherePage),\n]\n\nexport function App(): JSX.Element {\n\tconst page = useRouter(routes)\n\treturn (\n\t\t<div class=\"d-flex flex-column app-container\">\n\t\t\t<Header />\n\t\t\t<main>\n\t\t\t\t<PageWrap>{page}</PageWrap>\n\t\t\t</main>\n\t\t\t<Footer />\n\t\t\t<GoUpBtn />\n\t\t</div>\n\t)\n}\n","import { useEffect } from 'preact/hooks'\n\nimport { GI_RarityCode } from '#lib/genshin'\nimport { ArtifactRegularInfo, CharacterFullInfoWithRelated } from '#lib/parsing/combine'\nimport { CompactTextParagraphs, getInlineText, isParagraphArr } from '#lib/parsing/helperteam/text'\nimport { CharacterBuildInfoRole } from '#lib/parsing/helperteam/types'\nimport { useBuildWithDelayedLocs } from '#src/api'\nimport { MapAllByCode } from '#src/api/utils'\nimport { Spinner } from '#src/components/placeholders'\nimport { CharacterPicker } from '#src/containers/character-picker/character-picker'\nimport { FavoriteCharacters } from '#src/containers/character-picker/favorite-characters'\nimport {\n\tI18N_BUILD_RECS_FOR,\n\tI18N_BUILDS_PAGE_DESCRIPTION,\n\tI18N_CHAR_BUILD_RECS,\n\tI18N_CHARACTER_PAGE_DESCRIPTION,\n\tI18N_LOADING,\n\tI18N_PAGE_TITLE_POSTFIX,\n\tI18N_RECOMMENDED_RU_ONLY,\n\tI18N_SELECT_CHAR_BELOW,\n} from '#src/i18n/i18n'\nimport { CharacterBuildDetailed } from '#src/modules/builds/character-build-detailed'\nimport { isLoaded, useDocumentTitle, usePageDescription } from '#src/utils/hooks'\n\nexport function BuildsPage_CharSelect(): JSX.Element {\n\tuseDocumentTitle(I18N_CHAR_BUILD_RECS + I18N_PAGE_TITLE_POSTFIX)\n\n\tusePageDescription(() => I18N_BUILDS_PAGE_DESCRIPTION)\n\n\treturn (\n\t\t<div className=\"builds container\">\n\t\t\t<h1 className=\"my-1 letter-spacing-1\">{I18N_CHAR_BUILD_RECS}</h1>\n\t\t\t<h5 className=\"mt-2 mb-3 opacity-75\">{I18N_SELECT_CHAR_BELOW}</h5>\n\t\t\t<FavoriteCharacters navigateToCharacter={true} classes=\"mb-2\" />\n\t\t\t<CharacterPicker />\n\t\t</div>\n\t)\n}\nexport function BuildsPage_BuildDetail({ code }: { code: string }): JSX.Element {\n\tconst [build, isUpdating] = useBuildWithDelayedLocs(code)\n\n\tuseEffect(() => {\n\t\twindow.scrollTo(0, 0)\n\t}, [])\n\n\tuseDocumentTitle(\n\t\tisLoaded(build)\n\t\t\t? build.character.name + ' ' + I18N_BUILD_RECS_FOR + I18N_PAGE_TITLE_POSTFIX\n\t\t\t: I18N_LOADING + I18N_PAGE_TITLE_POSTFIX,\n\t)\n\n\tusePageDescription(() => {\n\t\tif (!isLoaded(build)) return null\n\t\tconst role = build.character.roles.find(x => x.isRecommended) ?? build.character.roles[0]\n\t\tif (!role) return null\n\t\tconst weaponR5 = findWeaponWithRarity(build, role, 5)\n\t\tconst weaponR4 = findWeaponWithRarity(build, role, 4)\n\t\tconst art = findFirtArtifact(build, role)\n\t\treturn I18N_CHARACTER_PAGE_DESCRIPTION(\n\t\t\tbuild.character.name,\n\t\t\tparagraphsToInline(role.name),\n\t\t\tweaponR5?.name,\n\t\t\tweaponR4?.name,\n\t\t\tart?.name,\n\t\t\tparagraphsToInline(role.tips),\n\t\t\tparagraphsToInline(role.notes),\n\t\t)\n\t})\n\n\tif (!isLoaded(build)) return <Spinner />\n\n\treturn (\n\t\t<div className=\"builds container\">\n\t\t\t<h1 className={`my-1 letter-spacing-1 ${BUNDLE_ENV.LANG === 'en' ? 'text-capitalize' : ''}`}>\n\t\t\t\t<span className=\"d-none d-xl-inline\">{build.character.name}</span>\n\t\t\t\t<span className=\"d-xl-none\">{I18N_RECOMMENDED_RU_ONLY}</span> {I18N_BUILD_RECS_FOR}\n\t\t\t</h1>\n\t\t\t<FavoriteCharacters navigateToCharacter={true} selectedCharacterCode={code} />\n\t\t\t<CharacterBuildDetailed build={build} isUpdating={isUpdating} />\n\t\t</div>\n\t)\n}\n\nfunction findWeaponWithRarity(\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>,\n\trole: CharacterBuildInfoRole<'monolang'>,\n\trarity: GI_RarityCode,\n) {\n\tfor (const item of role.weapons.advices)\n\t\tfor (const weapon of item.similar) {\n\t\t\tconst data = build.maps.weapons.get(weapon.code)\n\t\t\tif (data && data.rarity === rarity) return data\n\t\t}\n\treturn null\n}\n\nfunction findFirtArtifact(\n\tbuild: MapAllByCode<CharacterFullInfoWithRelated>,\n\trole: CharacterBuildInfoRole<'monolang'>,\n) {\n\treturn (function iter(arts): ArtifactRegularInfo | null {\n\t\tfor (const item of arts) {\n\t\t\tif ('op' in item) return iter(item.arts)\n\t\t\tconst data = build.maps.artifacts.get(item.code)\n\t\t\tif (data) return data\n\t\t}\n\t\treturn null\n\t})(role.artifacts.sets.map(x => x.arts))\n}\n\nfunction paragraphsToInline(node: CompactTextParagraphs | null): string {\n\tif (node === null) return ''\n\tif (typeof node !== 'string') {\n\t\tif (isParagraphArr(node)) return node.map(x => paragraphsToInline(x)).join(' ')\n\t\tif ('p' in node) return paragraphsToInline(node.p)\n\t}\n\tlet text = getInlineText(node)\n\ttext = text.trim().replaceAll('\\n', ': ') //  \n\treturn text\n}\n","import { Equipment } from '#src/modules/equipment'\n\nexport function WeaponsPage() {\n\treturn <Equipment code={'weapons'} />\n}\nexport function ArtifactsPage() {\n\treturn <Equipment code={'artifacts'} />\n}\n","import { I18N_ABOUT_SITE_CONTENT, I18N_ABOUT_SITE_EPIGRAPH } from '#src/i18n/about-site'\r\nimport { I18N_ABOUT_SITE, I18N_PAGE_TITLE_POSTFIX } from '#src/i18n/i18n'\r\nimport miko_fox_src from '#src/media/Miko_fox.png'\r\nimport { useDocumentTitle } from '#src/utils/hooks'\r\n\r\nexport function AboutPage(): JSX.Element {\r\n\tuseDocumentTitle(I18N_ABOUT_SITE + I18N_PAGE_TITLE_POSTFIX)\r\n\treturn (\r\n\t\t<div className=\"builds container\">\r\n\t\t\t<h1 className={`my-1 letter-spacing-1 ${BUNDLE_ENV.LANG === 'en' ? 'text-capitalize' : ''}`}>\r\n\t\t\t\t{I18N_ABOUT_SITE}\r\n\t\t\t</h1>\r\n\t\t\t<div className=\"row\">\r\n\t\t\t\t{/* todo   ,  */}\r\n\t\t\t\t<figure className=\"text-end\">\r\n\t\t\t\t\t<img style={{ width: '100px' }} src={miko_fox_src} />\r\n\t\t\t\t\t<blockquote className=\"blockquote\">\r\n\t\t\t\t\t\t<p>{I18N_ABOUT_SITE_EPIGRAPH.quote}</p>\r\n\t\t\t\t\t</blockquote>\r\n\t\t\t\t\t<figcaption className=\"blockquote-footer\">\r\n\t\t\t\t\t\t{I18N_ABOUT_SITE_EPIGRAPH.footer} <cite>{I18N_ABOUT_SITE_EPIGRAPH.cite}</cite>\r\n\t\t\t\t\t</figcaption>\r\n\t\t\t\t</figure>\r\n\t\t\t\t<div className=\"col-md-7 offset-md-1\">{I18N_ABOUT_SITE_CONTENT}</div>\r\n\t\t\t\t<div className=\"text-muted text-end\">28.03.2022</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","import { Greetings } from '#src/components/greetings'\r\nimport { ItemAvatar } from '#src/containers/item-cards/item-avatars'\r\nimport { I18N_BEST_CHAR_BUILDS, I18N_PAGE_TITLE_POSTFIX, I18N_WE_ARE_EVERYWHERE } from '#src/i18n/i18n'\r\nimport { useDocumentTitle } from '#src/utils/hooks'\r\nimport { ourPagesInSocialNetworks } from '#src/utils/our-pages-in-social-networks'\r\n\r\nexport function EverywherePage(): JSX.Element {\r\n\tuseDocumentTitle(I18N_WE_ARE_EVERYWHERE + I18N_PAGE_TITLE_POSTFIX)\r\n\treturn (\r\n\t\t<div className=\"everywhere container\">\r\n\t\t\t<div className=\"row\">\r\n\t\t\t\t<div class=\"d-none d-lg-block col-lg-9\">\r\n\t\t\t\t\t<Greetings isClosable={false} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"col-lg-3 col-12\">\r\n\t\t\t\t\t<div className=\"d-lg-none\">\r\n\t\t\t\t\t\t<h2 className=\"fw-bolder fst-italic text-center mb-3\">{I18N_BEST_CHAR_BUILDS}</h2>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"\">\r\n\t\t\t\t\t\t<h4 className=\"fw-bolder text-center mt-2 mb-3 text-muted\">\r\n\t\t\t\t\t\t\t{I18N_WE_ARE_EVERYWHERE}\r\n\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{ourPagesInSocialNetworks.map(g => (\r\n\t\t\t\t\t\t<div className=\"card mb-3\" key={g.title}>\r\n\t\t\t\t\t\t\t<div className=\"card-header\">{g.title}</div>\r\n\t\t\t\t\t\t\t<ul className=\"list-group list-group-flush\">\r\n\t\t\t\t\t\t\t\t{g.links.map(l => (\r\n\t\t\t\t\t\t\t\t\t<li className=\"list-group-item\" key={l.title}>\r\n\t\t\t\t\t\t\t\t\t\t<a href={l.href}>\r\n\t\t\t\t\t\t\t\t\t\t\t<ItemAvatar src={l.favicon} classes=\"small-avatar me-3\" />\r\n\t\t\t\t\t\t\t\t\t\t\t{l.title}\r\n\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n","if (process.env.NODE_ENV === 'development') {\n\trequire('preact/debug')\n}\n\n//     \nimport '#src/errors/catch'\n\nimport { render } from 'preact'\n\nimport { App } from './App'\nimport { I18N_UNSUPPORTED_LOCATION_WARNING } from './i18n/i18n'\n\nexport type SSRRenderFunc = () => Promise<string>\n\nexport const renderContent: void | SSRRenderFunc = BUNDLE_ENV.IS_SSR\n\t? //  preact-render-to-string   ,\n\t  // ..   -         -.\n\t  //   require(...) -     .\n\t  () => import('preact-render-to-string').then(x => x.renderToString(<App />, null, { pretty: false }))\n\t: isOnExpectedDomain()\n\t? render(<App />, document.querySelector('body .app') as Element)\n\t: insertUnsupportedLocationWarning()\n\nfunction isOnExpectedDomain() {\n\tif (BUNDLE_ENV.SUPPORTED_DOMAINS === null) return true\n\treturn BUNDLE_ENV.SUPPORTED_DOMAINS.some(x => location.hostname.endsWith(x))\n}\n\nfunction insertUnsupportedLocationWarning() {\n\tconst wrap = document.createElement('div')\n\twrap.className = 'py-1 bg-danger text-white text-center'\n\twrap.textContent = I18N_UNSUPPORTED_LOCATION_WARNING\n\tdocument.body.prepend(wrap)\n}\n"],"names":["inProgress","dataWebpackPrefix","n","l","u","t","o","r","f","e","c","s","a","parentNode","removeChild","h","i","arguments","length","children","call","defaultProps","v","type","props","key","ref","__k","__","__b","__e","__d","__c","__h","constructor","__v","vnode","p","d","this","context","_","indexOf","k","base","b","push","g","__r","debounceRendering","setTimeout","sort","some","__P","j","__n","ownerSVGElement","z","w","y","x","C","Array","isArray","m","A","N","M","appendChild","nextSibling","insertBefore","$","setProperty","test","H","style","cssText","replace","toLowerCase","slice","addEventListener","T","I","removeEventListener","removeAttribute","setAttribute","event","contextType","value","__E","prototype","render","O","sub","state","_sb","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","forEach","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","L","diffed","localName","nodeType","document","createTextNode","createElementNS","createElement","is","data","childNodes","dangerouslySetInnerHTML","attributes","name","__html","innerHTML","checked","current","unmount","componentWillUnmount","P","firstChild","B","Consumer","Provider","splice","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","__H","__V","__N","filter","every","F","q","shift","requestAnimationFrame","clearTimeout","cancelAnimationFrame","__source","__self","ContextProvider","Portal","_this","container","_container","_temp","_vnode","child","before","el","containerInfo","comparer","shouldUpdate","nextProps","updateRef","shallowDiffers","Memoed","displayName","isReactComponent","_forwarded","mustBeDefined","val","undefined","Error","mustBeNever","values","staticNever","clamp","min","max","promiseNever","Promise","isPromise","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","definition","Object","defineProperty","enumerable","get","chunkId","all","keys","reduce","promises","miniCssF","obj","prop","hasOwnProperty","url","done","script","needAttach","scripts","getElementsByTagName","getAttribute","charset","timeout","nc","src","onScriptComplete","prev","onerror","onload","doneFns","fn","bind","target","head","Symbol","toStringTag","installedChunks","installedChunkData","promise","resolve","reject","error","errorType","realSrc","message","request","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","id","chunkLoadingGlobal","self","sendNewItem","level","fingerprint","rollbarBody","body","JSON","stringify","environment","code_version","platform","location","href","client","javascript","browser","navigator","userAgent","fetch","method","headers","then","json","resp","err","logErrorExt","anyError","silent","console","class_","trace","frames","exception","class","sendError","stack","catch","logError","window","filename","lineno","colno","reason","mappedArrPush","map","set","arrShallowEqual","arrGetAfter","arr","item","direction","index","arrOrItemToArr","BS_BreakpointsCodes","BS_BreakpointsMap","xs","sm","md","lg","xl","xxl","BS_getCurrBreakpoint","screenWidth","find","PENDING","isLoaded","useFetch","loadFunc","args","controller","prevArgs","foceUpdate","useForceUpdate","abort","ac","AbortController","res","signal","finally","useClickAway","refs","callback","handleClick","HTMLElement","contains","useWindowSize","windowSize","setWindowSize","width","innerWidth","height","innerHeight","breakpoint","handleResize","versions","setVal","initialValue","setValueInner","curRecord","localStorage","getItem","parse","ex","setValueAndSave","setItem","dispatchEvent","CustomEvent","detail","onStorage","log","useLocalStorage","version","setValInner","setValue","node","handleMouseOver","handleMouseOut","useUniqKey","Math","random","useVisibleTicker","interval","isVisible","setIsVisible","visibilityState","onVisibilityChange","onPageHide","onPageShow","useWindowVisibility","callbackInner","Date","now","useDocumentTitle","title","shouldRestoreOnUnmount","defaultTitle","useHashValue","defaultValue","getHashValue","setHashValue","onHashChange","setValAndHash","URLSearchParams","hash","params","delete","toString","origin","pathname","search","history","replaceState","useScrollTo","shouldScrollToArg","scrollParams","shouldScrollTo","setShouldScrollTo","behavior","scrollIntoView","BULLET","NBSP","DASH","GoUpBtn","classes","onClick","scrollTo","scrollPosition","setScrollPosition","setScrollPositionLocal","pageYOffset","useScrollPosition","className","position","PageWrap","LINK_DISCORD_INVITE","LANG","I18N_LANG_NAMES","en","ru","I18N_LANG_NAME","I18N_PAGE_TITLE_POSTFIX","I18N_LOADING","I18N_COLLAPSE","I18N_DASHBOARD","I18N_REGION","I18N_UNTIL_DAY_RESET","I18N_ALCHEMY_CALC","I18N_WHAT_TO_FARM","I18N_BUILDS","I18N_ASIA","I18N_NORH_AMERICA","I18N_EUROPE","I18N_TODAY","I18N_WEEKDAYS","I18N_TOMORROW","I18N_DUNGEONS","I18N_TALENTS","I18N_WEAPONS","I18N_MAIN_INFO","I18N_WEAPON_STACKS_COUNT","stacks","pluralizeEN","pluralizeRU","I18N_WEAPON_REFINE","refine","I18N_WHY_ADD_TO_FAVS_TIP","I18N_FAV_CHARACTERS","add","remove","weapon","character","material","I18N_CHOOSE_FROM_FAV","I18N_ARTIFACTS","I18N_CHARACTERS","I18N_ART_STATS_PRIORITY","I18N_SUBSTATS_PRIORITY","I18N_TALENTS_PRIORITY","I18N_ASC_MATERIALS","I18N_FULL_BUILD_INFO","I18N_MORE_ON_BUILDS_PAGE","I18N_BACK","I18N_NOTES","artTypeNamesRU","flower","plume","sands","goblet","circlet","I18N_ART_TYPE","code","statNamesRu","def","dmg","atk","hp","em","er","healing","I18N_STAT_NAME","talentTypesNamesRU","attack","skill","burst","I18N_TALENT_NAME","I18N_CONJUCTIONS","or","and","I18N_RECOMMENDED_FOR","I18N_FOR_NOBODY","I18N_SOURCE","I18N_SCROLL_TO_ZOOM","I18N_PINCH_TO_ZOOM","I18N_CANCEL","I18N_SUBMIT","I18N_SUBMIT_BUG_SUCCESS","I18N_SUBMIT_BUG_ERROR","I18N_YOUR_MESSAGE_HERE","I18N_REPORT_BUG_GUIDE","I18N_ERROR","I18N_PIECE_BONUS","I18N_PIECES_BONUS","I18N_BASE_ATTACK","I18N_ITEM_STORY","I18N_ON_MAP","I18N_SECONDARY_STAT","I18N_MAP_CODES_NAME","teyvat","enkanomiya","chasm","I18N_CHAR_BUILD_RECS","I18N_BEST_CHAR_BUILDS","I18N_FOR_EXAMPLE","I18N_SELECT_CHAR_BELOW","I18N_BUILD_RECS_FOR","I18N_RECOMMENDED_RU_ONLY","I18N_ABOUT_SITE","I18N_OUR_SOCIAL_NETWORKS","I18N_PAGE_WITH_ALL_LINKS","I18N_WE_ARE_EVERYWHERE","I18N_CHATS","I18N_VIDEOS","I18N_DONATE_US","I18N_EQUIPMENT","I18N_OUR_DISCORD","yt","I18N_YOUTUBE_RU","I18N_YOUTUBE_UA","tiktok","I18N_TIKTOK_RU","I18N_TIKTOK_UA","I18N_CHAR_EQUIPMENT","I18N_CREATED_BY_US","I18N_REPORT_BUG","I18N_SUPPORT_US","I18N_SUPPORT_VIA_DONATELLO","I18N_SUPPORT_VIA_KO_FI","I18N_SUPPORT_VIA_DON_ALERTS","I18N_ORDER_SITE_FROM_US","I18N_NOT_AFFILIATED_WITH_MIHOYO","I18N_C_MIHOYO","I18N_HELPER_TEAM_TABLE","I18N_HONEY_IMPACT","I18N_GI_MAP","I18N_GI_WIKI","I18N_AKASHADATA","I18N_WE_USE_DATA_FROM","I18N_COPYRIGHTS","I18N_UNSUPPORTED_LOCATION_WARNING","I18N_NOTHING_TO_SHOW","I18N_MEGA_SEARCH_PLACEHOLDER","I18N_ABYSS_LETTERS_EXPLANATION","weaponTypeNamesRU","claymore","sword","catalyst","polearm","bow","I18N_WEAPON_TYPE_NAME","weaponObtainSourceNamesRU","wishes","events","forging","fishing","chests","quests","puzzles","investigation","playstation","other","I18N_WEAPON_OBTAIN_SOURCE_NAME","I18N_OBTAINED_DURING_STORYLINE","I18N_ART_GROUP_NAME","I18N_ITEM_DETAIL","I18N_ARROWS_TO_SELECT","I18N_RECOMMENDED_BUILDS","I18N_OBTAIN_SOURCES","I18N_SORT_BY","I18N_USAGE","I18N_USED_IN_ABYSS","toFixed","I18N_FILTER","I18N_WEAPON_TYPE","I18N_NAME","I18N_SUBSTAT","I18N_RARITY","I18N_WEAPON_TYPE_FILTER_TIP","everything","pluralizeHours","hours","pluralizeMinutes","minutes","I18N_MS_TO_HM_WORDS","duration","floor","w0","w1","d0","d10","w3","modalsEl","GET_MODALS_EL","querySelector","ReportBugModal","onClickAway","setMessage","isInvalid","setIsInvalid","onMessageChange","modalRef","tryToSendMessage","msg","alert","placeholder","rows","onInput","Footer","isReportBugModalVisible","setIsReportBugModalVisible","onRepBugBtnClick","closeRepBugModal","role","charactersShortList","ART_GROUP_CODES","paths","front","builds","buildCharacters","weapons","artifacts","about","everywhere","matchPath","path","rem","part","matched","withoutPrefix","variants","variant","prefix","startsWith","URL_LANG_PREFIX","makeUrlLangPrefix","findRoutedComponent","routes","route","comp","pathSearchHash","tryRouteToPage","hashChanged","pushState","lang","makeLocationHrefForLang","curPrefix","newUrl","assign","innerRef","isExternal","calcPosForDd","parentRect","ddRect","isAbsolute","isCentered","shouldFitInScreen","tWidth","tHeight","scrollTopFix","scrollY","centredFix","top","left","layoutPositionX","layoutPositionY","layoutPosition","targetEl","wrapRef","defClassName","arrowStyle","setArrowStyle","onResize","wrapEl","pos","getBoundingClientRect","offsetWidth","GI_ROTATION_WEEKDAY_CODES","GI_ARTIFACT_GROUP_CODES","_GI_STAT_PERCENT","_GI_STAT_DMG_PEFIXES","GI_REGION_TIMEZONE_OFFSET","concat","europe","asia","getRegionTime","regionCode","offsetHours","lastResetDate","setHours","getHours","weekdayMonSun","weekday","getUTCDay","setUTCHours","nextResetDate","setDate","getDate","weekdayCode","resetIn","resetAt","locEnc_code2map","E","decodeLocations","encodedLocations","downsample","parseInt","locs","mapCode","len3","decodeLocNum","str","decodeObjLocations","_locsEnc","locations","mapAllByCode","maps","attr","Map","decodeRelatedLocations","rel","items","enemies","enemy","getAllRelated","codes","BlockHeader","MobileDesktopSwitch","childrenDesktop","childrenMobile","br","tabTitleFromName","Tabs","tabs","titleFunc","selectedTab","onTabSelect","preventDefault","BtnTabGroup","visibleTabsLength","tabsGrouped","disabled","LightBtnTabGroup","btnClass","btnClassActive","btnClassDisabled","useSelectable","tabCodes","setTabCodes","argsInner","tab","setTab","ItemDetailDdPortal","contentKey","shouldScrollToTop","elTop","ItemDetailDdMobilePortal","artifactTypes","imgSrc","getArtifactTypeIconSrc","artifactTypeCode","at","isGroup","getArtifactIconSrc","artifactCode","getArtifactIconLargeSrc","getAllArtifacts","artsMap","getAllOrNone","getItemIconSrc","itemCode","weaponTypes","getWeaponIconSrc","weaponCode","getWeaponIconLageSrc","DEF_ANCESTRY_CODES","AlchemyCalculator","ancestryCodes","setValues","onValueChange","dataset","startNotRoundClass","endNotRoundClass","isFirst","isLast","rarity","ItemAvatar","endRoundClass","Spinner","CentredSpinner","CentredLabel","label","SimpleSelect","options","selectedOption","onOptionSelect","size","handleChange","onChange","selected","hidden","LazyTeyvatMap","dummyMarkerGroups","markers","icon","addMarkerGroupsByDomains","markerGroups","domains","domain","loc","addMarkerGroupsByEnemies","CardMap","itemData","isItemFavable","isFatHead","TeyvatMap","markerGroupsLocal","isMapEmpty","selectedSource","setSelectedSource","visibleMapCodeTabs","mapCodes","Set","marker","from","selectedMapCodeTab","setMapCodeTab","selectedMapCode","setSourceAndFixMapCode","sourceSelectEl","isItemWeaponPrimaryMaterial","types","opacity","ToggleWeaponPrimaryMaterialFav","LabeledItemAvatar","isNoBg","avatarClasses","for","SV_SELECTED_REGION_CODE","language","curOffset","getTimezoneOffset","guessCurrentRegion","SV_ARE_GREETINGS_VISIBLE","favCodes","SV_FAV_CHAR_CODES","SV_FAV_TALENT_MATERIAL_CODES","SV_FAV_WEAPON_PRIMARY_MATERIAL_CODES","RecommendedTo","charCodes","isInline","isAvatarWithBorder","navigateToCharacter","favCharCodes","charLists","groupsMap","count","groups","entries","countA","countB","reverse","CharacterAvatar","badgeTopStart","AscMaterials","materials","selectedMat","onMatSelect","matList","CardDescMobileWrap","Card","titleEl","selectorEl","bodyEl","mapEl","DdContext","ddContext","ArtifactCard","related","selectedArt","setSelectedArt","dataForMap","srcs","obtainSources","domainCodes","enemyCodes","sets","notesToJSX","recommendedTo","WeaponCard","materialCodes","materialOnMap","setMaterialOnMap","typeCode","join","subStat","passiveStat","OtherItemCard","isItemCharTalentMaterial","codesForCalc","ToggleTalentMaterialFav","DUMMY_ROLES","makeRoleTitle","isRecommended","CIRCLET_GOBLET_SANDS","getRoleData","build","selectedCode","roles","genArtMainStatDetail","isShort","genSimpleList","mainStats","genNotes","notes","tips","processObj","tip","split","flat","ItemLabelWithDd","artifact","getCoverArtifactForSet","artsForDd","coverArt","genArtifactAdvice","artifactsForDd","avatarTopEndBadge","ddComponent","ItemsListGroupWrap","arts","art","isLastInList","ItemsJoinerWrap","op","ToggleSmthFav","smthCode","storageKey","tipFav","tipNotFav","favSmthCodes","setFavSmthCodes","elRef","isHovered","isFav","toggleFav","ToggleCharFav","characterCode","unprefixTraveler","getCharacterAvatarSrc","getCharacterAvatarLargeSrc","getCharacterSilhouetteSrc","badgeTopEnd","borderColor","rarityClass","isExpanded","setIsExpanded","closeDd","openDd","pointerClass","onClickLocal","borderStyle","border","codeToBadge","classesLocal","ItemLabel","ItemDd","ItemsDataContext","ddComp","coverArtifact","interactiveLabelClass","avatarTopStartBadge","ourPagesInSocialNetworks","links","favicon","GlobeIcon","viewBox","fill","xmlns","isPageActive","routs","isOnRoute","Nav","isNavExpanded","EquipmentDd","LinksDd","DonationDd","LangSelect","linkDataToDdLink","LINKS_DD_LINKS","HeadDd","ddLinks","SUPPORT_DD_LINKS","EQUIPMENT_DD_LINKS","ddLinksLocal","isActive","ddRef","targetRef","toggleDd","isActiveLang","apiGetJSONFile","getLang","_map","func","apiGetArtifacts","apiGetWeapons","apiMaterialsTimetable","apiGetSearchData","apiGetAbyssStats","keyMap","genEquipmentHash","getIconForItem","strIndexOrInf","searchStr","Infinity","sortInItem","nameLC","nameEnLC","itemTypes","MegaSearch","setSearchStr","searchData","searchDataGrouped","searchDataLocal","si","toLocaleLowerCase","nameEn","clearSearch","shouldBlur","blur","ddEl","searchResults","searchResultsLocal","it","includes","searchInItem","clearSearchAndBlurLocal","onKeyPress","onSearchValueChange","currentTarget","SearchResultsWrap","searckTypeTitleMap","switchSearchType","offset","fromIndex","itemsLen","ctrlKey","altKey","shiftKey","metaKey","results","len","mainItemHrefMap","dispatchRouteTo","SearchItemCard","isSelected","highlightPartOfText","regexp","text","String","block","RegExp","nameWithHighlight","nameEnWithHighlight","mainItemHref","Header","setIsNavExpanded","zIndex","I18N_ABOUT_SITE_EPIGRAPH","quote","footer","cite","I18N_ABOUT_SITE_CONTENT","useBuildWithDelayedLocs","isUpdating","prevDataRef","sig","useFetchWithPrev","buildIsLoaded","fullInfo","locsInfo","applyItemsLocationsImmut","applyFullInfoLocationsImmut","locItems","resItems","hex","isNaN","round","charAt","trim","substring","convertToRGB","color","percentsSpectrum","colorStart","colorEnd","colorCount","end","start","alpha","saida","rgb","generateColor","getPercentLetters","percent","getAbyssDataForCharIcon","abyssStats","percents","mostUsedCharacters","use","letters","badge","right","WeaponTypeFilter","selectedWeaponTypeCode","onTypeCodeSelect","wt","CharacterPickerMobile","selectedElementCode","setSelectedElementCode","setSelectedWeaponTypeCode","element","characters","elementCode","weaponTypeCode","abyssData","selectElement","CharacterPickerDesktop","isLastRowClass","wType","CharacterPicker","FavoriteCharacters","onCharacterSelect","shoudSelectFirst","selectedCharacterCode","blockLabel","charactersShortListCodes","characterCodes","charactersElems","CharacterPortrait","CharacterRating","stats","charCodeLocal","charData","backgroundColor","CharacterBuildDetailed","roleTabs","selectedRoleTab","setSelectedRoleTab","goBack","back","weaponListBlock","advices","advice","isInList","similar","artifactsListBlock","artifactStatsAndSkillsBlock","subStats","talents","notesBlock","credits","materialsBlock","CharacterDetailDesktop","CharacterDetailMobile","Accordion","expandedItemCode","expandedItemCodeLocal","setexpandedItemCode","ai","isThisExpanded","content","artTypeTabs","ArtifactCardLine","onClose","selectedArtTypeTab","setSelectedArtTypeTab","artifactFull","apiGetArtifact","artTypeTabsFiltered","att","pieces","mainInfoColInner","loreInfoColInner","description","story","locationColInner","cellClass","forAccordion","ArtifactCardTableRow","group","setSelectedArtifactCode","toggleExpand","bgClass","cardRef","expandedRow","colSpan","collapsededRow","ArtifactsList","selectedArtifactCode","artifactsSorted","artifactsLocal","scope","WeaponCardLine","weaponFull","apiGetWeapon","WeaponCardTableRow","setSelectedWeaponCode","WEAPON_SORT_CODES","WEAPON_SORT_NAMES","WEAPON_SORT_FUNCS","WeaponSort","selectedSortCode","onSortCodeSelect","WEAPON_FILTER_OBTAIN_SOURCE","WeaponFilter","selectedSortCodes","onFilterCodeSelect","filterVariants","WeaponsList","setSelectedSortCode","selectedWeaponCode","selectedObtainSourceCodes","setSelectedObtainSourceCodes","otherObtainSourceCodes","sc","weaponsFilteredSorted","weaponsLocal","cats","Equipment","selectedCat","yaeCode","damages","updateEl","coords","sensX","sensY","transform","Greetings","isClosable","isHiddenOnMobile","areGreetingsVisible","setAreGreetingsVisible","areCurrentlyVisible","hiddenOnMobileClass","bgRef","mikoRef","damagesRef","mikoName","setMikoName","closeGreetings","openGreetings","moveElems","passive","clientX","clientY","dr","BuildInfo","updateName","FarmToday","ttData","selectedRegionCode","tomorrowCode","favTalMaterialCodes","favWeapPrimMatCodes","setSelectedTab","timetable","characterAscensions","asc","itemRegion","lineHeight","weaponMaterialCodes","europeOpt","RegionSwitch","setSelectedRegionCode","onOptSelectLocal","TimeUntilDayReset","CharacterBuildPreview","displayingCharacterCode","artifactMainStatsBlock","artifactSubStatsBlock","talentsBlock","BuildsPreviewsWrap","setSelectedCharacterCode","Fieldset","legend","hostname","endsWith","page","handled","button","Element","closest","URL","handleAnchorClick","onRouteTo","onPopState","Comp","useRouter","wrap","textContent","prepend","insertUnsupportedLocationWarning"],"sourceRoot":""}